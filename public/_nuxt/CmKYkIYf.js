import{_ as O}from"./CNMhSPC9.js";import{z as _,a as M,X as d,s as I,x as E,b as i,e as p,f as a,g as e,t as n,J as f,y as T,F as v,k as R,H as N,N as L,C as u,j as B,h as y,i as V,v as F,_ as j,n as P}from"./B6cxelmB.js";import{_ as K}from"./Da23Wecq.js";import{_ as G}from"./C6204BTj.js";import{_ as H}from"./CDRCXyuD.js";import{u as U}from"./DsqkzYFl.js";import{S as w}from"./Cks3IAUc.js";import{a as Y,n as X}from"./BILimEja.js";import{P as q}from"./D4--2Hlb.js";import{u as z}from"./CZuTiJYT.js";import{r as J}from"./nyUbY2H-.js";import{r as W}from"./81D-L97k.js";import{r as Q}from"./CW8KkBU1.js";import{r as Z}from"./4ZDoBlBI.js";import{r as $}from"./DZ0fSVSz.js";import{r as ee}from"./C-hhK8bf.js";import{_ as S}from"./DmiAZkRe.js";import{_ as te}from"./PHlxz6BT.js";import"./ggmJqlUs.js";import"./D3aePf0O.js";import"./D2wjyI06.js";import"./1lOtxyWh.js";import"./DnKNuaHm.js";import"./CRKLI29b.js";import"./48QfwrLv.js";import"./KGHA3aGV.js";const re={setup(){z({title:`${q.name.toUpperCase()} - Stock Reports`})},components:{ExportToExcel:Y,ExportToWord:X,ExclamationCircleIcon:J,CheckCircleIcon:W,ExclamationTriangleIcon:Q,ArchiveBoxXMarkIcon:Z},data(){return{moment:_,header:"Stock Reports",facility:U(),tab:0,generating:!1,dateRange:[],pages:[{name:"Home",link:"/home"},{name:"Stock Management",link:"#"}],reportData:new Array,generateIcon:$,exportIcon:ee,cookie:M("token"),transactionTypes:new Array,selectedType:{name:"-- select type --"}}},created(){this.init()},computed:{generalStockExportData(){return this.reportData.map(t=>({"STOCK ITEM":t.name,DESCRIPTION:t.description,BALANCE:t.consolidated_available_balance,"MINIMUM ORDER LEVEL":t.minimum_order_level,LOCATION:t.stock_location,CATEGORY:t.stock_category,STRENGTH:t.strength,BATCH:t.batch,"LOT NUMBER":t.lot,"TRANSACTION TYPE":t.transaction_type,"EXPIRY DATE":_(t.expiry_date).format(d),RECEIVER:t.receiving_from,SENDER:t.sending_to,REMAKRS:this.checkStock(t)}))},stockMovementExportData(){return this.reportData.map(t=>({"Stock Item":t.name,TYPE:t.transaction_type,"STOCK BEFORE":t.overall_stock_balance_before_transaction,ADJUSTMENT:t.transacted_quantity,"STOCK AFTER":t.overall_stock_balance_after_transaction,DATE:_(t.transaction_date).format(d)}))},generalStockData(){return this.reportData.map(t=>({...t,remarks:this.checkStock(t)}))},getStockClass(){return t=>{const r=(t||"").toLowerCase();return r==="not expired"?"text-green-600":r==="expired"?"text-red-600":r==="near expiry"?"text-yellow-500":r==="out of stock"?"text-gray-600":""}},getStockIcon(){return t=>{const r=(t||"").toLowerCase();return r==="not expired"?"CheckCircleIcon":r==="expired"||r==="near expiry"?"ExclamationTriangleIcon":r==="out of stock"?"ArchiveBoxXMarkIcon":"div"}},getStockText(){return t=>{const r=(t||"").toLowerCase();return r==="not expired"?"":r==="expired"?"Expired":r==="near expiry"?"Near Expiry":r==="out of stock"?"Out of Stock":""}}},methods:{checkStock(t){let r=this.checkExpiryStatus(t);if(r=="Not Expired")if(t.after_transaction_remaining_balance>0){if(t.after_transaction_remaining_balance<t.minimum_order_level)return"Low Stock"}else return"Out of Stock";else return r},checkExpiryStatus(t){const r=new Date;r.setHours(0,0,0,0);const c=new Date(t.expiry_date);if(c.setHours(0,0,0,0),c<r)return"Expired";const m=new Date;return m.setDate(r.getDate()+14),c<=m?"Near Expiry":"Not Expired"},async init(){const t=new w,{data:r,error:c,pending:m}=await t.getStockTransactionTypes(`${this.cookie}`);r.value&&(this.transactionTypes=r.value),c.value&&console.error(c.value)},async generateStockReport(){this.generating=!0;const t=this.dateRange!==null&&this.dateRange.length>0?_(this.dateRange[0]).format(d):"",r=this.dateRange!==null&&this.dateRange.length>1?_(this.dateRange[1]).format(d):"",c=this.selectedType.name=="-- select type --"?"":this.selectedType.name,m=new w,{data:o,error:l,pending:x}=await m.generateStockMovementReport(`${this.cookie}`,c,t,r);this.generating=x,o.value&&(this.reportData=o.value.data,this.generating=!1),l.value&&(console.error(l.value),this.generating=!1)}}},oe={class:"px-5 py-5"},se={class:"flex items-center justify-between py-5"},ne={class:"text-2xl font-semibold"},ae={class:"flex items-center space-x-2 bg-gray-50"},le={key:0,class:"py-5"},ie={class:"w-full flex items-center justify-between py-5"},ce={class:"flex items-center space-x-2"},pe={class:"flex items-center space-x-2"},de={id:"print-container1"},me={class:"w-full border rounded px-10 py-5"},_e={class:"flex items-center justify-between px-5"},ue={class:"py-5"},xe={class:"w-full"},fe={class:"w-full"},ye={class:"px-2 py-2 text-left border-r border-l"},he={class:"px-2 py-2 text-left border-r border-l"},ge={class:"px-2 py-2 text-left border-r border-l"},be={class:"px-2 py-2 text-left border-r border-l text-green-500"},ke={class:"px-2 py-2 text-left border-r border-l"},Ee={class:"px-2 py-2 text-left border-r border-l"},Te={key:1,class:"px-3 py-3"},ve={class:"flex items-center justify-between py-5"},Re={class:"flex items-center space-x-2"},we={class:"w-72"},Se={class:"border rounded mt-10",id:"print-container"},De={class:"w-full rounded-t border-b px-10 py-5"},Ae={class:"flex items-center justify-between px-5"},Ce={class:"py-5"},Oe={class:"px-3 py-4"},Me={class:"font-medium"},Ie={class:"text-normal font-normal"},Ne={class:"flex itmes-center mx-auto justify-center py-20"},Le={key:0,class:"w-full"},Be={class:"w-full"},Ve={class:"px-2 py-2 text-left border-r"},Fe={class:"px-2 py-2 text-left border-r border-l"},je={class:"px-2 py-2 text-left border-r border-l"},Pe={class:"px-2 py-2 text-left border-r border-l"},Ke={class:"px-2 py-2 text-left border-r border-l"},Ge={class:"px-2 py-2 text-left border-l"},He={key:0,class:"flex flex-col space-y-3 items-center justify-center"};function Ue(t,r,c,m,o,l){const x=O,h=j,g=K,b=E("excel"),k=G,D=E("datepicker"),A=H,C=P;return i(),p("div",oe,[a(x,{pages:o.pages},null,8,["pages"]),e("div",se,[e("h3",ne,n(o.header),1)]),e("div",null,[e("div",ae,[e("button",{onClick:r[0]||(r[0]=s=>o.tab=0),class:f(o.tab==0?"bg-sky-500 text-white py-2 px-4":"font-medium px-4 text-gray-600 hover:text-sky-500 transition duration-150")}," General Stock ",2),e("button",{onClick:r[1]||(r[1]=s=>o.tab=1),class:f(o.tab==1?"bg-sky-500 text-white py-2 px-4":"font-medium px-4 text-gray-600 hover:text-sky-500 transition duration-150")}," Stock Movements ",2)]),o.tab==0?(i(),p("div",le,[e("div",null,[e("div",ie,[e("div",ce,[a(h,{loading:o.generating,click:()=>{l.generateStockReport()},text:"Generate Report",color:"primary",icon:o.generateIcon},null,8,["loading","click","icon"])]),e("div",pe,[a(b,{class:"btn btn-default",header:["GENERAL STOCK LABORATORY REPORT",o.facility.details.name,o.facility.details.address,o.facility.details.phone],data:l.generalStockExportData,worksheet:"report-work-sheet",name:"general_stock_laboratory.xls"},{default:T(()=>[a(g,{color:"success",click:()=>{},icon:o.exportIcon,text:"Export"},null,8,["icon"])]),_:1},8,["header","data"])])]),e("div",de,[e("table",me,[e("tbody",null,[e("tr",_e,[r[4]||(r[4]=e("div",{class:"flex flex-col space-y-2"},[e("img",{src:S,alt:"app-logo",class:"w-24 h-24 object-cover"}),e("h3",{class:"text-xl font-semibold"},"GENERAL STOCK REPORT")],-1)),e("td",ue,[a(k)])])])]),e("table",xe,[r[5]||(r[5]=e("thead",{class:"w-full"},[e("tr",{class:"border-b border-r border-l bg-gray-50"},[e("th",{class:"px-2 py-2 text-left border-r uppercase"},"Stock Item"),e("th",{class:"px-2 py-2 text-left border-r uppercase"},"Location"),e("th",{class:"px-2 py-2 text-left border-r uppercase"},"Batch"),e("th",{class:"px-2 py-2 text-left border-r uppercase"},"Lot"),e("th",{class:"px-2 py-2 text-left border-r uppercase"},"Quantity"),e("th",{class:"px-2 py-2 text-left uppercase"},"Remarks")])],-1)),e("tbody",fe,[(i(!0),p(v,null,R(l.generalStockData,s=>(i(),p("tr",{class:"w-full border-b",key:s.id},[e("td",ye,n(s.name),1),e("td",he,n(s.stock_location),1),e("td",ge,n(s.batch),1),e("td",be,"#"+n(s.lot),1),e("td",ke,n(s.consolidated_available_balance),1),e("td",Ee,[e("div",{class:f(["flex items-center space-x-1",l.getStockClass(s==null?void 0:s.remarks)])},[(i(),N(L(l.getStockIcon(s==null?void 0:s.remarks)),{class:"w-5 h-5"})),e("p",null,n(l.getStockText(s==null?void 0:s.remarks)),1)],2)])]))),128))])])])])])):u("",!0),o.tab==1?(i(),p("div",Te,[e("div",null,[e("div",ve,[e("div",Re,[e("div",we,[a(D,{position:"left","input-class-name":"datepicker",range:"",placeholder:"start date & end date",modelValue:o.dateRange,"onUpdate:modelValue":r[2]||(r[2]=s=>o.dateRange=s),format:"dd/MM/yyyy",maxDate:new Date},null,8,["modelValue","maxDate"])]),a(A,{class:"w-44",items:o.transactionTypes,modelValue:o.selectedType,"onUpdate:modelValue":r[3]||(r[3]=s=>o.selectedType=s)},null,8,["items","modelValue"]),a(h,{text:"Generate",click:()=>{l.generateStockReport()},color:"success",icon:o.generateIcon},null,8,["click","icon"])]),e("div",null,[a(b,{class:"btn btn-default",header:["STOCK MOVEMENT LABORATORY REPORT",o.facility.details.name,o.facility.details.address,o.facility.details.phone],data:l.stockMovementExportData,worksheet:"report-work-sheet",name:"stock_movement_laboratory.xls"},{default:T(()=>[a(g,{color:"success",click:()=>{},icon:o.exportIcon,text:"Export"},null,8,["icon"])]),_:1},8,["header","data"])])]),e("div",Se,[e("table",De,[e("tbody",null,[e("tr",Ae,[r[6]||(r[6]=e("div",{class:"flex flex-col space-y-2"},[e("img",{src:S,alt:"app-logo",class:"w-24 h-24 object-cover"}),e("h3",{class:"text-xl font-semibold"},"STOCK MOVEMENT REPORT")],-1)),e("td",Ce,[a(k)])])])]),e("div",null,[e("div",Oe,[e("h4",Me,[r[7]||(r[7]=B("Movement period: ")),e("span",Ie,n(o.dateRange!==null&&o.dateRange.length>0?o.moment(o.dateRange[0]).format("DATE_FORMAT"in t?t.DATE_FORMAT:y(d)):"")+" - "+n(o.dateRange!==null&&o.dateRange.length>1?o.moment(o.dateRange[1]).format("DATE_FORMAT"in t?t.DATE_FORMAT:y(d)):""),1)])]),V(e("div",Ne,[a(C,{loading:o.generating},null,8,["loading"])],512),[[F,o.generating]]),o.reportData.length>0&&!o.generating?(i(),p("table",Le,[r[8]||(r[8]=e("thead",{class:"w-full"},[e("tr",{class:"border-t border-b bg-gray-50"},[e("th",{class:"px-2 py-2 text-left border-r uppercase"},"Stock Item"),e("th",{class:"px-2 py-2 text-left border-r uppercase"},"Type"),e("th",{class:"px-2 py-2 text-left border-r uppercase"},"Stock Before"),e("th",{class:"px-2 py-2 text-left border-r uppercase"},"Adjustment"),e("th",{class:"px-2 py-2 text-left border-r uppercase"},"Stock After"),e("th",{class:"px-2 py-2 text-left uppercase"},"Date")])],-1)),e("tbody",Be,[(i(!0),p(v,null,R(o.reportData,s=>(i(),p("tr",{class:"w-full",key:s.Lot},[e("td",Ve,n(s.name),1),e("td",Fe,n(s.transaction_type),1),e("td",je,n(s.overall_stock_balance_before_transaction),1),e("td",Pe,n(s.transacted_quantity),1),e("td",Ke,n(s.overall_stock_balance_after_transaction),1),e("td",Ge,n(o.moment(s.transaction_date).format("DATE_FORMAT"in t?t.DATE_FORMAT:y(d))),1)]))),128))])])):u("",!0)])]),o.reportData.length==0&&!o.generating?(i(),p("div",He,r[9]||(r[9]=[e("img",{src:te,class:"w-20 h-20",alt:"no-stock-svg"},null,-1),e("p",null,"Please generate report data to preview the report",-1)]))):u("",!0)])])):u("",!0)])])}const yt=I(re,[["render",Ue]]);export{yt as default};
