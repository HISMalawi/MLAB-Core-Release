import{_ as Ze}from"./Breadcrumb.vue.e3e89550.js";import{o as y,c as P,e as s,p as he,x as O,G as M,ac as je,ab as fe,N as G,P as qe,a4 as Ae,F as X,ad as _e,_ as Z,h as w,t as k,w as ve,v as ge,d as a,n as Fe,a as ie,b as L,i as T,j as K,f as ae,ah as Je,l as F,m as Y,q as U,r as oe,ao as et,g as tt,u as st}from"./entry.ede29211.js";import{r as ot,_ as nt}from"./Dropdown.ab1751ca.js";import{_ as rt}from"./SearchBar.1391c33c.js";import{r as J}from"./XMarkIcon.e9883b5f.js";import{_ as lt}from"./index.b56065f4.js";import{_ as Le}from"./OutlinedButton.b12dd67e.js";import{e as W,d as ce}from"./constants.ee9a0283.js";import{u as ue,e as q,f as A,o as it,p as at,q as ct,h as N,r as Oe,s as Me,P as Ie,l as re,k as Ue,c as ut,t as dt}from"./fetch.7c05310f.js";import{r as Be}from"./UserIcon.cdf70d1a.js";import{a as be,r as Ee}from"./PencilSquareIcon.8f17322d.js";import{r as Ne}from"./ArrowDownTrayIcon.a1ec8672.js";import{r as Ve}from"./ArrowUturnLeftIcon.7e967665.js";import{a as pt,p as mt,E as ht,n as ze,d as B,S as ye,h as xe,U as we,G as ke,V as Se}from"./transition.a542e4ff.js";import{r as ne}from"./CheckBadgeIcon.9b3198c3.js";import{r as ft}from"./PrinterIcon.41d0b58e.js";import{_ as _t}from"./Datatable.82d36aa2.js";import{P as vt}from"./package.6544c22a.js";import{r as gt}from"./MagnifyingGlassIcon.ca94e239.js";import{r as bt}from"./ChevronDownIcon.596ee427.js";import{r as yt}from"./CheckIcon.6472b009.js";import{m as Te,o as d,E as $e,u as H,g as xt,l as le,y as wt,i as kt,j as St,H as Ce,t as Q,f as de,a as pe,p as Tt,b as De,d as V,P as z,N as E,T as me}from"./hidden.43ef53b5.js";import{b as $t}from"./use-text-value.ab5a185c.js";import{r as Ct}from"./CheckCircleIcon.7771a99b.js";import{r as Pt}from"./FunnelIcon.33259fc4.js";import{r as Re}from"./SquaresPlusIcon.a875a76e.js";import{r as It}from"./AdjustmentsVerticalIcon.e58ae493.js";import{a as Dt,r as Rt}from"./ChevronRightIcon.600767ba.js";import{r as jt}from"./ArchiveBoxXMarkIcon.a4cc98d5.js";import{r as se}from"./HandThumbDownIcon.2f4ac99f.js";import{r as qt}from"./ArrowPathIcon.d17b6b30.js";import{F as At,K as Ft,B as Lt,N as Ot,H as Mt}from"./listbox.b2d98ace.js";import{M as Ut,R as Bt,h as Et,y as Nt}from"./menu.c3d21db7.js";import"./nuxt-link.cd4ac04e.js";import"./HomeIcon.e5ce52a1.js";import"./network.8dfa1f5e.js";function Vt(t,o){return y(),P("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[s("path",{"fill-rule":"evenodd",d:"M12.97 3.97a.75.75 0 011.06 0l7.5 7.5a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 11-1.06-1.06l6.22-6.22H3a.75.75 0 010-1.5h16.19l-6.22-6.22a.75.75 0 010-1.06z","clip-rule":"evenodd"})])}function zt(t,o){return y(),P("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[s("path",{"fill-rule":"evenodd",d:"M14.47 2.47a.75.75 0 011.06 0l6 6a.75.75 0 010 1.06l-6 6a.75.75 0 11-1.06-1.06l4.72-4.72H9a5.25 5.25 0 100 10.5h3a.75.75 0 010 1.5H9a6.75 6.75 0 010-13.5h10.19l-4.72-4.72a.75.75 0 010-1.06z","clip-rule":"evenodd"})])}function Yt(t,o){return y(),P("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[s("path",{"fill-rule":"evenodd",d:"M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.348c1.295.712 1.295 2.573 0 3.285L7.28 19.991c-1.25.687-2.779-.217-2.779-1.643V5.653z","clip-rule":"evenodd"})])}var Gt=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(Gt||{});let Ye=Symbol("PopoverContext");function Pe(t){let o=_e(Ye,null);if(o===null){let r=new Error(`<${t} /> is missing a parent <${He.name} /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Pe),r}return o}let Xt=Symbol("PopoverGroupContext");function Ge(){return _e(Xt,null)}let Xe=Symbol("PopoverPanelContext");function Ht(){return _e(Xe,null)}let He=he({name:"Popover",props:{as:{type:[Object,String],default:"div"}},setup(t,{slots:o,attrs:r,expose:i}){var e;let n=O(null);i({el:n,$el:n});let m=O(1),p=O(null),I=O(null),S=O(null),v=O(null),h=M(()=>Te(n)),D=M(()=>{var u,b;if(!d(p)||!d(v))return!1;for(let te of document.querySelectorAll("body > *"))if(Number(te==null?void 0:te.contains(d(p)))^Number(te==null?void 0:te.contains(d(v))))return!0;let x=$e(),j=x.indexOf(d(p)),ee=(j+x.length-1)%x.length,Ke=(j+1)%x.length,Qe=x[ee],We=x[Ke];return!((u=d(v))!=null&&u.contains(Qe))&&!((b=d(v))!=null&&b.contains(We))}),g={popoverState:m,buttonId:O(null),panelId:O(null),panel:v,button:p,isPortalled:D,beforePanelSentinel:I,afterPanelSentinel:S,togglePopover(){m.value=H(m.value,{[0]:1,[1]:0})},closePopover(){m.value!==1&&(m.value=1)},close(u){g.closePopover();let b=(()=>u?u instanceof HTMLElement?u:u.value instanceof HTMLElement?d(u):d(g.button):d(g.button))();b==null||b.focus()}};je(Ye,g),xt(M(()=>H(m.value,{[0]:le.Open,[1]:le.Closed})));let R={buttonId:g.buttonId,panelId:g.panelId,close(){g.closePopover()}},C=Ge(),l=C==null?void 0:C.registerPopover,[c,_]=pt(),f=mt({portals:c,defaultContainers:[p,v]});function $(){var u,b,x,j;return(j=C==null?void 0:C.isFocusWithinPopoverGroup())!=null?j:((u=h.value)==null?void 0:u.activeElement)&&(((b=d(p))==null?void 0:b.contains(h.value.activeElement))||((x=d(v))==null?void 0:x.contains(h.value.activeElement)))}return fe(()=>l==null?void 0:l(R)),ht((e=h.value)==null?void 0:e.defaultView,"focus",u=>{var b,x;u.target!==window&&u.target instanceof HTMLElement&&m.value===0&&($()||p&&v&&(f.contains(u.target)||(b=d(g.beforePanelSentinel))!=null&&b.contains(u.target)||(x=d(g.afterPanelSentinel))!=null&&x.contains(u.target)||g.closePopover()))},!0),wt(f.resolveContainers,(u,b)=>{var x;g.closePopover(),kt(b,St.Loose)||(u.preventDefault(),(x=d(p))==null||x.focus())},M(()=>m.value===0)),()=>{let u={open:m.value===0,close:g.close};return G(_,{},()=>Ce({theirProps:{...t,...r},ourProps:{ref:n},slot:u,slots:o,attrs:r,name:"Popover"}))}}}),Kt=he({name:"PopoverButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-popover-button-${Q()}`}},inheritAttrs:!1,setup(t,{attrs:o,slots:r,expose:i}){let e=Pe("PopoverButton"),n=M(()=>Te(e.button));i({el:e.button,$el:e.button}),qe(()=>{e.buttonId.value=t.id}),Ae(()=>{e.buttonId.value=null});let m=Ge(),p=m==null?void 0:m.closeOthers,I=Ht(),S=M(()=>I===null?!1:I.value===e.panelId.value),v=O(null),h=`headlessui-focus-sentinel-${Q()}`;S.value||fe(()=>{e.button.value=v.value});let D=$t(M(()=>({as:t.as,type:o.type})),v);function g(f){var $,u,b,x,j;if(S.value){if(e.popoverState.value===1)return;switch(f.key){case V.Space:case V.Enter:f.preventDefault(),(u=($=f.target).click)==null||u.call($),e.closePopover(),(b=d(e.button))==null||b.focus();break}}else switch(f.key){case V.Space:case V.Enter:f.preventDefault(),f.stopPropagation(),e.popoverState.value===1&&(p==null||p(e.buttonId.value)),e.togglePopover();break;case V.Escape:if(e.popoverState.value!==0)return p==null?void 0:p(e.buttonId.value);if(!d(e.button)||(x=n.value)!=null&&x.activeElement&&!((j=d(e.button))!=null&&j.contains(n.value.activeElement)))return;f.preventDefault(),f.stopPropagation(),e.closePopover();break}}function R(f){S.value||f.key===V.Space&&f.preventDefault()}function C(f){var $,u;t.disabled||(S.value?(e.closePopover(),($=d(e.button))==null||$.focus()):(f.preventDefault(),f.stopPropagation(),e.popoverState.value===1&&(p==null||p(e.buttonId.value)),e.togglePopover(),(u=d(e.button))==null||u.focus()))}function l(f){f.preventDefault(),f.stopPropagation()}let c=ze();function _(){let f=d(e.panel);if(!f)return;function $(){H(c.value,{[B.Forwards]:()=>z(f,E.First),[B.Backwards]:()=>z(f,E.Last)})===me.Error&&z($e().filter(u=>u.dataset.headlessuiFocusGuard!=="true"),H(c.value,{[B.Forwards]:E.Next,[B.Backwards]:E.Previous}),{relativeTo:d(e.button)})}$()}return()=>{let f=e.popoverState.value===0,$={open:f},{id:u,...b}=t,x=S.value?{ref:v,type:D.value,onKeydown:g,onClick:C}:{ref:v,id:u,type:D.value,"aria-expanded":e.popoverState.value===0,"aria-controls":d(e.panel)?e.panelId.value:void 0,disabled:t.disabled?!0:void 0,onKeydown:g,onKeyup:R,onClick:C,onMousedown:l};return G(X,[Ce({ourProps:x,theirProps:{...o,...b},slot:$,attrs:o,slots:r,name:"PopoverButton"}),f&&!S.value&&e.isPortalled.value&&G(de,{id:h,features:pe.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:_})])}}}),Qt=he({name:"PopoverPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},focus:{type:Boolean,default:!1},id:{type:String,default:()=>`headlessui-popover-panel-${Q()}`}},inheritAttrs:!1,setup(t,{attrs:o,slots:r,expose:i}){let{focus:e}=t,n=Pe("PopoverPanel"),m=M(()=>Te(n.panel)),p=`headlessui-focus-sentinel-before-${Q()}`,I=`headlessui-focus-sentinel-after-${Q()}`;i({el:n.panel,$el:n.panel}),qe(()=>{n.panelId.value=t.id}),Ae(()=>{n.panelId.value=null}),je(Xe,n.panelId),fe(()=>{var l,c;if(!e||n.popoverState.value!==0||!n.panel)return;let _=(l=m.value)==null?void 0:l.activeElement;(c=d(n.panel))!=null&&c.contains(_)||z(d(n.panel),E.First)});let S=Tt(),v=M(()=>S!==null?(S.value&le.Open)===le.Open:n.popoverState.value===0);function h(l){var c,_;switch(l.key){case V.Escape:if(n.popoverState.value!==0||!d(n.panel)||m.value&&!((c=d(n.panel))!=null&&c.contains(m.value.activeElement)))return;l.preventDefault(),l.stopPropagation(),n.closePopover(),(_=d(n.button))==null||_.focus();break}}function D(l){var c,_,f,$,u;let b=l.relatedTarget;b&&d(n.panel)&&((c=d(n.panel))!=null&&c.contains(b)||(n.closePopover(),((f=(_=d(n.beforePanelSentinel))==null?void 0:_.contains)!=null&&f.call(_,b)||(u=($=d(n.afterPanelSentinel))==null?void 0:$.contains)!=null&&u.call($,b))&&b.focus({preventScroll:!0})))}let g=ze();function R(){let l=d(n.panel);if(!l)return;function c(){H(g.value,{[B.Forwards]:()=>{var _;z(l,E.First)===me.Error&&((_=d(n.afterPanelSentinel))==null||_.focus())},[B.Backwards]:()=>{var _;(_=d(n.button))==null||_.focus({preventScroll:!0})}})}c()}function C(){let l=d(n.panel);if(!l)return;function c(){H(g.value,{[B.Forwards]:()=>{let _=d(n.button),f=d(n.panel);if(!_)return;let $=$e(),u=$.indexOf(_),b=$.slice(0,u+1),x=[...$.slice(u+1),...b];for(let j of x.slice())if(j.dataset.headlessuiFocusGuard==="true"||f!=null&&f.contains(j)){let ee=x.indexOf(j);ee!==-1&&x.splice(ee,1)}z(x,E.First,{sorted:!1})},[B.Backwards]:()=>{var _;z(l,E.Previous)===me.Error&&((_=d(n.button))==null||_.focus())}})}c()}return()=>{let l={open:n.popoverState.value===0,close:n.close},{id:c,focus:_,...f}=t,$={ref:n.panel,id:c,onKeydown:h,onFocusout:e&&n.popoverState.value===0?D:void 0,tabIndex:-1};return Ce({ourProps:$,theirProps:{...o,...f},attrs:o,slot:l,slots:{...r,default:(...u)=>{var b;return[G(X,[v.value&&n.isPortalled.value&&G(de,{id:p,ref:n.beforePanelSentinel,features:pe.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:R}),(b=r.default)==null?void 0:b.call(r,...u),v.value&&n.isPortalled.value&&G(de,{id:I,ref:n.afterPanelSentinel,features:pe.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:C})])]}},features:De.RenderStrategy|De.Static,visible:v.value,name:"PopoverPanel"})}}});const Wt={props:{value:{type:Object,required:!0},close:{type:Boolean,required:!0},color:{required:!1,type:String,default:"green"},icon:{required:!1,type:Object}},methods:{removeLabel(){this.$emit("update",this.value)}},components:{XMarkIcon:J}},Zt={class:"text-sm"};function Jt(t,o,r,i,e,n){const m=w("XMarkIcon");return y(),P("button",{class:Fe(["flex items-center space-x-2 px-2 py-1 text-white rounded",`bg-${r.color}-500`])},[s("p",Zt,k(r.value.text),1),ve(s("button",{onClick:o[0]||(o[0]=(...p)=>n.removeLabel&&n.removeLabel(...p))},[a(m,{class:"w-4 h-4"})],512),[[ge,r.close]])],2)}const es=Z(Wt,[["render",Jt]]),ts={components:{TransitionRoot:ye,TransitionChild:xe,Dialog:we,DialogPanel:ke,DialogTitle:Se,XMarkIcon:J,UserIcon:Be},props:{item:{required:!0,type:Object}},data(){return{open:!1,editIcon:be,saveIcon:Ne,clearIcon:Ve,name:"",description:"",testTypesSelected:[],loading:!1,testTypes:new Array,rawTestTypes:new Array,departments:new Array,selectedDepartment:"-- select department",cookie:ie("token"),authStore:ue(),departmentId:0}},methods:{async init(){this.handleClick();const t=this.authStore.department,o=this.authStore.user.departments.find(r=>r.name===t);o&&(this.departmentId=o.id),this.selectedDepartment=t,this.departments=this.authStore.user.departments,await this.getTestTypes(this.departmentId)},async getTestTypes(t){const o={route:`${q.specimenTestTypes}?department_id=${t}&specimen_id=${this.item.specimen_id}`,method:"GET",token:`${this.cookie}`},{error:r,data:i}=await A(o);i.value&&(this.rawTestTypes=i.value,this.testTypes=i.value),r.value&&console.error("error: ",r.value)},async submitForm(){this.loading=!0;let t=this.testTypesSelected.map(e=>({specimen:this.item.specimen_id,test_type:e}));const o={route:`${q.addTestOrder}`,method:"POST",token:`${this.cookie}`,body:{order_id:this.item.order_id,tests:t}},{data:r,error:i}=await A(o);r.value&&(this.handleClick(),L().$toast.success("Tests added to current order successfully!"),this.loading=!1,this.$emit("update",!0)),i.value&&(this.handleClick(),console.error("error: ",i.value),L().$toast.error(W),this.loading=!1)},handleClick(){this.open=!this.open},resetForm(){this.testTypesSelected=new Array}},watch:{selectedDepartment(t,o){if(t!==o){const r=this.authStore.user.departments.find(i=>i.name===t);r&&(this.departmentId=r.id,this.getTestTypes(this.departmentId))}}}},ss=s("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),os={class:"fixed inset-0 overflow-y-auto"},ns={class:"flex min-h-full items-center justify-center p-4 text-center"},rs={class:"border-b px-3 py-3 flex items-center justify-between"},ls={class:"mt-2 space-y-3 pb-40"},is={class:"w-full flex flex-col space-y-2 px-5"},as=s("label",{class:"font-medium"},"Department",-1),cs={class:"w-full flex flex-col space-y-2 px-5"},us=s("label",{class:"font-medium"},"Tests",-1),ds={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function ps(t,o,r,i,e,n){const m=ae,p=w("TransitionChild"),I=w("DialogTitle"),S=w("XMarkIcon"),v=w("multi-select"),h=Le,D=w("FormKit"),g=w("DialogPanel"),R=w("Dialog"),C=w("TransitionRoot");return y(),P("div",null,[s("div",null,[a(m,{text:"Add test to current order",color:"warning",icon:e.editIcon,click:n.init},null,8,["icon","click"])]),a(C,{appear:"",show:e.open,as:"template"},{default:T(()=>[a(R,{as:"div",onClose:n.handleClick,class:"relative z-10"},{default:T(()=>[a(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:T(()=>[ss]),_:1}),s("div",os,[s("div",ns,[a(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:T(()=>[a(g,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:T(()=>[s("div",rs,[a(I,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:T(()=>[K(" Add Test To Current Order ")]),_:1}),s("button",{onClick:o[0]||(o[0]=(...l)=>n.handleClick&&n.handleClick(...l))},[a(S,{class:"w-5 h-5"})])]),a(D,{type:"form","submit-label":"Update",onSubmit:n.submitForm,actions:!1,id:"submitForm"},{default:T(({value:l})=>[s("div",ls,[s("div",is,[as,a(v,{style:{"--ms-max-height":"none !important"},modelValue:e.selectedDepartment,"onUpdate:modelValue":o[1]||(o[1]=c=>e.selectedDepartment=c),options:e.departments.map(c=>c.name),searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])]),s("div",cs,[us,a(v,{style:{"--ms-max-height":"none !important"},modelValue:e.testTypesSelected,"onUpdate:modelValue":o[2]||(o[2]=c=>e.testTypesSelected=c),options:e.testTypes,mode:"tags",searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),s("div",ds,[a(h,{type:"button",click:()=>n.resetForm(),text:"Clear form"},null,8,["click"]),a(m,{loading:e.loading,type:"submit",click:()=>{},color:"success",icon:e.saveIcon,text:"Save changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const ms=Z(ts,[["render",ps]]),hs={components:{TransitionRoot:ye,TransitionChild:xe,Dialog:we,DialogPanel:ke,DialogTitle:Se,XMarkIcon:J,PhoneIcon:it,EnvelopeIcon:at,MapPinIcon:ct},data(){return{moment:N,viewIcon:Ee,show:this.open,addIcon:Oe,checkIcon:ne,editIcon:be,acceptIcon:Me,printerIcon:ft,cookie:ie("token"),details:{},loading:!1,verifying:!1,zebraPrinting:!1}},props:{open:{type:Boolean,required:!1}},methods:{async init(t){this.loading=!0;const o={route:`${q.tests}/${t.id}`,method:"GET",token:`${this.cookie}`},{data:r,error:i,pending:e}=await A(o);this.loading=e,r.value&&(this.details=r.value,typeof this.details=="object"&&this.handleClick()),i.value&&(this.loading=!1,console.error(i.value),L().$toast.error(W))},async printBBResults(){const t={route:q.printOutZebra,method:"POST",token:`${this.cookie}`,body:{order_id:this.details.order_id,tests:[this.details.id],is_cross_match:!0}},{data:o,error:r,pending:i}=await A(t);if(this.zebraPrinting=i,o.value){this.zebraPrinting=!1;const e=new FileReader;e.onload=()=>{const n=URL.createObjectURL(o.value),m=document.createElement("a");m.href=n,m.setAttribute("download",`${Date.now()}.lbl`),m.click(),URL.revokeObjectURL(n)},e.readAsText(o.value),L().$toast.success("Results printed successfully!")}r.value&&(this.zebraPrinting=!1,L().$toast.error(W),console.error(r.value))},async changeStatus(t,o){this.verifying=!0;const r={route:`${q.testStatus}/${o}/${t}`,method:"PUT",token:`${this.cookie}`},{data:i,error:e,pending:n}=await A(r);this.verifying=n,i.value&&(this.verifying=!1,L().$toast.success(`${this.details.test_type_name} test for ${this.details.client.first_name} ${this.details.client.middle_name!==null?this.details.client.middle_name:""} ${this.details.client.last_name} verified successfully!`),this.viewReport(!0)),e.value&&(console.error(e.value),this.verifying=!1)},updateChanges(){this.$emit("update",!0)},handleClick(){this.show=!this.show},printAccessionNumber(){return Ie.printSpecimenLabel(this.details.accession_number)},printTrackingNumber(){return Ie.printTrackingNumber(this.details.tracking_number)},viewReport(t=!1){return this.$router.push(`/reports/daily/patient-report/${this.details.client.id}?order_id=${this.details.order_id}&printer=${t}`)},getRequestedBy(t){let o="";return t.forEach(r=>{r.status.name==="pending"&&(o=`${r.initiator.first_name} ${r.initiator.last_name}`)}),re(o)}}},fs=""+new URL("prescription_document.18f957e1.svg",import.meta.url).href,_s=""+new URL("test_tube.2b522cf2.svg",import.meta.url).href,vs=""+new URL("i_exam_qualification.dd473ba6.svg",import.meta.url).href,gs={key:0},bs=s("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),ys={class:"fixed inset-0 overflow-y-auto"},xs={class:"flex min-h-full items-center justify-center text-center"},ws={class:"border-b px-3 py-3 flex items-center justify-between"},ks=s("img",{src:fs,class:"w-8 h-8 mr-2"},null,-1),Ss={class:"flex items-center justify-center mx-auto my-20"},Ts={class:"grid grid-cols-3 gap-4 px-5 py-5"},$s={class:"rounded border"},Cs=s("div",{class:"px-2 py-2 bg-gray-50 border-b rounded-t"},[s("h3",{class:"text-lg font-semibold text-black flex items-center"},[s("img",{src:et,class:"w-7 h-7 mr-1"}),K(" Patient ")])],-1),Ps={class:"w-full space-y-2 py-2"},Is={class:"w-full flex justify-between px-4 py-1"},Ds=s("h3",{class:"font-semibold"},"Patient Number",-1),Rs={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},js=s("h3",{class:"font-semibold"},"Name",-1),qs={class:"w-full flex justify-between px-4 py-1"},As=s("h3",{class:"font-semibold"},"Sex",-1),Fs={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Ls=s("h3",{class:"font-semibold"},"Age",-1),Os={class:"rounded border"},Ms=s("div",{class:"px-2 py-2 bg-gray-50 border-b rounded-t"},[s("h3",{class:"text-lg font-semibold text-black flex items-center"},[s("img",{src:_s,class:"w-7 h-7 mr-1"}),K(" Specimen ")])],-1),Us={class:"w-full space-y-2 py-2"},Bs={class:"w-full flex justify-between px-4 py-1"},Es=s("h3",{class:"font-semibold"},"Specimen Type",-1),Ns={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Vs=s("h3",{class:"font-semibold"},"Tracking Number",-1),zs={class:"w-full flex justify-between px-4 py-1"},Ys=s("h3",{class:"font-semibold"},"Accession Number",-1),Gs={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Xs=s("h3",{class:"font-semibold"},"Status",-1),Hs={class:"rounded border max-h-72 overflow-y-auto"},Ks=s("div",{class:"px-2 py-2 bg-gray-50 border-b rounded-t flex items-center"},[s("img",{src:vs,class:"w-7 h-7 mr-1"}),s("h3",{class:"text-lg font-semibold text-black"},"Test")],-1),Qs={class:"w-full space-y-2 py-2"},Ws={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Zs=s("h3",{class:"font-semibold"},"Name",-1),Js={class:"w-full flex justify-between px-4 py-1"},eo=s("h3",{class:"font-semibold"},"Date Registered",-1),to={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},so=s("h3",{class:"font-semibold"},"Receipt Date",-1),oo={class:"w-full flex justify-between px-4 py-1"},no=s("h3",{class:"font-semibold"},"Test Status",-1),ro={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},lo=s("h3",{class:"font-semibold"},"Ward/Location",-1),io={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},ao=s("h3",{class:"font-semibold"},"Request Origin",-1),co={class:"w-full flex justify-between px-4 py-1"},uo=s("h3",{class:"font-semibold"},"Registered By",-1),po={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},mo=s("h3",{class:"font-semibold"},"Requested By",-1),ho={class:"mx-5 rounded border mb-5"},fo={class:"flex items-center justify-between bg-gray-50 px-4 py-2 border-b rounded-t"},_o=s("h3",{class:"text-lg font-semibold text-black"},"Results",-1),vo={class:"justify-end flex items-center space-x-3"},go={class:"flex items-center space-x-1"},bo=["innerHTML"],yo={key:1,class:"text-xs"},xo={key:0,class:"px-2.5 py-2.5 border-t"};function wo(t,o,r,i,e,n){const m=lt,p=w("TransitionChild"),I=w("DialogTitle"),S=w("XMarkIcon"),v=tt,h=ae,D=ms,g=w("DialogPanel"),R=w("Dialog"),C=w("TransitionRoot");return y(),P("div",null,[Je(t.$slots,"default",{onClick:o[0]||(o[0]=(...l)=>n.init&&n.init(...l))}),e.details!==null&&e.details.client!==void 0?(y(),P("div",gs,[a(m,{class:"hidden",ref:"corePrinter",orderId:`${e.details.order_id}`,id:`${e.details.client.id}`},null,8,["orderId","id"])])):F("",!0),a(C,{appear:"",show:e.show,as:"template"},{default:T(()=>[a(R,{as:"div",class:"relative z-10"},{default:T(()=>[a(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:T(()=>[bs]),_:1}),s("div",ys,[s("div",xs,[a(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:T(()=>[a(g,{class:"w-full max-w-7xl m-20 transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:T(()=>[s("div",ws,[a(I,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:T(()=>[ks,K(" View Test ")]),_:1}),s("button",{onClick:o[1]||(o[1]=(...l)=>n.handleClick&&n.handleClick(...l))},[a(S,{class:"w-5 h-5"})])]),ve(s("div",Ss,[a(v,{loading:e.loading},null,8,["loading"])],512),[[ge,e.loading]]),s("div",Ts,[s("div",$s,[Cs,s("div",Ps,[s("div",Is,[Ds,s("p",null,k(e.details.client.id),1)]),s("div",Rs,[js,s("p",null,k(("capitalize"in t?t.capitalize:Y(re))(`${e.details.client.first_name} ${e.details.client.middle_name!==null?e.details.client.middle_name:""} ${e.details.client.last_name}`)),1)]),s("div",qs,[As,s("p",null,k(e.details.client.sex),1)]),s("div",Fs,[Ls,s("p",null,k(("calculateAge"in t?t.calculateAge:Y(Ue))(e.details.client.date_of_birth)),1)])])]),s("div",Os,[Ms,s("div",Us,[s("div",Bs,[Es,s("p",null,k(e.details.specimen_type),1)]),s("div",Ns,[Vs,s("p",null,k(e.details.tracking_number),1)]),s("div",zs,[Ys,s("p",null,k(e.details.accession_number),1)]),s("div",Gs,[Xs,s("p",null,k(("capitalize"in t?t.capitalize:Y(re))(e.details.order_status.split("-").join(" "))),1)])])]),s("div",Hs,[Ks,s("div",Qs,[s("div",Ws,[Zs,s("p",null,k(e.details.test_type_name),1)]),s("div",Js,[eo,s("p",null,k(e.moment(e.details.created_date).format("dateFormat"in t?t.dateFormat:Y(ce))),1)]),s("div",to,[so,s("p",null,k(e.moment(e.details.updated_date).format("dateFormat"in t?t.dateFormat:Y(ce))),1)]),s("div",oo,[no,s("p",null,k(("capitalizeStr"in t?t.capitalizeStr:Y(ut))(e.details.status.split("-").join(" "))),1)]),s("div",ro,[lo,s("p",null,k(e.details.requesting_ward),1)]),s("div",io,[ao,s("p",null,k(e.details.request_origin),1)]),s("div",co,[uo,s("p",null,k(n.getRequestedBy(e.details.status_trail)),1)]),s("div",po,[mo,s("p",null,k(e.details.requested_by),1)])])])]),s("div",ho,[s("div",fo,[_o,s("div",vo,[e.details.status.toLowerCase()==="completed"?(y(),U(h,{key:0,icon:e.checkIcon,text:"Authorize",click:()=>{n.changeStatus("verified",e.details.id)},color:"success",loading:e.verifying},null,8,["icon","click","loading"])):F("",!0),e.details.status.toLowerCase()==="completed"||e.details.status.toLowerCase()==="verified"?(y(),U(h,{key:1,icon:e.viewIcon,text:"View Report",click:n.viewReport,color:"primary"},null,8,["icon","click"])):F("",!0),a(D,{item:e.details,onUpdate:n.updateChanges,color:"primary"},null,8,["item","onUpdate"]),a(h,{icon:e.printerIcon,text:"Print Accession Number",click:n.printAccessionNumber,color:"primary"},null,8,["icon","click"]),a(h,{icon:e.printerIcon,color:"success",text:"Print Tracking Number",click:n.printTrackingNumber},null,8,["icon","click"])])]),(y(!0),P(X,null,oe(e.details.indicators,(l,c)=>{var _;return y(),P("div",{class:Fe(e.details.indicators.length!==c+1?"w-full px-5 py-2 border-b border-dotted flex justify-between items-center":"w-full px-5 py-2 flex justify-between items-center"),key:c},[s("h3",null,k(l.name),1),s("div",go,[l.result?(y(),P("p",{key:0,innerHTML:l.result.value?l.result.value:"Not done"},null,8,bo)):F("",!0),(_=l.result)!=null&&_.value?(y(),P("span",yo,k(l==null?void 0:l.unit),1)):F("",!0)])],2)}),128)),e.details.test_type_name=="Cross-match"&&e.details.status.toLowerCase()=="verified"?(y(),P("div",xo,[a(h,{loading:e.zebraPrinting,click:()=>{n.printBBResults()},text:"Print results",color:"primary",icon:e.printerIcon},null,8,["loading","click","icon"])])):F("",!0)])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const ko=Z(hs,[["render",wo]]),So={components:{TransitionRoot:ye,TransitionChild:xe,Dialog:we,DialogPanel:ke,DialogTitle:Se,XMarkIcon:J,UserIcon:Be},data(){return{open:!1,addIcon:Oe,saveIcon:Ne,clearIcon:Ve,name:"",description:"",loading:!1,cookie:ie("token"),reasons:new Array,reasonsSelected:"",rawReasons:new Array}},props:{item:{required:!0,type:Object},text:{type:String,required:!0},action:{type:String,required:!0},icon:{type:[Object,Function],required:!0}},methods:{async init(){this.handleClick();const t={route:q.rejectionReasons,method:"GET",token:`${this.cookie}`},{error:o,data:r}=await A(t);r.value&&(this.rawReasons=r.value,r.value.map(i=>{this.reasons.push(i.description)})),o.value&&console.error(o.value)},async submitForm(){this.loading=!0;let t=null;this.rawReasons.map(n=>{n.description===this.reasonsSelected&&(t=n.id)});const o={route:`${q.testStatus}/${this.item.id}/${this.action}?status_reason_id=${t}&person_talked_to=${this.name}`,method:"PUT",token:`${this.cookie}`,body:{}},{data:r,error:i,pending:e}=await A(o);this.loading=e,r.value&&(L().$toast.success(`Test action "${this.text}" done successfully!`),this.handleClick(),this.loading=!1,this.$emit("update",!0)),i.value&&(console.error(i.value),L().$toast.error(W),this.loading=!1)},handleClick(){this.open=!this.open},resetForm(){this.reasonsSelected="",this.$formkit.reset("rejectionForm")}}},To=""+new URL("rdt_result_no_test.6a8034c1.svg",import.meta.url).href,$o=s("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Co={class:"fixed inset-0 overflow-y-auto"},Po={class:"flex min-h-full items-center justify-center p-4 text-center"},Io={class:"border-b px-3 py-3 flex items-center justify-between"},Do=s("img",{src:To,class:"w-8 h-8 mr-2"},null,-1),Ro={class:"mt-2 space-y-3 px-5 py-5"},jo={class:"space-y-2"},qo=s("h3",{class:"font-medium"},"Test Type",-1),Ao={class:"border-b border-dotted text-gray-600"},Fo={class:"space-y-2"},Lo=s("h3",{class:"font-medium"},"Specimen",-1),Oo={class:"border-b border-dotted text-gray-600"},Mo={class:"space-y-2"},Uo=s("h3",{class:"font-medium"},"Accession Number",-1),Bo={class:"border-b border-dotted text-gray-600"},Eo={class:"w-full flex items-center"},No={class:"w-full flex flex-col space-y-2"},Vo={class:"w-full flex flex-col space-y-2 pb-40"},zo=s("label",{class:"font-medium"},"Select Reason(s)",-1),Yo={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Go(t,o,r,i,e,n){const m=ae,p=w("TransitionChild"),I=w("DialogTitle"),S=w("XMarkIcon"),v=w("FormKit"),h=w("multi-select"),D=Le,g=w("DialogPanel"),R=w("Dialog"),C=w("TransitionRoot");return y(),P("div",null,[s("div",null,[a(m,{text:r.text,color:"error",icon:r.icon,click:n.init},null,8,["text","icon","click"])]),a(C,{appear:"",show:e.open,as:"template"},{default:T(()=>[a(R,{as:"div",onClose:n.handleClick,class:"relative z-10"},{default:T(()=>[a(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:T(()=>[$o]),_:1}),s("div",Co,[s("div",Po,[a(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:T(()=>[a(g,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:T(()=>[s("div",Io,[a(I,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:T(()=>[Do,K(" "+k(r.text.charAt(0).toUpperCase()+r.text.slice(1))+" Reason ",1)]),_:1}),s("button",{onClick:o[0]||(o[0]=(...l)=>n.handleClick&&n.handleClick(...l))},[a(S,{class:"w-5 h-5"})])]),a(v,{type:"form","submit-label":"Update",onSubmit:n.submitForm,actions:!1,id:"rejectionForm"},{default:T(({value:l})=>[s("div",Ro,[s("div",jo,[qo,s("p",Ao,k(r.item.test_type_name),1)]),s("div",Fo,[Lo,s("p",Oo,k(r.item.specimen_type),1)]),s("div",Mo,[Uo,s("p",Bo,k(r.item.accession_number),1)]),s("div",Eo,[s("div",No,[a(v,{type:"text",label:"Person Talked To",validation:r.text.toLowerCase()!=="void"?"required":"",modelValue:e.name,"onUpdate:modelValue":o[1]||(o[1]=c=>e.name=c)},null,8,["validation","modelValue"])])]),s("div",Vo,[zo,a(h,{style:{"--ms-max-height":"none !important"},modelValue:e.reasonsSelected,"onUpdate:modelValue":o[2]||(o[2]=c=>e.reasonsSelected=c),options:e.reasons,searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),s("div",Yo,[a(D,{type:"button",text:"Clear form",click:n.resetForm},null,8,["click"]),a(m,{loading:e.loading,type:"submit",click:()=>{},color:"success",icon:e.saveIcon,text:"Save changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const Xo=Z(So,[["render",Go]]),Ho={components:{MagnifyingGlassIcon:gt,Listbox:At,ListboxButton:Ft,ListboxLabel:Lt,ListboxOptions:Ot,ListboxOption:Mt,ChevronUpDownIcon:ot,ArrowRightIcon:Vt,ChevronDownIcon:bt,Menu:Ut,MenuButton:Bt,MenuItems:Et,MenuItem:Nt,CheckIcon:yt,PopoverButton:Kt,Popover:He,PopoverPanel:Qt,XMarkIcon:J,CheckCircleIcon:Ct,FunnelIcon:Pt},setup(){const t=ue();st({title:`${vt.name.toUpperCase()} - ${t.department} Tests`})},data(){return{moment:N,addIcon:Re,filterIcon:It,applyIcon:zt,acceptIcon:Me,viewIcon:Ee,moreActions:!1,showMore:0,okIcon:ne,moreIcon:Dt,lessIcon:Rt,clearIcon:jt,dropIcon:se,editIcon:be,refreshIcon:qt,dateRange:["",""],search:"",header:"Tests Lists",pages:[{name:"Home",link:"/home"}],headers:[{text:"PATIENT NO",value:"client.id",sortable:!0},{text:"PATIENT NAME",value:"name",sortable:!0},{text:"ACCESSION NO",value:"accession_number",sortable:!0},{text:"TEST",value:"test_type_name",sortable:!0},{text:"LOCATION",value:"requesting_ward",sortable:!0},{text:"ORDER STATUS",value:"order_status",sortable:!0},{text:"STATUS",value:"status",sortable:!0},{text:"DATE REGISTERED",value:"created_date",sortable:!0},{text:"ACTIONS",value:"actions"}],statuses:[{text:"Results",color:"primary",icon:Re,status:"completed",show:"started"},{text:"Accept",color:"success",icon:ne,status:"pending",show:"not-collected"},{text:"Start",color:"warning",icon:Yt,status:"started",show:"pending"},{text:"Authorize",color:"success",status:"verified",icon:ne,show:"completed"}],rejectStatuses:[{name:"Reject",icon:se,action:"rejected"},{name:"Void",icon:se,action:"voided"},{name:"Notdone",icon:se,action:"not_done"}],changing:!1,data:new Array,statusSelected:{name:"select status"},searchField:"accession_number",searchValue:"",cookie:ie("token"),loading:!1,serverItemsLength:0,serverOptions:{page:1,rowsPerPage:10,sortBy:"name"},authStore:ue(),testStatuses:new Array,filters:new Array}},created(){var t,o,r,i,e,n;this.serverOptions={page:Number(this.$route.query.page?this.$route.query.page:1),rowsPerPage:Number(this.$route.query.rowsPerPage?this.$route.query.rowsPerPage:10)},this.statusSelected=this.$route.query.status?{name:this.$route.query.status.toString()}:{name:"select status"},this.search=(t=this.$route.query.search)!=null&&t.toString()?(o=this.$route.query.search)==null?void 0:o.toString():"",this.dateRange=[`${(r=this.$route.query.from)!=null&&r.toString()?(i=this.$route.query.from)==null?void 0:i.toString():""}`,`${(e=this.$route.query.to)!=null&&e.toString()?(n=this.$route.query.to)==null?void 0:n.toString():""}`],this.init()},methods:{shouldDisplayMore(t){this.showMore==t?this.showMore=0:this.showMore=t},async searchNlims(t){this.loading=!0;const o={route:`${q.nlimsTestSearch}?tracking_number=${t.replace(/\$$/,"")}`,method:"GET",token:`${this.cookie}`},{data:r,error:i}=await A(o);r.value&&(dt(r.value).then(e=>{const m={...this.$router.currentRoute.value.query,search:e};this.$router.replace({query:m}),this.search=e,this.searchValue=e,this.init()}).catch(e=>{console.error("error routing to merged test: ",e)}),this.loading=!1),i.value&&(console.error(i.value),L().$toast.error(`${i.value.data.error}`),this.loading=!1)},async init(){this.loadStatuses(),this.loading=!0;const{page:t,rowsPerPage:o}=this.serverOptions;let r=this.getIdFromName(this.authStore.user.departments,this.authStore.department),i=this.getIdFromName(this.authStore.locations,this.authStore.selectedLocation),e=this.statusSelected.name==="select status"?"":this.statusSelected.name!==void 0&&this.statusSelected.name;const n=this.dateRange[0].toString()!==""?N(this.dateRange[0].toString()).format("YYYY-MM-DD"):"",m=this.dateRange[1].toString()!==""?N(this.dateRange[1].toString()).format("YYYY-MM-DD"):"",p={route:`${q.tests}?minimal=true&page=${t}&per_page=${o}&status=${e.toString().toLowerCase()}&search=${this.search}&department_id=${r}&lab_location=${i}&start_date=${n}&end_date=${m}`,method:"GET",token:`${this.cookie}`},{data:I,error:S,pending:v}=await A(p);this.loading=v,I.value&&(this.data=I.value.data.map(h=>{var D,g,R,C;return{...h,name:`${re(`${(D=h.client)==null?void 0:D.first_name} ${((g=h.client)==null?void 0:g.middle_name)!==null?h.client.middle_name:""} ${(R=h.client)==null?void 0:R.last_name}`)} (${h.client.sex}, ${Ue((C=h.client)==null?void 0:C.date_of_birth)} yrs)`,order_status:`${h.order_status!==null?(h.order_status.charAt(0).toUpperCase()+h.order_status.slice(1)).split("-").join(" "):""}`,status:`${h.status!==null?h.status.charAt(0).toUpperCase()+h.status.slice(1):""}`,created_date:N(h.created_date).utcOffset(2).format(ce)}}),this.serverItemsLength=I.value.meta.total_count,this.loading=!1),S.value&&(console.error(S.value.data),L().$toast.error(W),this.loading=!1)},async loadStatuses(){const t={route:`${q.testStatus}/all`,method:"GET",token:`${this.cookie}`},{data:o,error:r}=await A(t);o.value&&(this.testStatuses=o.value.map(i=>({id:i.id,name:i.name.charAt(0).toUpperCase()+i.name.slice(1)}))),r.value&&console.error(r.value)},async changeStatus(t,o){this.loading=!0;const r={route:`${q.testStatus}/${o}/${t}`,method:"PUT",token:`${this.cookie}`,body:{}},{data:i,error:e,pending:n}=await A(r);this.loading=n,i.value&&(this.init(),this.loading=!1),e.value&&(console.error(e.value),this.loading=!1)},async changeOrderStatus(t,o){this.loading=!0;const r={route:`${q.orderStatus}/${t}`,method:"PUT",token:`${this.cookie}`,body:{order_id:o}},{data:i,error:e,pending:n}=await A(r);this.loading=n,i.value&&(this.init(),this.loading=!1),e.value&&(console.error(e.value),this.loading=!1)},checkStatus(t,o){t.status==="completed"?o.test_type_name.toLowerCase().includes("culture")?this.redirect(o,`/tests/result/culture-sensitivity?accession_number=${o.accession_number}&test_id=${o.id}`):this.redirect(o,`/tests/result?accession_number=${o.accession_number}&test_id=${o.id}`):t.status==="verified"?this.openTestsDialog(o):t.status!==""?this.changeStatus(t.status,o.id):this.printTest(o)},printTest(t){print()},getIdFromName(t,o){const r=t.find(i=>i.name===o);return r?r.id:null},updateTests(t){if(typeof t=="object"){this.serverOptions=t;const r={...this.$router.currentRoute.value.query,page:t.page,rowsPerPage:t.rowsPerPage};this.$router.replace({query:r})}this.init(),this.moreActions=!1},refreshTests(){this.searchValue="",this.search="",this.init()},update(t){this.search=t,this.searchValue=t;const r={...this.$router.currentRoute.value.query,search:t};this.$router.replace({query:r}),t!==""?this.checkTrackingNumber(t)?this.searchNlims(t):this.updateTests(t):this.init()},handleClick(){this.moreActions=!this.moreActions},redirect(t,o){this.$router.push(o)},checkTrackingNumber(t){return/^(x|l).*\d/.test(t.toLowerCase())},updateOnStatus(t){if(t.name!=="select status"){const i=this.filters.find(e=>e.origin==="statuses");i?i.value=t.name:this.filters.push({origin:"statuses",value:t.name})}this.statusSelected=t;const r={...this.$router.currentRoute.value.query,status:t.name.toLowerCase()=="select status"?"":t.name.toLowerCase()};this.$router.replace({query:r}),this.init()},removeFilter(t){t.origin==="statuses"&&this.statusSelected.name!=="select status"&&this.updateOnStatus({name:"select status"});const o=this.filters.findIndex(r=>r.origin===t.origin);o!==-1&&this.filters.splice(o,1),this.init()},isCompletedByCurrentUserOrSuperAdmin(t){const o=this.authStore.user,r=t.completed_by;if(r){if(r.id!==o.id)return!0;if(r.is_super_admin===!0)return!0}return!1},shouldDisplayButton(t,o){const r=t.status.toLowerCase(),i=o.show.toLowerCase();if(r===i){const e=this.isCompletedByCurrentUserOrSuperAdmin(t);return r==="pending"&&t.order_status.toLowerCase()==="specimen not collected"?!1:e}return!1},hideRejectActions(t){return!["voided","test-rejected","verified","rejected"].includes(t.toLowerCase())},cleared(){this.dateRange=["",""]},openTestsDialog(t){this.$refs.testsDialog!=null&&this.$refs.testsDialog!==void 0&&this.$refs.testsDialog.init(t)}},watch:{authStore:{handler(){this.init()},deep:!0},dateRange:{handler(t,o){const r=t[0].toString()!==""?N(t[0].toString()).format("YYYY-MM-DD"):"",i=t[1].toString()!==""?N(t[1].toString()).format("YYYY-MM-DD"):"",n={...this.$router.currentRoute.value.query,from:r,to:i};this.$router.replace({query:n}),this.init()},deep:!0},statusSelected:{handler(t){this.updateOnStatus(t)},deep:!0}}},Ko=""+new URL("experiment-results.d7dc2871.png",import.meta.url).href,Qo={class:"py-5 px-5"},Wo=s("div",{class:"flex items-center space-x-2 py-5"},[s("img",{src:Ko,alt:"experiment-results-icon",class:"w-auto h-8"}),s("h3",{class:"text-2xl font-semibold uppercase"},"Tests List")],-1),Zo={class:"flex justify-between items-center w-full py-2 mb-2"},Jo={class:"flex items-center space-x-2"},en={class:"relative z-10 w-40"},tn={class:"pt-1"},sn={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},on={class:"w-72 ml-2"},nn={class:"py-3 flex items-center space-x-3"},rn={class:"py-2 flex items-center"},ln={class:"w-full flex items-center justify-between space-x-2"},an={key:0,class:"flex items-center space-x-2"},cn={key:0,class:"flex items-center space-x-2"},un=s("div",{id:"tests-container"},null,-1);function dn(t,o,r,i,e,n){const m=Ze,p=ae,I=nt,S=w("FunnelIcon"),v=w("datepicker"),h=rt,D=es,g=ko,R=Xo,C=_t;return y(),P("div",Qo,[a(m,{pages:e.pages},null,8,["pages"]),Wo,s("div",Zo,[s("div",Jo,[a(p,{text:"Refresh",color:"warning",icon:e.refreshIcon,click:()=>{n.refreshTests()},loading:e.loading},null,8,["icon","click","loading"]),s("div",en,[a(I,{items:e.testStatuses,modelValue:e.statusSelected,"onUpdate:modelValue":o[0]||(o[0]=l=>e.statusSelected=l)},null,8,["items","modelValue"])]),s("div",tn,[s("div",sn,[a(S,{class:"w-5 h-5 mr-2"}),K(" Filter By Date Range "),s("div",on,[a(v,{required:"",position:"left",onCleared:n.cleared,placeholder:"select start & end date",range:!0,format:"dd/MM/yyyy","input-class-name":"datepicker",modelValue:e.dateRange,"onUpdate:modelValue":o[1]||(o[1]=l=>e.dateRange=l)},null,8,["onCleared","modelValue"])])])])]),a(h,{onUpdate:n.update,search:e.search,"onUpdate:search":o[2]||(o[2]=l=>e.search=l)},null,8,["onUpdate","search"])]),s("div",nn,[(y(!0),P(X,null,oe(e.filters,(l,c)=>(y(),U(D,{value:{origin:"statuses",text:l.value},close:"",color:"green",key:c,onUpdate:n.removeFilter},null,8,["value","onUpdate"]))),128))]),a(C,{headers:e.headers,data:e.data,loading:e.loading,searchField:e.searchField,searchValue:e.searchValue,serverItemsLength:e.serverItemsLength,serverOptions:e.serverOptions,onUpdate:n.updateTests},{actions:T(({item:l})=>[s("div",rn,[s("div",ln,[e.showMore!==l.id?(y(),P("div",an,[a(g,{ref:"testsDialog",onUpdate:n.updateTests},{default:T(()=>[a(p,{color:"primary",text:"View",icon:e.viewIcon,click:()=>{n.openTestsDialog(l)}},null,8,["icon","click"])]),_:2},1032,["onUpdate"]),l.status.toLowerCase()==="completed"?(y(),U(p,{key:0,click:()=>{n.checkStatus({status:"completed"},l)},text:"Edit",color:"success",icon:e.editIcon},null,8,["click","icon"])):F("",!0),(y(!0),P(X,null,oe(e.statuses,(c,_)=>ve((y(),U(p,{color:c.color,text:c.text,icon:c.icon,click:()=>{n.checkStatus(c,l)},key:_},null,8,["color","text","icon","click"])),[[ge,n.shouldDisplayButton(l,c)]])),128)),!l.status.toLowerCase().includes("rejected")&&l.order_status.toLowerCase()==="specimen not collected"?(y(),U(p,{key:1,color:"success",text:"Accept",icon:e.acceptIcon,click:()=>n.changeOrderStatus("accepted",l.order_id)},null,8,["icon","click"])):F("",!0)])):F("",!0),n.hideRejectActions(l.status)?(y(),U(p,{key:1,click:()=>n.shouldDisplayMore(l.id),color:"",text:"",icon:e.moreActions==!0?e.lessIcon:e.moreIcon},null,8,["click","icon"])):F("",!0)]),n.hideRejectActions(l.status)&&e.showMore==l.id?(y(),P("div",cn,[(y(!0),P(X,null,oe(e.rejectStatuses,(c,_)=>(y(),U(R,{item:l,key:c.name,text:c.name,icon:c.icon,action:c.action,onUpdate:n.updateTests},null,8,["item","text","icon","action","onUpdate"]))),128))])):F("",!0)])]),_:1},8,["headers","data","loading","searchField","searchValue","serverItemsLength","serverOptions","onUpdate"]),un])}const Hn=Z(Ho,[["render",dn]]);export{Hn as default};
