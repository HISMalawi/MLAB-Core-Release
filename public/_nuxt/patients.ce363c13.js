import{_ as oe}from"./Breadcrumb.vue.6f7f01db.js";import{o as V,c as k,e,m as H,s as F,a as A,A as B,g as v,d as a,h as d,l as n,i as S,b,f as j,t as w,_ as E,w as I,v as T,F as ie,r as ne,j as re,u as de}from"./entry.5bdb8488.js";import{_ as J}from"./OutlinedButton.f18d48ca.js";import{c as Q,s as G,e as P}from"./constants.b04a9525.js";import{h as K,k as W,e as $,f as C,r as U,d as ce,u as ue,b as me,l as pe}from"./fetch.7dc9d831.js";import{r as M}from"./XMarkIcon.49b75dff.js";import{r as X}from"./ArrowDownTrayIcon.1d4f2a31.js";import{U as q,h as N,G as L,V as R,S as Y}from"./transition.ad4c8a99.js";import{_ as fe}from"./Loader.2016ba72.js";import{r as Z}from"./UserIcon.ef43faf0.js";import{r as ee,a as te}from"./PencilSquareIcon.551b626a.js";import{r as ae}from"./ArrowUturnLeftIcon.182cf6f5.js";import{_ as _e}from"./Datatable.d21eac23.js";import{P as he}from"./package.62af87d2.js";import{r as ve,a as ge}from"./UsersIcon.00208fbf.js";import{r as ye}from"./MagnifyingGlassIcon.d967f597.js";import{r as xe}from"./ArrowPathIcon.f4019e96.js";import"./nuxt-link.e30313a8.js";import"./HomeIcon.db590299.js";import"./network.3c519541.js";import"./PrinterIcon.df26e017.js";import"./hidden.b0c25628.js";function be(s,o){return V(),k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm4.28 10.28a.75.75 0 000-1.06l-3-3a.75.75 0 10-1.06 1.06l1.72 1.72H8.25a.75.75 0 000 1.5h5.69l-1.72 1.72a.75.75 0 101.06 1.06l3-3z","clip-rule":"evenodd"})])}const z=""+new URL("nausea.bd1778ec.svg",import.meta.url).href,we=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Ve={class:"fixed inset-0 overflow-y-auto"},ke={class:"flex min-h-full items-center justify-center p-4 text-center"},De={class:"border-b px-3 py-3 flex items-center justify-between"},Pe=e("img",{src:z,class:"w-8 h-8 mr-2"},null,-1),$e={class:"mt-2 space-y-3 px-5 py-5"},Ce={class:"w-full grid grid-cols-3 gap-2"},Fe={class:"grid grid-cols-2 gap-2 space-x-3"},Ne={class:"w-full flex flex-col space-y-2"},Ie=e("label",{class:"font-medium"},"Date Of Birth",-1),Ue={class:"w-full"},Ae={class:"w-full grid grid-cols-2 gap-2"},Se={class:"mt-3 justify-end flex items-center space-x-3 px-3 py-2 border-t"},je=H({__name:"index",props:{openForm:{type:Boolean},defaultData:{}},emits:["onPatientCreated","setAdjustVisibility"],setup(s,{emit:o}){const h=o,_=F(!1),t=F(!1),c=A("token"),m=s,l=F({uuid:"",firstName:"",middleName:"",lastName:"",gender:"",physicalAddress:"",dateOfBirth:"",estimatedDate:!1,age:""}),y=()=>{_.value=!_.value,h("setAdjustVisibility",_.value)},g=async()=>{t.value=!0;const p={route:$.clients,method:"POST",token:`${c.value}`,body:{client:{uuid:""},person:{first_name:l.value.firstName,middle_name:l.value.middleName,last_name:l.value.lastName,sex:l.value.gender.charAt(0),date_of_birth:l.value.dateOfBirth,birth_date_estimated:l.value.estimatedDate},client_identifiers:{current_village:"",current_district:"",current_traditional_authority:"",physical_address:l.value.physicalAddress}}},{data:u,error:f,pending:x}=await C(p);t.value=x,u.value&&(b().$toast.success("Patient created successfully!"),y(),r(),h("onPatientCreated",!0),t.value=!1),f.value&&(console.error(f.value),b().$toast.error(`${P}`),t.value=!1)},r=()=>{l.value.uuid="",l.value.firstName="",l.value.middleName="",l.value.lastName="",l.value.gender="",l.value.physicalAddress="",l.value.dateOfBirth="",l.value.estimatedDate=!1,l.value.age=""};return B(()=>l.value.age,p=>{l.value.dateOfBirth=K().subtract(p,"years").format("YYYY-MM-DD"),l.value.estimatedDate=!0}),B(()=>m.defaultData,p=>{l.value.firstName=p.firstName,l.value.lastName=p.lastName,l.value.gender=p.gender}),B(()=>l.value.dateOfBirth,p=>{l.value.age=W(l.value.dateOfBirth),l.value.estimatedDate=!1}),B(()=>m.openForm,p=>{_.value=p}),(p,u)=>{const f=v("FormKit"),x=v("datepicker"),D=J,O=j;return V(),k("div",null,[a(n(Y),{appear:"",show:_.value,as:"template"},{default:d(()=>[a(n(q),{as:"div",onClose:y,class:"relative z-10"},{default:d(()=>[a(n(N),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:d(()=>[we]),_:1}),e("div",Ve,[e("div",ke,[a(n(N),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:d(()=>[a(n(L),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:d(()=>[e("div",De,[a(n(R),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:d(()=>[Pe,S(" Create patient ")]),_:1}),e("button",{onClick:y},[a(n(M),{class:"w-5 h-5"})])]),a(f,{type:"form",id:"patientForm","submit-label":"Update",onSubmit:g,actions:!1},{default:d(({})=>[e("div",$e,[e("div",Ce,[a(f,{type:"text",label:"First name",validation:"required",modelValue:l.value.firstName,"onUpdate:modelValue":u[0]||(u[0]=i=>l.value.firstName=i)},null,8,["modelValue"]),a(f,{type:"text",label:"Middle name",modelValue:l.value.middleName,"onUpdate:modelValue":u[1]||(u[1]=i=>l.value.middleName=i)},null,8,["modelValue"]),a(f,{type:"text",label:"Last name",validation:"required",modelValue:l.value.lastName,"onUpdate:modelValue":u[2]||(u[2]=i=>l.value.lastName=i)},null,8,["modelValue"])]),e("div",Fe,[e("div",Ne,[Ie,e("div",Ue,[a(x,{placeholder:new Date().toDateString(),"input-class-name":"border border-gray-50 rounded px-2 py-1.5 block focus:outline-none transition duration-150","as-single":"",shortcuts:!0,modelValue:l.value.dateOfBirth,"onUpdate:modelValue":u[3]||(u[3]=i=>l.value.dateOfBirth=i),range:!1,"max-date":new Date,"ignore-time-validation":!0,teleport:!0,"enable-time-picker":!1,formatter:("constants"in p?p.constants:n(Q)).dateFormatter},null,8,["placeholder","modelValue","max-date","formatter"])])]),a(f,{type:"text",label:"Age",modelValue:l.value.age,"onUpdate:modelValue":u[4]||(u[4]=i=>l.value.age=i)},null,8,["modelValue"])]),e("div",Ae,[a(f,{modelValue:l.value.gender,"onUpdate:modelValue":u[5]||(u[5]=i=>l.value.gender=i),type:"radio",label:"Sex",options:"sex"in p?p.sex:n(G),validation:"required"},null,8,["modelValue","options"]),a(f,{type:"text",label:"Physical Address",validation:"required",modelValue:l.value.physicalAddress,"onUpdate:modelValue":u[6]||(u[6]=i=>l.value.physicalAddress=i)},null,8,["modelValue"])])]),e("div",Se,[a(D,{type:"button",click:()=>{r()},text:"Clear form"},null,8,["click"]),a(O,{type:"submit",click:()=>{},color:"success",icon:n(X),text:"Save changes",loading:t.value},null,8,["icon","loading"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),Oe=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Be={class:"fixed inset-0 overflow-y-auto"},Te={class:"flex min-h-full items-center justify-center p-4 text-center"},Me={class:"border-b px-3 py-3 flex items-center justify-between"},qe=e("img",{src:z,class:"w-8 h-8 mr-2"},null,-1),Le={class:"mt-2 space-y-3 px-5 py-5"},Re={class:"w-full grid grid-cols-2 gap-2"},Ye={class:"items-center"},ze={class:"mt-3 justify-end flex items-center space-x-3 px-3 py-2 border-t"},Ee=H({__name:"index",emits:["action-completed"],setup(s,{emit:o}){const h=o,_=F(!1),t=F(!1),c=A("token"),m=F({firstName:"",lastName:"",gender:""}),l=()=>_.value=!_.value,y=async()=>{t.value=!0;const g={route:ce($.client.search,{first_name:m.value.firstName,last_name:m.value.lastName,gender:m.value.gender}),method:"GET",token:`${c.value}`},r=await C(g);t.value=r.pending,r.data.value&&(l(),h("action-completed",{patient:r.data.value,defaults:m.value}),m.value={firstName:"",lastName:"",gender:""}),r.error.value&&b().$toast.error(`${P}`),t.value=_.value=!1};return(g,r)=>{const p=j,u=v("FormKit");return V(),k("div",null,[e("div",null,[a(p,{text:"Find/Create Patient",color:"primary",icon:n(U),click:l},null,8,["icon"])]),a(n(Y),{appear:"",show:n(_),as:"template"},{default:d(()=>[a(n(q),{as:"div",onClose:l,class:"relative z-10"},{default:d(()=>[a(n(N),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:d(()=>[Oe]),_:1}),e("div",Be,[e("div",Te,[a(n(N),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:d(()=>[a(n(L),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:d(()=>[e("div",Me,[a(n(R),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:d(()=>[qe,S(" "+w("Find or Create patient"))]),_:1}),e("button",{onClick:l},[a(n(M),{class:"w-5 h-5"})])]),a(u,{type:"form",onSubmit:y,actions:!1},{default:d(({})=>[e("div",Le,[e("div",Re,[a(u,{type:"text",label:"First name",validation:"required",modelValue:n(m).firstName,"onUpdate:modelValue":r[0]||(r[0]=f=>n(m).firstName=f)},null,8,["modelValue"]),a(u,{type:"text",label:"Last name",validation:"required",modelValue:n(m).lastName,"onUpdate:modelValue":r[1]||(r[1]=f=>n(m).lastName=f)},null,8,["modelValue"])]),e("div",Ye,[a(u,{modelValue:n(m).gender,"onUpdate:modelValue":r[2]||(r[2]=f=>n(m).gender=f),type:"radio",label:"Gender",options:"sex"in g?g.sex:n(G),validation:"required"},null,8,["modelValue","options"])])]),e("div",ze,[a(p,{type:"submit",click:()=>{},color:"success",icon:n(be),text:"Find",loading:n(t)},null,8,["icon","loading"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),Ge={components:{TransitionRoot:Y,TransitionChild:N,Dialog:q,DialogPanel:L,DialogTitle:R,XMarkIcon:M,UserIcon:Z},props:{data:{required:!0,type:Object}},data(){return{details:new Object,open:!1,addIcon:U,viewIcon:ee,saveIcon:X,clearIcon:ae,cookie:A("token"),loading:!1}},methods:{async init(){this.adjustVisibility(),this.loading=!0;const s={route:`${$.clients}/${this.data.client_id}`,method:"GET",token:`${this.cookie}`},{data:o,pending:h,error:_}=await C(s);o.value&&(this.details=o.value,this.loading=!1),_.value&&(console.log(_.value),b().$toast.error(P))},adjustVisibility(){this.open=!this.open}}},Ke=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Xe={class:"fixed inset-0 overflow-y-auto"},He={class:"flex min-h-full items-center justify-center p-4 text-center"},Je={class:"border-b px-3 py-3 flex items-center justify-between"},Qe=e("img",{src:z,class:"w-8 h-8 mr-2"},null,-1),We={class:"flex items-center justify-center mx-auto my-20"},Ze={class:"mt-2 space-y-3 px-5 py-5"},et={class:"w-full flex flex-col space-y-1"},tt=e("label",{class:"font-semibold text-lg"},"Name",-1),at={class:"underline"},st={class:"w-full flex flex-col space-y-1"},lt=e("label",{class:"font-semibold text-lg"},"National Patient ID",-1),ot={class:"underline"},it={class:"w-full flex flex-col space-y-1"},nt=e("label",{class:"font-semibold text-lg"},"Date Of Birth",-1),rt={class:"underline"},dt={class:"w-full flex flex-col space-y-1"},ct=e("label",{class:"font-semibold text-lg"},"Sex",-1),ut={class:"underline"},mt={class:"w-full flex flex-col space-y-1"},pt=e("label",{class:"font-semibold text-lg"},"Physical Address",-1),ft={class:"underline"};function _t(s,o,h,_,t,c){const m=j,l=v("TransitionChild"),y=v("DialogTitle"),g=v("XMarkIcon"),r=fe,p=v("DialogPanel"),u=v("Dialog"),f=v("TransitionRoot");return V(),k("div",null,[e("div",null,[a(m,{text:"View",color:"success",icon:t.viewIcon,click:c.init},null,8,["icon","click"])]),a(f,{appear:"",show:t.open,as:"template"},{default:d(()=>[a(u,{as:"div",onClose:c.adjustVisibility,class:"relative z-10"},{default:d(()=>[a(l,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:d(()=>[Ke]),_:1}),e("div",Xe,[e("div",He,[a(l,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:d(()=>[a(p,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:d(()=>[e("div",Je,[a(y,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:d(()=>[Qe,S(" View patient ")]),_:1}),e("button",{onClick:o[0]||(o[0]=(...x)=>c.adjustVisibility&&c.adjustVisibility(...x))},[a(g,{class:"w-5 h-5"})])]),I(e("div",We,[a(r,{loading:t.loading},null,8,["loading"])],512),[[T,t.loading]]),I(e("div",Ze,[e("div",et,[tt,e("p",at,w(`${t.details.first_name} ${t.details.last_name}`),1)]),e("div",st,[lt,e("p",ot,w(t.details.npid),1)]),e("div",it,[nt,e("p",rt,w(t.details.date_of_birth),1)]),e("div",dt,[ct,e("p",ut,w(t.details.sex),1)]),e("div",mt,[pt,e("p",ft,w(t.details.physical_address),1)])],512),[[T,!t.loading]])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const ht=E(Ge,[["render",_t]]),vt={components:{TransitionRoot:Y,TransitionChild:N,Dialog:q,DialogPanel:L,DialogTitle:R,XMarkIcon:M,UserIcon:Z},props:{data:{required:!0,type:Object}},data(){return{details:new Object,open:!1,addIcon:U,saveIcon:X,clearIcon:ae,editIcon:te,loading:!1,cookie:A("token"),updatingFromDob:!1,updatingFromAge:!1,estimatedDate:!1}},methods:{async init(){this.handleDialog();const s={route:`${$.clients}/${this.data.client_id}`,method:"GET",token:`${this.cookie}`},{data:o,error:h}=await C(s);o.value&&(this.details=o.value),h.value&&(console.error(h.value),b().$toast.error(P))},async submitForm(){this.loading=!0;const s={route:`${$.clients}/${this.data.client_id}`,method:"PUT",token:`${this.cookie}`,body:{client:{uuid:this.details.uuid},person:{first_name:this.details.first_name,middle_name:this.details.middle_name,last_name:this.details.last_name,sex:this.details.sex.charAt(0),date_of_birth:this.details.date_of_birth,birth_date_estimated:this.estimatedDate},client_identifiers:[{type:"physical_address",value:this.details.physical_address},{type:"phone",value:this.details.phone},{type:"npid",value:this.details.npid}]}},{data:o,error:h,pending:_}=await C(s);this.loading=_,o.value&&(this.loading=!1,this.details={},b().$toast.success("Patient updated successfully!"),this.handleDialog(),this.$emit("update",!0)),h.value&&(this.loading=!1,console.error(h.value),b().$toast.error(`${P}`))},handleDialog(){this.open=!this.open}},watch:{"details.date_of_birth"(s){this.updatingFromAge||(this.updatingFromDob=!0,this.details.age=Number(W(s)),this.updatingFromDob=!1)},"details.age"(s,o){s!=o&&!this.updatingFromDob&&(this.updatingFromAge=!0,this.details.date_of_birth=K().subtract(s,"years").format("YYYY-MM-DD"),this.updatingFromAge=!1,this.estimatedDate=!0)}}},gt=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),yt={class:"fixed inset-0 overflow-y-auto"},xt={class:"flex min-h-full items-center justify-center p-4 text-center"},bt={class:"border-b px-3 py-3 flex items-center justify-between"},wt=e("img",{src:z,class:"w-8 h-8 mr-2"},null,-1),Vt={class:"mt-2 space-y-3 px-5 py-5"},kt={class:"w-full grid grid-cols-2 gap-2"},Dt={class:"w-full grid grid-cols-3 gap-2"},Pt={class:"grid grid-cols-2 gap-2 space-x-3"},$t={class:"w-full flex flex-col space-y-2"},Ct=e("label",{class:"font-medium"},"Date Of Birth",-1),Ft={class:"w-full"},Nt={class:"lex items-center"},It=e("label",{class:"mr-5 font-medium"},"Sex",-1),Ut=["value"],At={class:"ml-2"},St={class:"w-full grid grid-cols-2 gap-2"},jt={class:"mt-3 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Ot(s,o,h,_,t,c){const m=j,l=v("TransitionChild"),y=v("DialogTitle"),g=v("XMarkIcon"),r=v("FormKit"),p=v("datepicker"),u=J,f=v("DialogPanel"),x=v("Dialog"),D=v("TransitionRoot");return V(),k("div",null,[e("div",null,[a(m,{text:"Edit",color:"primary",icon:t.editIcon,click:c.init},null,8,["icon","click"])]),a(D,{appear:"",show:t.open,as:"template"},{default:d(()=>[a(x,{as:"div",onClose:c.handleDialog,class:"relative z-10"},{default:d(()=>[a(l,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:d(()=>[gt]),_:1}),e("div",yt,[e("div",xt,[a(l,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:d(()=>[a(f,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:d(()=>[e("div",bt,[a(y,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:d(()=>[wt,S(" Edit patient ")]),_:1}),e("button",{onClick:o[0]||(o[0]=(...O)=>c.handleDialog&&c.handleDialog(...O))},[a(g,{class:"w-5 h-5"})])]),a(r,{type:"form",id:"patientForm","submit-label":"Update",onSubmit:c.submitForm,actions:!1},{default:d(({value:O})=>[e("div",Vt,[e("div",kt,[a(r,{type:"text",label:"Patient ID",modelValue:t.details.uuid,"onUpdate:modelValue":o[1]||(o[1]=i=>t.details.uuid=i)},null,8,["modelValue"]),a(r,{type:"text",label:"National Patient ID",modelValue:t.details.npid,"onUpdate:modelValue":o[2]||(o[2]=i=>t.details.npid=i)},null,8,["modelValue"])]),e("div",Dt,[a(r,{type:"text",label:"First name",validation:"required",modelValue:t.details.first_name,"onUpdate:modelValue":o[3]||(o[3]=i=>t.details.first_name=i)},null,8,["modelValue"]),a(r,{type:"text",label:"Middle name",modelValue:t.details.middle_name,"onUpdate:modelValue":o[4]||(o[4]=i=>t.details.middle_name=i)},null,8,["modelValue"]),a(r,{type:"text",label:"Last name",validation:"required",modelValue:t.details.last_name,"onUpdate:modelValue":o[5]||(o[5]=i=>t.details.last_name=i)},null,8,["modelValue"])]),e("div",Pt,[e("div",$t,[Ct,e("div",Ft,[a(p,{placeholder:new Date().toDateString(),"input-classes":"border rounded px-2 py-1.5 block focus:outline-none focus:ring-2 focus:ring-sky-500 transition duration-150 focus:border-none","as-single":"",shortcuts:!0,modelValue:t.details.date_of_birth,"onUpdate:modelValue":o[6]||(o[6]=i=>t.details.date_of_birth=i),"text-input":!0,range:!1,"max-date":new Date,formatter:("constants"in s?s.constants:n(Q)).dateFormatter},null,8,["placeholder","modelValue","max-date","formatter"])])]),a(r,{type:"text",label:"Age",modelValue:t.details.age,"onUpdate:modelValue":o[7]||(o[7]=i=>t.details.age=i)},null,8,["modelValue"])]),e("div",Nt,[It,(V(!0),k(ie,null,ne("sex"in s?s.sex:n(G),(i,se)=>(V(),k("label",{class:"flex items-center mr-2",key:se},[I(e("input",{required:!0,"onUpdate:modelValue":o[8]||(o[8]=le=>t.details.sex=le),value:i.value,type:"radio",placeholder:"Male",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,8,Ut),[[re,t.details.sex]]),e("span",At,w(i.name),1)]))),128))]),e("div",St,[a(r,{type:"text",label:"Physical Address",modelValue:t.details.physical_address,"onUpdate:modelValue":o[9]||(o[9]=i=>t.details.physical_address=i)},null,8,["modelValue"]),a(r,{type:"tel",label:"Phone number","prefix-icon":"telephone",modelValue:t.details.phone,"onUpdate:modelValue":o[10]||(o[10]=i=>t.details.phone=i),"prefix-icon-class":"inline-block w-5 h-5 text-gray-700 absolute mt-4 ml-2 mr-2","validation-visibility":"dirty"},null,8,["modelValue"])])]),e("div",jt,[a(u,{type:"button",click:()=>{},text:"Clear form"}),a(m,{type:"submit",click:()=>{},color:"success",icon:t.saveIcon,text:"Save changes",loading:t.loading},null,8,["icon","loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const Bt=E(vt,[["render",Ot]]),Tt={components:{UsersIcon:ve,PlusIcon:U,MagnifyingGlassIcon:ye},setup(){de({title:`${he.name.toUpperCase()} - Patients`})},data(){return{loading:!1,openCreatePatientForm:!1,newIcon:ge,defaultData:{},editIcon:te,viewIcon:ee,refreshIcon:xe,headers:new Array({text:"patient no",value:"client_id",sortable:!0},{text:"name",value:"name",sortable:!0},{text:"sex",value:"sex",sortable:!0},{text:"date of birth",value:"date_of_birth",sortable:!0},{text:"physical address",value:"physical_address",sortable:!0},{text:"actions",value:"actions"}),pages:[{name:"Home",link:"/home"}],data:{},addIcon:U,patients:new Array,cookie:A("token"),serverItemsLength:0,serverOptions:{page:1,rowsPerPage:25,sortBy:"name"},searchField:"name",search:"",searchValue:"",createPatient:!1,showSearch:!1}},created(){this.init()},methods:{updateSearch(s){this.searchValue=s,this.search=s,this.updatePatients(!0)},async init(){this.createPatient=!1,this.defaultData={firstName:"",lastName:"",middleName:"",gender:""},this.loading=!0;const{page:s,rowsPerPage:o}=this.serverOptions,h=ue(),_=me(h.locations,h.selectedLocation),t={route:`${$.clients}?page=${s}&per_page=${o}&search=${this.search}&lab_location=${_}`,method:"GET",token:`${this.cookie}`};let{data:c,error:m,pending:l}=await C(t);this.loading=l,c.value&&(this.patients=c.value.clients,this.serverItemsLength=c.value.meta.total_count),m.value&&(console.error(m.value.data),b().$toast.error(`${P}`))},updatePatients(s){typeof s=="object"&&(this.serverOptions=s),this.init()},async handleClick(s){this.data=s,s.source==="remote"&&await this.handleSaveRemotePatient(this.data),this.$router.push(`/tests/new-test?patient_id=${s.client_id}`)},async handleSaveRemotePatient(s){const o={route:$.clients,method:"POST",token:this.cookie,body:{client:{uuid:s.uuid},person:{first_name:s.first_name,middle_name:s.middle_name,last_name:s.last_name,sex:s.sex,date_of_birth:s.date_of_birth,birth_date_estimated:!1},client_identifiers:{current_village:s.current_village,current_district:s.current_district,current_traditional_authority:s.current_traditional_authority,physical_address:`${s.home_village} ${s.home_traditional_authority} ${s.home_district}`,npid:s.npid}}},{data:h,error:_,pending:t}=await C(o);h.value&&(this.data=h.value),_.value&&b().$toast.error(`${P}`)},handleActionCompleted(s){s.patient.length>0?(this.createPatient=!0,this.patients=s.patient,this.serverItemsLength=s.patient.length,this.showSearch=!0):(b().$toast.warning("Patient not found"),this.openCreatePatientForm=!0,this.defaultData=s.defaults,this.showSearch=!1)},setCreatePatientFormVisibility(s){this.openCreatePatientForm=s}},computed:{filteredPatients(){return this.patients.map(s=>({...s,name:pe(`${s.first_name} ${s.middle_name!=null?s.middle_name:""} ${s.last_name}`),date_of_birth:K(s.date_of_birth).format("DD/MMMM/YYYY")}))}}},Mt=""+new URL("health_worker_form.1359104e.svg",import.meta.url).href,qt={class:"py-5 px-5"},Lt=e("div",{class:"flex items-center space-x-2 py-5"},[e("img",{src:Mt,alt:"form-icon",class:"w-auto h-10"}),e("h3",{class:"text-2xl font-semibold uppercase"},"Patients List")],-1),Rt={class:"flex justify-between items-center w-full px-2 py-2 mb-2"},Yt={class:"flex items-center space-x-2"},zt={class:"mb-2.5"},Et={class:"text-lg font-medium"},Gt={class:"py-2 flex items-center space-x-2"};function Kt(s,o,h,_,t,c){var f,x;const m=oe,l=j,y=je,g=Ee,r=ht,p=Bt,u=_e;return V(),k("div",qt,[a(m,{pages:t.pages},null,8,["pages"]),Lt,e("div",Rt,[e("div",Yt,[a(l,{color:"warning",icon:t.refreshIcon,text:"Refresh",click:()=>{c.init()}},null,8,["icon","click"]),I(a(l,{click:()=>{t.openCreatePatientForm=!0},text:"Create a new patient",color:"success",icon:t.addIcon},null,8,["click","icon"]),[[T,t.createPatient]])]),a(y,{openForm:t.openCreatePatientForm,onSetAdjustVisibility:c.setCreatePatientFormVisibility,onOnPatientCreated:c.updatePatients,"default-data":t.defaultData},null,8,["openForm","onSetAdjustVisibility","onOnPatientCreated","default-data"]),a(g,{onActionCompleted:c.handleActionCompleted},null,8,["onActionCompleted"])]),I(e("div",zt,[S(" Showing results for "),e("span",Et,w(`${(f=t.defaultData)==null?void 0:f.firstName} ${(x=t.defaultData)==null?void 0:x.lastName}`),1)],512),[[T,t.showSearch]]),a(u,{headers:t.headers,data:c.filteredPatients,loading:t.loading,searchField:t.searchField,searchValue:t.searchValue,serverItemsLength:t.serverItemsLength,serverOptions:t.serverOptions,onUpdate:c.updatePatients},{actions:d(({item:D})=>[e("div",Gt,[a(l,{click:()=>c.handleClick(D),text:"New Test",color:"primary",icon:t.newIcon},null,8,["click","icon"]),a(r,{data:D},null,8,["data"]),a(p,{data:D,onUpdate:c.updatePatients},null,8,["data","onUpdate"])])]),_:1},8,["headers","data","loading","searchField","searchValue","serverItemsLength","serverOptions","onUpdate"])])}const ha=E(Tt,[["render",Kt]]);export{ha as default};
