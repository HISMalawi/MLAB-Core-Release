import{d as U,M as E,al as F,u as q,r as b,o as R,x as P,b as n,e as i,g as e,h as o,f as u,C as w,t as k,K as z,j as T,y as L,A as K,i as G,F as j,k as D,bs as O,m as V,l as C,n as W,_ as J}from"./B6cxelmB.js";import{_ as Q}from"./CNMhSPC9.js";import{P as X}from"./D4--2Hlb.js";import{u as Y}from"./B-gZ4rWW.js";import{u as Z}from"./CZuTiJYT.js";import{r as ee}from"./BWLZVQ-n.js";import{r as te}from"./sNlg2jLO.js";import"./ggmJqlUs.js";import"./D3aePf0O.js";const se={class:"px-5 py-5"},ae={class:"relative min-h-screen"},oe={key:0,class:"absolute inset-0 z-20 bg-white bg-opacity-70 flex items-center justify-center"},re={class:"text-center"},le={class:"flex items-center justify-between py-5"},ne={key:0,class:"flex items-center"},ie={key:1,class:"flex items-center"},de={key:2,class:"flex items-center"},ue={class:"ml-4"},ve={class:"text-2xl font-semibold"},me={key:3,class:"flex space-x-2"},ce={class:"pt-5"},pe={class:"flex justify-end space-x-3"},ye=["disabled"],fe={key:1,class:"animate-pulse"},ge={key:2,class:"mt-10"},he={class:"bg-white border border-red-200 rounded-lg p-6 shadow-sm"},xe={class:"flex flex-col items-center justify-center py-10"},be={key:3},_e={class:"bg-white border border-gray-200 rounded p-6"},we={class:"mt-2 space-y-5"},ke={class:"grid grid-cols-2 gap-6"},Te={class:"w-full flex space-x-4"},Ve={class:"ml-2 flex flex-col space-y-2"},Ce={class:"relative"},$e=["value"],Ie={key:0,class:"mt-6"},Ne={class:"bg-gray-50 p-4 rounded border border-gray-100"},ze={class:"flex flex-col"},je={class:"flex items-center mb-2"},De={class:"pl-2 py-0 bg-gray-200 flex items-center text-gray-700 text-xs rounded-full"},He={class:"bg-sky-500 text-sm text-white px-2 py-1 rounded-r-full ml-2 font-medium"},Le=U({__name:"[id]",setup(Me){Z({title:`${X.name.toUpperCase()} - Test Types`});const $=E(),H=F(),c=q(),v=b(!1),p=b(!1),M=te,{getSecureId:I,clearAndNavigate:_}=Y(),s=b({preferred_name:"",expected_turn_around_time:{value:"",unit:""},name:"",indicators:[]}),m=b(""),y=b({name:"-- select value --"}),A=[{name:"Month"},{name:"Weeks"},{name:"Days"},{name:"Hours"},{name:"Minutes"}],B=[{name:"Home",link:"/home"},{name:"Test Catalog",link:"#"},{name:"Test Types",link:"/test-catalog/test-types"}],S=async()=>{v.value=!0;const h=I();if(!h){const l=$.params.id;if(l&&!isNaN(parseInt(l))){const f=parseInt(l),d={route:`${C.viewTestType}/${f}`,method:"GET"};try{const{data:r,error:a}=await V(d);if(r.value&&Object.keys(r.value).length>0){s.value=r.value,s.value.indicators&&s.value.indicators.length>0&&(s.value.indicators=s.value.indicators.map(x=>({...x,preferred_name:x.preferred_name||x.name})));const g=r.value.expected_turn_around_time||{unit:null,value:""};y.value={name:g.unit||"-- select value --"},m.value=g.value||"",v.value=!1;return}}catch(r){console.error("Error trying direct ID:",r)}}v.value=!1,c.$toast.error("Invalid or missing test type ID"),H.push("/test-catalog/test-types");return}const t={route:`${C.viewTestType}/${h}`,method:"GET"};try{const{data:l,error:f}=await V(t);if(l.value&&Object.keys(l.value).length>0){s.value=l.value,s.value.indicators&&s.value.indicators.length>0&&(s.value.indicators=s.value.indicators.map(r=>({...r,preferred_name:r.preferred_name||r.name})));const d=l.value.expected_turn_around_time||{unit:null,value:""};y.value={name:d.unit||"-- select value --"},m.value=d.value||""}else console.error("Test type data is empty or not found"),c.$toast.error("Test type not found or could not be loaded")}catch(l){console.error("Error fetching test type:",l),c.$toast.error("Failed to load test type data")}finally{v.value=!1}},N=async()=>{p.value=!0;const h=m.value===""?"0":m.value,t=y.value.name==="-- select value --"?"Days":y.value.name;s.value.expected_turn_around_time={value:h,unit:t},s.value.indicators&&s.value.indicators.length>0&&(s.value.indicators=s.value.indicators.map(a=>({...a,preferred_name:a.preferred_name||a.name})));let l=I();if(!l){const a=$.params.id;if(a&&!isNaN(parseInt(a)))l=parseInt(a);else{c.$toast.error("Invalid test type ID"),p.value=!1;return}}const f={route:`${C.testTypes}/${l}`,method:"PUT",body:s.value},{data:d,error:r}=await V(f);d.value&&(c.$toast.success("Test type updated successfully!"),p.value=!1,_("/test-catalog/test-types")),r.value&&(c.$toast.error("An error occurred, please try again!"),console.error("error:",r.value),p.value=!1)};return R(()=>{S()}),(h,t)=>{const l=W,f=Q,d=J,r=P("FormKit");return n(),i("div",se,[e("div",ae,[o(v)?(n(),i("div",oe,[e("div",re,[u(l,{size:"lg"}),t[5]||(t[5]=e("div",{class:"mt-4"},[e("label",{class:"font-medium text-gray-700"},"Loading test type data, please wait...")],-1))])])):w("",!0),u(f,{pages:B}),e("div",le,[o(v)?(n(),i("div",ne,t[6]||(t[6]=[e("div",{class:"h-12 w-12 bg-gray-200 rounded-full animate-pulse mr-4"},null,-1),e("div",{class:"h-8 w-56 bg-gray-200 rounded animate-pulse"},null,-1)]))):o(s).name?(n(),i("div",de,[t[9]||(t[9]=e("div",{class:"text-sky-500 flex-shrink-0"},[e("svg",{class:"w-16 h-16",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 48 48"},[e("path",{fill:"currentColor","fill-rule":"evenodd",d:"M31 10a1 1 0 1 0 0 2v7h-3v-7a1 1 0 1 0 0-2h-8a1 1 0 1 0 0 2v7h-3v-7a1 1 0 1 0 0-2H9a1 1 0 1 0 0 2v7H7v-3H5v3H4v2h1v13H4v2h1v2h2v-2h34v2h2v-2h1v-2h-1V21h1v-2h-1v-3h-2v3h-2v-7a1 1 0 1 0 0-2zm6 9v-7h-4v7zm-4 2h4v5h-4zm-2 0v8a4 4 0 0 0 8 0v-8h2v13H7V21h2v8a4 4 0 0 0 8 0v-8h3v8a4 4 0 0 0 8 0v-8zm-5-2v-7h-4v7zm-11 0v-7h-4v7zm-4 2h4v2h-4z","clip-rule":"evenodd"})])],-1)),e("div",ue,[e("h3",ve,k(o(s).name),1),t[8]||(t[8]=e("p",{class:"text-gray-500 text-sm"},"Edit Test Type Details",-1))])])):(n(),i("div",ie,t[7]||(t[7]=[e("div",{class:"text-red-500"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-10 h-10"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1),e("h3",{class:"text-2xl font-semibold ml-3 text-red-500"}," Test Type Not Found ",-1)]))),o(s).name?(n(),i("div",me,[e("div",ce,[e("div",pe,[e("button",{type:"button",class:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50 transition",onClick:t[0]||(t[0]=a=>o(_)("/test-catalog/test-types")),disabled:o(p)}," Cancel ",8,ye),u(d,{type:"submit",click:()=>{N()},loading:o(p),color:"success",icon:o(M),text:"Save Changes"},null,8,["click","loading","icon"])])])])):w("",!0)]),o(v)?(n(),i("div",fe,t[10]||(t[10]=[z('<div class="mt-4 space-y-6"><div class="grid grid-cols-2 gap-4"><div><div class="h-5 w-28 bg-gray-200 rounded mb-2"></div><div class="h-10 bg-gray-200 rounded w-full"></div></div></div><div class="w-full flex"><div class="flex-1"><div class="h-5 w-48 bg-gray-200 rounded mb-2"></div><div class="h-10 bg-gray-200 rounded w-full"></div></div><div class="ml-2 w-48"><div class="h-5 w-20 bg-gray-200 rounded mb-2"></div><div class="h-10 bg-gray-200 rounded w-full"></div></div></div><div class="mt-10 flex justify-end"><div class="h-10 w-36 bg-gray-200 rounded"></div></div></div>',1)]))):o(s).name?(n(),i("div",be,[e("div",_e,[u(r,{type:"form","submit-label":"Update",onSubmit:N,actions:!1},{default:L(()=>[e("div",we,[e("div",ke,[u(r,{type:"text",label:"Preferred name",validation:"required","validation-visibility":"live",help:"The display name for this test type",modelValue:o(s).preferred_name,"onUpdate:modelValue":t[2]||(t[2]=a=>o(s).preferred_name=a)},null,8,["modelValue"])]),e("div",Te,[u(r,{type:"number",label:"Expected Turn Around Time",validation:"number","validation-messages":{number:"Turn around time must be a valid number"},"validation-visibility":"live",placeholder:"Enter turn around time (default: 0)",help:"How long this test typically takes to complete",modelValue:o(m),"onUpdate:modelValue":t[3]||(t[3]=a=>K(m)?m.value=a:null)},null,8,["modelValue"]),e("div",Ve,[t[15]||(t[15]=e("label",{class:"font-medium text-base"},[T("Duration "),e("span",{class:"text-red-600"},"*")],-1)),e("div",Ce,[G(e("select",{"onUpdate:modelValue":t[4]||(t[4]=a=>o(y).name=a),class:"w-full appearance-none border border-gray-300 rounded py-1.5 pl-3 pr-10 text-gray-700 cursor-pointer focus:outline-none focus:ring-0 focus:border-transparent"},[t[13]||(t[13]=e("option",{value:"-- select value --",disabled:""}," -- select value -- ",-1)),(n(),i(j,null,D(A,(a,g)=>e("option",{key:g,value:a.name},k(a.name),9,$e)),64))],512),[[O,o(y).name]]),t[14]||(t[14]=e("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-500"},[e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"m8 16l4 4l4-4M8 8l4-4l4 4"})])],-1))])])]),o(s).indicators&&o(s).indicators.length>0?(n(),i("div",Ie,[t[17]||(t[17]=e("h3",{class:"text-lg font-medium text-gray-800 mb-3"},"Measures (Indicators)",-1)),e("div",Ne,[(n(!0),i(j,null,D(o(s).indicators,(a,g)=>(n(),i("div",{key:g,class:"mb-4 pb-4 border-b border-gray-200 last:border-0 last:mb-0 last:pb-0"},[e("div",ze,[e("div",je,[e("span",De,[t[16]||(t[16]=T(" System name ")),e("span",He,k(a.name),1)])]),u(r,{type:"text",label:"Preferred name",validation:"required","validation-visibility":"live",help:`Set display name for '${a.name}'`,modelValue:a.preferred_name,"onUpdate:modelValue":x=>a.preferred_name=x},null,8,["help","modelValue","onUpdate:modelValue"])])]))),128))])])):w("",!0)])]),_:1})])])):(n(),i("div",ge,[e("div",he,[e("div",xe,[t[12]||(t[12]=z('<div class="text-red-500 mb-4"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-20 h-20"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z"></path></svg></div><h2 class="text-2xl font-bold text-gray-800 mb-2"> Test Type Not Found </h2><p class="text-gray-600 mb-8 text-center max-w-lg"> The test type you are looking for could not be found or has been removed from the system. </p>',3)),e("button",{onClick:t[1]||(t[1]=a=>o(_)("/test-catalog/test-types")),class:"px-4 py-2 bg-sky-500 flex items-center text-white rounded-md hover:bg-sky-600 transition shadow-sm"},[u(o(ee),{class:"w-5 h-5 mr-2"}),t[11]||(t[11]=T(" Return to Test Types List "))])])])]))])])}}});export{Le as default};
