import{_ as I}from"./Breadcrumb.vue.5ee97787.js";import{_ as K}from"./Dropdown.9b914841.js";import{m as Q,u as W,C as u,a as X,L as D,g as M,o as a,c as n,d as l,l as e,e as t,t as i,i as C,E as T,h as Z,F as y,r as x,b as k,f as ee}from"./entry.97d0b54e.js";import{_ as te}from"./index.7a3f7cb8.js";import{_ as oe}from"./ExportButton.vue.4fdcd0b0.js";import{_ as re}from"./Address.vue.fb5f2755.js";import{d as F,e as se}from"./constants.0c4e4d21.js";import{_ as ae}from"./report.9c4679cd.js";import{_ as ne}from"./logo.e661b2c6.js";import{h as _,e as P,f as S}from"./fetch.e0862392.js";import{u as le}from"./facility.288f2472.js";import{P as de}from"./package.e5cbe000.js";import{r as ce}from"./FunnelIcon.d7b83064.js";import{r as ie}from"./ArrowPathIcon.c9420c22.js";import"./nuxt-link.68cca64c.js";import"./HomeIcon.68cf51b5.js";import"./listbox.275dc16f.js";import"./hidden.a4deafd9.js";import"./use-text-value.ce167c22.js";import"./CheckIcon.bd552bd1.js";import"./CheckCircleIcon.882786b8.js";import"./MagnifyingGlassIcon.2cc40897.js";import"./html2canvas.esm.acdae98d.js";import"./jspdf.es.min.314f3148.js";import"./XMarkIcon.14e83439.js";import"./PrinterIcon.068c8bcd.js";import"./transition.24037afa.js";import"./PencilSquareIcon.5fdb3ab6.js";const me={class:"px-5 py-5"},pe=t("img",{src:ae,alt:"report-icon",class:"w-8 h-8 mr-2"},null,-1),ue={class:"w-full flex items-center justify-between"},_e={class:"flex items-center space-x-3"},fe={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},ve={class:"w-72 ml-2"},be={class:"w-44"},he={class:"flex items-center space-x-3"},ye={class:"mt-3"},xe={class:"text-lg font-semibold mb-2"},ge={class:"text-normal font-normal"},Re={class:"border rounded print-container",id:"print-container"},De={class:"flex items-center justify-between px-5 py-5 border-b"},ke=t("div",{class:"flex flex-col space-y-2"},[t("img",{src:ne,alt:"app-logo",class:"w-24 h-24 object-cover"}),t("h3",{class:"text-xl font-semibold"}," REJECTED SAMPLES REPORT ")],-1),we={class:"mt-10"},Ee={class:"w-full border border-dotted rounded overflow-x-auto"},$e={class:"bg-gray-50 border-b border-dotted rounded-t"},Me=t("th",{class:"border-r"},null,-1),Ce=["colspan"],Te=t("th",null,"TOTAL",-1),Fe=t("td",{class:"border-r border-b border-dotted px-2 py-2"},null,-1),Pe={class:"border-r border-b border-dotted px-2 py-2"},Se={class:"border-r border-t border-b border-dotted px-2 py-2"},Ve="Rejected Samples Report",it=Q({__name:"rejected-samples",setup(je){W({title:`${de.name.toUpperCase()} - Rejected Samples Report`});const V=u([{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"Aggregate Reports",link:"#"}]),w=u([]),f=u({name:"select department"}),E=X("token"),g=le(),d=u(["",""]),j=()=>{d.value=new Array("","")},m=u({result:[],value:void 0,wards:void 0}),A=D(()=>[]),v=u(!1),Y=()=>{const o={};return m.value.result.forEach(r=>{r.test_types.forEach(s=>{o[s.name]?o[s.name]+=s.count:o[s.name]=s.count})}),o};async function B(){const o={route:P.departments,method:"GET",token:`${E.value}`},{data:r,error:s}=await S(o);r.value&&(w.value=r.value),s.value&&console.error(s.value)}const b=D(()=>d.value[0]?_(d.value[0]).format("YYYY-MM-DD"):""),h=D(()=>d.value[1]?_(d.value[1]).format("YYYY-MM-DD"):"");async function L(){if(O())k().$toast.warning("Please select a department");else{v.value=!0;const o={route:`${P.aggregateReports}rejected?from=${b.value}&to=${h.value}&department=${f.value.id}`,method:"GET",token:`${E.value}`},{data:r,error:s,pending:R}=await S(o);v.value=R,r.value&&(v.value=!1,m.value=r.value.data,console.log(r.value.data),k().$toast.success("Report generated successfully!")),s.value&&(console.log(s.value),v.value=!1,k().$toast.error(se))}}function O(){return f.value.name=="select department"}return B(),(o,r)=>{const s=I,R=M("datepicker"),q=K,N=ee,G=te,U=oe,H=M("excel"),J=re;return a(),n("div",me,[l(s,{pages:e(V)},null,8,["pages"]),t("div",{class:"flex items-center py-5"},[pe,t("h3",{class:"text-2xl font-semibold uppercase"},i(Ve))]),t("div",ue,[t("div",_e,[t("div",fe,[l(e(ce),{class:"w-5 h-5 mr-2"}),C(" Filter By Date Range "),t("div",ve,[l(R,{onCleared:j,required:"",position:"left",placeholder:"select start & end date",range:!0,"input-class-name":"datepicker",modelValue:e(d),"onUpdate:modelValue":r[0]||(r[0]=p=>T(d)?d.value=p:null),format:"dd/MM/yyyy"},null,8,["modelValue"])])]),t("div",be,[l(q,{items:e(w),modelValue:e(f),"onUpdate:modelValue":r[1]||(r[1]=p=>T(f)?f.value=p:null)},null,8,["items","modelValue"])]),l(N,{color:"primary",text:"Generate Report",icon:e(ie),click:()=>L(),loading:e(v)},null,8,["icon","click","loading"])]),t("div",he,[l(G,{printSmallLabel:!1}),l(H,{class:"btn btn-default",header:["REJECTED SAMPLES REPORT ",`PERIOD FROM ${e(_)(e(b)).format("DD-MM-yyyy")} TO ${e(h)}).format('DD-MM-yyyy')}`,e(g).details.name,e(g).details.address,e(g).details.phone],data:e(A),worksheet:"report-work-sheet",name:`rejected_samples_report_${e(_)(e(b)).format("DD_MM_yyyy")}_to_${e(h)}).format('DD_MM_yyyy')}.xls`},{default:Z(()=>[l(U,{text:"Export Excel"})]),_:1},8,["header","data","name"])])]),t("div",ye,[t("h3",xe,[C("Tests Performed Period: "),t("span",ge,i(e(b)!=""?e(_)(e(b)).format("dateFormat"in o?o.dateFormat:e(F)):"")+" - "+i(e(h)!=""?e(_)(e(h)).format("dateFormat"in o?o.dateFormat:e(F)):""),1)])]),t("div",Re,[t("div",De,[ke,l(J)]),t("div",we,[t("table",Ee,[(a(!0),n(y,null,x(e(m).result,(p,z)=>(a(),n(y,{key:z},[t("thead",$e,[t("tr",null,[Me,t("th",{colspan:e(m).wards.length,class:"px-5 py-2 border-r"},i(p.name),9,Ce),Te])]),t("tbody",null,[t("tr",null,[Fe,(a(!0),n(y,null,x(e(m).wards,c=>(a(),n("td",{key:c,class:"border-r border-b border-dotted px-2 py-2"},i(c),1))),128))]),(a(!0),n(y,null,x(p.test_types,c=>(a(),n("tr",{key:c.name},[t("td",Pe,i(c.name),1),(a(!0),n(y,null,x(e(m).wards,$=>(a(),n("td",{key:$,class:"border-r border-b border-dotted px-2 py-2"},i(c.ward===$?c.count:0),1))),128)),t("td",Se,i(Y()[c.name]),1)]))),128))])],64))),128))])])])])}}});export{it as default};
