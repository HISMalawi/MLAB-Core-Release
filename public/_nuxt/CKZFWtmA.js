import{_ as ee}from"./CJvkj-tn.js";import{_ as te}from"./C1s4h11S.js";import{d as oe,aE as re,r as $,a as ae,a2 as se,N as ne,u as ce,w as ie,C as Q,c as de,o as P,y as le,b as C,e as R,f as m,h as r,g as t,j as F,H as ue,z as pe,t as s,K as V,F as me,k as ye,l as G,m as H,aF as be,E as _e,_ as he,n as xe}from"./DnTf3NWd.js";import{_ as ve}from"./DJz_oooy.js";import{_ as fe,a as ke}from"./ySeiYOL9.js";import{_ as ge}from"./B0gStN0n.js";import{_ as $e}from"./ZfS1jsdp.js";import{u as Ce}from"./BVRlufMU.js";import{P as Re}from"./BoMgRSy8.js";import{u as we}from"./mHvkefY9.js";import{r as je}from"./CuOiP421.js";import{r as De}from"./DFUnnXAW.js";import"./BhIICg8V.js";import"./DfD7FrAn.js";import"./WltjxLmA.js";import"./BLLOd8LX.js";import"./1eaZyNWU.js";import"./yvghsNpl.js";import"./BtxD3RuX.js";import"./1YzmTxIi.js";import"./B8fW6sbj.js";const Ne={class:"px-5 py-5"},Qe={class:"w-full flex justify-between py-5"},Me={class:"flex items-center space-x-3"},Ye={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},Te={class:"w-36 ml-2 bg-white"},Oe={class:"border rounded"},Ae={class:"rounded-tr rounded-tl border-b px-5 py-5 flex items-center justify-between"},Ee={class:"px-4 py-2.5 font-medium"},qe={class:"font-normal"},Fe={class:"overflow-x-auto rounded border-t relative"},Be={key:0,class:"w-full bg-black bg-opacity-5 absolute flex space-y-2 justify-center py-20 mx-auto h-full"},Se={class:"flex flex-col items-center space-y-"},Ie={class:"overflow-x-auto"},Le={class:"px-4 py-2 text-center border-r border-b"},Pe=["onClick"],Ve=["onClick"],Ge=["onClick"],He={class:"px-4 py-2 text-center bg-sky-50 text-sky-500 border border-sky-100"},Je=["onClick"],Ue=["onClick"],ze=["onClick"],Ke={class:"px-4 py-2 text-center bg-sky-50 text-sky-500 border border-sky-100"},We=["onClick"],Xe=["onClick"],Ze=["onClick"],et={class:"px-4 py-2 text-center bg-sky-50 text-sky-500 border border-sky-100"},tt=["onClick"],ot=["onClick"],rt=["onClick"],at={class:"px-4 py-2 text-center bg-sky-50 text-sky-500 border-t border-l border-b border-sky-100"},st={class:"px-4 py-2 text-center bg-green-600 border text-white border-green-400"},nt={key:1,class:"w-full flex flex-col items-center justify-center space-y-2 py-10"},Nt=oe({__name:"microbiology",setup(ct){we({title:`${Re.name.toUpperCase()} - Biochemistry Report`});const J=re([{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"MoH Diagnistic Reports",link:"#"}]),b=$([]),a=$({name:"select year"}),B=$([]),S=ae("token"),u=$(!1),_=se(),h=ne(),{$toast:x}=ce(),M=Ce(),I=$([]),l=(n,o,c,p)=>{if(c!==0&&p!==""){const y=Q(o).format("MMMM-YYYY");_.push(`/reports/${p}?origin=moh&type=Microbiology-report&dateRange=${y}&test=${n} - ${y}&department=Microbiology&count=${c}`)}else x.warning("No data found for this month")},U=async()=>{u.value=!0;const n={route:`${G.reportIndicators}?department=Microbiology`,method:"GET",token:`${S.value}`},{data:o,error:c}=await H(n);o.value&&(b.value=o.value.map(p=>({indicator:p,jan:{count:"!",associated_ids:""},feb:{count:"!",associated_ids:""},mar:{count:"!",associated_ids:""},totalQ1:"!",apr:{count:"!",associated_ids:""},may:{count:"!",associated_ids:""},june:{count:"!",associated_ids:""},totalQ2:"!",jul:{count:"!",associated_ids:""},aug:{count:"!",associated_ids:""},sept:{count:"!",associated_ids:""},totalQ3:"!",oct:{count:"!",associated_ids:""},nov:{count:"!",associated_ids:""},dec:{count:"!",associated_ids:""},totalQ4:"!",total:"!"})),u.value=!1),c.value&&(console.error(c.value),u.value=!1,x.error(be))},z=async()=>{a.value.name==="select year"?x.warning("Please select a year"):L()},K=()=>{let n="";if(a.value.name!=="select year"&&(n=`&year=${a.value.name}`),h.query.period){const o=`1/${String(h.query.period)}`;n=`&year=${Q(o).format("YYYY")}`,a.value={name:Q(o).format("YYYY")}}return n},L=async()=>{u.value=!0;const n={route:`${G.mohReport}microbiology?report_id=${h.query.report_id}${K()}`,method:"GET",token:`${S.value}`},{data:o,error:c,pending:p}=await H(n);if(u.value=p,o.value){let y=[];b.value.map(i=>{let v=o.value.january[i.indicator],f=o.value.february[i.indicator],k=o.value.march[i.indicator],e=o.value.april[i.indicator],g=o.value.may[i.indicator],d=o.value.june[i.indicator],Y=o.value.july[i.indicator],T=o.value.august[i.indicator],O=o.value.september[i.indicator],A=o.value.october[i.indicator],E=o.value.november[i.indicator],q=o.value.december[i.indicator],w=v.count+f.count+k.count,j=e.count+g.count+d.count,D=Y.count+T.count+O.count,N=A.count+E.count+q.count;y.push({indicator:i.indicator,jan:v,feb:f,mar:k,totalQ1:w,apr:e,may:g,june:d,totalQ2:j,jul:Y,aug:T,sept:O,totalQ3:D,oct:A,nov:E,dec:q,totalQ4:N,total:w+j+D+N}),I.value.push({"Laboratory Service":i.indicator,January:v.count,February:f.count,March:k.count,"Total Q1":w,April:e.count,May:g.count,June:d.count,"Total Q2":j,July:Y.count,August:T.count,September:O.count,"Total Q3":D,October:A.count,November:E.count,December:q.count,"Total Q4":N,Total:w+j+D+N})}),b.value=[],b.value.push(...y),u.value=!1,W(o.value.report_id),x.success("Report data generated successfully!")}c.value&&(u.value=!1,console.error(c.value),x.error(_e))},W=n=>{const c={..._.currentRoute.value.query,report_id:n};_.replace({query:c}).catch(p=>{console.error("Failed to replace route:",p)})},X=()=>{const n=new Date().getFullYear();B.value=Array.from({length:n-1999},(o,c)=>({name:(n-c).toString(),id:n-c}))};ie(a,()=>{if(a){const o={..._.currentRoute.value.query,period:Q(a.value.name).format("M/yyyy"),report_id:""};_.replace({query:o}).catch(c=>{console.error("Failed to replace route:",c)})}},{deep:!0});const Z=de(()=>h.query.period!==void 0&&h.query.period!=="");return P(()=>{Z.value&&L()}),P(()=>{X(),U()}),(n,o)=>{const c=ee,p=te,y=he,i=ve,v=le("excel"),f=ke,k=xe;return C(),R("div",Ne,[m(c,{pages:r(J)},null,8,["pages"]),o[6]||(o[6]=t("div",{class:"py-5"},[t("div",{class:"text-2xl font-semibold flex items-center uppercase"},[t("img",{src:ge,alt:"report-icon",class:"w-8 h-8 mr-2"}),F(" Microbiology Report ")])],-1)),t("div",Qe,[t("div",Me,[t("div",Ye,[m(r(je),{class:"w-5 h-5 mr-2"}),o[1]||(o[1]=F(" Filter By Year ")),t("div",Te,[m(p,{items:r(B),modelValue:r(a),"onUpdate:modelValue":o[0]||(o[0]=e=>ue(a)?a.value=e:null)},null,8,["items","modelValue"])])]),m(y,{loading:r(u),click:()=>{z()},color:"primary",icon:r(De),text:"Generate report"},null,8,["loading","click","icon"])]),t("div",null,[m(v,{class:"btn btn-default",header:[`MICROBIOLOGY MoH LABORATORY REPORT ${r(a).name}`,r(M).details.name,r(M).details.address,r(M).details.phone],data:r(I),worksheet:"report-work-sheet",name:`moh_microbiology_report_${r(a).name}.xls`},{default:pe(()=>[m(i,{text:"Export Excel"})]),_:1},8,["header","data","name"])])]),t("div",Oe,[t("div",Ae,[o[2]||(o[2]=t("div",{class:"flex flex-col space-y-2"},[t("img",{src:$e,alt:"app-logo",class:"w-24 h-24 object-cover"}),t("h3",{class:"text-xl font-semibold"}," MICROBIOLOGY MoH LABORATORY REPORT ")],-1)),m(f)]),t("div",null,[t("h3",Ee,[o[3]||(o[3]=F("Data for the year: ")),t("span",qe,s(r(a).name=="select year"?"-:-":r(a).name),1)])]),t("div",Fe,[r(u)?(C(),R("div",Be,[t("div",Se,[m(k,{width:100,height:100})])])):V("",!0),t("table",Ie,[o[4]||(o[4]=t("thead",{class:"border-b"},[t("tr",{class:"w-full bg-gray-50"},[t("th",{class:"px-4 py-2 uppercase border-r"},"Laboratory Service"),t("th",{class:"px-4 py-2 uppercase border-r"},"Jan"),t("th",{class:"px-4 py-2 uppercase border-r"},"Feb"),t("th",{class:"px-4 py-2 uppercase"},"March"),t("th",{class:"px-4 py-2 uppercase bg-sky-50 text-sky-500 border border-sky-100"},"Total Q1"),t("th",{class:"px-4 py-2 uppercase border-r"},"Apr"),t("th",{class:"px-4 py-2 uppercase border-r"},"May"),t("th",{class:"px-4 py-2 uppercase"},"Jun"),t("th",{class:"px-4 py-2 uppercase bg-sky-50 text-sky-500 border border-sky-100"},"Total Q2"),t("th",{class:"px-4 py-2 uppercase border-r"},"Jul"),t("th",{class:"px-4 py-2 uppercase border-r"},"Aug"),t("th",{class:"px-4 py-2 uppercase"},"Sep"),t("th",{class:"px-4 py-2 uppercase bg-sky-50 text-sky-500 border border-sky-100"},"Total Q3"),t("th",{class:"px-4 py-2 uppercase border-r"},"Oct"),t("th",{class:"px-4 py-2 uppercase border-r"},"Nov"),t("th",{class:"px-4 py-2 uppercase"},"Dec"),t("th",{class:"px-4 py-2 uppercase bg-sky-50 text-sky-500 border-t border-l border-b border-sky-100"}," Total Q4 "),t("th",{class:"px-4 py-2 uppercase bg-green-600 text-white border border-green-400"},"Total")])],-1)),t("tbody",null,[(C(!0),R(me,null,ye(r(b),(e,g)=>(C(),R("tr",{class:"px-2",key:g},[t("td",Le,s(e.indicator),1),t("td",{class:"px-4 py-2 text-center border-r border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:d=>l(e.indicator,`01-01-${r(a).name}`,Number(e.jan.count),e.jan.associated_ids)},s(e.jan.count),9,Pe),t("td",{class:"px-4 py-2 text-center border-r border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:d=>l(e.indicator,`02-01-${r(a).name}`,Number(e.feb.count),e.feb.associated_ids)},s(e.feb.count),9,Ve),t("td",{class:"px-4 py-2 text-center border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:d=>l(e.indicator,`03-01-${r(a).name}`,Number(e.mar.count),e.mar.associated_ids)},s(e.mar.count),9,Ge),t("td",He,s(e.totalQ1),1),t("td",{class:"px-4 py-2 text-center border-r border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:d=>l(e.indicator,`04-01-${r(a).name}`,Number(e.apr.count),e.apr.associated_ids)},s(e.apr.count),9,Je),t("td",{class:"px-4 py-2 text-center border-r border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:d=>l(e.indicator,`05-01-${r(a).name}`,Number(e.may.count),e.may.associated_ids)},s(e.may.count),9,Ue),t("td",{class:"px-4 py-2 text-center border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:d=>l(e.indicator,`06-01-${r(a).name}`,Number(e.june.count),e.june.associated_ids)},s(e.june.count),9,ze),t("td",Ke,s(e.totalQ2),1),t("td",{class:"px-4 py-2 text-center border-r border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:d=>l(e.indicator,`07-01-${r(a).name}`,Number(e.jul.count),e.jul.associated_ids)},s(e.jul.count),9,We),t("td",{class:"px-4 py-2 text-center border-r border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:d=>l(e.indicator,`08-08-${r(a).name}`,Number(e.aug.count),e.aug.associated_ids)},s(e.aug.count),9,Xe),t("td",{class:"px-4 py-2 text-center border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:d=>l(e.indicator,`09-9-${r(a).name}`,Number(e.sept.count),e.sept.associated_ids)},s(e.sept.count),9,Ze),t("td",et,s(e.totalQ3),1),t("td",{class:"px-4 py-2 text-center border-r border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:d=>l(e.indicator,`10-10-${r(a).name}`,Number(e.oct.count),e.oct.associated_ids)},s(e.oct.count),9,tt),t("td",{class:"px-4 py-2 text-center border-r border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:d=>l(e.indicator,`11-11-${r(a).name}`,Number(e.nov.count),e.nov.associated_ids)},s(e.nov.count),9,ot),t("td",{class:"px-4 py-2 text-center border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:d=>l(e.indicator,`12-12-${r(a).name}`,Number(e.dec.count),e.dec.associated_ids)},s(e.dec.count),9,rt),t("td",at,s(e.totalQ4),1),t("td",st,s(e.total),1)]))),128))])]),r(b).length==0&&!r(u)?(C(),R("div",nt,o[5]||(o[5]=[t("img",{src:fe,alt:"page-icon",class:"object-cover w-20 h-20"},null,-1),t("p",{class:"text-base"},"Could not load data, please try again",-1)]))):V("",!0)])])])}}});export{Nt as default};
