import{_ as g}from"./Breadcrumb.vue.b73741aa.js";import{_ as v}from"./SearchBar.da1959bc.js";import{u as x,a as y,_ as k,f as m,o as b,c as D,b as o,d as r,h as R,g as w,e as V}from"./entry.0879c7d5.js";import{_ as P}from"./Datatable.0963b085.js";import{u as C}from"./vue.f36acd1f.aa0d3b05.js";import{d as I,e as F}from"./constants.1331d04e.js";import{h as l,e as B,f as M}from"./fetch.dce1d52e.js";import{P as U}from"./package.56414df9.js";import{r as Y}from"./MagnifyingGlassIcon.dbd7a965.js";import{r as S}from"./FunnelIcon.e7fe6273.js";import{r as O}from"./PencilSquareIcon.9968ff52.js";import"./nuxt-link.496c02dd.js";import"./HomeIcon.b7f124e7.js";import"./XMarkIcon.98c7f7ed.js";import"./Loader.7369c2e5.js";import"./transition.174a4272.js";import"./hidden.4eb37939.js";import"./PrinterIcon.8a7d7efd.js";const $={setup(){C({title:`${U.name.toUpperCase()} - Patient Report`})},components:{MagnifyingGlassIcon:Y,FunnelIcon:S},data(){return{headers:[{text:"patient id",value:"client_id",sortable:!0},{text:"name",value:"name",sortable:!0},{text:"sex",value:"sex",sortable:!0},{text:"date of birth",value:"date_of_birth",sortable:!0},{text:"actions",value:"actions"}],patients:new Array,pages:[{name:"Home",link:"/home"},{name:"Reports",link:"#"}],search:"",loading:!1,viewIcon:O,cookie:x("token"),selectedDateRange:["",""],serverItemsLength:0,serverOptions:{page:1,rowsPerPage:25,sortBy:"name"},searchField:"name",searchValue:""}},created(){this.init()},computed:{filteredPatients(){return this.patients.map(e=>({...e,name:`${e.first_name} ${e.middle_name?e.middle_name:""} ${e.last_name}`.split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" "),date_of_birth:l(e.date_of_birth).format(I)}))}},methods:{updateSearch(e){this.searchValue=e,this.search=e,this.updatePatients(!0)},updatePatients(e){typeof e=="object"&&(this.serverOptions=e),this.init()},async init(){this.loading=!0;const{page:e,rowsPerPage:a}=this.serverOptions;let d=this.selectedDateRange!==null&&this.selectedDateRange[0].toString()!=""?l(this.selectedDateRange[0].toString()).format("YYYY-MM-DD"):"",p=this.selectedDateRange!==null&&this.selectedDateRange[1].toString()!=""?l(this.selectedDateRange[1].toString()).format("YYYY-MM-DD"):"";const t={route:`${B.clients}?page=${e}&per_page=${a}&search=${this.search}&from=${d}&to=${p}`,method:"GET",token:`${this.cookie}`};let{data:s,error:n,pending:i}=await M(t);this.loading=i,s.value&&(this.patients=s.value.clients,this.serverItemsLength=s.value.meta.total_count),n.value&&(console.error(n.value.data),y().$toast.error(`${F}`))},dateClicked(){this.init()},async viewReport(e){this.$router.push(`/reports/daily/patient-report/${e.client_id}`)}}},j={class:"px-5 py-5"},L=r("div",{class:"flex items-center justify-between py-5"},[r("h3",{class:"text-2xl font-semibold uppercase"},"Patient reports")],-1),A={class:"w-full flex items-center justify-between"},N={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},q={class:"w-72 ml-2"},E={class:"flex justify-end px-2 py-2 mb-2"},G={class:"py-2 flex items-center space-x-2"};function H(e,a,d,p,t,s){const n=g,i=m("FunnelIcon"),h=m("datepicker"),u=v,_=V,f=P;return b(),D("div",j,[o(n,{pages:t.pages},null,8,["pages"]),L,r("div",A,[r("div",N,[o(i,{class:"w-5 h-5 mr-2"}),R(" Filter By Date Range "),r("div",q,[o(h,{required:"",position:"left",placeholder:"select start & end date",range:!0,"input-class-name":"datepicker",format:"dd/MM/yyyy",modelValue:t.selectedDateRange,"onUpdate:modelValue":[a[0]||(a[0]=c=>t.selectedDateRange=c),s.dateClicked]},null,8,["modelValue","onUpdate:modelValue"])])]),r("div",E,[o(u,{search:t.search,onUpdate:s.updateSearch},null,8,["search","onUpdate"])])]),o(f,{headers:t.headers,data:s.filteredPatients,loading:t.loading,searchField:t.searchField,searchValue:t.searchValue,serverItemsLength:t.serverItemsLength,serverOptions:t.serverOptions,onUpdate:s.updatePatients},{actions:w(({item:c})=>[r("div",G,[o(_,{click:()=>s.viewReport(c),color:"primary",text:"View Report",icon:t.viewIcon},null,8,["click","icon"])])]),_:1},8,["headers","data","loading","searchField","searchValue","serverItemsLength","serverOptions","onUpdate"])])}const de=k($,[["render",H]]);export{de as default};
