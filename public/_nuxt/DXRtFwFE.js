import{_ as ke}from"./ClfMiJjE.js";import{b as k,e as q,g as e,d as pe,r as n,a as se,u as te,y as S,f as a,h as t,z as u,Y as oe,p as Y,G as ne,V as ie,j as X,q as re,H as L,i as Z,I as ae,J as $e,S as de,s as ge,l as O,m as G,_ as ce,C as Ce,A as Ve,B as xe,x as ye,v as le,t as R,F as ue,k as me,n as be,D as Ue,K as H,c as De,w as _e,o as Se,L as W}from"./CixClB4B.js";import{_ as he}from"./DO6rL3gL.js";import{_ as ve}from"./cY2JJaup.js";import{r as we}from"./Cunjaw2h.js";import{_ as Ae}from"./gABIlpKP.js";import{r as Ie}from"./sJwSpI0-.js";import{r as Pe}from"./h-nck--E.js";import{_ as Te}from"./C53nXZ5b.js";import{u as ee}from"./DWMfh5Rr.js";import{P as Le}from"./BlxtFnsa.js";import{u as qe}from"./CxhUJg9t.js";import"./Byfr2sQ2.js";import"./DrXEl-8J.js";import"./BtKeQrYB.js";import"./CTps4lyc.js";function Fe(V,l){return k(),q("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z","clip-rule":"evenodd"})])}const fe="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6%2036C6%2031.0347%2017.9925%2028%2024%2028C30.0075%2028%2042%2031.0347%2042%2036V42H6V36Z'%20fill='%23333333'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M24%2024C28.4183%2024%2032%2020.4183%2032%2016C32%2011.5817%2028.4183%208%2024%208C19.5817%208%2016%2011.5817%2016%2016C16%2020.4183%2019.5817%2024%2024%2024ZM24%2026C29.5228%2026%2034%2021.5228%2034%2016C34%2010.4772%2029.5228%206%2024%206C18.4772%206%2014%2010.4772%2014%2016C14%2021.5228%2018.4772%2026%2024%2026Z'%20fill='%23333333'/%3e%3c/svg%3e",Me={class:"fixed inset-0 overflow-y-auto"},Ee={class:"flex min-h-full items-center justify-center p-4 text-center"},je={class:"border-b px-3 py-3 flex items-center justify-between"},Be={class:"mt-2 space-y-3 px-5"},Re={class:"grid grid-cols-2 gap-4"},Ne={class:"grid grid-cols-2 gap-4"},ze={class:"grid grid-cols-2 gap-4"},Ze={class:"w-full flex items-center"},Oe={class:"flex items-center"},Ge={class:"flex items-center ml-2"},Ke={class:"mt-10 justify-end flex items-center space-x-3 px-3 py-2 border-t"},He=pe({__name:"index",setup(V){const l=n(!1),p=ge,$=we,i=n([]),y=n([]),v=n([]),U=se("token"),F=n([]),P=n([]),A=n([]),g=n([]),B=n([]),b=n([]),f=n(""),o=n(""),h=n(""),C=n(""),I=n(""),E=n(""),M=n(!1),{$metadata:c}=te(),N=async()=>{M.value=!0;const w=i.value?i.value.map(x=>{var T;return(T=v.value.find(Q=>x===Q.name))==null?void 0:T.id}).filter(x=>x!==void 0):[],s=A.value?A.value.map(x=>{var T;return(T=P.value.find(Q=>x===Q.name))==null?void 0:T.id}).filter(x=>x!==void 0):[],j=b.value?b.value.map(x=>{var T;return(T=g.value.find(Q=>x===Q.name))==null?void 0:T.id}).filter(x=>x!==void 0).map(Number):[],D={route:O.users,method:"POST",token:`${U.value}`,body:{person:{first_name:f.value,middle_name:o.value,last_name:h.value,sex:I.value},user:{username:C.value,password:E.value},roles:s,departments:w,lab_locations:j}},{data:m,error:_,pending:d}=await G(D);M.value=d;const{$toast:r}=te();m.value&&(K(),r.success("User created successfully!"),M.value=!1),_.value&&(K(),r.error(_.value),M.value=!1,console.error(_.value))},J=()=>{P.value=c.roles,F.value=P.value.map(w=>w.name),g.value=c.locations,B.value=g.value.map(w=>w.name),v.value=c.departments,y.value=v.value.map(w=>w.name)},z=async()=>{J(),K()},K=()=>{l.value=!l.value};return(w,s)=>{const j=ce,D=S("FormKit"),m=he,_=ve;return k(),q("div",null,[e("div",null,[a(j,{text:"Add user",color:"primary",icon:t(p),click:()=>{z()}},null,8,["icon","click"])]),a(t(de),{appear:"",show:t(l),as:"template"},{default:u(()=>[a(t(oe),{as:"div",onClose:K,class:"relative z-10"},{default:u(()=>[a(t(Y),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>s[10]||(s[10]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",Me,[e("div",Ee,[a(t(Y),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[a(t(ne),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[e("div",je,[a(t(ie),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:u(()=>s[11]||(s[11]=[e("img",{src:fe,alt:"user-icon",class:"w-8 h-8 mr-2"},null,-1),X(" Add user ")])),_:1}),e("button",{onClick:K},[a(t(re),{class:"w-5 h-5"})])]),a(D,{type:"form",id:"submitForm","submit-label":"Update",onSubmit:N,actions:!1},{default:u(()=>[e("div",Be,[e("div",Re,[a(D,{type:"text",label:"Username",validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"Username must contain only letters, no spaces or special characters"},modelValue:t(C),"onUpdate:modelValue":s[0]||(s[0]=d=>L(C)?C.value=d:null)},null,8,["modelValue"]),a(D,{type:"text",label:"First name",modelValue:t(f),"onUpdate:modelValue":s[1]||(s[1]=d=>L(f)?f.value=d:null),validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"First name must contain only letters, no spaces or special characters"}},null,8,["modelValue"])]),e("div",Ne,[a(D,{type:"text",label:"Middle name",modelValue:t(o),"onUpdate:modelValue":s[2]||(s[2]=d=>L(o)?o.value=d:null)},null,8,["modelValue"]),a(D,{type:"text",label:"Last name",modelValue:t(h),"onUpdate:modelValue":s[3]||(s[3]=d=>L(h)?h.value=d:null),validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"Last name must contain only letters, no spaces or special characters"}},null,8,["modelValue"])]),a(D,{type:"group"},{default:u(()=>[e("div",ze,[a(D,{type:"password",label:"Password",name:"password",validation:"required",modelValue:t(E),"onUpdate:modelValue":s[4]||(s[4]=d=>L(E)?E.value=d:null),"validation-visibility":"live"},null,8,["modelValue"]),a(D,{type:"password",label:"Confirm password",name:"password_confirm",validation:"required|confirm","validation-label":"Password confirmation","validation-visibility":"live"})])]),_:1}),e("div",Ze,[s[14]||(s[14]=e("label",{class:"mr-5 font-medium text-lg"},"Sex",-1)),e("label",Oe,[Z(e("input",{required:"","onUpdate:modelValue":s[5]||(s[5]=d=>L(I)?I.value=d:null),type:"radio",value:"M",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[ae,t(I)]]),s[12]||(s[12]=e("span",{class:"ml-2"},"Male",-1))]),e("label",Ge,[Z(e("input",{required:"","onUpdate:modelValue":s[6]||(s[6]=d=>L(I)?I.value=d:null),type:"radio",value:"F",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[ae,t(I)]]),s[13]||(s[13]=e("span",{class:"ml-2"},"Female",-1))])]),a(m,{label:"Select Role(s)","items-selected":t(A),"onUpdate:itemsSelected":s[7]||(s[7]=d=>L(A)?A.value=d:null),items:t(F),mode:"tags"},null,8,["items-selected","items"]),a(m,{label:"Select Laboratory Location(s)","items-selected":t(b),"onUpdate:itemsSelected":s[8]||(s[8]=d=>L(b)?b.value=d:null),items:t(B),mode:"tags"},null,8,["items-selected","items"]),a(m,{label:"Select Lab Section(s)","items-selected":t(i),"onUpdate:itemsSelected":s[9]||(s[9]=d=>L(i)?i.value=d:null),items:t(y),mode:"tags"},null,8,["items-selected","items"])]),e("div",Ke,[a(_,{type:"button",click:()=>{t($e)("submitForm")},text:"Clear form"},null,8,["click"]),a(j,{loading:t(M),type:"submit",click:()=>{},color:"success",icon:t($),text:"Save Changes"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),Xe={components:{TransitionRoot:de,TransitionChild:Y,Dialog:oe,DialogPanel:ne,DialogTitle:ie,XMarkIcon:re,UserIcon:Ie},props:{data:{required:!0,type:Object}},data(){return{moment:Ce,open:!1,addIcon:ge,viewIcon:Ve,editIcon:xe,clearIcon:Pe,details:{id:"",username:"",first_name:"",last_name:"",middle_name:"",sex:"",date_of_birth:"",lab_locations:new Array,roles:new Array,departments:new Array},loading:!1,cookie:se("token")}},methods:{async init(){this.loading=!0;const V={route:`${O.users}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:l,error:p,pending:$}=await G(V);this.loading=$,l.value&&(this.details=l.value,this.loading=!1,this.handleDialog()),p.value&&(console.error(p.value),this.loading=!1)},handleDialog(){this.open=!this.open}}},Ye={class:"fixed inset-0 overflow-y-auto"},Je={class:"flex min-h-full items-center justify-center p-4 text-center"},Qe={class:"border-b px-3 py-3 flex items-center justify-between"},We={class:"flex items-center justify-center mx-auto my-20"},et={class:"space-y-3 px-5 py-5"},tt={class:"w-full flex flex-col space-y-1"},st={class:"text-base text-gray-600"},at={class:"w-full flex flex-col space-y-1"},lt={class:"text-base text-gray-600"},ot={class:"w-full flex flex-col space-y-1"},nt={class:"text-base text-gray-600"},it={class:"w-full flex flex-col space-y-1"},rt={class:"w-full flex flex-col space-y-1"},dt={class:"w-full flex flex-col space-y-1"};function ct(V,l,p,$,i,y){const v=ce,U=S("TransitionChild"),F=S("DialogTitle"),P=S("XMarkIcon"),A=be,g=S("DialogPanel"),B=S("Dialog"),b=S("TransitionRoot");return k(),q("div",null,[e("div",null,[a(v,{text:"View",color:"primary",icon:i.viewIcon,click:y.init},null,8,["icon","click"])]),a(b,{appear:"",show:i.open,as:"template"},{default:u(()=>[a(B,{as:"div",onClose:y.handleDialog,class:"relative z-10"},{default:u(()=>[a(U,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>l[1]||(l[1]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",Ye,[e("div",Je,[a(U,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[a(g,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[e("div",Qe,[a(F,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:u(()=>l[2]||(l[2]=[e("img",{src:fe,class:"w-6 h-6 mr-2"},null,-1),X(" View User Account ")])),_:1}),e("button",{onClick:l[0]||(l[0]=(...f)=>y.handleDialog&&y.handleDialog(...f))},[a(P,{class:"w-5 h-5"})])]),Z(e("div",We,[a(A,{loading:i.loading},null,8,["loading"])],512),[[le,i.loading]]),Z(e("div",et,[e("div",tt,[l[3]||(l[3]=e("label",{class:"font-semibold text-lg"},"Username",-1)),e("p",st,R(i.details.username),1)]),e("div",at,[l[4]||(l[4]=e("label",{class:"font-semibold text-lg"},"First name",-1)),e("p",lt,R(i.details.first_name),1)]),e("div",ot,[l[5]||(l[5]=e("label",{class:"font-semibold text-lg"},"Last name",-1)),e("p",nt,R(i.details.last_name),1)]),e("div",it,[l[6]||(l[6]=e("label",{class:"font-semibold text-lg"},"Roles",-1)),(k(!0),q(ue,null,me(i.details.roles,(f,o)=>(k(),q("p",{class:"text-base text-gray-600",key:o},R(f.role_name),1))),128))]),e("div",rt,[l[7]||(l[7]=e("label",{class:"font-semibold text-lg"},"Locations",-1)),(k(!0),q(ue,null,me(i.details.lab_locations,(f,o)=>(k(),q("p",{class:"text-base text-gray-600",key:o},R(f.name),1))),128))]),e("div",dt,[l[8]||(l[8]=e("label",{class:"font-semibold text-lg"},"Departments",-1)),(k(!0),q(ue,null,me(i.details.departments,(f,o)=>(k(),q("p",{class:"text-base text-gray-600",key:o},R(f.name),1))),128))])],512),[[le,!i.loading]])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const ut=ye(Xe,[["render",ct]]),mt={class:"mx-auto flex justify-center py-20 bg-white"},pt={class:"fixed inset-0 overflow-y-auto"},vt={class:"flex min-h-full items-center justify-center p-4 text-center"},ft={class:"border-b px-3 py-3 flex items-center justify-between"},_t={class:"mt-2 space-y-3 px-5 py-5"},gt={class:"grid grid-cols-2 gap-4"},xt={class:"grid grid-cols-2 gap-4"},yt={class:"grid grid-cols-2 gap-4"},bt={class:"w-full flex flex-col space-y-2"},ht={class:"w-full flex flex-col space-y-2"},wt={class:"flex items-center"},kt={class:"flex items-center"},$t={class:"flex items-center ml-2"},Ct={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},Vt=pe({__name:"index",props:{data:{}},emits:["update"],setup(V,{emit:l}){const p=V,$=n(!1),i=xe,y=we,v=n([]),U=n([]),F=n([]),P=n([]),A=n([]),g=n([]),B=se("token"),b=n([]),f=n([]),o=n([]),h=n(!1),C=n(!1),I=l,{$toast:E,$metadata:M}=te(),c=n({id:"",username:"",first_name:"",last_name:"",middle_name:"",old_password:"",new_password:"",sex:"",date_of_birth:"",roles:[],lab_locations:[],departments:[]}),N=()=>{$.value=!$.value},J=()=>{f.value=M.roles,b.value=f.value.map(w=>w.name),P.value=M.locations,A.value=P.value.map(w=>w.name),F.value=M.departments,U.value=F.value.map(w=>w.name)},z=async()=>{J(),N(),C.value=!0;const w={route:`${O.users}/${p.data.id}`,method:"GET",token:`${B.value}`},{data:s,error:j,pending:D}=await G(w);C.value=D,s.value&&(c.value=s.value,C.value=!1,o.value=s.value.roles.map(({role_name:m})=>{var _;return(_=f.value.find(d=>m===d.name))==null?void 0:_.name}).filter(m=>m!==void 0),v.value=s.value.departments.map(({name:m})=>{var _;return(_=F.value.find(d=>m===d.name))==null?void 0:_.name}).filter(m=>m!==void 0),g.value=s.value.lab_locations.map(({name:m})=>{var _;return(_=P.value.find(d=>m===d.name))==null?void 0:_.name}).filter(m=>m!==void 0)),j.value&&(console.error(j.value),C.value=!1)},K=async()=>{h.value=!0;const w=v.value?v.value.map(r=>{var x;return(x=F.value.find(T=>r===T.name))==null?void 0:x.id}).filter(r=>r!==void 0).map(Number):[],s=o.value?o.value.map(r=>{var x;return(x=f.value.find(T=>r===T.name))==null?void 0:x.id}).filter(r=>r!==void 0):[],j=g.value?g.value.map(r=>{var x;return(x=P.value.find(T=>r===T.name))==null?void 0:x.id}).filter(r=>r!==void 0).map(Number):[],D={route:`${O.users}/${p.data.id}`,method:"PUT",token:`${B.value}`,body:{person:{first_name:c.value.first_name,middle_name:c.value.middle_name,last_name:c.value.last_name,sex:c.value.sex,date_of_birth:c.value.date_of_birth},user:{username:c.value.username,old_password:c.value.old_password,password:c.value.new_password},roles:s,departments:w,lab_locations:j}},{data:m,error:_,pending:d}=await G(D);h.value=d,m.value&&(N(),E.success("User updated successfully!"),h.value=!1,I("update",!0)),_.value&&(console.error(_.value),N(),E.error(errorMessage),h.value=!1)};return(w,s)=>{const j=ce,D=be,m=S("FormKit"),_=he,d=ve;return k(),q("div",null,[e("div",null,[a(j,{text:"Edit",color:"primary",icon:t(i),click:z},null,8,["icon"])]),a(t(de),{appear:"",show:t($),as:"template"},{default:u(()=>[a(t(oe),{as:"div",onClose:N,class:"relative z-10"},{default:u(()=>[a(t(Y),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>s[10]||(s[10]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),Z(e("div",mt,[a(D)],512),[[le,t(C)]]),Z(e("div",pt,[e("div",vt,[a(t(Y),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[a(t(ne),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[e("div",ft,[a(t(ie),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:u(()=>s[11]||(s[11]=[e("img",{src:fe,class:"w-8 h-8 mr-2",alt:"person-icon"},null,-1),X(" Edit user ")])),_:1}),e("button",{onClick:N},[a(t(re),{class:"w-5 h-5"})])]),a(m,{type:"form","submit-label":"Update",onSubmit:K,actions:!1},{default:u(()=>[e("div",_t,[e("div",gt,[a(m,{type:"text",label:"Username",modelValue:t(c).username,"onUpdate:modelValue":s[0]||(s[0]=r=>t(c).username=r),validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"Username must contain only letters and spaces"}},null,8,["modelValue"]),a(m,{type:"text",label:"First name",modelValue:t(c).first_name,"onUpdate:modelValue":s[1]||(s[1]=r=>t(c).first_name=r),validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"First name must contain only letters and spaces"}},null,8,["modelValue"])]),e("div",xt,[a(m,{type:"text",label:"Middle name",modelValue:t(c).middle_name,"onUpdate:modelValue":s[2]||(s[2]=r=>t(c).middle_name=r)},null,8,["modelValue"]),a(m,{type:"text",label:"Last name",modelValue:t(c).last_name,"onUpdate:modelValue":s[3]||(s[3]=r=>t(c).last_name=r),validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"Last name must contain only letters and spaces"}},null,8,["modelValue"])]),a(m,{type:"group"},{default:u(()=>[e("div",yt,[e("div",bt,[a(m,{type:"password",label:"New password",name:"password",modelValue:t(c).new_password,"onUpdate:modelValue":s[4]||(s[4]=r=>t(c).new_password=r),"validation-visibility":"live"},null,8,["modelValue"])]),e("div",ht,[a(m,{type:"password",label:"Confirm new password",name:"password_confirm",validation:t(c).new_password&&"required|confirm","validation-label":"Password confirmation","validation-visibility":"live"},null,8,["validation"])])])]),_:1}),e("div",wt,[s[14]||(s[14]=e("label",{class:"mr-5 font-medium text-lg"},"Sex",-1)),e("label",kt,[Z(e("input",{required:"","onUpdate:modelValue":s[5]||(s[5]=r=>t(c).sex=r),type:"radio",value:"M",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[ae,t(c).sex]]),s[12]||(s[12]=e("span",{class:"ml-2"},"Male",-1))]),e("label",$t,[Z(e("input",{required:"","onUpdate:modelValue":s[6]||(s[6]=r=>t(c).sex=r),type:"radio",value:"F",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[ae,t(c).sex]]),s[13]||(s[13]=e("span",{class:"ml-2"},"Female",-1))])]),a(_,{label:"Select Role(s)","items-selected":t(o),"onUpdate:itemsSelected":s[7]||(s[7]=r=>L(o)?o.value=r:null),items:t(b),mode:"tags"},null,8,["items-selected","items"]),a(_,{label:"Select Laboratory Location(s)","items-selected":t(g),"onUpdate:itemsSelected":s[8]||(s[8]=r=>L(g)?g.value=r:null),items:t(A),mode:"tags"},null,8,["items-selected","items"]),a(_,{label:"Select Lab Section(s)","items-selected":t(v),"onUpdate:itemsSelected":s[9]||(s[9]=r=>L(v)?v.value=r:null),items:t(U),mode:"tags"},null,8,["items-selected","items"])]),e("div",Ct,[a(d,{type:"button",click:()=>{},text:"Clear form"}),a(j,{loading:t(h),type:"submit",click:()=>{},color:"success",icon:t(y),text:"Save Changes"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])],512),[[le,!t(C)]])]),_:1})]),_:1},8,["show"])])}}}),Ut={components:{TransitionRoot:de,TransitionChild:Y,Dialog:oe,DialogPanel:ne,DialogTitle:ie,XMarkIcon:re,ExclamationTriangleIcon:Ue},data(){return{show:!1,disableIcon:Fe,loading:!1,reason:"",cookie:se("token"),details:{id:"",username:"",first_name:"",last_name:"",middle_name:"",sex:"",date_of_birth:"",lab_locations:new Array,roles:new Array,departments:new Array}}},props:{data:{type:Object,required:!0}},methods:{async init(){this.loading=!0;const V={route:`${O.users}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:l,error:p,pending:$}=await G(V);this.loading=$,l.value&&(this.details=l.value,this.loading=!1,this.handleDialog()),p.value&&(console.error(p.value),this.loading=!1)},async deleteData(V){this.loading=!0;const l={route:`${O.users}/${V}`,method:"DELETE",token:`${this.cookie}`},{pending:p,error:$,data:i}=await G(l);this.loading=p,i.value&&(this.handleDialog(),te().$toast.success(`${i.value.message}`),this.loading=!1,this.$emit("update",!0),this.reason=""),$.value&&(console.log(i.value),this.loading=!1)},async activate(V){this.loading=!0;const l={route:`${O.users}/activate/${V}`,method:"PUT",token:`${this.cookie}`,body:{retired_reason:this.reason}},{pending:p,error:$,data:i}=await G(l);this.loading=p,i.value&&(this.handleDialog(),te().$toast.success(`${i.value.message}`),this.loading=!1,this.$emit("update",!0),this.reason=""),$.value&&(console.log(i.value),this.loading=!1)},handleDialog(){this.show=!this.show}}},Dt={key:0},St={key:1},At={class:"fixed inset-0 overflow-y-auto"},It={class:"flex min-h-full items-center justify-center p-4 text-center"},Pt={class:"border-b px-3 py-3 flex items-center justify-between"},Tt={class:"mt-2 space-y-3 px-5"},Lt={class:"rounded px-2 py-2"},qt={class:"font-semibold text-red-500"},Ft={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Mt(V,l,p,$,i,y){const v=ce,U=S("TransitionChild"),F=S("ExclamationTriangleIcon"),P=S("DialogTitle"),A=S("XMarkIcon"),g=S("FormKit"),B=ve,b=S("DialogPanel"),f=S("Dialog"),o=S("TransitionRoot");return k(),q("div",null,[e("div",null,[p.data.is_active?(k(),q("div",Dt,[a(v,{click:y.init,color:"error",text:"Disable",icon:i.disableIcon},null,8,["click","icon"])])):H("",!0),p.data.is_active?H("",!0):(k(),q("div",St,[a(v,{click:y.init,color:"success",text:"Enable",icon:i.disableIcon},null,8,["click","icon"])]))]),a(o,{appear:"",show:i.show,as:"template"},{default:u(()=>[a(f,{as:"div",class:"relative z-10"},{default:u(()=>[a(U,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>l[3]||(l[3]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",At,[e("div",It,[a(U,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[a(b,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[e("div",Pt,[a(P,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:u(()=>[a(F,{class:"h-5 w-5 mr-2"}),X(" "+R(p.data.is_active?"Confirm disable":"Confirm activate"),1)]),_:1}),e("button",{onClick:l[0]||(l[0]=(...h)=>y.handleDialog&&y.handleDialog(...h))},[a(A,{class:"w-5 h-5"})])]),a(g,{type:"form","submit-label":"Update",onSubmit:l[2]||(l[2]=h=>p.data.is_active?y.deleteData(p.data.id):y.activate(p.data.id)),actions:!1},{default:u(({value:h})=>[e("div",Tt,[e("div",Lt,[X(" Do you want to "+R(p.data.is_active?"disable":"activate")+" ",1),e("span",qt,R(p.data.username),1),l[4]||(l[4]=X(" account? Note that once this action is completed, it can not be undone "))]),a(g,{type:"textarea",label:"Reason",validation:"required",modelValue:i.reason,"onUpdate:modelValue":l[1]||(l[1]=C=>i.reason=C)},null,8,["modelValue"])]),e("div",Ft,[a(B,{click:y.handleDialog,type:"button",text:"Cancel"},null,8,["click"]),a(v,{loading:i.loading,type:"submit",click:()=>{},color:"success",icon:i.disableIcon,text:"Continue"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const Et=ye(Ut,[["render",Mt]]),jt=()=>{const V=n([{text:"id",value:"id",sortable:!0},{text:"username",value:"username",sortable:!0},{text:"full name",value:"fullname",sortable:!0},{text:"sex",value:"sex",sortable:!0},{text:"actions",value:"actions"}]),l=n([{name:"Home",link:"/home"},{name:"Access Controls",link:"#"}]);return{HEADERS:V,PAGES:l}},Bt={class:"py-5 px-5"},Rt={class:"flex items-center justify-between py-5"},Nt={class:"text-2xl font-semibold"},zt={class:"flex justify-end w-full px-2 py-2 mb-2"},Zt={class:"py-2 flex items-center space-x-2"},is=pe({__name:"user-accounts",setup(V){qe({title:`${Le.name.toUpperCase()} - User Accounts`});const l=n("List of users"),p=jt(),$=p.HEADERS.value,i=n([]),y=se("token"),v=n(!1),U=n(""),F=n(""),P=p.PAGES.value,A=n(0),g=n({page:1,rowsPerPage:25,sortBy:"name"}),B=De(()=>i.value.map(o=>({id:o.id,is_active:o.is_active,username:o.username.charAt(0).toUpperCase()+o.username.slice(1),fullname:`${o.first_name} ${o.last_name}`,sex:o.sex})));async function b(){v.value=!0;const{page:o,rowsPerPage:h}=g.value,C={route:`${O.users}?page=${o}&per_page=${h}&search=${U.value}`,method:"GET",token:`${y.value}`},{data:I,error:E,pending:M}=await G(C);v.value=M,I.value&&(i.value=I.value.data,v.value=!1,A.value=I.value.meta.total_count),E.value&&(console.error(E.value),v.value=!1)}const f=o=>{typeof o=="object"&&(g.value=o)};return _e(U,()=>{b()}),_e(g,()=>{b()}),Se(()=>{b()}),(o,h)=>{const C=ke,I=He,E=Ae,M=ut,c=Vt,N=Et,J=Te;return k(),q("div",Bt,[a(C,{pages:t(P)},null,8,["pages"]),e("div",Rt,[e("h3",Nt,R(t(l)),1),("usePermissions"in o?o.usePermissions:t(ee))().can.manage("users")?(k(),W(I,{key:0,onUpdate:b})):H("",!0)]),e("div",zt,[a(E,{search:t(U),"onUpdate:search":h[0]||(h[0]=z=>L(U)?U.value=z:null)},null,8,["search"])]),("usePermissions"in o?o.usePermissions:t(ee))().can.manage("users")?(k(),W(J,{key:0,headers:t($),data:t(B),loading:t(v),searchField:"username",searchValue:t(F),serverItemsLength:t(A),serverOptions:t(g),onUpdate:f},{actions:u(({item:z})=>[e("div",Zt,[("usePermissions"in o?o.usePermissions:t(ee))().can.manage("users")?(k(),W(M,{key:0,data:z},null,8,["data"])):H("",!0),("usePermissions"in o?o.usePermissions:t(ee))().can.manage("users")?(k(),W(c,{key:1,data:z,onUpdate:b},null,8,["data"])):H("",!0),("usePermissions"in o?o.usePermissions:t(ee))().can.manage("users")?(k(),W(N,{key:2,data:z,onUpdate:b},null,8,["data"])):H("",!0)])]),_:1},8,["headers","data","loading","searchValue","serverItemsLength","serverOptions"])):H("",!0)])}}});export{is as default};
