import{_ as I}from"./Breadcrumb.vue.ad824e0f.js";import{u as D,a as q,b as u,_ as $,g,o as m,c as _,d as r,e,t as a,i as N,F as O,r as U,w as A,v as j,k as C,f as P}from"./entry.3e997e44.js";import{_ as R,a as B}from"./index.0d4cab81.js";import{d as v,e as b}from"./constants.be4260bc.js";import{S as f}from"./stock.ac6d2bee.js";import{h as y}from"./fetch.d43a083b.js";import{P as F}from"./package.2b319c9a.js";import{r as M}from"./TicketIcon.3282c326.js";import{r as T}from"./CheckIcon.9716edbc.js";import{r as Q}from"./DocumentCheckIcon.218b9f3c.js";import{r as H}from"./NoSymbolIcon.e624b2fd.js";import{r as K}from"./TrashIcon.054fc78a.js";import{_ as L}from"./pharmacy_alt.1c453109.js";import"./nuxt-link.4d6d5112.js";import"./HomeIcon.5803e93b.js";import"./OutlinedButton.318868b2.js";import"./XMarkIcon.737949c3.js";import"./transition.82a1c525.js";import"./hidden.eaac968f.js";import"./network.bc619a46.js";import"./PencilSquareIcon.b3862558.js";import"./PrinterIcon.b5dff05e.js";const E={setup(){D({title:`${F.name.toUpperCase()} - Approve Stock Order`})},components:{TicketIcon:M},data(){return{header:"Approve Stock Order",checkIcon:T,allIcon:Q,rejectIcon:H,pages:[{name:"Home",link:"/home"},{name:"Stock Orders",link:"/stock-management/orders"}],cookie:q("token"),deleteicon:K,loading:!1,approving:!1,verifying:!1,requisitions:new Array,voidReason:"",issuerName:"",issuerDesignation:"",issuerPhone:"",issuerSignature:"",approverName:"",approverDesignation:"",approverPhone:"",approverSignature:"",issuedDate:"",approvedDate:""}},created(){this.init()},methods:{async init(){this.loading=!0;const t=new f,{data:n,error:d,pending:i}=await t.getStockOrder(`${this.cookie}`,`${this.$route.query.order_id}`);this.loading=i,n.value&&(this.requisitions=n.value.stock_requisitions,this.loading=!1,n.value.stock_pharmacy_approver_and_issuers.map(o=>{o.record_type=="issuer"?(this.issuerName=o.name,this.issuerPhone=o.phone_number,this.issuerDesignation=o.designation,this.issuerSignature=o.signature,this.issuedDate=y(o.created_date).format(v)):(this.approverName=o.name,this.approverPhone=o.phone_number,this.approverDesignation=o.designation,this.approverSignature=o.signature,this.approvedDate=y(o.created_date).format(v))})),d.value&&(console.error(d.value),this.loading=!1)},async approveStockOrder(){this.approving=!0;const t=new f;let n=this.requisitions.map(l=>l.id);const{data:d,error:i,pending:o}=await t.approveStockOrder(`${this.cookie}`,{stock_order_id:`${this.$route.query.order_id}`,stock_requisition_ids:n});this.approving=o,d.value&&(this.approving=!1,this.$router.push("/stock-management/orders"),u().$toast.success(`Stock order request #${this.$route.params.voucherId} approved successfully`)),i.value&&(console.error(i.value),u().$toast.error(b),this.approving=!1)},async approveRequisition(t){this.loading=!0;const n=new f,{data:d,error:i,pending:o}=await n.approveStockOrderRequisition(`${this.cookie}`,{stock_requisition_id:t});this.loading=o,d.value&&(this.loading=!1,u().$toast.success("Stock order requisition approved successfully")),i.value&&(console.error(i.value),u().$toast.error(b),this.loading=!1)}}},z={class:"px-5 py-5"},G={class:"py-5 flex items-center justify-between"},J={class:"text-2xl font-semibold"},W={class:"px-4 py-2 bg-gray-50 flex items-center justify-between"},X={class:"flex items-center space-x-2"},Y={class:"flex items-center space-x-3 justify-end"},Z={class:"rounded border mt-5"},ee=e("div",{class:"flex items-center space-x-3 bg-gray-50 py-2 rounded-t px-2 border-b"},[e("img",{src:L,class:"w-6 h-6"}),e("h3",{class:"text-lg font-semibold"},"Pharmacy")],-1),oe={class:"w-full grid grid-cols-2 gap-5 py-5 px-5"},se={class:"col-span-1 flex flex-col space-y-2"},te={class:"w-full flex items-center space-x-2"},re=e("p",{class:"w-72 font-medium"},"Issued by: ",-1),ae={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ne={class:"w-full flex items-center space-x-2"},ie=e("p",{class:"w-72 font-medium"},"Designation: ",-1),de={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ce={class:"w-full flex items-center space-x-2"},le=e("p",{class:"w-72 font-medium"},"Signature: ",-1),pe={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ue={class:"w-full flex items-center space-x-2"},me=e("p",{class:"w-72 font-medium"},"Date:",-1),_e={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},fe={class:"col-span-1 flex flex-col space-y-2"},he={class:"w-full flex items-center space-x-2"},ge=e("p",{class:"w-72 font-medium"},"Approved by: ",-1),ve={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},be={class:"w-full flex items-center space-x-2"},ye=e("p",{class:"w-72 font-medium"},"Designation: ",-1),xe={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ke={class:"w-full flex items-center space-x-2"},we=e("p",{class:"w-72 font-medium"},"Signature: ",-1),Se={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Ve={class:"w-full flex items-center space-x-2"},Ie=e("p",{class:"w-72 font-medium"},"Date:",-1),De={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},qe={key:0,class:"grid grid-cols-5 gap-4 mt-5"},$e={class:"flex flex-col space-y-2"},Ne={class:"flex items-center space-x-2 pt-8"};function Oe(t,n,d,i,o,l){const x=I,k=g("TicketIcon"),h=P,w=R,p=g("FormKit"),S=B;return m(),_("div",z,[r(x,{pages:o.pages},null,8,["pages"]),e("div",G,[e("h3",J,a(o.header),1)]),e("div",W,[e("div",X,[r(k,{class:"h-5 w-5"}),e("p",null,[N("Voucher Number: "),e("strong",null,a(t.$route.params.voucherId),1)])]),e("div",Y,[r(h,{loading:o.approving,icon:o.allIcon,text:"Approve Order",color:"success",click:l.approveStockOrder},null,8,["loading","icon","click"]),r(w,{stockId:`${t.$route.query.order_id}`,orderId:`${t.$route.params.voucherId}`},null,8,["stockId","orderId"])])]),e("div",Z,[ee,e("div",oe,[e("div",se,[e("div",te,[re,e("span",ae,a(o.issuerName),1)]),e("div",ne,[ie,e("span",de,a(o.issuerDesignation),1)]),e("div",ce,[le,e("span",pe,a(o.issuerSignature),1)]),e("div",ue,[me,e("span",_e,a(o.issuedDate),1)])]),e("div",fe,[e("div",he,[ge,e("span",ve,a(o.approverName),1)]),e("div",be,[ye,e("span",xe,a(o.approverDesignation),1)]),e("div",ke,[we,e("span",Se,a(o.issuerSignature),1)]),e("div",Ve,[Ie,e("span",De,a(o.approvedDate),1)])])])]),(m(!0),_(O,null,U(o.requisitions,(s,V)=>A((m(),_("div",{class:"flex flex-col space-y-3",key:V},[s.requisition_status.toLowerCase()!=="rejected"?(m(),_("div",qe,[e("div",$e,[r(p,{label:"Stock item",disabled:!0,modelValue:s.item.name,"onUpdate:modelValue":c=>s.item.name=c},null,8,["modelValue","onUpdate:modelValue"])]),r(p,{label:"Quantity requested",type:"number",disabled:!0,modelValue:s.quantity_requested,"onUpdate:modelValue":c=>s.quantity_requested=c},null,8,["modelValue","onUpdate:modelValue"]),r(p,{label:"Quantity issued",type:"number",disabled:!0,modelValue:s.quantity_issued,"onUpdate:modelValue":c=>s.quantity_issued=c},null,8,["modelValue","onUpdate:modelValue"]),r(p,{label:"Quantity collected",type:"number",disabled:!0,modelValue:s.quantity_collected,"onUpdate:modelValue":c=>s.quantity_collected=c},null,8,["modelValue","onUpdate:modelValue"]),e("div",Ne,[r(h,{text:"Approve",icon:o.checkIcon,color:"success",click:()=>{l.approveRequisition(s.id)}},null,8,["icon","click"]),r(S,{onUpdate:l.init,data:s,orderId:`${t.$route.params.voucherId}`},null,8,["onUpdate","data","orderId"])])])):C("",!0)])),[[j,!o.loading]])),128))])}const eo=$(E,[["render",Oe]]);export{eo as default};
