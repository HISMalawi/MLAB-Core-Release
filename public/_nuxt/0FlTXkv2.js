import{_ as _e}from"./BxxC6xAb.js";import{_ as fe}from"./Bzacd9Q4.js";import{d as V,C as S,x as q,b as n,e as l,g as e,F as k,k as M,t as r,h as s,az as N,K as T,j as w,a4 as Z,r as m,a as be,c as U,w as J,y as X,f,H as I,z as ye,L as Y,l as P,m as O,u as F,_ as he,n as ve,ay as xe}from"./CUNWPMFO.js";import{_ as Ee}from"./gfVcOhv3.js";import{_ as Te,a as $e}from"./CCZbx7P8.js";import{_ as ge}from"./dli2YLOw.js";import{_ as Ae}from"./CO_ZpYZU.js";import{u as Re}from"./X5WAEVcs.js";import{P as De}from"./BSY9E36G.js";import{u as Se}from"./C_AIsC7W.js";import{r as ke}from"./tZDXc706.js";import{r as Me}from"./B-Af-kVh.js";import"./CDJ4C1jN.js";import"./C5KkEBG1.js";import"./DGiBFwjt.js";import"./B1NysoR-.js";import"./BoMo2d9h.js";import"./Bnw_B-mo.js";import"./BfjsmCpQ.js";import"./DAgWbDoT.js";import"./B73RjFxO.js";const Ne=V({props:{data:{required:!0,type:Object}},data(){return{moment:S,headers:[{name:"SN"},{name:"Patient ID"},{name:"Patient Name"},{name:"Accession Number"},{name:"Specimen"},{name:"Receipt Date"},{name:"Tests"},{name:"Performed By"},{name:"Results"},{name:"Remarks"},{name:"Results Entry Date"},{name:"Authorized By"},{name:"Authorized Date"},{name:"Turn Around Time"}],reportData:this.data}}}),Ie={class:"w-full overflow-x-auto"},we={class:"w-full text-left overflow-y-auto"},Ce={class:"uppercase bg-gray-100"},Pe={class:"border-b"},Oe={class:"px-2 py-2 font-normal border-r"},Ve={class:"px-2 py-2 font-normal border-r"},Le={class:"px-2 py-2 font-normal border-r"},je={class:"px-2 py-2 font-normal border-r"},Be={class:"px-2 py-2 font-normal border-r"},Ue={class:"px-2 py-2 font-normal border-r"},Ye={class:"px-2 py-2 font-normal border-r"},Fe={class:"px-2 py-2 font-normal border-r"},qe={class:"px-2 py-2 font-normal border-r"},ze={key:0,class:"font-medium"},Ge={class:"px-2 py-2 font-normal border-r"},He={class:"px-2 py-2 font-normal border-r"},Ke={class:"px-2 py-2 font-normal border-r"},Je={class:"px-2 py-2 font-normal border-r"},Xe={class:"px-2 py-2 font-normal"};function Ze(a,p,R,y,$,h){return n(),l("div",Ie,[e("table",we,[e("thead",Ce,[e("tr",Pe,[(n(!0),l(k,null,M(a.headers,(o,u)=>(n(),l("th",{class:"uppercase py-2 px-2 border-r",key:u},r(o.name),1))),128))])]),e("tbody",null,[(n(!0),l(k,null,M(a.data.data,(o,u)=>(n(),l("tr",{class:"bg-white border-b",key:u},[e("th",Oe,r(u+1),1),e("th",Ve,r(o.patient_id),1),e("th",Le,r(o.patient_name),1),e("th",je,r(o.accession_number),1),e("th",Be,r(o.specimen),1),e("th",Ue,r(a.moment(o.created_date).format("DATE_TIME_FORMAT"in a?a.DATE_TIME_FORMAT:s(N))),1),e("th",Ye,r(o.test),1),e("th",Fe,r(o.performed_by),1),e("th",qe,[(n(!0),l(k,null,M(o.results,(b,g)=>(n(),l("p",{key:g},[b!=null&&b!==""?(n(),l("span",ze,r(`${g}:`),1)):T("",!0),w(" "+r(b),1)]))),128))]),e("th",Ge,r(o.remarks),1),e("th",He,r(o.result_date?a.moment(o.result_date).format("DATE_TIME_FORMAT"in a?a.DATE_TIME_FORMAT:s(N)):""),1),e("th",Ke,r(o.authorized_by),1),e("th",Je,r(o.authorized_date?a.moment(o.authorized_date).format("DATE_TIME_FORMAT"in a?a.DATE_TIME_FORMAT:s(N)):""),1),e("th",Xe,r(o.tat),1)]))),128))])])])}const Qe=q(Ne,[["render",Ze]]),We=V({props:{data:{required:!0,type:Object}},data(){var a;return{details:(a=this.data)==null?void 0:a.data}},methods:{removeDuplicates(a){return a.filter((R,y)=>a.findIndex($=>$.patient_no===R.patient_no)===y)}}}),et={class:"w-full text-left"},tt={class:"px-2 py-2 font-normal border-r border-b"},st={class:"px-2 py-2 font-normal border-r border-b"},ot={class:"px-2 py-2 font-normal border-r border-b"},rt={class:"px-2 py-2 font-normal border-r border-b"},at={class:"px-2 py-2 font-normal border-r border-b"},nt={class:"px-2 py-2 font-normal border-r border-b"},lt={class:"px-2 py-2 font-normal border-r border-b"},dt={class:"px-2 py-2 font-normal border-r border-b space-y-1"},ct={class:"w-full text-left"},pt={class:"px-2 py-2 font-normal border-r border-b"},it={class:"px-2 py-2 font-normal border-r border-b"},ut={class:"px-2 py-2 font-normal border-r border-b"};function mt(a,p,R,y,$,h){return n(),l("div",null,[e("div",null,[e("table",et,[p[0]||(p[0]=e("thead",{class:"uppercase bg-gray-100"},[e("tr",{class:"border-b"},[e("th",{class:"uppercase py-2 px-2 border-r"},"SN"),e("th",{class:"uppercase py-2 px-2 border-r"},"PATIENT NO"),e("th",{class:"uppercase py-2 px-2 border-r"},"PATIENT NAME"),e("th",{class:"uppercase py-2 px-2 border-r"},"AGE"),e("th",{class:"uppercase py-2 px-2 border-r"},"SEX"),e("th",{class:"uppercase py-2 px-2 border-r"},"ACCESSION NUMBER"),e("th",{class:"uppercase py-2 px-2 border-r"},"SPECIMEN TYPE"),e("th",{class:"uppercase py-2 px-2 border-r"},"TESTS")])],-1)),e("tbody",null,[(n(!0),l(k,null,M(a.details,(o,u)=>(n(),l("tr",{key:u},[e("th",tt,r(u+1),1),e("th",st,r(o.patient_no),1),e("th",ot,r(o.patient_name),1),e("th",rt,r(("calculateAge"in a?a.calculateAge:s(Z))(o.dob)),1),e("th",at,r(o.gender),1),e("th",nt,r(o.accession_number),1),e("th",lt,r(o.specimen),1),e("th",dt,[(n(!0),l(k,null,M(o.test_type,(b,g)=>(n(),l("p",{key:g},r(b),1))),128))])]))),128))])])]),p[2]||(p[2]=e("div",{class:"px-3 py-3 uppercase"},"SUMMARY",-1)),e("table",ct,[p[1]||(p[1]=e("thead",{class:"uppercase bg-gray-100"},[e("tr",{class:"border-b"},[e("th",{class:"uppercase py-2 px-2 border-r"},"TOTAL VISITS"),e("th",{class:"uppercase py-2 px-2 border-r"},"MALE"),e("th",{class:"uppercase py-2 px-2 border-r"},"FEMALE")])],-1)),e("tbody",null,[e("tr",null,[e("th",pt,r(a.data.visits.length),1),e("th",it,r(a.removeDuplicates(a.details).filter(o=>o.gender=="M").length),1),e("th",ut,r(a.removeDuplicates(a.details).filter(o=>o.gender=="F").length),1)])])])])}const _t=q(We,[["render",mt]]),ft=V({props:{data:{required:!0,type:Object}},data(){var a;return{details:(a=this.data)==null?void 0:a.data}}}),bt={class:"w-full text-left"},yt={class:"px-2 py-2 font-normal border-r border-b"},ht={class:"px-2 py-2 font-normal border-r border-b"},vt={class:"px-2 py-2 font-normal border-r border-b"},xt={class:"px-2 py-2 font-normal border-r border-b"},Et={class:"px-2 py-2 font-normal border-r border-b"},Tt={class:"px-2 py-2 font-normal border-r border-b"},$t={class:"px-2 py-2 font-normal border-r border-b"},gt={class:"px-2 py-2 font-normal border-r border-b"},At={class:"px-2 py-2 font-normal border-r border-b"};function Rt(a,p,R,y,$,h){return n(),l("div",null,[e("table",bt,[p[0]||(p[0]=e("thead",{class:"uppercase bg-gray-100"},[e("tr",{class:"border-b"},[e("th",{class:"uppercase py-2 px-2 border-r"}," SN "),e("th",{class:"uppercase py-2 px-2 border-r"}," ACCESSION NUMBER "),e("th",{class:"uppercase py-2 px-2 border-r"}," SPECIMEN "),e("th",{class:"uppercase py-2 px-2 border-r"}," RECEIPT DATE "),e("th",{class:"uppercase py-2 px-2 border-r"}," TESTS "),e("th",{class:"uppercase py-2 px-2 border-r"}," LAB selection "),e("th",{class:"uppercase py-2 px-2 border-r"}," REJECTION REASON "),e("th",{class:"uppercase py-2 px-2 border-r"}," PERSON TALKED TO "),e("th",{class:"uppercase py-2 px-2 border-r"}," DATE REJECTED ")])],-1)),e("tbody",null,[(n(!0),l(k,null,M(a.details,(o,u)=>(n(),l("tr",{key:u},[e("th",yt,r(u+1),1),e("th",ht,r(o.accession_number),1),e("th",vt,r(o.specimen),1),e("th",xt,r(o.receipt_date),1),e("th",Et,r(o.test),1),e("th",Tt,r(o.department),1),e("th",$t,r(o.rejection_reason),1),e("th",gt,r(o.person_talked_to),1),e("th",At,r(o.test_status_date),1)]))),128))])])])}const Dt=q(ft,[["render",Rt]]),St={class:"px-5 py-5"},kt={class:"flex items-center"},Mt={class:"bg-white flex space-x-5 py-5 flex-wrap"},Nt={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},It={class:"w-72 ml-2"},wt={class:"flex flex-col"},Ct={class:"flex flex-col"},Pt={class:"flex flex-col"},Ot={class:"flex flex-col"},Vt={class:"border rounded"},Lt={class:"flex items-center justify-between px-5 py-5 border-b"},jt={class:"px-5 py-3"},Bt={key:0,class:"text-lg font-semibold"},Ut={class:"text-md font-normal"},Yt={class:"text-lg font-semibold"},Ft={class:"text-md font-normal"},qt={key:0,class:"w-full border-t"},zt={key:1,class:"w-full flex flex-col items-center justify-center space-y-2 py-10"},Gt={key:2,class:"mx-auto justify-center flex flex-col items-center space-y-3 py-10"},_s=V({__name:"daily-log",setup(a){Se({title:`${De.name} - Daily Log Reports`});const p=Re(),R=m([{name:"Home",link:"/home"},{name:"Reports",link:"#"}]),y=be("token"),$=m([]),h=m({name:"select department"}),o=m([]),u=new xe,b=m({name:"select test type"}),g=m([]),A=m({name:"select test status"}),x=m(["",""]),_=m({}),z=m(0),Q=m([{name:"Test record",value:"test_record"},{name:"Patient record",value:"patient_record"}]),i=m({name:"select report type",value:"select report type"}),E=m(!1),L=U(()=>x.value[0]?S(x.value[0]).format("YYYY-MM-DD"):""),j=U(()=>x.value[1]?S(x.value[1]).format("YYYY-MM-DD"):""),W=()=>{x.value=["",""]};async function ee(){const d={route:P.departments,method:"GET",token:`${y.value}`},{data:t,error:c}=await O(d);t.value&&($.value=t.value),c.value&&console.error(c.value)}async function G(){const d={route:`${P.testTypes}/by_department?department_id=${h.value.id}`,method:"GET",token:`${y.value}`},{data:t,error:c}=await O(d);t.value&&(o.value=t.value),c.value&&console.error(c.value)}function B(d){let t="";return d=="select department"||d==="select test type"||d==="select test status"?t="":t=d,t}async function te(){const d={route:`${P.testStatus}/all`,method:"GET",token:`${y.value}`},{data:t,error:c}=await O(d);t.value&&(g.value=t.value),c.value&&console.error(c.value)}const se=d=>Object.entries(d).map(([t,c])=>`${t}: ${c}`).join(", "),oe=U(()=>{let d=new Array;return i.value.value=="test_record"&&_.value.data&&_.value.data.map(t=>{d.push({"PATIENT ID":t.patient_id,"PATIENT NAME":t.patient_name,"ACCESSION NUMBER":t.accession_number,SPECIMEN:t.specimen,"RECEIPT DATE":t.created_date?S(t.created_date).format(N):"",TEST:t.test,"PERFORMED BY":t.performed_by,RESULTS:se(t.results),REMARKS:t.remarks,"RESULTS ENTRY DATE":t.result_date?S(t.result_date).format(N):"","AUTHORIZED BY":t.authorized_by,"AUTHORIZED DATE":t.authorized_date?S(t.authorized_date).format(N):"","TURN AROUND TIME":t.tat})}),i.value.value=="patient_record"&&_.value.data&&_.value.data.map(t=>{d.push({"PATIENT ID":t.patient_no,"PATIENT NAME":t.patient_name,AGE:Z(t.dob),SEX:t.gender,"ACCESSION NUMBER":t.accession_number,"SPECIMEN TYPE":t.specimen,TESTS:t.test_type.join(", ")})}),d}),re=()=>{u.cancel(F)};async function ae(){var d;if(E.value=!0,i.value.value!="select report type"){let t=`from=${L.value}&to=${j.value}&department=${B(h.value.name)}&report_type=${i.value.value}&test_status=${B(A.value.name)}&test_type=${B(b.value.name)}`;const{data:c,error:C,pending:D}=await O({route:`${P.dailyReports}/daily_log?${t}`,method:"GET",token:`${y.value}`},u);E.value=D,c.value&&(E.value=!1,((d=c.value)==null?void 0:d.data.length)==0&&F().$toast.warning("No data found for specified parameters"),_.value=c.value,i.value.value=="test_record"&&(z.value=c.value.completed_tests)),C.value&&(E.value=!1,console.error(C.value))}else F().$toast.warning("Please select the report type before generating the report"),E.value=!1}return J(()=>h.value,()=>{G()}),J(()=>i.value,()=>{_.value=[]}),ee(),G(),te(),(d,t)=>{var H,K;const c=_e,C=X("datepicker"),D=fe,ne=he,le=Ee,de=X("excel"),ce=$e,pe=Qe,ie=_t,ue=Dt,me=ve;return n(),l("div",St,[f(c,{pages:s(R)},null,8,["pages"]),t[11]||(t[11]=e("div",{class:"flex items-center py-5"},[e("img",{src:ge,alt:"report-icon",class:"w-8 h-8 mr-2"}),e("h3",{class:"text-2xl font-semibold uppercase"},"Daily Log Report")],-1)),e("div",kt,[e("div",Mt,[e("div",Nt,[f(s(ke),{class:"w-5 h-5 mr-2"}),t[5]||(t[5]=w(" Filter By Date Range ")),e("div",It,[f(C,{required:"",position:"left",placeholder:"select start & end date",range:!0,format:"dd/MM/yyyy",onCleared:W,"input-class-name":"datepicker",modelValue:s(x),"onUpdate:modelValue":t[0]||(t[0]=v=>I(x)?x.value=v:null)},null,8,["modelValue"])])]),e("div",wt,[f(D,{items:s($),modelValue:s(h),"onUpdate:modelValue":t[1]||(t[1]=v=>I(h)?h.value=v:null)},null,8,["items","modelValue"])]),e("div",Ct,[f(D,{items:s(o),modelValue:s(b),"onUpdate:modelValue":t[2]||(t[2]=v=>I(b)?b.value=v:null)},null,8,["items","modelValue"])]),e("div",Pt,[f(D,{items:s(g),modelValue:s(A),"onUpdate:modelValue":t[3]||(t[3]=v=>I(A)?A.value=v:null)},null,8,["items","modelValue"])]),e("div",Ot,[f(D,{items:s(Q),modelValue:s(i),"onUpdate:modelValue":t[4]||(t[4]=v=>I(i)?i.value=v:null)},null,8,["items","modelValue"])]),f(ne,{color:"primary",text:"Generate Report",icon:s(Me),loading:s(E),click:()=>ae()},null,8,["icon","loading","click"]),f(de,{class:"btn btn-default",header:[`DAILY LOG ${s(i).name.toUpperCase()} REPORT`,`PERIOD: ${s(L)} - ${s(j)}`,s(p).details.name,s(p).details.address,s(p).details.phone],data:s(oe),worksheet:"report-work-sheet",name:`daily_log_${s(i).value}_report.xls`},{default:ye(()=>[f(le,{text:"Export Excel"})]),_:1},8,["header","data","name"])])]),e("div",Vt,[e("div",Lt,[t[6]||(t[6]=e("div",{class:"flex flex-col space-y-2"},[e("img",{src:Ae,alt:"app-logo",class:"w-24 h-24 object-cover"}),e("h3",{class:"text-xl font-semibold"},"DAILY LOG REPORT")],-1)),f(ce)]),e("div",jt,[s(i).value=="test_record"&&s(A).name!=="test-rejected"?(n(),l("h3",Bt,[t[7]||(t[7]=w(" Test Record: ")),e("span",Ut,r(s(z).toLocaleString())+" completed tests",1)])):T("",!0),e("h3",Yt,[t[8]||(t[8]=w(" Tests Performed Period: ")),e("span",Ft,r(s(L))+" - "+r(s(j)),1)])]),((K=(H=s(_))==null?void 0:H.data)==null?void 0:K.length)>0?(n(),l("div",qt,[s(i).value=="test_record"&&s(A).name!=="test-rejected"?(n(),Y(pe,{key:0,data:s(_)},null,8,["data"])):T("",!0),s(i).value=="patient_record"?(n(),Y(ie,{key:1,data:s(_)},null,8,["data"])):T("",!0),s(A).name=="test-rejected"?(n(),Y(ue,{key:2,data:s(_)},null,8,["data"])):T("",!0)])):T("",!0),s(_).length==0&&!s(E)?(n(),l("div",zt,t[9]||(t[9]=[e("img",{src:Te,alt:"page-icon",class:"object-cover w-20 h-20"},null,-1),e("p",null,"Data not found, please generate report",-1)]))):T("",!0),s(E)&&s(_).length==0?(n(),l("div",Gt,[f(me),t[10]||(t[10]=e("p",{class:"text-base"},[w(" Generating report, please wait"),e("span",{class:"animate-ping"},"...")],-1)),e("button",{class:"font-medium text-base text-sky-500",onClick:re},"Cancel")])):T("",!0)])])}}});export{_s as default};
