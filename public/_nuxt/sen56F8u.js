import{r as S,c as g,d as j,ar as Y,o as M,w as U,M as N,F as G,O as J,Y as X,as as Z,Q as L,R as A}from"./CFJLM_Ie.js";import{a as $,d as _,m as ee,n as te,o as O,j as le,b as E,f as ae,E as oe,u as ne,A as V,k as ie,I as B,l as ue,e as z,O as re,g as x}from"./B307KWXK.js";import{f as se,c as h,s as ve,p as de,u as pe}from"./DL7tKmRK.js";function ce(t,i,n){let m=S(n==null?void 0:n.value),s=g(()=>t.value!==void 0);return[g(()=>s.value?t.value:m.value),function(v){return s.value||(m.value=v),i==null?void 0:i(v)}]}function K(t={},i=null,n=[]){for(let[m,s]of Object.entries(t))q(n,Q(i,m),s);return n}function Q(t,i){return t?t+"["+i+"]":i}function q(t,i,n){if(Array.isArray(n))for(let[m,s]of n.entries())q(t,Q(i,m.toString()),s);else n instanceof Date?t.push([i,n.toISOString()]):typeof n=="boolean"?t.push([i,n?"1":"0"]):typeof n=="string"?t.push([i,n]):typeof n=="number"?t.push([i,`${n}`]):n==null?t.push([i,""]):K(n,i,t)}function fe(t,i){return t===i}var be=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(be||{}),me=(t=>(t[t.Single=0]="Single",t[t.Multi=1]="Multi",t))(me||{}),xe=(t=>(t[t.Pointer=0]="Pointer",t[t.Other=1]="Other",t))(xe||{});function ge(t){requestAnimationFrame(()=>requestAnimationFrame(t))}let H=Symbol("ListboxContext");function C(t){let i=Z(H,null);if(i===null){let n=new Error(`<${t} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,C),n}return i}let Se=j({name:"Listbox",emits:{"update:modelValue":t=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>fe},horizontal:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(t,{slots:i,attrs:n,emit:m}){let s=S(1),v=S(null),e=S(null),c=S(null),p=S([]),f=S(""),b=S(null),a=S(1);function u(l=o=>o){let o=b.value!==null?p.value[b.value]:null,r=re(l(p.value.slice()),y=>O(y.dataRef.domRef)),d=o?r.indexOf(o):null;return d===-1&&(d=null),{options:r,activeOptionIndex:d}}let w=g(()=>t.multiple?1:0),[P,R]=ce(g(()=>t.modelValue),l=>m("update:modelValue",l),g(()=>t.defaultValue)),D=g(()=>P.value===void 0?$(w.value,{1:[],0:void 0}):P.value),k={listboxState:s,value:D,mode:w,compare(l,o){if(typeof t.by=="string"){let r=t.by;return(l==null?void 0:l[r])===(o==null?void 0:o[r])}return t.by(l,o)},orientation:g(()=>t.horizontal?"horizontal":"vertical"),labelRef:v,buttonRef:e,optionsRef:c,disabled:g(()=>t.disabled),options:p,searchQuery:f,activeOptionIndex:b,activationTrigger:a,closeListbox(){t.disabled||s.value!==1&&(s.value=1,b.value=null)},openListbox(){t.disabled||s.value!==0&&(s.value=0)},goToOption(l,o,r){if(t.disabled||s.value===1)return;let d=u(),y=se(l===h.Specific?{focus:h.Specific,id:o}:{focus:l},{resolveItems:()=>d.options,resolveActiveIndex:()=>d.activeOptionIndex,resolveId:I=>I.id,resolveDisabled:I=>I.dataRef.disabled});f.value="",b.value=y,a.value=r??1,p.value=d.options},search(l){if(t.disabled||s.value===1)return;let o=f.value!==""?0:1;f.value+=l.toLowerCase();let r=(b.value!==null?p.value.slice(b.value+o).concat(p.value.slice(0,b.value+o)):p.value).find(y=>y.dataRef.textValue.startsWith(f.value)&&!y.dataRef.disabled),d=r?p.value.indexOf(r):-1;d===-1||d===b.value||(b.value=d,a.value=1)},clearSearch(){t.disabled||s.value!==1&&f.value!==""&&(f.value="")},registerOption(l,o){let r=u(d=>[...d,{id:l,dataRef:o}]);p.value=r.options,b.value=r.activeOptionIndex},unregisterOption(l){let o=u(r=>{let d=r.findIndex(y=>y.id===l);return d!==-1&&r.splice(d,1),r});p.value=o.options,b.value=o.activeOptionIndex,a.value=1},theirOnChange(l){t.disabled||R(l)},select(l){t.disabled||R($(w.value,{0:()=>l,1:()=>{let o=L(k.value.value).slice(),r=L(l),d=o.findIndex(y=>k.compare(r,L(y)));return d===-1?o.push(r):o.splice(d,1),o}}))}};_([e,c],(l,o)=>{var r;k.closeListbox(),ee(o,te.Loose)||(l.preventDefault(),(r=O(e))==null||r.focus())},g(()=>s.value===0)),Y(H,k),le(g(()=>$(s.value,{0:E.Open,1:E.Closed})));let T=g(()=>{var l;return(l=O(e))==null?void 0:l.closest("form")});return M(()=>{U([T],()=>{if(!T.value||t.defaultValue===void 0)return;function l(){k.theirOnChange(t.defaultValue)}return T.value.addEventListener("reset",l),()=>{var o;(o=T.value)==null||o.removeEventListener("reset",l)}},{immediate:!0})}),()=>{let{name:l,modelValue:o,disabled:r,form:d,...y}=t,I={open:s.value===0,disabled:r,value:D.value};return N(G,[...l!=null&&D.value!=null?K({[l]:D.value}).map(([F,W])=>N(ae,oe({features:ne.Hidden,key:F,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:d,disabled:r,name:F,value:W}))):[],V({ourProps:{},theirProps:{...n,...ie(y,["defaultValue","onUpdate:modelValue","horizontal","multiple","by"])},slot:I,slots:i,attrs:n,name:"Listbox"})])}}}),Le=j({name:"ListboxLabel",props:{as:{type:[Object,String],default:"label"},id:{type:String,default:null}},setup(t,{attrs:i,slots:n}){var m;let s=(m=t.id)!=null?m:`headlessui-listbox-label-${B()}`,v=C("ListboxLabel");function e(){var c;(c=O(v.buttonRef))==null||c.focus({preventScroll:!0})}return()=>{let c={open:v.listboxState.value===0,disabled:v.disabled.value},{...p}=t,f={id:s,ref:v.labelRef,onClick:e};return V({ourProps:f,theirProps:p,slot:c,attrs:i,slots:n,name:"ListboxLabel"})}}}),Re=j({name:"ListboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(t,{attrs:i,slots:n,expose:m}){var s;let v=(s=t.id)!=null?s:`headlessui-listbox-button-${B()}`,e=C("ListboxButton");m({el:e.buttonRef,$el:e.buttonRef});function c(a){switch(a.key){case x.Space:case x.Enter:case x.ArrowDown:a.preventDefault(),e.openListbox(),A(()=>{var u;(u=O(e.optionsRef))==null||u.focus({preventScroll:!0}),e.value.value||e.goToOption(h.First)});break;case x.ArrowUp:a.preventDefault(),e.openListbox(),A(()=>{var u;(u=O(e.optionsRef))==null||u.focus({preventScroll:!0}),e.value.value||e.goToOption(h.Last)});break}}function p(a){switch(a.key){case x.Space:a.preventDefault();break}}function f(a){e.disabled.value||(e.listboxState.value===0?(e.closeListbox(),A(()=>{var u;return(u=O(e.buttonRef))==null?void 0:u.focus({preventScroll:!0})})):(a.preventDefault(),e.openListbox(),ge(()=>{var u;return(u=O(e.optionsRef))==null?void 0:u.focus({preventScroll:!0})})))}let b=ve(g(()=>({as:t.as,type:i.type})),e.buttonRef);return()=>{var a,u;let w={open:e.listboxState.value===0,disabled:e.disabled.value,value:e.value.value},{...P}=t,R={ref:e.buttonRef,id:v,type:b.value,"aria-haspopup":"listbox","aria-controls":(a=O(e.optionsRef))==null?void 0:a.id,"aria-expanded":e.listboxState.value===0,"aria-labelledby":e.labelRef.value?[(u=O(e.labelRef))==null?void 0:u.id,v].join(" "):void 0,disabled:e.disabled.value===!0?!0:void 0,onKeydown:c,onKeyup:p,onClick:f};return V({ourProps:R,theirProps:P,slot:w,attrs:i,slots:n,name:"ListboxButton"})}}}),we=j({name:"ListboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(t,{attrs:i,slots:n,expose:m}){var s;let v=(s=t.id)!=null?s:`headlessui-listbox-options-${B()}`,e=C("ListboxOptions"),c=S(null);m({el:e.optionsRef,$el:e.optionsRef});function p(a){switch(c.value&&clearTimeout(c.value),a.key){case x.Space:if(e.searchQuery.value!=="")return a.preventDefault(),a.stopPropagation(),e.search(a.key);case x.Enter:if(a.preventDefault(),a.stopPropagation(),e.activeOptionIndex.value!==null){let u=e.options.value[e.activeOptionIndex.value];e.select(u.dataRef.value)}e.mode.value===0&&(e.closeListbox(),A(()=>{var u;return(u=O(e.buttonRef))==null?void 0:u.focus({preventScroll:!0})}));break;case $(e.orientation.value,{vertical:x.ArrowDown,horizontal:x.ArrowRight}):return a.preventDefault(),a.stopPropagation(),e.goToOption(h.Next);case $(e.orientation.value,{vertical:x.ArrowUp,horizontal:x.ArrowLeft}):return a.preventDefault(),a.stopPropagation(),e.goToOption(h.Previous);case x.Home:case x.PageUp:return a.preventDefault(),a.stopPropagation(),e.goToOption(h.First);case x.End:case x.PageDown:return a.preventDefault(),a.stopPropagation(),e.goToOption(h.Last);case x.Escape:a.preventDefault(),a.stopPropagation(),e.closeListbox(),A(()=>{var u;return(u=O(e.buttonRef))==null?void 0:u.focus({preventScroll:!0})});break;case x.Tab:a.preventDefault(),a.stopPropagation();break;default:a.key.length===1&&(e.search(a.key),c.value=setTimeout(()=>e.clearSearch(),350));break}}let f=ue(),b=g(()=>f!==null?(f.value&E.Open)===E.Open:e.listboxState.value===0);return()=>{var a,u;let w={open:e.listboxState.value===0},{...P}=t,R={"aria-activedescendant":e.activeOptionIndex.value===null||(a=e.options.value[e.activeOptionIndex.value])==null?void 0:a.id,"aria-multiselectable":e.mode.value===1?!0:void 0,"aria-labelledby":(u=O(e.buttonRef))==null?void 0:u.id,"aria-orientation":e.orientation.value,id:v,onKeydown:p,role:"listbox",tabIndex:0,ref:e.optionsRef};return V({ourProps:R,theirProps:P,slot:w,attrs:i,slots:n,features:z.RenderStrategy|z.Static,visible:b.value,name:"ListboxOptions"})}}}),Pe=j({name:"ListboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(t,{slots:i,attrs:n,expose:m}){var s;let v=(s=t.id)!=null?s:`headlessui-listbox-option-${B()}`,e=C("ListboxOption"),c=S(null);m({el:c,$el:c});let p=g(()=>e.activeOptionIndex.value!==null?e.options.value[e.activeOptionIndex.value].id===v:!1),f=g(()=>$(e.mode.value,{0:()=>e.compare(L(e.value.value),L(t.value)),1:()=>L(e.value.value).some(l=>e.compare(L(l),L(t.value)))})),b=g(()=>$(e.mode.value,{1:()=>{var l;let o=L(e.value.value);return((l=e.options.value.find(r=>o.some(d=>e.compare(L(d),L(r.dataRef.value)))))==null?void 0:l.id)===v},0:()=>f.value})),a=de(c),u=g(()=>({disabled:t.disabled,value:t.value,get textValue(){return a()},domRef:c}));M(()=>e.registerOption(v,u)),J(()=>e.unregisterOption(v)),M(()=>{U([e.listboxState,f],()=>{e.listboxState.value===0&&f.value&&$(e.mode.value,{1:()=>{b.value&&e.goToOption(h.Specific,v)},0:()=>{e.goToOption(h.Specific,v)}})},{immediate:!0})}),X(()=>{e.listboxState.value===0&&p.value&&e.activationTrigger.value!==0&&A(()=>{var l,o;return(o=(l=O(c))==null?void 0:l.scrollIntoView)==null?void 0:o.call(l,{block:"nearest"})})});function w(l){if(t.disabled)return l.preventDefault();e.select(t.value),e.mode.value===0&&(e.closeListbox(),A(()=>{var o;return(o=O(e.buttonRef))==null?void 0:o.focus({preventScroll:!0})}))}function P(){if(t.disabled)return e.goToOption(h.Nothing);e.goToOption(h.Specific,v)}let R=pe();function D(l){R.update(l)}function k(l){R.wasMoved(l)&&(t.disabled||p.value||e.goToOption(h.Specific,v,0))}function T(l){R.wasMoved(l)&&(t.disabled||p.value&&e.goToOption(h.Nothing))}return()=>{let{disabled:l}=t,o={active:p.value,selected:f.value,disabled:l},{value:r,disabled:d,...y}=t,I={id:v,ref:c,role:"option",tabIndex:l===!0?void 0:-1,"aria-disabled":l===!0?!0:void 0,"aria-selected":f.value,disabled:void 0,onClick:w,onFocus:P,onPointerenter:D,onMouseenter:D,onPointermove:k,onMousemove:k,onPointerleave:T,onMouseleave:T};return V({ourProps:I,theirProps:y,slot:o,attrs:n,slots:i,name:"ListboxOption"})}}});export{we as A,Le as E,Pe as F,Se as I,Re as j};
