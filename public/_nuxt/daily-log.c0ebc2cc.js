import{_ as ue}from"./Breadcrumb.vue.29096239.js";import{_ as me}from"./Dropdown.b76af8d6.js";import{m as O,_ as U,o as n,c as l,e,F as k,r as A,t as r,l as s,k as E,i as P,u as _e,s as u,a as he,I as j,A as H,g as J,d as h,y as D,h as fe,p as Y,b as K,f as be}from"./entry.8b130418.js";import{_ as ye}from"./ExportButton.vue.2aea1df0.js";import{_ as ve}from"./Address.vue.b3425546.js";import{d as M}from"./constants.71ae81d4.js";import{h as N,k as X,e as C,f as I}from"./fetch.6ed6d8be.js";import{_ as xe}from"./Loader.d7f1913d.js";import{_ as $e}from"./report.f12e8797.js";import{_ as Ee}from"./logo.7772852c.js";import{_ as ge}from"./page.ae16c829.js";import{u as Te}from"./facility.89075c79.js";import{P as Re}from"./package.651db5f9.js";import{r as Se}from"./FunnelIcon.d3368d75.js";import{r as ke}from"./ArrowPathIcon.f2fac6c8.js";import"./nuxt-link.a6b19347.js";import"./HomeIcon.75dd900a.js";import"./listbox.232a252f.js";import"./hidden.94b93f99.js";import"./use-text-value.d90f1789.js";import"./CheckIcon.54595a00.js";import"./CheckCircleIcon.78765db9.js";import"./MagnifyingGlassIcon.a1000dd2.js";import"./network.9f9ddcab.js";import"./transition.0c9cdf07.js";import"./XMarkIcon.2df3c244.js";import"./PencilSquareIcon.e8095535.js";import"./PrinterIcon.55ff5c9e.js";const Ae=O({props:{data:{required:!0,type:Object}},data(){return{moment:N,headers:[{name:"SN"},{name:"Patient ID"},{name:"Patient Name"},{name:"Accession Number"},{name:"Specimen"},{name:"Receipt Date"},{name:"Tests"},{name:"Performed By"},{name:"Results"},{name:"Remarks"},{name:"Results Entry Date"},{name:"Authorized By"}],reportData:this.data}}}),De={class:"w-full overflow-x-auto"},Ne={class:"w-full text-left overflow-y-auto"},Pe={class:"uppercase bg-gray-100"},we={class:"border-b"},Ce={class:"px-2 py-2 font-normal border-r"},Ie={class:"px-2 py-2 font-normal border-r"},Me={class:"px-2 py-2 font-normal border-r"},Oe={class:"px-2 py-2 font-normal border-r"},Ve={class:"px-2 py-2 font-normal border-r"},Le={class:"px-2 py-2 font-normal border-r"},Be={class:"px-2 py-2 font-normal border-r"},je={class:"px-2 py-2 font-normal border-r"},Ye={class:"px-2 py-2 font-normal border-r"},Ue={key:0,class:"font-medium"},Fe={class:"px-2 py-2 font-normal border-r"},qe={class:"px-2 py-2 font-normal border-r"},Ge={class:"px-2 py-2 font-normal"};function ze(a,g,R,f,T,b){return n(),l("div",De,[e("table",Ne,[e("thead",Pe,[e("tr",we,[(n(!0),l(k,null,A(a.headers,(o,d)=>(n(),l("th",{class:"uppercase py-2 px-2 border-r",key:d},r(o.name),1))),128))])]),e("tbody",null,[(n(!0),l(k,null,A(a.data.data,(o,d)=>(n(),l("tr",{class:"bg-white border-b",key:d},[e("th",Ce,r(d+1),1),e("th",Ie,r(o.patient_id),1),e("th",Me,r(o.patient_name),1),e("th",Oe,r(o.accession_number),1),e("th",Ve,r(o.specimen),1),e("th",Le,r(a.moment(o.receipt_date).format("dateFormat"in a?a.dateFormat:s(M))),1),e("th",Be,r(o.test),1),e("th",je,r(o.performed_by),1),e("th",Ye,[(n(!0),l(k,null,A(o.results,(y,m)=>(n(),l("p",{key:m},[y!=null&&y!==""?(n(),l("span",Ue,r(`${m}:`),1)):E("",!0),P(" "+r(y),1)]))),128))]),e("th",Fe,r(o.remarks),1),e("th",qe,r(a.moment(o.result_date).format("dateFormat"in a?a.dateFormat:s(M))),1),e("th",Ge,r(o.authorized_by),1)]))),128))])])])}const He=U(Ae,[["render",ze]]),Je=O({props:{data:{required:!0,type:Object}},data(){var a;return{details:(a=this.data)==null?void 0:a.data}},methods:{removeDuplicates(a){return a.filter((R,f)=>a.findIndex(T=>T.patient_no===R.patient_no)===f)}}}),Ke={class:"w-full text-left"},Xe=e("thead",{class:"uppercase bg-gray-100"},[e("tr",{class:"border-b"},[e("th",{class:"uppercase py-2 px-2 border-r"},"SN"),e("th",{class:"uppercase py-2 px-2 border-r"},"PATIENT NO"),e("th",{class:"uppercase py-2 px-2 border-r"},"PATIENT NAME"),e("th",{class:"uppercase py-2 px-2 border-r"},"AGE"),e("th",{class:"uppercase py-2 px-2 border-r"},"SEX"),e("th",{class:"uppercase py-2 px-2 border-r"},"ACCESSION NUMBER"),e("th",{class:"uppercase py-2 px-2 border-r"},"SPECIMEN TYPE"),e("th",{class:"uppercase py-2 px-2 border-r"},"TESTS")])],-1),Ze={class:"px-2 py-2 font-normal border-r border-b"},Qe={class:"px-2 py-2 font-normal border-r border-b"},We={class:"px-2 py-2 font-normal border-r border-b"},et={class:"px-2 py-2 font-normal border-r border-b"},tt={class:"px-2 py-2 font-normal border-r border-b"},st={class:"px-2 py-2 font-normal border-r border-b"},ot={class:"px-2 py-2 font-normal border-r border-b"},rt={class:"px-2 py-2 font-normal border-r border-b space-y-1"},at=e("div",{class:"px-3 py-3 uppercase"},"SUMMARY",-1),nt={class:"w-full text-left"},lt=e("thead",{class:"uppercase bg-gray-100"},[e("tr",{class:"border-b"},[e("th",{class:"uppercase py-2 px-2 border-r"},"TOTAL VISITS"),e("th",{class:"uppercase py-2 px-2 border-r"},"MALE"),e("th",{class:"uppercase py-2 px-2 border-r"},"FEMALE")])],-1),ct={class:"px-2 py-2 font-normal border-r border-b"},pt={class:"px-2 py-2 font-normal border-r border-b"},dt={class:"px-2 py-2 font-normal border-r border-b"};function it(a,g,R,f,T,b){return n(),l("div",null,[e("div",null,[e("table",Ke,[Xe,e("tbody",null,[(n(!0),l(k,null,A(a.details,(o,d)=>(n(),l("tr",{key:d},[e("th",Ze,r(d+1),1),e("th",Qe,r(o.patient_no),1),e("th",We,r(o.patient_name),1),e("th",et,r(("calculateAge"in a?a.calculateAge:s(X))(o.dob)),1),e("th",tt,r(o.gender),1),e("th",st,r(o.accession_number),1),e("th",ot,r(o.specimen),1),e("th",rt,[(n(!0),l(k,null,A(o.test_type,(y,m)=>(n(),l("p",{key:m},r(y),1))),128))])]))),128))])])]),at,e("table",nt,[lt,e("tbody",null,[e("tr",null,[e("th",ct,r(a.data.visits.length),1),e("th",pt,r(a.removeDuplicates(a.details).filter(o=>o.gender=="M").length),1),e("th",dt,r(a.removeDuplicates(a.details).filter(o=>o.gender=="F").length),1)])])])])}const ut=U(Je,[["render",it]]),mt=O({props:{data:{required:!0,type:Object}},data(){var a;return{details:(a=this.data)==null?void 0:a.data}}}),_t={class:"w-full text-left"},ht=e("thead",{class:"uppercase bg-gray-100"},[e("tr",{class:"border-b"},[e("th",{class:"uppercase py-2 px-2 border-r"}," SN "),e("th",{class:"uppercase py-2 px-2 border-r"}," ACCESSION NUMBER "),e("th",{class:"uppercase py-2 px-2 border-r"}," SPECIMEN "),e("th",{class:"uppercase py-2 px-2 border-r"}," RECEIPT DATE "),e("th",{class:"uppercase py-2 px-2 border-r"}," TESTS "),e("th",{class:"uppercase py-2 px-2 border-r"}," LAB selection "),e("th",{class:"uppercase py-2 px-2 border-r"}," REJECTION REASON "),e("th",{class:"uppercase py-2 px-2 border-r"}," PERSON TALKED TO "),e("th",{class:"uppercase py-2 px-2 border-r"}," DATE REJECTED ")])],-1),ft={class:"px-2 py-2 font-normal border-r border-b"},bt={class:"px-2 py-2 font-normal border-r border-b"},yt={class:"px-2 py-2 font-normal border-r border-b"},vt={class:"px-2 py-2 font-normal border-r border-b"},xt={class:"px-2 py-2 font-normal border-r border-b"},$t={class:"px-2 py-2 font-normal border-r border-b"},Et={class:"px-2 py-2 font-normal border-r border-b"},gt={class:"px-2 py-2 font-normal border-r border-b"},Tt={class:"px-2 py-2 font-normal border-r border-b"};function Rt(a,g,R,f,T,b){return n(),l("div",null,[e("table",_t,[ht,e("tbody",null,[(n(!0),l(k,null,A(a.details,(o,d)=>(n(),l("tr",{key:d},[e("th",ft,r(d+1),1),e("th",bt,r(o.accession_number),1),e("th",yt,r(o.specimen),1),e("th",vt,r(o.receipt_date),1),e("th",xt,r(o.test),1),e("th",$t,r(o.department),1),e("th",Et,r(o.rejection_reason),1),e("th",gt,r(o.person_talked_to),1),e("th",Tt,r(o.test_status_date),1)]))),128))])])])}const St=U(mt,[["render",Rt]]),kt={class:"px-5 py-5"},At=e("div",{class:"flex items-center py-5"},[e("img",{src:$e,alt:"report-icon",class:"w-8 h-8 mr-2"}),e("h3",{class:"text-2xl font-semibold uppercase"},"Daily Log Report")],-1),Dt={class:"flex items-center"},Nt={class:"bg-white flex space-x-5 py-5 flex-wrap"},Pt={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},wt={class:"w-72 ml-2"},Ct={class:"flex flex-col"},It={class:"flex flex-col"},Mt={class:"flex flex-col"},Ot={class:"flex flex-col"},Vt={class:"border rounded"},Lt={class:"flex items-center justify-between px-5 py-5 border-b"},Bt=e("div",{class:"flex flex-col space-y-2"},[e("img",{src:Ee,alt:"app-logo",class:"w-24 h-24 object-cover"}),e("h3",{class:"text-xl font-semibold"},"DAILY LOG REPORT")],-1),jt={class:"px-5 py-3"},Yt={key:0,class:"text-lg font-semibold"},Ut={class:"text-md font-normal"},Ft={class:"text-lg font-semibold"},qt={class:"text-md font-normal"},Gt={key:0,class:"w-full border-t"},zt={key:1,class:"w-full flex flex-col items-center justify-center space-y-2 py-10"},Ht=e("img",{src:ge,alt:"page-icon",class:"object-cover w-20 h-20"},null,-1),Jt=e("p",null,"Data not found, please generate report",-1),Kt=[Ht,Jt],Xt={key:2,class:"mx-auto justify-center flex flex-col items-center space-y-3 py-10"},Zt=e("p",{class:"text-base"},[P(" Generating report, please wait"),e("span",{class:"animate-ping"},"...")],-1),Ss=O({__name:"daily-log",setup(a){_e({title:`${Re.name} - Daily Log Reports`});const g=Te(),R=u([{name:"Home",link:"/home"},{name:"Reports",link:"#"}]),f=he("token"),T=u([]),b=u({name:"select department"}),o=u([]),d=u({name:"select test type"}),y=u([]),m=u({name:"select test status"}),x=u(["",""]),_=u({}),F=u(0),Z=u([{name:"Test record",value:"test_record"},{name:"Patient record",value:"patient_record"}]),i=u({name:"select report type",value:"select report type"}),$=u(!1),V=j(()=>x.value[0]?N(x.value[0]).format("YYYY-MM-DD"):""),L=j(()=>x.value[1]?N(x.value[1]).format("YYYY-MM-DD"):""),Q=()=>{x.value=["",""]};async function W(){const c={route:C.departments,method:"GET",token:`${f.value}`},{data:t,error:p}=await I(c);t.value&&(T.value=t.value),p.value&&console.error(p.value)}async function q(){const c={route:`${C.testTypes}/by_department?department_id=${b.value.id}`,method:"GET",token:`${f.value}`},{data:t,error:p}=await I(c);t.value&&(o.value=t.value),p.value&&console.error(p.value)}function B(c){let t="";return c=="select department"||c==="select test type"||c==="select test status"?t="":t=c,t}async function ee(){const c={route:`${C.testStatus}/all`,method:"GET",token:`${f.value}`},{data:t,error:p}=await I(c);t.value&&(y.value=t.value),p.value&&console.error(p.value)}const te=c=>Object.entries(c).map(([t,p])=>`${t}: ${p}`).join(", "),se=j(()=>{let c=new Array;return i.value.value=="test_record"&&_.value.data&&_.value.data.map(t=>{c.push({"PATIENT ID":t.patient_id,"PATIENT NAME":t.patient_name,"ACCESSION NUMBER":t.accession_number,SPECIMEN:t.specimen,"RECEIPT DATE":N(t.receipt_date).format(M),TEST:t.test,"PERFORMED BY":t.performed_by,RESULTS:te(t.results),REMARKS:t.remarks,"RESULTS ENTRY DATE":N(t.result_date).format(M),"AUTHORIZED BY":t.authorized_by})}),i.value.value=="patient_record"&&_.value.data&&_.value.data.map(t=>{c.push({"PATIENT ID":t.patient_no,"PATIENT NAME":t.patient_name,AGE:X(t.dob),SEX:t.gender,"ACCESSION NUMBER":t.accession_number,"SPECIMEN TYPE":t.specimen,TESTS:t.test_type.join(", ")})}),c});async function oe(){var c;if($.value=!0,i.value.value!="select report type"){let t=`from=${V.value}&to=${L.value}&department=${B(b.value.name)}&report_type=${i.value.value}&test_status=${B(m.value.name)}&test_type=${B(d.value.name)}`;const{data:p,error:w,pending:S}=await I({route:`${C.dailyReports}/daily_log?${t}`,method:"GET",token:`${f.value}`});$.value=S,p.value&&($.value=!1,((c=p.value)==null?void 0:c.data.length)==0&&K().$toast.warning("No data found for specified parameters"),_.value=p.value,i.value.value=="test_record"&&(F.value=p.value.completed_tests)),w.value&&($.value=!1,console.error(w.value))}else K().$toast.warning("Please select the report type before generating the report"),$.value=!1}return H(()=>b.value,()=>{q()}),H(()=>i.value,()=>{_.value=[]}),W(),q(),ee(),(c,t)=>{var G,z;const p=ue,w=J("datepicker"),S=me,re=be,ae=ye,ne=J("excel"),le=ve,ce=He,pe=ut,de=St,ie=xe;return n(),l("div",kt,[h(p,{pages:s(R)},null,8,["pages"]),At,e("div",Dt,[e("div",Nt,[e("div",Pt,[h(s(Se),{class:"w-5 h-5 mr-2"}),P(" Filter By Date Range "),e("div",wt,[h(w,{required:"",position:"left",placeholder:"select start & end date",range:!0,onCleared:Q,"input-class-name":"datepicker",modelValue:s(x),"onUpdate:modelValue":t[0]||(t[0]=v=>D(x)?x.value=v:null)},null,8,["modelValue"])])]),e("div",Ct,[h(S,{items:s(T),modelValue:s(b),"onUpdate:modelValue":t[1]||(t[1]=v=>D(b)?b.value=v:null)},null,8,["items","modelValue"])]),e("div",It,[h(S,{items:s(o),modelValue:s(d),"onUpdate:modelValue":t[2]||(t[2]=v=>D(d)?d.value=v:null)},null,8,["items","modelValue"])]),e("div",Mt,[h(S,{items:s(y),modelValue:s(m),"onUpdate:modelValue":t[3]||(t[3]=v=>D(m)?m.value=v:null)},null,8,["items","modelValue"])]),e("div",Ot,[h(S,{items:s(Z),modelValue:s(i),"onUpdate:modelValue":t[4]||(t[4]=v=>D(i)?i.value=v:null)},null,8,["items","modelValue"])]),h(re,{color:"primary",text:"Generate Report",icon:s(ke),loading:s($),click:()=>oe()},null,8,["icon","loading","click"]),h(ne,{class:"btn btn-default",header:[`DAILY LOG ${s(i).name.toUpperCase()} REPORT`,`PERIOD: ${s(V)} - ${s(L)}`,s(g).details.name,s(g).details.address,s(g).details.phone],data:s(se),worksheet:"report-work-sheet",name:`daily_log_${s(i).value}_report.xls`},{default:fe(()=>[h(ae,{text:"Export Excel"})]),_:1},8,["header","data","name"])])]),e("div",Vt,[e("div",Lt,[Bt,h(le)]),e("div",jt,[s(i).value=="test_record"&&s(m).name!=="test-rejected"?(n(),l("h3",Yt,[P(" Test Record: "),e("span",Ut,r(s(F).toLocaleString())+" completed tests",1)])):E("",!0),e("h3",Ft,[P(" Tests Performed Period: "),e("span",qt,r(s(V))+" - "+r(s(L)),1)])]),((z=(G=s(_))==null?void 0:G.data)==null?void 0:z.length)>0?(n(),l("div",Gt,[s(i).value=="test_record"&&s(m).name!=="test-rejected"?(n(),Y(ce,{key:0,data:s(_)},null,8,["data"])):E("",!0),s(i).value=="patient_record"?(n(),Y(pe,{key:1,data:s(_)},null,8,["data"])):E("",!0),s(m).name=="test-rejected"?(n(),Y(de,{key:2,data:s(_)},null,8,["data"])):E("",!0)])):E("",!0),s(_).length==0&&!s($)?(n(),l("div",zt,Kt)):E("",!0),s($)&&s(_).length==0?(n(),l("div",Xt,[h(ie),Zt])):E("",!0)])])}}});export{Ss as default};
