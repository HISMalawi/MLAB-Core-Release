import{_ as H}from"./DV1Zihh-.js";import{d as V,r as b,u as I,c as w,z as p,o as U,x as T,b as c,e as i,f as d,h as e,M as q,g as t,j as g,A as W,y as G,t as y,L as M,F as E,k as R,D as z,l as K,_ as Q}from"./Bz6dDDnm.js";import{_ as J}from"./BJnLWEDZ.js";import{_ as X,a as Z}from"./D9FmbqHg.js";import{u as ee,_ as te}from"./BJKFxhbf.js";import{_ as oe}from"./BD0uniIa.js";import{_ as se}from"./BAX8diHQ.js";import{P as re}from"./Vq2kRzrb.js";import{u as ae}from"./DJ7dCo8l.js";import{u as ne}from"./CYvY0-Vn.js";import{r as le}from"./BBJp7UAL.js";import{r as ce}from"./B_nqcZFa.js";import"./CJmHsYwL.js";import"./sX7iQee9.js";const ie=""+new URL("whonet.BSO_29W3.png",import.meta.url).href,de={class:"px-5 py-5"},me={class:"w-full flex items-center justify-between"},ue={class:"bg-white flex space-x-5 py-5 flex-wrap"},pe={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},_e={class:"w-72 ml-2"},fe={class:"border rounded print-container mt-5"},ye={class:"w-full rounded-tr rounded-tl border-b px-5 py-5 flex items-center justify-between"},ve={class:"mt-3 px-5 border-b"},ge={class:"font-medium mb-2"},xe={class:"font-normal"},he={class:"max-w-full overflow-x-auto"},be={class:"p-4"},we={class:"w-full border border-dotted rounded overflow-x-auto"},Ee={class:"bg-gray-100"},Re={class:"border-b"},Ae={key:0,class:"flex flex-col space-y-3 items-center justify-center py-10"},He=V({__name:"whonet",setup(De){ne({title:`${re.name} - Daily Log Reports`}),ae();const N=b([{name:"Home",link:"/home"},{name:"Reports",link:"#"}]),{$toast:x}=I(),{loading:a,executeCancellableRequest:C,cancelRequest:k}=ee(),n=b(["",""]),l=b([]),_=w(()=>n.value[0]?p(n.value[0]).format("YYYY-MM-DD"):""),f=w(()=>n.value[1]?p(n.value[1]).format("YYYY-MM-DD"):""),O=()=>{n.value=["",""]},A=s=>["laboratory","first_name","last_name","gender","dob","ward_or_location","accession_number","specimen_type","requested_by"].filter(r=>s.length>0&&s.some(m=>r in m)),S=s=>({WARD_OR_LOCATION:"WARD OR LOCATION",SPECIMEN_TYPE:"SPECIMEN TYPE",REQUESTED_BY:"REQUESTED BY",ACCESSION_NUMBER:"ACCESSION NUMBER",FIRST_NAME:"FIRST NAME",LAST_NAME:"LAST NAME"})[s]||s.replaceAll("_"," "),$=w(()=>{const s=new Set;return l.value.forEach(o=>{Object.keys(o).forEach(r=>s.add(r))}),l.value.map(o=>{const r={};return Array.from(s).forEach(m=>{const h=m.toUpperCase().replace(/[_-]/g," ");r[h]=o[m]||""}),r})}),B=async()=>{if(a.value=!0,!_.value||!f.value){x.warn("Please select a date range"),a.value=!1;return}l.value=[];let s=`start_date=${_.value}&end_date=${f.value}`;const{data:o,error:r}=await C({route:`${K.whonet}?${s}`,method:"GET"});o.value&&(l.value=o.value.data,a.value=!1,x.success("Report generated successfully")),r.value&&(console.error(r.value),x.error("An error occurred while generating report"),a.value=!1)};return U(()=>{a.value=!1}),(s,o)=>{const r=H,m=T("datepicker"),h=Q,P=J,Y=T("excel"),F=Z,j=te;return c(),i("div",de,[d(r,{pages:e(N)},null,8,["pages"]),o[5]||(o[5]=q('<div class="flex items-center py-5"><div class="flex items-center mr-2"><div class="w-12 h-12 bg-gray-100 flex items-center justify-center rounded-full"><img src="'+oe+'" alt="report-icon" class="w-8 h-8"></div><div class="w-12 h-12 bg-gray-100 flex items-center justify-center rounded-full -ml-3"><img src="'+ie+'" alt="report-icon" class="w-8 h-8"></div></div><h3 class="text-2xl font-semibold uppercase">WHONET Report</h3></div>',1)),t("div",me,[t("div",ue,[t("div",pe,[d(e(le),{class:"w-5 h-5 mr-2"}),o[1]||(o[1]=g(" Filter By Date Range ")),t("div",_e,[d(m,{required:"",position:"left",placeholder:"select start & end date",range:!0,format:"dd/MM/yyyy",onCleared:O,"input-class-name":"datepicker",modelValue:e(n),"onUpdate:modelValue":o[0]||(o[0]=u=>W(n)?n.value=u:null),"max-date":new Date},null,8,["modelValue","max-date"])])]),t("div",null,[d(h,{color:"primary",text:"Generate Report",icon:e(ce),click:()=>B(),loading:e(a)},null,8,["icon","click","loading"])])]),d(Y,{class:"btn btn-default",header:[],data:e($),worksheet:"report-work-sheet",name:`whonet_report_${e(p)(e(_)).format("DD_MM_yyyy")}_to_${e(p)(e(f)).format("DD_MM_yyyy")}.xls`},{default:G(()=>[d(P,{text:"Export Excel"})]),_:1},8,["data","name"])]),t("div",fe,[t("div",ye,[o[2]||(o[2]=t("div",{class:"flex flex-col space-y-2"},[t("img",{src:se,alt:"app-logo",class:"w-24 h-24 object-cover"}),t("h3",{class:"text-xl font-semibold"},"WHONET REPORT")],-1)),d(F)]),t("div",ve,[t("h3",ge,[o[3]||(o[3]=g(" Tests Performed Period: ")),t("span",xe,y(e(_)?e(p)(e(_)).format("DATE_FORMAT"in s?s.DATE_FORMAT:e(M)):"-")+" - "+y(e(f)?e(p)(e(f)).format("DATE_FORMAT"in s?s.DATE_FORMAT:e(M)):"-"),1)])]),t("div",he,[t("div",be,[t("table",we,[t("thead",Ee,[t("tr",Re,[(c(!0),i(E,null,R(A(e(l)),(u,v)=>(c(),i("th",{key:v,class:"px-2 py-2 text-center border-r text-lg uppercase"},y(S(u)),1))),128))])]),t("tbody",null,[(c(!0),i(E,null,R(e(l),(u,v)=>(c(),i("tr",{key:v,class:"divide-gray-200"},[(c(!0),i(E,null,R(A(e(l)),(D,L)=>(c(),i("td",{key:`${v}-${L}`,class:"capitalize px-2 py-2 text-center border-b border-r"},y(u[D]===""?"â€”":u[D]),1))),128))]))),128))])])])]),d(j,{condition:e(a),cancelReportGeneration:()=>e(k)()},null,8,["condition","cancelReportGeneration"]),e(l).length==0&&!e(a)?(c(),i("div",Ae,o[4]||(o[4]=[t("img",{src:X,class:"w-20 h-20 object-cover",alt:"page-icon"},null,-1),t("p",null,[g(" Please generate report data to preview the "),t("span",{class:"font-medium"},y("whonet")),g(" report. ")],-1)]))):z("",!0)])])}}});export{He as default};
