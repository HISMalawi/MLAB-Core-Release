import{_ as D}from"./BBiETNY7.js";import{a as q,P as c,u as m,l as $,m as v,b as _,e as h,f as r,g as e,t as a,p as N,F as O,j as U,i as P,v as j,s as A,_ as R}from"./Br_iYJbE.js";import{_ as C,a as B}from"./D3FUxWgY.js";import{u as F}from"./C7tJ_rpQ.js";import{d as b,e as y}from"./D_g9DqRP.js";import{S as f}from"./CtCsDpHC.js";import{h as x}from"./Dog3sDT3.js";import{P as M}from"./CsuZ4PXZ.js";import{r as T}from"./CK1ibRi0.js";import{r as Q}from"./BSk7cgnm.js";import{r as H}from"./DG7tqCU3.js";import{r as K}from"./Brj7ygpg.js";import{r as L}from"./2u3kVXwJ.js";import{_ as E}from"./IQzdcCmk.js";import"./C3HP_w3b.js";import"./CsEX3TnJ.js";import"./BWngzJgz.js";import"./BoyxTlis.js";import"./AtAlRHB5.js";import"./a0kEX_gA.js";import"./2-4F2Czp.js";import"./BIfGgD6z.js";import"./tiZpgdZ8.js";import"./BxXqpYSD.js";import"./CKyme56o.js";const z={setup(){F({title:`${M.name.toUpperCase()} - Approve Stock Order`})},components:{TicketIcon:T},data(){return{header:"Approve Stock Order",checkIcon:Q,allIcon:H,rejectIcon:K,pages:[{name:"Home",link:"/home"},{name:"Stock Orders",link:"/stock-management/orders"}],cookie:q("token"),deleteicon:L,loading:!1,approving:!1,verifying:!1,requisitions:new Array,voidReason:"",issuerName:"",issuerDesignation:"",issuerPhone:"",issuerSignature:"",approverName:"",approverDesignation:"",approverPhone:"",approverSignature:"",issuedDate:"",approvedDate:""}},created(){this.init()},methods:{async init(){this.loading=!0;const s=new f,{data:i,error:d,pending:n}=await s.getStockOrder(`${this.cookie}`,`${(this._.provides[c]||this.$route).query.order_id}`);this.loading=n,i.value&&(this.requisitions=i.value.stock_requisitions,this.loading=!1,i.value.stock_pharmacy_approver_and_issuers.map(o=>{o.record_type=="issuer"?(this.issuerName=o.name,this.issuerPhone=o.phone_number,this.issuerDesignation=o.designation,this.issuerSignature=o.signature,this.issuedDate=x(o.created_date).format(b)):(this.approverName=o.name,this.approverPhone=o.phone_number,this.approverDesignation=o.designation,this.approverSignature=o.signature,this.approvedDate=x(o.created_date).format(b))})),d.value&&(console.error(d.value),this.loading=!1)},async approveStockOrder(){this.approving=!0;const s=new f;let i=this.requisitions.map(p=>p.id);const{data:d,error:n,pending:o}=await s.approveStockOrder(`${this.cookie}`,{stock_order_id:`${(this._.provides[c]||this.$route).query.order_id}`,stock_requisition_ids:i});this.approving=o,d.value&&(this.approving=!1,this.$router.push("/stock-management/orders"),m().$toast.success(`Stock order request #${(this._.provides[c]||this.$route).params.voucherId} approved successfully`)),n.value&&(console.error(n.value),m().$toast.error(y),this.approving=!1)},async approveRequisition(s){this.loading=!0;const i=new f,{data:d,error:n,pending:o}=await i.approveStockOrderRequisition(`${this.cookie}`,{stock_requisition_id:s});this.loading=o,d.value&&(this.loading=!1,m().$toast.success("Stock order requisition approved successfully")),n.value&&(console.error(n.value),m().$toast.error(y),this.loading=!1)}}},G={class:"px-5 py-5"},J={class:"py-5 flex items-center justify-between"},W={class:"text-2xl font-semibold"},X={class:"px-4 py-2 bg-gray-50 flex items-center justify-between"},Y={class:"flex items-center space-x-2"},Z={class:"flex items-center space-x-3 justify-end"},ee={class:"rounded border mt-5"},oe=e("div",{class:"flex items-center space-x-3 bg-gray-50 py-2 rounded-t px-2 border-b"},[e("img",{src:E,class:"w-6 h-6"}),e("h3",{class:"text-lg font-semibold"},"Pharmacy")],-1),se={class:"w-full grid grid-cols-2 gap-5 py-5 px-5"},te={class:"col-span-1 flex flex-col space-y-2"},re={class:"w-full flex items-center space-x-2"},ae=e("p",{class:"w-72 font-medium"},"Issued by: ",-1),ie={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ne={class:"w-full flex items-center space-x-2"},de=e("p",{class:"w-72 font-medium"},"Designation: ",-1),le={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ce={class:"w-full flex items-center space-x-2"},pe=e("p",{class:"w-72 font-medium"},"Signature: ",-1),ue={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},me={class:"w-full flex items-center space-x-2"},_e=e("p",{class:"w-72 font-medium"},"Date:",-1),he={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},fe={class:"col-span-1 flex flex-col space-y-2"},ge={class:"w-full flex items-center space-x-2"},ve=e("p",{class:"w-72 font-medium"},"Approved by: ",-1),be={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ye={class:"w-full flex items-center space-x-2"},xe=e("p",{class:"w-72 font-medium"},"Designation: ",-1),ke={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},we={class:"w-full flex items-center space-x-2"},Se=e("p",{class:"w-72 font-medium"},"Signature: ",-1),Ve={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Ie={class:"w-full flex items-center space-x-2"},De=e("p",{class:"w-72 font-medium"},"Date:",-1),qe={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},$e={key:0,class:"grid grid-cols-5 gap-4 mt-5"},Ne={class:"flex flex-col space-y-2"},Oe={class:"flex items-center space-x-2 pt-8"};function Ue(s,i,d,n,o,p){const k=D,w=v("TicketIcon"),g=R,S=C,u=v("FormKit"),V=B;return _(),h("div",G,[r(k,{pages:o.pages},null,8,["pages"]),e("div",J,[e("h3",W,a(o.header),1)]),e("div",X,[e("div",Y,[r(w,{class:"h-5 w-5"}),e("p",null,[N("Voucher Number: "),e("strong",null,a((s._.provides[c]||s.$route).params.voucherId),1)])]),e("div",Z,[r(g,{loading:o.approving,icon:o.allIcon,text:"Approve Order",color:"success",click:p.approveStockOrder},null,8,["loading","icon","click"]),r(S,{stockId:`${(s._.provides[c]||s.$route).query.order_id}`,orderId:`${(s._.provides[c]||s.$route).params.voucherId}`},null,8,["stockId","orderId"])])]),e("div",ee,[oe,e("div",se,[e("div",te,[e("div",re,[ae,e("span",ie,a(o.issuerName),1)]),e("div",ne,[de,e("span",le,a(o.issuerDesignation),1)]),e("div",ce,[pe,e("span",ue,a(o.issuerSignature),1)]),e("div",me,[_e,e("span",he,a(o.issuedDate),1)])]),e("div",fe,[e("div",ge,[ve,e("span",be,a(o.approverName),1)]),e("div",ye,[xe,e("span",ke,a(o.approverDesignation),1)]),e("div",we,[Se,e("span",Ve,a(o.issuerSignature),1)]),e("div",Ie,[De,e("span",qe,a(o.approvedDate),1)])])])]),(_(!0),h(O,null,U(o.requisitions,(t,I)=>P((_(),h("div",{class:"flex flex-col space-y-3",key:I},[t.requisition_status.toLowerCase()!=="rejected"?(_(),h("div",$e,[e("div",Ne,[r(u,{label:"Stock item",disabled:!0,modelValue:t.item.name,"onUpdate:modelValue":l=>t.item.name=l},null,8,["modelValue","onUpdate:modelValue"])]),r(u,{label:"Quantity requested",type:"number",disabled:!0,modelValue:t.quantity_requested,"onUpdate:modelValue":l=>t.quantity_requested=l},null,8,["modelValue","onUpdate:modelValue"]),r(u,{label:"Quantity issued",type:"number",disabled:!0,modelValue:t.quantity_issued,"onUpdate:modelValue":l=>t.quantity_issued=l},null,8,["modelValue","onUpdate:modelValue"]),r(u,{label:"Quantity collected",type:"number",disabled:!0,modelValue:t.quantity_collected,"onUpdate:modelValue":l=>t.quantity_collected=l},null,8,["modelValue","onUpdate:modelValue"]),e("div",Oe,[r(g,{text:"Approve",icon:o.checkIcon,color:"success",click:()=>{p.approveRequisition(t.id)}},null,8,["icon","click"]),r(V,{onUpdate:p.init,data:t,orderId:`${(s._.provides[c]||s.$route).params.voucherId}`},null,8,["onUpdate","data","orderId"])])])):A("",!0)])),[[j,!o.loading]])),128))])}const ro=$(z,[["render",Ue]]);export{ro as default};
