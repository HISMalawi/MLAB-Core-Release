import{d as Q,e as W}from"./BughWnsJ.js";import{d as C,r as R,c as m,b9 as D,b4 as G,b5 as J,b6 as X,a8 as x,b7 as Y,b8 as Z,ba as B,o as M,w as H,a9 as z,aa as _,ab as $,ac as ee,ad as E,ae as te,F as le,a6 as F,bb as ae,bc as U,au as oe,aH as ne,a7 as ie,bg as ue,av as S,af as b,am as V}from"./DV-4n8jq.js";import{s as se}from"./JsFzH7BX.js";import{f as re,c as O,p as de,u as ve}from"./FoxSJF9V.js";function pe(t,f){return t===f}var ce=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(ce||{}),be=(t=>(t[t.Single=0]="Single",t[t.Multi=1]="Multi",t))(be||{}),fe=(t=>(t[t.Pointer=0]="Pointer",t[t.Other=1]="Other",t))(fe||{});function me(t){requestAnimationFrame(()=>requestAnimationFrame(t))}let K=Symbol("ListboxContext");function j(t){let f=ie(K,null);if(f===null){let y=new Error(`<${t} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(y,j),y}return f}let Se=C({name:"Listbox",emits:{"update:modelValue":t=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>pe},horizontal:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(t,{slots:f,attrs:y,emit:h}){let s=R(1),r=R(null),e=R(null),v=R(null),d=R([]),p=R(""),c=R(null),a=R(1);function n(l=o=>o){let o=c.value!==null?d.value[c.value]:null,i=ue(l(d.value.slice()),g=>x(g.dataRef.domRef)),u=o?i.indexOf(o):null;return u===-1&&(u=null),{options:i,activeOptionIndex:u}}let w=m(()=>t.multiple?1:0),[P,L]=Q(m(()=>t.modelValue),l=>h("update:modelValue",l),m(()=>t.defaultValue)),T=m(()=>P.value===void 0?D(w.value,{1:[],0:void 0}):P.value),k={listboxState:s,value:T,mode:w,compare(l,o){if(typeof t.by=="string"){let i=t.by;return(l==null?void 0:l[i])===(o==null?void 0:o[i])}return t.by(l,o)},orientation:m(()=>t.horizontal?"horizontal":"vertical"),labelRef:r,buttonRef:e,optionsRef:v,disabled:m(()=>t.disabled),options:d,searchQuery:p,activeOptionIndex:c,activationTrigger:a,closeListbox(){t.disabled||s.value!==1&&(s.value=1,c.value=null)},openListbox(){t.disabled||s.value!==0&&(s.value=0)},goToOption(l,o,i){if(t.disabled||s.value===1)return;let u=n(),g=re(l===O.Specific?{focus:O.Specific,id:o}:{focus:l},{resolveItems:()=>u.options,resolveActiveIndex:()=>u.activeOptionIndex,resolveId:A=>A.id,resolveDisabled:A=>A.dataRef.disabled});p.value="",c.value=g,a.value=i??1,d.value=u.options},search(l){if(t.disabled||s.value===1)return;let o=p.value!==""?0:1;p.value+=l.toLowerCase();let i=(c.value!==null?d.value.slice(c.value+o).concat(d.value.slice(0,c.value+o)):d.value).find(g=>g.dataRef.textValue.startsWith(p.value)&&!g.dataRef.disabled),u=i?d.value.indexOf(i):-1;u===-1||u===c.value||(c.value=u,a.value=1)},clearSearch(){t.disabled||s.value!==1&&p.value!==""&&(p.value="")},registerOption(l,o){let i=n(u=>[...u,{id:l,dataRef:o}]);d.value=i.options,c.value=i.activeOptionIndex},unregisterOption(l){let o=n(i=>{let u=i.findIndex(g=>g.id===l);return u!==-1&&i.splice(u,1),i});d.value=o.options,c.value=o.activeOptionIndex,a.value=1},theirOnChange(l){t.disabled||L(l)},select(l){t.disabled||L(D(w.value,{0:()=>l,1:()=>{let o=S(k.value.value).slice(),i=S(l),u=o.findIndex(g=>k.compare(i,S(g)));return u===-1?o.push(i):o.splice(u,1),o}}))}};G([e,v],(l,o)=>{var i;k.closeListbox(),J(o,X.Loose)||(l.preventDefault(),(i=x(e))==null||i.focus())},m(()=>s.value===0)),Y(K,k),Z(m(()=>D(s.value,{0:B.Open,1:B.Closed})));let I=m(()=>{var l;return(l=x(e))==null?void 0:l.closest("form")});return M(()=>{H([I],()=>{if(!I.value||t.defaultValue===void 0)return;function l(){k.theirOnChange(t.defaultValue)}return I.value.addEventListener("reset",l),()=>{var o;(o=I.value)==null||o.removeEventListener("reset",l)}},{immediate:!0})}),()=>{let{name:l,modelValue:o,disabled:i,form:u,...g}=t,A={open:s.value===0,disabled:i,value:T.value};return z(le,[...l!=null&&T.value!=null?W({[l]:T.value}).map(([N,q])=>z(_,$({features:ee.Hidden,key:N,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:u,disabled:i,name:N,value:q}))):[],E({ourProps:{},theirProps:{...y,...te(g,["defaultValue","onUpdate:modelValue","horizontal","multiple","by"])},slot:A,slots:f,attrs:y,name:"Listbox"})])}}}),he=C({name:"ListboxLabel",props:{as:{type:[Object,String],default:"label"},id:{type:String,default:null}},setup(t,{attrs:f,slots:y}){var h;let s=(h=t.id)!=null?h:`headlessui-listbox-label-${F()}`,r=j("ListboxLabel");function e(){var v;(v=x(r.buttonRef))==null||v.focus({preventScroll:!0})}return()=>{let v={open:r.listboxState.value===0,disabled:r.disabled.value},{...d}=t,p={id:s,ref:r.labelRef,onClick:e};return E({ourProps:p,theirProps:d,slot:v,attrs:f,slots:y,name:"ListboxLabel"})}}}),Le=C({name:"ListboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(t,{attrs:f,slots:y,expose:h}){var s;let r=(s=t.id)!=null?s:`headlessui-listbox-button-${F()}`,e=j("ListboxButton");h({el:e.buttonRef,$el:e.buttonRef});function v(a){switch(a.key){case b.Space:case b.Enter:case b.ArrowDown:a.preventDefault(),e.openListbox(),V(()=>{var n;(n=x(e.optionsRef))==null||n.focus({preventScroll:!0}),e.value.value||e.goToOption(O.First)});break;case b.ArrowUp:a.preventDefault(),e.openListbox(),V(()=>{var n;(n=x(e.optionsRef))==null||n.focus({preventScroll:!0}),e.value.value||e.goToOption(O.Last)});break}}function d(a){switch(a.key){case b.Space:a.preventDefault();break}}function p(a){e.disabled.value||(e.listboxState.value===0?(e.closeListbox(),V(()=>{var n;return(n=x(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})})):(a.preventDefault(),e.openListbox(),me(()=>{var n;return(n=x(e.optionsRef))==null?void 0:n.focus({preventScroll:!0})})))}let c=se(m(()=>({as:t.as,type:f.type})),e.buttonRef);return()=>{var a,n;let w={open:e.listboxState.value===0,disabled:e.disabled.value,value:e.value.value},{...P}=t,L={ref:e.buttonRef,id:r,type:c.value,"aria-haspopup":"listbox","aria-controls":(a=x(e.optionsRef))==null?void 0:a.id,"aria-expanded":e.listboxState.value===0,"aria-labelledby":e.labelRef.value?[(n=x(e.labelRef))==null?void 0:n.id,r].join(" "):void 0,disabled:e.disabled.value===!0?!0:void 0,onKeydown:v,onKeyup:d,onClick:p};return E({ourProps:L,theirProps:P,slot:w,attrs:f,slots:y,name:"ListboxButton"})}}}),Re=C({name:"ListboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(t,{attrs:f,slots:y,expose:h}){var s;let r=(s=t.id)!=null?s:`headlessui-listbox-options-${F()}`,e=j("ListboxOptions"),v=R(null);h({el:e.optionsRef,$el:e.optionsRef});function d(a){switch(v.value&&clearTimeout(v.value),a.key){case b.Space:if(e.searchQuery.value!=="")return a.preventDefault(),a.stopPropagation(),e.search(a.key);case b.Enter:if(a.preventDefault(),a.stopPropagation(),e.activeOptionIndex.value!==null){let n=e.options.value[e.activeOptionIndex.value];e.select(n.dataRef.value)}e.mode.value===0&&(e.closeListbox(),V(()=>{var n;return(n=x(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})}));break;case D(e.orientation.value,{vertical:b.ArrowDown,horizontal:b.ArrowRight}):return a.preventDefault(),a.stopPropagation(),e.goToOption(O.Next);case D(e.orientation.value,{vertical:b.ArrowUp,horizontal:b.ArrowLeft}):return a.preventDefault(),a.stopPropagation(),e.goToOption(O.Previous);case b.Home:case b.PageUp:return a.preventDefault(),a.stopPropagation(),e.goToOption(O.First);case b.End:case b.PageDown:return a.preventDefault(),a.stopPropagation(),e.goToOption(O.Last);case b.Escape:a.preventDefault(),a.stopPropagation(),e.closeListbox(),V(()=>{var n;return(n=x(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})});break;case b.Tab:a.preventDefault(),a.stopPropagation();break;default:a.key.length===1&&(e.search(a.key),v.value=setTimeout(()=>e.clearSearch(),350));break}}let p=ae(),c=m(()=>p!==null?(p.value&B.Open)===B.Open:e.listboxState.value===0);return()=>{var a,n;let w={open:e.listboxState.value===0},{...P}=t,L={"aria-activedescendant":e.activeOptionIndex.value===null||(a=e.options.value[e.activeOptionIndex.value])==null?void 0:a.id,"aria-multiselectable":e.mode.value===1?!0:void 0,"aria-labelledby":(n=x(e.buttonRef))==null?void 0:n.id,"aria-orientation":e.orientation.value,id:r,onKeydown:d,role:"listbox",tabIndex:0,ref:e.optionsRef};return E({ourProps:L,theirProps:P,slot:w,attrs:f,slots:y,features:U.RenderStrategy|U.Static,visible:c.value,name:"ListboxOptions"})}}}),we=C({name:"ListboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(t,{slots:f,attrs:y,expose:h}){var s;let r=(s=t.id)!=null?s:`headlessui-listbox-option-${F()}`,e=j("ListboxOption"),v=R(null);h({el:v,$el:v});let d=m(()=>e.activeOptionIndex.value!==null?e.options.value[e.activeOptionIndex.value].id===r:!1),p=m(()=>D(e.mode.value,{0:()=>e.compare(S(e.value.value),S(t.value)),1:()=>S(e.value.value).some(l=>e.compare(S(l),S(t.value)))})),c=m(()=>D(e.mode.value,{1:()=>{var l;let o=S(e.value.value);return((l=e.options.value.find(i=>o.some(u=>e.compare(S(u),S(i.dataRef.value)))))==null?void 0:l.id)===r},0:()=>p.value})),a=de(v),n=m(()=>({disabled:t.disabled,value:t.value,get textValue(){return a()},domRef:v}));M(()=>e.registerOption(r,n)),oe(()=>e.unregisterOption(r)),M(()=>{H([e.listboxState,p],()=>{e.listboxState.value===0&&p.value&&D(e.mode.value,{1:()=>{c.value&&e.goToOption(O.Specific,r)},0:()=>{e.goToOption(O.Specific,r)}})},{immediate:!0})}),ne(()=>{e.listboxState.value===0&&d.value&&e.activationTrigger.value!==0&&V(()=>{var l,o;return(o=(l=x(v))==null?void 0:l.scrollIntoView)==null?void 0:o.call(l,{block:"nearest"})})});function w(l){if(t.disabled)return l.preventDefault();e.select(t.value),e.mode.value===0&&(e.closeListbox(),V(()=>{var o;return(o=x(e.buttonRef))==null?void 0:o.focus({preventScroll:!0})}))}function P(){if(t.disabled)return e.goToOption(O.Nothing);e.goToOption(O.Specific,r)}let L=ve();function T(l){L.update(l)}function k(l){L.wasMoved(l)&&(t.disabled||d.value||e.goToOption(O.Specific,r,0))}function I(l){L.wasMoved(l)&&(t.disabled||d.value&&e.goToOption(O.Nothing))}return()=>{let{disabled:l}=t,o={active:d.value,selected:p.value,disabled:l},{value:i,disabled:u,...g}=t,A={id:r,ref:v,role:"option",tabIndex:l===!0?void 0:-1,"aria-disabled":l===!0?!0:void 0,"aria-selected":p.value,disabled:void 0,onClick:w,onFocus:P,onPointerenter:T,onMouseenter:T,onPointermove:k,onMousemove:k,onPointerleave:I,onMouseleave:I};return E({ourProps:A,theirProps:g,slot:o,attrs:y,slots:f,name:"ListboxOption"})}}});export{Re as A,he as E,we as F,Se as I,Le as j};
