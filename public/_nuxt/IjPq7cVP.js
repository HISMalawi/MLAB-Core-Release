import{_ as ge}from"./Cjy89chx.js";import{b as F,e as P,g as t,d as Y,u as Z,r as s,a as J,x as R,f as o,h as e,y as r,Y as W,p as H,G as ee,V as se,j as G,q as ne,A as I,H as ae,C as Q,S as te,E as re,D as fe,_ as ie,n as ve,at as me,J as ke,t as q,F as be,k as we,s as he,o as Ce,z as $e,X as Se}from"./Dq6GAKbi.js";import{_ as _e}from"./CmfTMOIT.js";import{_ as ye}from"./aL3Laz_N.js";import{_ as ce}from"./DSfYjN7g.js";import{_ as de}from"./PHlxz6BT.js";import{S as A}from"./zpTkBSNp.js";import{r as pe}from"./BxpGzns0.js";import{r as xe}from"./D5QMWYSq.js";import{r as ue}from"./CyEda1vY.js";import{a as Ve,_ as Me}from"./hslKxxJB.js";import{_ as Ue}from"./B75xAycs.js";import{r as De}from"./BqtKM9rz.js";import{r as Ie}from"./HOxJZgwd.js";import{r as Fe}from"./Br9Nyai2.js";import{_ as Be}from"./DwzG69rt.js";import{P as je}from"./Cym2IAMG.js";import{u as Le}from"./B-asOVRT.js";import{u as Te}from"./DausA3Fa.js";import"./CCv5i2WQ.js";import"./E1BQBXOe.js";import"./DD5ohXvj.js";import"./V6O_Nsr-.js";import"./Bzq-bUMT.js";import"./B9U-_Lex.js";import"./B0f6nJlG.js";import"./FeIzrERn.js";import"./cn4mwiMo.js";function Pe(O,m){return F(),P("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 1 1-16 0 8 8 0 0 1 16 0Zm-7-4a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM9 9a.75.75 0 0 0 0 1.5h.253a.25.25 0 0 1 .244.304l-.459 2.066A1.75 1.75 0 0 0 10.747 15H11a.75.75 0 0 0 0-1.5h-.253a.25.25 0 0 1-.244-.304l.459-2.066A1.75 1.75 0 0 0 9.253 9H9Z","clip-rule":"evenodd"})])}const Ee={class:"fixed inset-0 overflow-y-auto"},qe={class:"flex min-h-full items-center justify-center p-4 text-center"},Ae={class:"border-b px-3 py-3 flex items-center justify-between"},Oe={class:"mt-2 space-y-3 px-5"},ze={class:"flex items-center"},Re={class:"flex items-center space-x-2 pt-8 ml-3"},He={class:"bg-white"},Ke={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},Ne=Y({__name:"index",emits:["update"],setup(O,{emit:m}){const x=m,{$toast:v}=Z(),d=s(!1),_=s(!1),u=s(""),V=s(""),g=s(""),y=J("token"),i=s([]),C=s([]),b=s(""),h=s(0),B=s([]),T=s([]),M=s([]),$=s({name:"-- selected location --",id:0}),U=s(""),z=s(""),j=s(0),oe=async()=>{const S=new A,{data:a,error:p}=await S.getStockCategory(`${y.value}`);a.value&&(i.value=a.value,C.value=a.value.map(l=>l.name)),p.value&&console.error(p.value)},N=async()=>{const S=new A,{data:a,error:p}=await S.getStockUnit(`${y.value}`);a.value&&(B.value=a.value,T.value=a.value.map(l=>l.name)),p.value&&console.error(p.value)},le=async()=>{const S=new A,{data:a,error:p}=await S.getStockLocation(`${y.value}`);a.value&&(M.value=a.value),p.value&&console.error(p.value)},k=async()=>{await oe(),await N(),await le(),w()},c=async()=>{_.value=!0;const S=new A,a={name:u.value,product_ccode:V.value,description:g.value,stock_location_id:$.value.id,stock_category_id:i.value.filter(f=>f.name===b.value)[0].id,measurement_unit:B.value.filter(f=>f.name===U.value)[0].id,quantity_unit:h.value,strength:z.value,minimum_order_level:j.value},{pending:p,error:l,data:n}=await S.createStockItem(`${y.value}`,a);_.value=p,n.value&&(w(),v.success(`${u.value} stock item created successfully!`),_.value=!1,g.value="",u.value="",h.value=0,x("update",!0)),l.value&&(w(),console.error(l.value),v.error(re),_.value=!1)},w=()=>{d.value=!d.value},E=()=>{fe("submitForm")};return(S,a)=>{const p=ie,l=R("FormKit"),n=_e,f=ye,K=ce;return F(),P("div",null,[t("div",null,[o(p,{text:"Create stock item",color:"primary",icon:e(pe),click:k},null,8,["icon"])]),o(e(te),{appear:"",show:e(d),as:"template"},{default:r(()=>[o(e(W),{as:"div",onClose:w,class:"relative z-10"},{default:r(()=>[o(e(H),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:r(()=>a[9]||(a[9]=[t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),t("div",Ee,[t("div",qe,[o(e(H),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:r(()=>[o(e(ee),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:r(()=>[t("div",Ae,[o(e(se),{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:r(()=>a[10]||(a[10]=[t("img",{src:de,class:"w-8 h-8 mr-2",alt:"stock-item-svg"},null,-1),G(" Create Stock Item ")])),_:1}),t("button",{onClick:w},[o(e(ne),{class:"w-5 h-5"})])]),o(l,{ref:"formkit",type:"form","submit-label":"Update",onSubmit:c,actions:!1,id:"submitForm"},{default:r(({value:X})=>[t("div",Oe,[o(l,{type:"text",label:"Name",validation:"required",modelValue:e(u),"onUpdate:modelValue":a[0]||(a[0]=D=>I(u)?u.value=D:null)},null,8,["modelValue"]),o(l,{type:"text",label:"Product code",modelValue:e(V),"onUpdate:modelValue":a[1]||(a[1]=D=>I(V)?V.value=D:null)},null,8,["modelValue"]),o(l,{type:"textarea",label:"Description",validation:"required",modelValue:e(g),"onUpdate:modelValue":a[2]||(a[2]=D=>I(g)?g.value=D:null)},null,8,["modelValue"]),t("div",ze,[o(n,{mode:"single","items-selected":e(U),"onUpdate:itemsSelected":a[3]||(a[3]=D=>I(U)?U.value=D:null),label:"Measurement Unit",items:e(T)},null,8,["items-selected","items"]),t("div",Re,[e(U)==""?(F(),ae(p,{key:0,icon:e(pe),color:"primary",text:"Add",click:()=>{S.$router.push("/stock-management/metrics")}},null,8,["icon","click"])):Q("",!0),e(U)!=""?(F(),ae(p,{key:1,icon:e(xe),color:"success",text:"Edit",click:()=>{S.$router.push("/stock-management/metrics")}},null,8,["icon","click"])):Q("",!0)])]),o(l,{type:"number",label:"Quantity of measurement",validation:"required",modelValue:e(h),"onUpdate:modelValue":a[4]||(a[4]=D=>I(h)?h.value=D:null)},null,8,["modelValue"]),t("div",He,[o(n,{mode:"single",label:"Category",items:e(C),"items-selected":e(b),"onUpdate:itemsSelected":a[5]||(a[5]=D=>I(b)?b.value=D:null)},null,8,["items","items-selected"])]),t("div",null,[a[11]||(a[11]=t("label",{class:"font-medium mb-2.5 text-lg"},"Location",-1)),o(f,{items:e(M),modelValue:e($),"onUpdate:modelValue":a[6]||(a[6]=D=>I($)?$.value=D:null)},null,8,["items","modelValue"])]),o(l,{type:"text",label:"Strength",modelValue:e(z),"onUpdate:modelValue":a[7]||(a[7]=D=>I(z)?z.value=D:null)},null,8,["modelValue"]),o(l,{type:"number",label:"Minimum order level",validation:"required",modelValue:e(j),"onUpdate:modelValue":a[8]||(a[8]=D=>I(j)?j.value=D:null)},null,8,["modelValue"])]),t("div",Ke,[o(K,{type:"button",click:()=>{E()},text:"Clear form"},null,8,["click"]),o(p,{loading:e(_),type:"submit",click:()=>{},color:"success",icon:e(ue),text:"Save changes"},null,8,["loading","icon"])])]),_:1},512)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),Ge={class:"fixed inset-0 overflow-y-auto top-0"},Qe={class:"flex min-h-full items-start justify-end top-0 p-4 text-center"},Xe={class:"flex items-center space-x-2"},Ze=Y({__name:"ImportingDialog",setup(O,{expose:m}){const x=s(!1);function v(){x.value=!1}function d(){x.value=!0}return m({openModal:d,closeModal:v}),(_,u)=>{const V=ve;return F(),ae(e(te),{appear:"",show:e(x),as:"template"},{default:r(()=>[o(e(W),{as:"div",onClose:v,class:"relative z-10"},{default:r(()=>[o(e(H),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:r(()=>u[0]||(u[0]=[t("div",{class:"fixed inset-0 bg-black bg-opacity-50"},null,-1)])),_:1}),t("div",Ge,[t("div",Qe,[o(e(H),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:r(()=>[o(e(ee),{class:"w-full max-w-md transform overflow-hidden rounded bg-white p-6 text-left align-middle shadow-xl transition-all"},{default:r(()=>[t("div",Xe,[o(V),u[1]||(u[1]=t("div",null,[t("h3",{class:"text-xl font-semibold"},"Importing"),t("p",{class:"text-gray-500"}," Please wait patiently, it may take 1-4 minutes to successfully import all the products ")],-1))])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])}}}),Ye={class:"fixed inset-0 overflow-y-auto"},Je={class:"flex min-h-full items-center justify-center p-4 text-center"},We={class:"border-b px-3 py-3 flex items-center justify-between"},et={class:"w-full px-5 py-5"},tt={class:""},ot={class:"mb-2"},lt={key:0,class:"mt-4"},at={class:"list-disc pl-5 text-sky-500"},st={key:1,class:"mt-4 flex items-start text-red-500 bg-red-50 rounded p-4"},nt={class:"text-base"},it={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},rt=Y({__name:"index",emits:["update"],setup(O,{emit:m}){const x=m,v=s(!1),d=s(!1),_=s(!1),u=s([]),V=new A,{$toast:g}=Z(),y=s(null),i=s(null),C=J("token"),b=["productCode","name","description","categoryDescription","packRoundingThreshold","packSize","roundToZero","dispensable","program","dosesPerPatient","active","category","fullSupply","displayOrder","pricePerPack"],h=k=>{_.value=!0},B=k=>{_.value=!1},T=k=>{_.value=!1;const c=k.dataTransfer.files;$(c)},M=k=>{const c=k.target;if(c.files){const w=c.files;$(w)}},$=k=>{var c;if(k.length>0){const w=k[0];((c=w.name.split(".").pop())==null?void 0:c.toLowerCase())==="csv"?(u.value=[w],z(w)):g.error("Please select a CSV file")}},U=k=>{if(k===0)return"0 Bytes";const c=1024,w=["Bytes","KB","MB","GB","TB"],E=Math.floor(Math.log(k)/Math.log(c));return parseFloat((k/Math.pow(c,E)).toFixed(2))+" "+w[E]},z=k=>{const c=new FileReader;c.onload=w=>{var l;const S=((l=w.target)==null?void 0:l.result).split(`
`)[0].split(",").map(n=>n.trim()),a=b.filter(n=>!S.includes(n)),p=S.filter(n=>!b.includes(n));if(a.length>0||p.length>0){let n=`CSV headers do not match the expected format.
`;a.length>0&&(n+=`Missing headers: ${a.join(", ")}
`),n+="Please check your file and ensure it matches the required format.",i.value=n}else i.value=null},c.readAsText(k)},j=()=>{u.value=[],i.value=null},oe=()=>{j()},N=()=>{v.value=!v.value},le=async()=>{var S,a,p;d.value=!0,(S=y.value)==null||S.openModal();const k=new FormData;k.append("file",u.value[0]);const{data:c,error:w,pending:E}=await V.importStockItems(String(C.value),k);d.value=E,c.value&&(d.value=!1,(a=y.value)==null||a.closeModal(),g.success("Products imported as stock items successfully"),x("update",!0)),w.value&&(console.error(w.value),d.value=!1,(p=y.value)==null||p.closeModal(),g.error(re)),N()};return(k,c)=>{const w=Ze,E=Me,S=ce,a=ie,p=R("FormKit");return F(),P("div",null,[t("div",null,[o(w,{ref_key:"importDialog",ref:y},null,512),o(E,{onClick:N,text:"Import OpenMLMIS Products"})]),o(e(te),{appear:"",show:e(v),as:"template"},{default:r(()=>[o(e(W),{as:"div",onClose:N,class:"relative z-10"},{default:r(()=>[o(e(H),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:r(()=>c[6]||(c[6]=[t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),t("div",Ye,[t("div",Je,[o(e(H),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:r(()=>[o(e(ee),{class:"w-full max-w-2xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:r(()=>[t("div",We,[o(e(se),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:r(()=>c[7]||(c[7]=[t("img",{src:Ve,class:"w-6 h-6 mr-2",alt:"excel-icon"},null,-1),G(" Import OpenMLMIS Products ")])),_:1}),t("button",{onClick:N},[o(e(ne),{class:"w-5 h-5"})])]),o(p,{type:"form","submit-label":"Update",actions:!1,onSubmit:c[5]||(c[5]=l=>le()),id:"submitForm"},{default:r(({value:l})=>[t("div",et,[t("div",tt,[t("div",{onDragover:c[2]||(c[2]=me(n=>h(n),["prevent"])),onDragleave:c[3]||(c[3]=n=>B(n)),onDrop:c[4]||(c[4]=me(n=>T(n),["prevent"])),class:ke(["border-2 border-dashed p-8 text-center cursor-pointer",e(_)?"border-sky-500 bg-sky-50":"border-gray-300"])},[t("input",{type:"file",ref:"fileInput",onChange:c[0]||(c[0]=n=>M(n)),class:"hidden",multiple:!1},null,544),t("p",ot,q(e(_)?"Drop files here":"Drag and drop csv file here"),1),t("button",{onClick:c[1]||(c[1]=n=>{var f,K;return(K=(f=k.$refs)==null?void 0:f.fileInput)==null?void 0:K.click()}),type:"button",class:"bg-sky-500 hover:bg-sky-600 rounded text-white font-normal py-1 px-4 border border-sky-500 hover:border-transparent"}," Select a CSV file ")],34),e(u).length>0?(F(),P("div",lt,[c[8]||(c[8]=t("h3",{class:"font-semibold mb-2"},"Selected File:",-1)),t("ul",at,[(F(!0),P(be,null,we(e(u),n=>(F(),P("li",{key:n.name},q(n.name)+" ("+q(U(n.size))+") ",1))),128))])])):Q("",!0),e(i)?(F(),P("div",st,[o(e(Pe),{class:"w-6 h-6 flex-shrink-0 text-red-500 mr-2"}),t("p",nt,q(e(i)),1)])):Q("",!0)])]),t("div",it,[o(S,{type:"button",click:()=>{oe()},text:"Clear form"},null,8,["click"]),o(a,{disabled:e(i)!==null,loading:e(d),type:"submit",click:()=>{},color:"success",icon:e(ue),text:"Save changes"},null,8,["disabled","loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),ct={class:"fixed inset-0 overflow-y-auto"},dt={class:"flex min-h-full items-center justify-center p-4 text-center"},ut={class:"border-b px-3 py-3 flex items-center justify-between"},mt={key:0,class:"flex flex-col space-y-2 items-center justify-center mx-auto my-20"},pt={key:1,class:"space-y-3 px-5 py-5"},ft={class:"w-full flex flex-col space-y-1"},vt={class:"w-full flex flex-col space-y-1"},_t={class:"w-full flex flex-col space-y-1"},yt={class:"w-full flex flex-col space-y-1"},xt={class:"w-full flex flex-col space-y-1"},gt={class:"w-full flex flex-col space-y-1"},kt=Y({__name:"index",props:{data:{type:Object,required:!0}},setup(O){const m=O,x=J("token"),v=s(!1),d=s(),_=new A,u=s(!1),V=async()=>{v.value=!0;const{data:y,error:i,pending:C}=await _.readStockItem(String(x.value),{id:m.data.id});v.value=C,y.value&&(d.value=y.value,v.value=!1),i.value&&(console.error(i.value),v.value=!1)},g=()=>{u.value=!u.value,u.value&&V()};return(y,i)=>{const C=ie,b=ve;return F(),P("div",null,[o(C,{click:()=>{g()},color:"primary",text:"View",icon:e(De)},null,8,["click","icon"]),o(e(te),{appear:"",show:e(u),as:"template"},{default:r(()=>[o(e(W),{as:"div",class:"relative z-10"},{default:r(()=>[o(e(H),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:r(()=>i[0]||(i[0]=[t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),t("div",ct,[t("div",dt,[o(e(H),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:r(()=>[o(e(ee),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:r(()=>{var h,B,T,M,$,U;return[t("div",ut,[o(e(se),{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:r(()=>i[1]||(i[1]=[t("img",{src:de,class:"w-8 h-8 mr-2"},null,-1),G(" View Stock Item ")])),_:1}),t("button",{onClick:g},[o(e(ne),{class:"w-5 h-5"})])]),e(v)?(F(),P("div",mt,[o(b,{loading:e(v)},null,8,["loading"]),i[2]||(i[2]=t("p",null,[G("Loading please wait "),t("span",{class:"animate-pulse"},"...")],-1))])):(F(),P("div",pt,[t("div",ft,[i[3]||(i[3]=t("label",{class:"font-semibold text-lg"},"Name",-1)),t("p",null,q((h=e(d))==null?void 0:h.name),1)]),t("div",vt,[i[4]||(i[4]=t("label",{class:"font-semibold text-lg"},"Description",-1)),t("p",null,q((B=e(d))==null?void 0:B.description),1)]),t("div",_t,[i[5]||(i[5]=t("label",{class:"font-semibold text-lg"},"OpenMLMIS Product Code",-1)),t("p",null,q((T=e(d))==null?void 0:T.product_code),1)]),t("div",yt,[i[6]||(i[6]=t("label",{class:"font-semibold text-lg"},"Measurement Unit",-1)),t("p",null,q((M=e(d))==null?void 0:M.stock_unit),1)]),t("div",xt,[i[7]||(i[7]=t("label",{class:"font-semibold text-lg"},"Category",-1)),t("p",null,q(($=e(d))==null?void 0:$.stock_category),1)]),t("div",gt,[i[8]||(i[8]=t("label",{class:"font-semibold text-lg"},"Location",-1)),t("p",null,q((U=e(d))==null?void 0:U.stock_location),1)])]))]}),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),bt={class:"fixed inset-0 overflow-y-auto"},wt={class:"flex min-h-full items-center justify-center p-4 text-center"},ht={class:"border-b px-3 py-3 flex items-center justify-between"},Ct={class:"mt-2 space-y-3 px-5"},$t={class:"flex items-center"},St={class:"bg-white"},Vt={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},Mt=Y({__name:"index",props:{data:{}},emits:["update"],setup(O,{emit:m}){const x=O,v=m,d=s(!1),_=s(!1),u=s(""),V=s(""),g=s(""),y=J("token"),i=s([]),C=s([]),b=s(""),h=s(0),B=s([]),T=s([]),M=s(""),$=s(""),U=s(0),z=s([]),j=s({name:"-- selected location --",id:0}),oe=xe,N=ue,le=async()=>{const p=new A,{data:l,error:n}=await p.getStockLocation(`${y.value}`);l.value&&(z.value=l.value,j.value=l.value.filter(f=>f.id==x.data.stock_location_id)[0]),n.value&&console.error(n.value)},k=async()=>{const p=new A,{data:l,error:n}=await p.getStockCategory(`${y.value}`);l.value&&(i.value=l.value,C.value=l.value.map(f=>f.name),b.value=i.value.filter(f=>f.id==x.data.stock_category_id)[0].name),n.value&&console.error(n.value)},c=async()=>{const p=new A,{data:l,error:n}=await p.getStockUnit(`${y.value}`);l.value&&(B.value=l.value,T.value=l.value.map(f=>f.name),M.value=B.value.filter(f=>f.id==x.data.measurement_unit)[0].name),n.value&&console.error(n.value)},w=async()=>{await k(),await c(),await le(),a(),u.value=x.data.name,g.value=x.data.description,$.value=x.data.strength,U.value=x.data.minimum_order_level},E=async()=>{_.value=!0;const p=new A,l={id:x.data.id,name:u.value,description:g.value,stock_location_id:j.value.id,stock_category_id:i.value.filter(X=>X.name===b.value)[0].id,measurement_unit:B.value.filter(X=>X.name===M.value)[0].id,quantity_unit:h.value,strength:$.value,minimum_order_level:U.value},{data:n,error:f,pending:K}=await p.updateStockItem(`${y.value}`,l);_.value=K,n.value&&(a(),Z().$toast.success(`${u.value} stock item updated successfully!`),_.value=!1,g.value="",u.value="",v("update",!0)),f.value&&(a(),console.error(f.value),Z().$toast.error(re),_.value=!1)},S=()=>{fe("editForm")},a=()=>{d.value=!d.value};return(p,l)=>{const n=ie,f=R("FormKit"),K=_e,X=ye,D=ce;return F(),P("div",null,[o(n,{click:()=>{w()},text:"Edit",color:"success",icon:e(oe)},null,8,["click","icon"]),o(e(te),{appear:"",show:e(d),as:"template"},{default:r(()=>[o(e(W),{as:"div",class:"relative z-10"},{default:r(()=>[o(e(H),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:r(()=>l[9]||(l[9]=[t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),t("div",bt,[t("div",wt,[o(e(H),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:r(()=>[o(e(ee),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:r(()=>[t("div",ht,[o(e(se),{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:r(()=>l[10]||(l[10]=[t("img",{src:de,class:"w-8 h-8 mr-2",alt:"stock-item-svg"},null,-1),G(" Edit Stock Item ")])),_:1}),t("button",{onClick:a},[o(e(ne),{class:"w-5 h-5"})])]),o(f,{type:"form",id:"editForm","submit-label":"Update",onSubmit:E,actions:!1},{default:r(({value:Nt})=>[t("div",Ct,[o(f,{type:"text",label:"Name",validation:"required",modelValue:e(u),"onUpdate:modelValue":l[0]||(l[0]=L=>I(u)?u.value=L:null)},null,8,["modelValue"]),o(f,{type:"text",label:"Product code",modelValue:e(V),"onUpdate:modelValue":l[1]||(l[1]=L=>I(V)?V.value=L:null)},null,8,["modelValue"]),o(f,{type:"textarea",label:"Description",validation:"required",modelValue:e(g),"onUpdate:modelValue":l[2]||(l[2]=L=>I(g)?g.value=L:null)},null,8,["modelValue"]),t("div",$t,[o(K,{mode:"single","items-selected":e(M),"onUpdate:itemsSelected":l[3]||(l[3]=L=>I(M)?M.value=L:null),label:"Measurement Unit",items:e(T)},null,8,["items-selected","items"])]),o(f,{type:"number",label:"Quantity of measurement",validation:"required",modelValue:e(h),"onUpdate:modelValue":l[4]||(l[4]=L=>I(h)?h.value=L:null)},null,8,["modelValue"]),t("div",St,[o(K,{mode:"single",label:"Category",items:e(C),"items-selected":e(b),"onUpdate:itemsSelected":l[5]||(l[5]=L=>I(b)?b.value=L:null)},null,8,["items","items-selected"])]),t("div",null,[l[11]||(l[11]=t("label",{class:"font-medium mb-2.5 text-lg"},"Location",-1)),o(X,{items:e(z),modelValue:e(j),"onUpdate:modelValue":l[6]||(l[6]=L=>I(j)?j.value=L:null)},null,8,["items","modelValue"])]),o(f,{type:"text",label:"Strength",modelValue:e($),"onUpdate:modelValue":l[7]||(l[7]=L=>I($)?$.value=L:null)},null,8,["modelValue"]),o(f,{type:"number",label:"Minimum order level",validation:"required",modelValue:e(U),"onUpdate:modelValue":l[8]||(l[8]=L=>I(U)?U.value=L:null)},null,8,["modelValue"])]),t("div",Vt,[o(D,{type:"button",click:()=>{S()},text:"Clear form"},null,8,["click"]),o(n,{loading:e(_),type:"submit",click:()=>{},color:"success",icon:e(N),text:"Save changes"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),Ut={components:{TransitionRoot:te,TransitionChild:H,Dialog:W,DialogPanel:ee,DialogTitle:se,XMarkIcon:ne,ExclamationTriangleIcon:Ie},data(){return{show:!1,deleteIcon:Fe,loading:!1,reason:"",cookie:J("token")}},props:{data:{type:Object,required:!0}},methods:{async voidStockSupplier(O){this.loading=!0;const m=new A,{data:x,error:v,pending:d}=await m.voidStockItem(`${this.cookie}`,{reason:this.reason,id:O});this.loading=d,x.value&&(this.handleClick(),Z().$toast.success("Stock item deleted successfully!"),this.loading=!1,this.reason="",this.$emit("update",!0)),v.value&&(console.error(v.value),Z().$toast.error(re),this.loading=!1)},handleClick(){this.show=!this.show}}},Dt={class:"fixed inset-0 overflow-y-auto"},It={class:"flex min-h-full items-center justify-center p-4 text-center"},Ft={class:"border-b px-3 py-3 flex items-center justify-between"},Bt={class:"mt-2 space-y-3 px-5"},jt={class:"rounded px-2 py-2"},Lt={class:"font-semibold text-red-500"},Tt={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Pt(O,m,x,v,d,_){const u=ie,V=R("TransitionChild"),g=R("ExclamationTriangleIcon"),y=R("DialogTitle"),i=R("XMarkIcon"),C=R("FormKit"),b=ce,h=R("DialogPanel"),B=R("Dialog"),T=R("TransitionRoot");return F(),P("div",null,[o(u,{click:_.handleClick,color:"error",text:"Delete",icon:d.deleteIcon},null,8,["click","icon"]),o(T,{appear:"",show:d.show,as:"template"},{default:r(()=>[o(B,{as:"div",class:"relative z-10"},{default:r(()=>[o(V,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:r(()=>m[3]||(m[3]=[t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),t("div",Dt,[t("div",It,[o(V,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:r(()=>[o(h,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:r(()=>[t("div",Ft,[o(y,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:r(()=>[o(g,{class:"h-5 w-5 mr-2"}),m[4]||(m[4]=G(" Confirm delete "))]),_:1}),t("button",{onClick:m[0]||(m[0]=(...M)=>_.handleClick&&_.handleClick(...M))},[o(i,{class:"w-5 h-5"})])]),o(C,{type:"form","submit-label":"Update",onSubmit:m[2]||(m[2]=M=>_.voidStockSupplier(x.data.id)),actions:!1},{default:r(({value:M})=>[t("div",Bt,[t("div",jt,[m[5]||(m[5]=G(" Do you really want to delete ")),t("span",Lt,q(x.data.name),1),m[6]||(m[6]=G("? Note that once this action is completed, it can not be undone "))]),o(C,{type:"textarea",label:"Reason",validation:"required",modelValue:d.reason,"onUpdate:modelValue":m[1]||(m[1]=$=>d.reason=$)},null,8,["modelValue"])]),t("div",Tt,[o(b,{click:()=>{_.handleClick()},type:"button",text:"Cancel"},null,8,["click"]),o(u,{loading:d.loading,type:"submit",click:()=>{},color:"error",icon:d.deleteIcon,text:"Delete"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const Et=he(Ut,[["render",Pt]]),qt={class:"px-5 py-5"},At={class:"flex items-center justify-between py-5"},Ot={class:"text-2xl font-semibold uppercase"},zt={key:0,class:"flex items-center space-x-3"},Rt={class:"flex items-center justify-end mt-3"},Ht={class:"mt-10"},Kt={class:"py-2 flex items-center space-x-2"},wo=Y({__name:"stock-items",setup(O){Le({title:`${je.name.toUpperCase()} - Stock Items`});const{can:m}=Te(),x=s("Stock Items"),v=s(!1),d=s(""),_=J("token"),u=s([]),V=s([{name:"Home",link:"/home"},{name:"Stock Management",link:"#"}]),g=[{text:"name",value:"name",sortable:!0},{text:"description",value:"description"},{text:"date modified",value:"updated_date"},{text:"actions",value:"actions"}];async function y(){v.value=!0;const i=new A,{data:C,error:b,pending:h}=await i.getStockItem(`${_.value}`);v.value=h,C.value&&(u.value=C.value.map(B=>({...B,updated_date:$e(B.updated_date).format(Se)})),v.value=!1),b.value&&(console.error(b.value),v.value=!1)}return Ce(()=>{y()}),(i,C)=>{const b=ge,h=Ne,B=rt,T=Ue,M=kt,$=Mt,U=Et,z=Be;return F(),P("div",qt,[o(b,{pages:e(V)},null,8,["pages"]),t("div",At,[t("h3",Ot,q(e(x)),1),e(m).manage("stock_management")?(F(),P("div",zt,[o(h,{onUpdate:y}),o(B,{onUpdate:y})])):Q("",!0)]),t("div",Rt,[o(T,{search:e(d),"onUpdate:search":C[0]||(C[0]=j=>I(d)?d.value=j:null)},null,8,["search"])]),t("div",Ht,[o(z,{"search-field":"name","search-value":e(d),headers:g,data:e(u),loading:e(v)},{actions:r(({item:j})=>[t("div",Kt,[o(M,{data:j,onUpdate:y},null,8,["data"]),e(m).manage("stock_management")?(F(),ae($,{key:0,data:j,onUpdate:y},null,8,["data"])):Q("",!0),e(m).manage("stock_management")?(F(),ae(U,{key:1,data:j,onUpdate:y},null,8,["data"])):Q("",!0)])]),_:1},8,["search-value","data","loading"])])])}}});export{wo as default};
