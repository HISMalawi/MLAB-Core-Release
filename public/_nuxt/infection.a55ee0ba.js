import{_ as F}from"./Breadcrumb.cfeb06ed.js";import{_ as T}from"./Dropdown.28b1fd1d.js";import{u as V,a as u,_ as R,f as y,o as a,c as p,b as l,d as e,t as s,g as E,h as C,F as i,r as g,j as A,e as B}from"./entry.6a3fbfc1.js";import{u as I}from"./vue.f36acd1f.f8958c90.js";import{e as N}from"./constants.cf42f90d.js";import{h as f,e as M,f as k}from"./fetch.444ade97.js";import{k as P}from"./vue-doc-download.4e161023.js";import{P as U}from"./package.d411c004.js";import{r as j}from"./DocumentTextIcon.9fa90f2c.js";import{r as q}from"./ArrowPathIcon.8bf7277c.js";import"./nuxt-link.bebad584.js";import"./HomeIcon.54ceb79b.js";import"./listbox.064b6dcd.js";import"./hidden.e85239c2.js";import"./use-text-value.75cce7ff.js";import"./CheckIcon.9343e206.js";import"./CheckCircleIcon.6ff04472.js";import"./MagnifyingGlassIcon.ba982fe1.js";import"./transition.9bb58b2a.js";import"./XMarkIcon.fd9a39e2.js";import"./PencilSquareIcon.79aa7948.js";import"./PrinterIcon.b8623d34.js";const G={setup(){I({title:`${U.name.toUpperCase()} - Infection Report`})},components:{ExportToExcel:P},data(){return{moment:f,exportIcon:j,refreshIcon:q,title:"Infection Report",pages:[{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"Aggregate Reports",link:"#"}],departments:new Array,selectedDepartment:{name:"-- select department --"},dateFrom:"",dateTo:"",cookie:V("token"),loading:!1,reportData:new Array}},created(){this.loadDepartments()},methods:{async loadDepartments(){const d={route:`${M.departments}`,method:"GET",token:`${this.cookie}`},{data:r,error:c}=await k(d);r.value&&(this.departments=r.value),c.value&&console.log(c.value)},async generateReport(){if(this.validate())u().$toast.warning("Please select a department");else{this.loading=!0;let d=this.dateFrom!=""?f(this.dateFrom).format("YYYY-MM-DD"):"",r=this.dateTo!=""?f(this.dateTo).format("YYYY-MM-DD"):"";const c={route:`${M.aggregateReports}infection?from=${d}&to=${r}&department=${this.selectedDepartment.id}`,method:"GET",token:`${this.cookie}`},{data:m,error:o,pending:_}=await k(c);this.loading=_,m.value&&(this.loading=!1,this.reportData=m.value.data,u().$toast.success("Report generated successfully!")),o.value&&(console.log(o.value),this.loading=!1,u().$toast.error(N))}},validate(){return this.selectedDepartment.name=="-- select department --"}}},H={class:"px-5 py-5"},S={class:"flex items-center justify-between py-5"},L={class:"text-2xl font-semibold"},z={class:"w-full flex items-center justify-between mb-5"},J={class:"w-full flex items-center space-x-3"},K={class:"w-40"},O={class:"w-40"},Q={class:"w-40"},W={class:"flex items-center space-x-2"},X={id:"print-container"},Z={class:"text-lg font-semibold mb-2"},$={class:"text-normal font-normal"},ee={class:"rounded border"},oe={class:"w-full rounded"},te=e("thead",{class:"w-full bg-gray-50 h-full border-b"},[e("tr",{class:"w-full h-full"},[e("th",{rowspan:"2",class:"px-2 py-2 border-r"},"Test"),e("th",{rowspan:"2",class:"border-r"},"Measure"),e("th",{rowspan:"2",class:"px-2 py-2 border-r"},"Results"),e("th",{rowspan:"2",class:"px-2 py-2 border-r"},"Sex"),e("th",{colspan:"3",scope:"colgroup",class:"border-r border-b px-2 py-2"},"Age Range"),e("th",{rowspan:"2",class:"px-2 py-2 border-r"},"M/F Total"),e("th",{rowspan:"2",class:"px-2 py-2"},"Total")]),e("tr",null,[e("th",{scope:"col",class:"border-l px-2 py-2 border-r"},"[0-5]"),e("th",{scope:"col",class:"border-r px-2 py-2"},"[5-14]"),e("th",{scope:"col",class:"border-r px-2 py-2"},"[14-120]")])],-1),se=["rowspan"],re={class:"border-r px-2 py-2"},ne={rowspan:2,class:"border-r px-2 py-2"},le=e("td",{class:"border-r border-b px-2 py-2"},"Male",-1),ae={class:"border-r border-b px-2 py-2"},pe={class:"border-r border-b px-2 py-2"},ce={class:"border-r border-b px-2 py-2"},de={class:"border-r border-b px-2 py-2"},ie={class:"border-b px-2 py-2",rowspan:"2"},me={class:"border-b"},_e=e("td",{class:"border-r px-2 py-2"},null,-1),ue=e("td",{class:"border-r px-2 py-2"},"Female",-1),fe={class:"border-r px-2 py-2"},he={class:"border-r px-2 py-2"},be={class:"border-r px-2 py-2"},xe={class:"border-r px-2 py-2"};function ye(d,r,c,m,o,_){const w=F,h=y("datepicker"),D=T,b=B,Y=y("ExportToExcel");return a(),p("div",H,[l(w,{pages:o.pages},null,8,["pages"]),e("div",S,[e("h3",L,s(o.title),1)]),e("div",z,[e("div",J,[e("div",K,[l(h,{position:"left",range:!1,placeholder:"-- start date --","input-classes":"border rounded px-2 py-1.5 block focus:outline-none focus:ring-2 focus:ring-sky-500 transition duration-150 focus:border-none",modelValue:o.dateFrom,"onUpdate:modelValue":r[0]||(r[0]=n=>o.dateFrom=n),format:"dd/MM/yyyy"},null,8,["modelValue"])]),e("div",O,[l(h,{range:!1,placeholder:"-- end date --","input-classes":"border rounded px-2 py-1.5 block focus:outline-none focus:ring-2 focus:ring-sky-500 transition duration-150 focus:border-none",modelValue:o.dateTo,"onUpdate:modelValue":r[1]||(r[1]=n=>o.dateTo=n),format:"dd/MM/yyyy"},null,8,["modelValue"])]),e("div",Q,[l(D,{items:o.departments,modelValue:o.selectedDepartment,"onUpdate:modelValue":r[2]||(r[2]=n=>o.selectedDepartment=n)},null,8,["items","modelValue"])]),e("div",null,[l(b,{loading:o.loading,color:"success",text:"Generate Report",icon:o.refreshIcon,click:()=>_.generateReport()},null,8,["loading","icon","click"])])]),e("div",W,[l(Y,{element:"print-container",filename:`infection_report_from_${o.moment(o.dateFrom).format("DD_MM_YYYY")}_to_${o.moment(o.dateTo).format("DD_MM_YYYY")}`},{default:E(()=>[l(b,{color:"success",text:"Export",icon:o.exportIcon,click:()=>{}},null,8,["icon"])]),_:1},8,["filename"])])]),e("div",X,[e("h3",Z,[C("Tests Performed Period: "),e("span",$,s(o.dateFrom!=""?o.moment(o.dateFrom).format("DD/MM/YYYY"):"")+" - "+s(o.dateTo!=""?o.moment(o.dateTo).format("DD/MM/YYYY"):""),1)]),e("div",ee,[e("table",oe,[te,(a(!0),p(i,null,g(o.reportData,(n,v)=>(a(),p(i,{key:v},[(a(!0),p(i,null,g(n.indicators,(t,x)=>(a(),p(i,{key:x},[e("tr",null,[x===0?(a(),p("td",{key:0,rowspan:n.indicators.length*2,class:"border-r px-2 py-2"},s(n.test_type),9,se)):A("",!0),e("td",re,s(t.indicator.name),1),e("td",ne,s(t.indicator.result!==null?t.indicator.result.value:""),1),le,e("td",ae,s(t.M["0-5"]),1),e("td",pe,s(t.M["5-14"]),1),e("td",ce,s(t.M["14-120"]),1),e("td",de,s(t.M["0-5"]+t.M["5-14"]+t.M["14-120"]),1),e("td",ie,s(t.M["0-5"]+t.M["5-14"]+t.M["14-120"]+t.F["0-5"]+t.F["5-14"]+t.F["14-120"]),1)]),e("tr",me,[_e,ue,e("td",fe,s(t.F["0-5"]),1),e("td",he,s(t.F["5-14"]),1),e("td",be,s(t.F["14-120"]),1),e("td",xe,s(t.F["0-5"]+t.F["5-14"]+t.F["14-120"]),1)])],64))),128))],64))),128))])])])])}const He=R(G,[["render",ye]]);export{He as default};
