import{_ as ne}from"./Bo9Y6Pu_.js";import{b as x,e as V,g as e,d as J,r as N,a as T,w as U,C as G,a6 as Q,y as v,f as s,z as d,h as n,Y as j,p as I,G as H,V as R,k as S,q,a7 as re,S as L,l as D,m as P,u as w,E as $,_ as M,s as F,t as C,a8 as W,a1 as de,A as ee,x as K,i as A,v as B,n as ce,B as te,F as ue,j as me,I as pe,X as fe,a9 as _e,L as Z,K as Y}from"./B6Tj7v0x.js";import{_ as ae}from"./Cvxcf13Z.js";import{r as X}from"./LlNZ35XP.js";import{r as se}from"./DopEa1Gw.js";import{r as le}from"./DjbowuN7.js";import{_ as he}from"./DV7heDwp.js";import{u as z}from"./CNoZcmv_.js";import{u as ve}from"./BU27LF7R.js";import{P as ge}from"./D0dD8Pjq.js";import{u as ye}from"./DbZAM_j6.js";import{r as xe,a as be}from"./CJ3XBQzx.js";import{r as we}from"./DcNW31lB.js";import{r as Ce}from"./CeZ-UIlw.js";import"./BbLbM4kr.js";import"./Ch3yEbHE.js";import"./CFG611di.js";function Ve(a,o){return x(),V("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm4.28 10.28a.75.75 0 0 0 0-1.06l-3-3a.75.75 0 1 0-1.06 1.06l1.72 1.72H8.25a.75.75 0 0 0 0 1.5h5.69l-1.72 1.72a.75.75 0 1 0 1.06 1.06l3-3Z","clip-rule":"evenodd"})])}const E="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M25.1716%208.17157C26.0154%207.32777%2027.1424%206.93977%2028.2466%207.00756C27.631%205.25582%2025.9622%204%2024%204C21.5147%204%2019.5%206.01472%2019.5%208.5C19.5%2010.9853%2021.5147%2013%2024%2013C24.1751%2013%2024.348%2012.99%2024.5179%2012.9705C23.6533%2011.4448%2023.8712%209.47191%2025.1716%208.17157Z'%20fill='%23333333'/%3e%3cpath%20d='M13.8493%2017.0002C15.0941%2015.7409%2016.8649%2015%2018.9884%2015H29.1716L26.5858%2012.4142C25.8047%2011.6332%2025.8047%2010.3668%2026.5858%209.58579C27.3668%208.80474%2028.6332%208.80474%2029.4142%209.58579L35.4142%2015.5858C35.9862%2016.1578%2036.1573%2017.018%2035.8478%2017.7654C35.5382%2018.5127%2034.8089%2019%2034%2019H30V42C30%2043.0722%2029.1544%2043.9537%2028.0831%2043.9983C27.0118%2044.0428%2026.096%2043.2346%2026.0069%2042.1661L25.1597%2032H22.8403L21.9931%2042.1661C21.904%2043.2346%2020.9882%2044.0428%2019.9169%2043.9983C18.8456%2043.9537%2018%2043.0722%2018%2042V30H21C23.2091%2030%2025%2028.2091%2025%2026C25%2023.7909%2023.2091%2022%2021%2022H18V19.1088C17.3996%2019.2527%2016.9805%2019.5224%2016.694%2019.8123C16.2492%2020.2622%2016.0063%2020.879%2016.0001%2021.5192C15.994%2022.158%2016.2233%2022.758%2016.6498%2023.1924C17.0565%2023.6064%2017.7714%2024%2018.9884%2024H20.9913C22.0959%2024%2022.9913%2024.8954%2022.9913%2026C22.9913%2027.1046%2022.0959%2028%2020.9913%2028H18.9893C16.8375%2028%2015.0466%2027.2686%2013.796%2025.9951C12.5652%2024.742%2011.9848%2023.092%2012.0003%2021.4808C12.0158%2019.871%2012.6259%2018.2378%2013.8493%2017.0002Z'%20fill='%23333333'/%3e%3c/svg%3e",ke=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),De={class:"fixed inset-0 overflow-y-auto"},Pe={class:"flex min-h-full items-center justify-center p-4 text-center"},$e={class:"border-b px-3 py-3 flex items-center justify-between"},Ne=e("img",{src:E,class:"w-8 h-8 mr-2",alt:"nausea-icon"},null,-1),Ie={class:"mt-2 space-y-3 px-5 py-5"},Fe={class:"w-full grid grid-cols-3 gap-2"},Ae={class:"grid grid-cols-2 gap-2 space-x-3"},Te={class:"w-full flex flex-col space-y-2"},Se=e("label",{class:"font-medium"},"Date Of Birth",-1),Me={class:"w-full"},Oe={class:"w-full grid grid-cols-2 gap-2"},Ue={class:"mt-3 justify-end flex items-center space-x-3 px-3 py-2 border-t"},Be=J({__name:"index",props:{openForm:{type:Boolean},defaultData:{}},emits:["onPatientCreated","sethandleDialog"],setup(a,{emit:o}){const h=o,_=N(!1),t=N(!1),c=T("token"),m=a,l=N({uuid:"",firstName:"",middleName:"",lastName:"",gender:"",physicalAddress:"",dateOfBirth:"",estimatedDate:!1,age:""}),y=()=>{_.value=!_.value,h("sethandleDialog",_.value)},g=async()=>{t.value=!0;const p={route:D.clients,method:"POST",token:`${c.value}`,body:{client:{uuid:""},person:{first_name:l.value.firstName,middle_name:l.value.middleName,last_name:l.value.lastName,sex:l.value.gender.charAt(0),date_of_birth:l.value.dateOfBirth,birth_date_estimated:l.value.estimatedDate},client_identifiers:{current_village:"",current_district:"",current_traditional_authority:"",physical_address:l.value.physicalAddress}}},{data:u,error:f,pending:b}=await P(p);t.value=b,u.value&&(w().$toast.success("Patient created successfully!"),y(),r(),h("onPatientCreated",!0),t.value=!1),f.value&&(console.error(f.value),w().$toast.error(`${$}`),t.value=!1)},r=()=>{l.value.uuid="",l.value.firstName="",l.value.middleName="",l.value.lastName="",l.value.gender="",l.value.physicalAddress="",l.value.dateOfBirth="",l.value.estimatedDate=!1,l.value.age=""};return U(()=>l.value.age,p=>{l.value.dateOfBirth=G().subtract(p,"years").format("YYYY-MM-DD"),l.value.estimatedDate=!0}),U(()=>m.defaultData,p=>{l.value.firstName=p.firstName,l.value.lastName=p.lastName,l.value.gender=p.gender}),U(()=>l.value.dateOfBirth,p=>{l.value.age=Q(l.value.dateOfBirth),l.value.estimatedDate=!1}),U(()=>m.openForm,p=>{_.value=p}),(p,u)=>{const f=v("FormKit"),b=v("datepicker"),k=ae,O=M;return x(),V("div",null,[s(n(L),{appear:"",show:_.value,as:"template"},{default:d(()=>[s(n(j),{as:"div",onClose:y,class:"relative z-10"},{default:d(()=>[s(n(I),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:d(()=>[ke]),_:1}),e("div",De,[e("div",Pe,[s(n(I),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:d(()=>[s(n(H),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:d(()=>[e("div",$e,[s(n(R),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:d(()=>[Ne,S(" Create patient ")]),_:1}),e("button",{onClick:y},[s(n(q),{class:"w-5 h-5"})])]),s(f,{type:"form",id:"patientForm","submit-label":"Update",onSubmit:g,actions:!1},{default:d(({})=>[e("div",Ie,[e("div",Fe,[s(f,{type:"text",label:"First name",validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"First name must contain only letters, no spaces or special characters"},modelValue:l.value.firstName,"onUpdate:modelValue":u[0]||(u[0]=i=>l.value.firstName=i)},null,8,["modelValue"]),s(f,{type:"text",label:"Middle name",modelValue:l.value.middleName,"onUpdate:modelValue":u[1]||(u[1]=i=>l.value.middleName=i)},null,8,["modelValue"]),s(f,{type:"text",label:"Last name",validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"Last name must contain only letters, no spaces or special characters"},modelValue:l.value.lastName,"onUpdate:modelValue":u[2]||(u[2]=i=>l.value.lastName=i)},null,8,["modelValue"])]),e("div",Ae,[e("div",Te,[Se,e("div",Me,[s(b,{placeholder:new Date().toDateString(),"input-class-name":"datepicker","as-single":"",shortcuts:!0,modelValue:l.value.dateOfBirth,"onUpdate:modelValue":u[3]||(u[3]=i=>l.value.dateOfBirth=i),range:!1,"max-date":new Date,"ignore-time-validation":!0,teleport:!0,"enable-time-picker":!1,formatter:p.DATE_FORMATter},null,8,["placeholder","modelValue","max-date","formatter"])])]),s(f,{type:"text",label:"Age",modelValue:l.value.age,"onUpdate:modelValue":u[4]||(u[4]=i=>l.value.age=i)},null,8,["modelValue"])]),e("div",Oe,[s(f,{modelValue:l.value.gender,"onUpdate:modelValue":u[5]||(u[5]=i=>l.value.gender=i),type:"radio",label:"Sex",options:"INTERPRETATIONS"in p?p.INTERPRETATIONS:n(re),validation:"required"},null,8,["modelValue","options"]),s(f,{type:"text",label:"Physical Address",validation:"required",modelValue:l.value.physicalAddress,"onUpdate:modelValue":u[6]||(u[6]=i=>l.value.physicalAddress=i)},null,8,["modelValue"])])]),e("div",Ue,[s(k,{type:"button",click:()=>{r()},text:"Clear form"},null,8,["click"]),s(O,{type:"submit",click:()=>{},color:"success",icon:n(X),text:"Save changes",loading:t.value},null,8,["icon","loading"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),je=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),He={class:"fixed inset-0 overflow-y-auto"},Re={class:"flex min-h-full items-center justify-center p-4 text-center"},qe={class:"border-b px-3 py-3 flex items-center justify-between"},Le=e("img",{src:E,class:"w-8 h-8 mr-2"},null,-1),Ee={class:"mt-2 space-y-3 px-5 py-5"},Ze={class:"w-full grid grid-cols-2 gap-2"},Ye={class:"items-center"},ze={class:"mt-3 justify-end flex items-center space-x-3 px-3 py-2 border-t"},Ge=J({__name:"index",emits:["action-completed"],setup(a,{emit:o}){const h=o,_=N(!1),t=N(!1),c=T("token"),m=N({firstName:"",lastName:"",gender:""}),l=()=>_.value=!_.value,y=async()=>{t.value=!0;const g={route:de(D.client.search,{first_name:m.value.firstName,last_name:m.value.lastName,gender:m.value.gender}),method:"GET",token:`${c.value}`},r=await P(g);t.value=r.pending,r.data.value&&(l(),h("action-completed",{patient:r.data.value,defaults:m.value}),m.value={firstName:"",lastName:"",gender:""}),r.error.value&&w().$toast.error(`${$}`),t.value=_.value=!1};return(g,r)=>{const p=M,u=v("FormKit");return x(),V("div",null,[e("div",null,[s(p,{text:"Find/Create Patient",color:"primary",icon:n(F),click:l},null,8,["icon"])]),s(n(L),{appear:"",show:n(_),as:"template"},{default:d(()=>[s(n(j),{as:"div",onClose:l,class:"relative z-10"},{default:d(()=>[s(n(I),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:d(()=>[je]),_:1}),e("div",He,[e("div",Re,[s(n(I),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:d(()=>[s(n(H),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:d(()=>[e("div",qe,[s(n(R),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:d(()=>[Le,S(" "+C("Find or Create patient"))]),_:1}),e("button",{onClick:l},[s(n(q),{class:"w-5 h-5"})])]),s(u,{type:"form",onSubmit:y,actions:!1},{default:d(({})=>[e("div",Ee,[e("div",Ze,[s(u,{type:"text",label:"First name",validation:"required",modelValue:n(m).firstName,"onUpdate:modelValue":r[0]||(r[0]=f=>n(m).firstName=f)},null,8,["modelValue"]),s(u,{type:"text",label:"Last name",validation:"required",modelValue:n(m).lastName,"onUpdate:modelValue":r[1]||(r[1]=f=>n(m).lastName=f)},null,8,["modelValue"])]),e("div",Ye,[s(u,{modelValue:n(m).gender,"onUpdate:modelValue":r[2]||(r[2]=f=>n(m).gender=f),type:"radio",label:"Gender",options:"sex"in g?g.sex:n(W),validation:"required"},null,8,["modelValue","options"])])]),e("div",ze,[s(p,{type:"submit",click:()=>{},color:"success",icon:n(Ve),text:"Find",loading:n(t)},null,8,["icon","loading"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),Ke={components:{TransitionRoot:L,TransitionChild:I,Dialog:j,DialogPanel:H,DialogTitle:R,XMarkIcon:q,UserIcon:se},props:{data:{required:!0,type:Object}},data(){return{details:new Object,open:!1,addIcon:F,viewIcon:ee,saveIcon:X,clearIcon:le,cookie:T("token"),loading:!1}},methods:{async init(){this.adjustVisibility(),this.loading=!0;const a={route:`${D.clients}/${this.data.client_id}`,method:"GET",token:`${this.cookie}`},{data:o,pending:h,error:_}=await P(a);o.value&&(this.details=o.value,this.loading=!1),_.value&&(console.log(_.value),w().$toast.error($))},adjustVisibility(){this.open=!this.open}}},Xe=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Je={class:"fixed inset-0 overflow-y-auto"},Qe={class:"flex min-h-full items-center justify-center p-4 text-center"},We={class:"border-b px-3 py-3 flex items-center justify-between"},et=e("img",{src:E,class:"w-8 h-8 mr-2"},null,-1),tt={class:"flex items-center justify-center mx-auto my-20"},at={class:"mt-2 space-y-3 px-5 py-5"},st={class:"w-full flex flex-col space-y-1"},lt=e("label",{class:"font-semibold text-lg"},"Name",-1),ot={class:"underline"},it={class:"w-full flex flex-col space-y-1"},nt=e("label",{class:"font-semibold text-lg"},"National Patient ID",-1),rt={class:"underline"},dt={class:"w-full flex flex-col space-y-1"},ct=e("label",{class:"font-semibold text-lg"},"Date Of Birth",-1),ut={class:"underline"},mt={class:"w-full flex flex-col space-y-1"},pt=e("label",{class:"font-semibold text-lg"},"Sex",-1),ft={class:"underline"},_t={class:"w-full flex flex-col space-y-1"},ht=e("label",{class:"font-semibold text-lg"},"Physical Address",-1),vt={class:"underline"};function gt(a,o,h,_,t,c){const m=M,l=v("TransitionChild"),y=v("DialogTitle"),g=v("XMarkIcon"),r=ce,p=v("DialogPanel"),u=v("Dialog"),f=v("TransitionRoot");return x(),V("div",null,[e("div",null,[s(m,{text:"View",color:"success",icon:t.viewIcon,click:c.init},null,8,["icon","click"])]),s(f,{appear:"",show:t.open,as:"template"},{default:d(()=>[s(u,{as:"div",onClose:c.adjustVisibility,class:"relative z-10"},{default:d(()=>[s(l,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:d(()=>[Xe]),_:1}),e("div",Je,[e("div",Qe,[s(l,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:d(()=>[s(p,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:d(()=>[e("div",We,[s(y,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:d(()=>[et,S(" View patient ")]),_:1}),e("button",{onClick:o[0]||(o[0]=(...b)=>c.adjustVisibility&&c.adjustVisibility(...b))},[s(g,{class:"w-5 h-5"})])]),A(e("div",tt,[s(r,{loading:t.loading},null,8,["loading"])],512),[[B,t.loading]]),A(e("div",at,[e("div",st,[lt,e("p",ot,C(`${t.details.first_name} ${t.details.last_name}`),1)]),e("div",it,[nt,e("p",rt,C(t.details.npid),1)]),e("div",dt,[ct,e("p",ut,C(t.details.date_of_birth),1)]),e("div",mt,[pt,e("p",ft,C(t.details.sex),1)]),e("div",_t,[ht,e("p",vt,C(t.details.physical_address),1)])],512),[[B,!t.loading]])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const yt=K(Ke,[["render",gt]]),xt={components:{TransitionRoot:L,TransitionChild:I,Dialog:j,DialogPanel:H,DialogTitle:R,XMarkIcon:q,UserIcon:se},props:{data:{required:!0,type:Object}},data(){return{details:new Object,open:!1,addIcon:F,saveIcon:X,clearIcon:le,editIcon:te,loading:!1,cookie:T("token"),updatingFromDob:!1,updatingFromAge:!1,estimatedDate:!1}},methods:{async init(){this.handleDialog();const a={route:`${D.clients}/${this.data.client_id}`,method:"GET",token:`${this.cookie}`},{data:o,error:h}=await P(a);o.value&&(this.details=o.value),h.value&&(console.error(h.value),w().$toast.error($))},async submitForm(){this.loading=!0;const a={route:`${D.clients}/${this.data.client_id}`,method:"PUT",token:`${this.cookie}`,body:{client:{uuid:this.details.uuid},person:{first_name:this.details.first_name,middle_name:this.details.middle_name,last_name:this.details.last_name,sex:this.details.sex.charAt(0),date_of_birth:this.details.date_of_birth,birth_date_estimated:this.estimatedDate},client_identifiers:[{type:"physical_address",value:this.details.physical_address},{type:"phone",value:this.details.phone},{type:"npid",value:this.details.npid}]}},{data:o,error:h,pending:_}=await P(a);this.loading=_,o.value&&(this.loading=!1,this.details={},w().$toast.success("Patient updated successfully!"),this.handleDialog(),this.$emit("update",!0)),h.value&&(this.loading=!1,console.error(h.value),w().$toast.error(`${$}`))},handleDialog(){this.open=!this.open}},watch:{"details.date_of_birth"(a){this.updatingFromAge||(this.updatingFromDob=!0,this.details.age=Number(Q(a)),this.updatingFromDob=!1)},"details.age"(a,o){a!=o&&!this.updatingFromDob&&(this.updatingFromAge=!0,this.details.date_of_birth=G().subtract(a,"years").format("YYYY-MM-DD"),this.updatingFromAge=!1,this.estimatedDate=!0)}}},bt=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),wt={class:"fixed inset-0 overflow-y-auto"},Ct={class:"flex min-h-full items-center justify-center p-4 text-center"},Vt={class:"border-b px-3 py-3 flex items-center justify-between"},kt=e("img",{src:E,class:"w-8 h-8 mr-2",alt:"nausea-icon"},null,-1),Dt={class:"mt-2 space-y-3 px-5 py-5"},Pt={class:"w-full grid grid-cols-2 gap-2"},$t={class:"w-full grid grid-cols-3 gap-2"},Nt={class:"grid grid-cols-2 gap-2 space-x-3"},It={class:"w-full flex flex-col space-y-2"},Ft=e("label",{class:"font-medium"},"Date Of Birth",-1),At={class:"w-full"},Tt={class:"lex items-center"},St=e("label",{class:"mr-5 font-medium"},"Sex",-1),Mt=["value"],Ot={class:"ml-2"},Ut={class:"w-full grid grid-cols-2 gap-2"},Bt={class:"mt-3 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function jt(a,o,h,_,t,c){const m=M,l=v("TransitionChild"),y=v("DialogTitle"),g=v("XMarkIcon"),r=v("FormKit"),p=v("datepicker"),u=ae,f=v("DialogPanel"),b=v("Dialog"),k=v("TransitionRoot");return x(),V("div",null,[e("div",null,[s(m,{text:"Edit",color:"primary",icon:t.editIcon,click:c.init},null,8,["icon","click"])]),s(k,{appear:"",show:t.open,as:"template"},{default:d(()=>[s(b,{as:"div",onClose:c.handleDialog,class:"relative z-10"},{default:d(()=>[s(l,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:d(()=>[bt]),_:1}),e("div",wt,[e("div",Ct,[s(l,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:d(()=>[s(f,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:d(()=>[e("div",Vt,[s(y,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:d(()=>[kt,S(" Edit patient ")]),_:1}),e("button",{onClick:o[0]||(o[0]=(...O)=>c.handleDialog&&c.handleDialog(...O))},[s(g,{class:"w-5 h-5"})])]),s(r,{type:"form",id:"patientForm","submit-label":"Update",onSubmit:c.submitForm,actions:!1},{default:d(({value:O})=>[e("div",Dt,[e("div",Pt,[s(r,{type:"text",label:"Patient ID",modelValue:t.details.uuid,"onUpdate:modelValue":o[1]||(o[1]=i=>t.details.uuid=i)},null,8,["modelValue"]),s(r,{type:"text",label:"National Patient ID",modelValue:t.details.npid,"onUpdate:modelValue":o[2]||(o[2]=i=>t.details.npid=i)},null,8,["modelValue"])]),e("div",$t,[s(r,{type:"text",label:"First name",validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"First name must contain only letters, no spaces or special characters"},modelValue:t.details.first_name,"onUpdate:modelValue":o[3]||(o[3]=i=>t.details.first_name=i)},null,8,["modelValue"]),s(r,{type:"text",label:"Middle name",modelValue:t.details.middle_name,"onUpdate:modelValue":o[4]||(o[4]=i=>t.details.middle_name=i)},null,8,["modelValue"]),s(r,{type:"text",label:"Last name",validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"Last name must contain only letters, no spaces or special characters"},modelValue:t.details.last_name,"onUpdate:modelValue":o[5]||(o[5]=i=>t.details.last_name=i)},null,8,["modelValue"])]),e("div",Nt,[e("div",It,[Ft,e("div",At,[s(p,{placeholder:new Date().toDateString(),"input-class-name":"datepicker","as-single":"",shortcuts:!0,modelValue:t.details.date_of_birth,"onUpdate:modelValue":o[6]||(o[6]=i=>t.details.date_of_birth=i),"text-input":!0,range:!1,"max-date":new Date,format:"dd/MM/yyyy",position:"right",teleport:!0,formatter:a.DATE_FORMATter},null,8,["placeholder","modelValue","max-date","formatter"])])]),s(r,{type:"text",label:"Age",modelValue:t.details.age,"onUpdate:modelValue":o[7]||(o[7]=i=>t.details.age=i)},null,8,["modelValue"])]),e("div",Tt,[St,(x(!0),V(ue,null,me("sex"in a?a.sex:n(W),(i,oe)=>(x(),V("label",{class:"flex items-center mr-2",key:oe},[A(e("input",{required:!0,"onUpdate:modelValue":o[8]||(o[8]=ie=>t.details.sex=ie),value:i.value,type:"radio",placeholder:"Male",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,8,Mt),[[pe,t.details.sex]]),e("span",Ot,C(i.name),1)]))),128))]),e("div",Ut,[s(r,{type:"text",label:"Physical Address",modelValue:t.details.physical_address,"onUpdate:modelValue":o[9]||(o[9]=i=>t.details.physical_address=i)},null,8,["modelValue"]),s(r,{type:"tel",label:"Phone number","prefix-icon":"telephone",modelValue:t.details.phone,"onUpdate:modelValue":o[10]||(o[10]=i=>t.details.phone=i),"prefix-icon-class":"inline-block w-5 h-5 text-gray-700 absolute mt-4 ml-2 mr-2","validation-visibility":"dirty"},null,8,["modelValue"])])]),e("div",Bt,[s(u,{type:"button",click:()=>{},text:"Clear form"}),s(m,{type:"submit",click:()=>{},color:"success",icon:t.saveIcon,text:"Save changes",loading:t.loading},null,8,["icon","loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const Ht=K(xt,[["render",jt]]),Rt={components:{UsersIcon:xe,PlusIcon:F,MagnifyingGlassIcon:we},setup(){ve({title:`${ge.name.toUpperCase()} - Patients`})},data(){return{loading:!1,openCreatePatientForm:!1,newIcon:be,defaultData:{},editIcon:te,viewIcon:ee,refreshIcon:Ce,headers:new Array({text:"patient no",value:"client_id",sortable:!0},{text:"name",value:"name",sortable:!0},{text:"sex",value:"sex",sortable:!0},{text:"date of birth",value:"date_of_birth",sortable:!0},{text:"physical address",value:"physical_address",sortable:!0},{text:"actions",value:"actions"}),pages:[{name:"Home",link:"/home"}],data:{},addIcon:F,patients:new Array,cookie:T("token"),serverItemsLength:0,serverOptions:{page:1,rowsPerPage:25,sortBy:"name"},searchField:"name",search:"",searchValue:"",createPatient:!1,showSearch:!1}},created(){this.init()},methods:{updateSearch(a){this.searchValue=a,this.search=a,this.updatePatients(!0)},async init(){this.createPatient=!1,this.defaultData={firstName:"",lastName:"",middleName:"",gender:""},this.loading=!0;const{page:a,rowsPerPage:o}=this.serverOptions,h=ye(),_=fe(h.locations,h.selectedLocation),t={route:`${D.clients}?page=${a}&per_page=${o}&search=${this.search}&lab_location=${_}`,method:"GET",token:`${this.cookie}`};let{data:c,error:m,pending:l}=await P(t);this.loading=l,c.value&&(this.patients=c.value.clients,this.serverItemsLength=c.value.meta.total_count),m.value&&(console.error(m.value.data),w().$toast.error(`${$}`))},updatePatients(a){typeof a=="object"&&(this.serverOptions=a),this.init()},async handleClick(a){this.data=a,a.source==="remote"&&await this.handleSaveRemotePatient(this.data),this.$router.push(`/tests/new-test?patient_id=${a.client_id}`)},async handleSaveRemotePatient(a){const o={route:D.clients,method:"POST",token:this.cookie,body:{client:{uuid:a.uuid},person:{first_name:a.first_name,middle_name:a.middle_name,last_name:a.last_name,sex:a.sex,date_of_birth:a.date_of_birth,birth_date_estimated:!1},client_identifiers:{current_village:a.current_village,current_district:a.current_district,current_traditional_authority:a.current_traditional_authority,physical_address:`${a.home_village} ${a.home_traditional_authority} ${a.home_district}`,npid:a.npid}}},{data:h,error:_,pending:t}=await P(o);h.value&&(this.data=h.value),_.value&&w().$toast.error(`${$}`)},handleActionCompleted(a){a.patient.length>0?(this.createPatient=!0,this.patients=a.patient,this.serverItemsLength=a.patient.length,this.showSearch=!0):(w().$toast.warning("Patient not found"),this.openCreatePatientForm=!0,this.defaultData=a.defaults,this.showSearch=!1)},setCreatePatientFormVisibility(a){this.openCreatePatientForm=a}},computed:{filteredPatients(){return this.patients.map(a=>({...a,name:_e(`${a.first_name} ${a.middle_name!=null?a.middle_name:""} ${a.last_name}`),date_of_birth:G(a.date_of_birth).format("DD/MMMM/YYYY")}))}}},qt="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M17%2031V29H19V31H17Z'%20fill='currentColor'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M20%204C18.3431%204%2017%205.34315%2017%207H13C11.3431%207%2010%208.34315%2010%2010V41C10%2042.6569%2011.3431%2044%2013%2044H35C36.6569%2044%2038%2042.6569%2038%2041V10C38%208.34315%2036.6569%207%2035%207H31C31%205.34315%2029.6569%204%2028%204H20ZM19%207C19%206.44772%2019.4477%206%2020%206H28C28.5523%206%2029%206.44772%2029%207V9C29%209.55228%2028.5523%2010%2028%2010H20C19.4477%2010%2019%209.55228%2019%209V7ZM16%2020C15.4477%2020%2015%2020.4477%2015%2021C15%2021.5523%2015.4477%2022%2016%2022H23C23.5523%2022%2024%2021.5523%2024%2021C24%2020.4477%2023.5523%2020%2023%2020H16ZM15%2016C15%2015.4477%2015.4477%2015%2016%2015H31.5C32.0523%2015%2032.5%2015.4477%2032.5%2016C32.5%2016.5523%2032.0523%2017%2031.5%2017H16C15.4477%2017%2015%2016.5523%2015%2016ZM15%2028C15%2027.4477%2015.4477%2027%2016%2027H20C20.5523%2027%2021%2027.4477%2021%2028V32C21%2032.5523%2020.5523%2033%2020%2033H16C15.4477%2033%2015%2032.5523%2015%2032V28ZM28%2032C29.6575%2032%2031%2030.6575%2031%2029C31%2027.3425%2029.6575%2026%2028%2026C26.3425%2026%2025%2027.3425%2025%2029C25%2030.6575%2026.3425%2032%2028%2032ZM22%2036.5001C22%2034.3842%2025.9975%2033.3182%2028%2033.3182C30.0025%2033.3182%2034%2034.3842%2034%2036.5001V38.9999H22V36.5001Z'%20fill='currentColor'/%3e%3c/svg%3e",Lt={class:"py-5 px-5"},Et=e("div",{class:"flex items-center space-x-2 py-5"},[e("img",{src:qt,alt:"form-icon",class:"w-auto h-10"}),e("h3",{class:"text-2xl font-semibold uppercase"},"Patients List")],-1),Zt={class:"flex justify-between items-center w-full px-2 py-2 mb-2"},Yt={class:"flex items-center space-x-2"},zt={class:"mb-2.5"},Gt={class:"text-lg font-medium"},Kt={class:"py-2 flex items-center space-x-2"};function Xt(a,o,h,_,t,c){var f,b;const m=ne,l=M,y=Be,g=Ge,r=yt,p=Ht,u=he;return x(),V("div",Lt,[s(m,{pages:t.pages},null,8,["pages"]),Et,e("div",Zt,[e("div",Yt,[s(l,{color:"warning",icon:t.refreshIcon,text:"Refresh",click:()=>{c.init()}},null,8,["icon","click"]),A(s(l,{click:()=>{t.openCreatePatientForm=!0},text:"Create a new patient",color:"success",icon:t.addIcon},null,8,["click","icon"]),[[B,t.createPatient]])]),("usePermissions"in a?a.usePermissions:n(z))().can.manage("patients")?(x(),Z(y,{key:0,openForm:t.openCreatePatientForm,onSetAdjustVisibility:c.setCreatePatientFormVisibility,onOnPatientCreated:c.updatePatients,"default-data":t.defaultData},null,8,["openForm","onSetAdjustVisibility","onOnPatientCreated","default-data"])):Y("",!0),("usePermissions"in a?a.usePermissions:n(z))().can.manage("patients")?(x(),Z(g,{key:1,onActionCompleted:c.handleActionCompleted},null,8,["onActionCompleted"])):Y("",!0)]),A(e("div",zt,[S(" Showing results for "),e("span",Gt,C(`${(f=t.defaultData)==null?void 0:f.firstName} ${(b=t.defaultData)==null?void 0:b.lastName}`),1)],512),[[B,t.showSearch]]),("usePermissions"in a?a.usePermissions:n(z))().can.manage("patients")?(x(),Z(u,{key:0,headers:t.headers,data:c.filteredPatients,loading:t.loading,searchField:t.searchField,searchValue:t.searchValue,serverItemsLength:t.serverItemsLength,serverOptions:t.serverOptions,onUpdate:c.updatePatients},{actions:d(({item:k})=>[e("div",Kt,[s(l,{click:()=>c.handleClick(k),text:"New Test",color:"primary",icon:t.newIcon},null,8,["click","icon"]),s(r,{data:k},null,8,["data"]),s(p,{data:k,onUpdate:c.updatePatients},null,8,["data","onUpdate"])])]),_:1},8,["headers","data","loading","searchField","searchValue","serverItemsLength","serverOptions","onUpdate"])):Y("",!0)])}const fa=K(Rt,[["render",Xt]]);export{fa as default};
