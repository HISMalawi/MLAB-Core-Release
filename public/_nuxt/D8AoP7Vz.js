import{d as D,r as f,a as O,ak as U,a5 as j,c as N,w as L,C as m,o as B,y as $,b as _,e as h,g as t,at as P,f as c,h as e,k as v,H as z,z as Q,t as u,F as H,j as K,K as M,i as J,v as W,u as G,l as X,m as Z,E as ee,_ as te,n as oe}from"./BxD-h1LR.js";import{_ as re}from"./BNhNOnHe.js";import{_ as se}from"./Cs7plFji.js";import{_ as ae}from"./B4cMvEBz.js";import{_ as ne}from"./CQcCm1L6.js";import{u as le}from"./DRcUz5ts.js";import{s as ie}from"./Qw5I_VYr.js";import{r as de}from"./BkJfYQCG.js";import{r as ce}from"./CQe3LSWs.js";const ue={class:"w-full flex items-center justify-between mb-10"},me={class:"flex flex-row items-center bg-gray-100 rounded-l pl-2 font-normal text-zinc-500"},pe={class:"w-44 ml-2"},fe={class:"w-48"},_e={class:"rounded border",id:"print-container"},he={class:"rounded-tr rounded-tl border-b px-5 py-5 flex items-center justify-between"},ve=t("div",{class:"flex flex-col space-y-2"},[t("img",{src:ae,alt:"app-logo",class:"w-24 h-24 object-cover"}),t("h3",{class:"text-xl font-semibold"}," CULTURE & SENSITIVITY GENERAL COUNTS REPORT ")],-1),ye={class:"px-4 py-2.5 font-medium"},we={class:"font-normal"},xe={key:0,class:"w-full mt-2",ref:"table"},ge={class:"w-full border-b border-t bg-gray-100 rounded-t"},be={class:"w-full"},Ge={class:"border-b"},Re={class:"w-full items-center flex flex-col space-y-2 my-10"},ke=t("p",{class:"text-base"},[v(" Generating report, please wait"),t("span",{class:"animate-pulse"},"...")],-1),Ce={key:1,class:"flex flex-col space-y-3 items-center justify-center py-10"},Ee=t("img",{src:ne,class:"w-20 h-20 object-cover",alt:"page-icon"},null,-1),Ne=t("p",{class:"text-base"},[v(" Please generate report data to preview the "),t("span",{class:"font-medium"},"General Counts"),v(" report. ")],-1),$e=[Ee,Ne],Oe=D({__name:"general-counts",setup(Me){const s=f(""),T=O("token"),x=le(),i=f(!1),g=U(),y=j(),S=f(""),r=f({Growth:{total:0,associated_ids:""},"No growth":{total:0,associated_ids:""},"Mixed growth; no predominant organism":{total:0,associated_ids:""},"Growth of normal flora; no pathogens isolated":{total:0,associated_ids:""},"Growth of contaminants":{total:0,associated_ids:""}}),R=a=>Object.values(a).every(o=>o.total!==0),k=f([{name:"Growth"},{name:"No Growth"},{name:"Mixed Growth:  No Predominant Organism"},{name:"Growth Normal Flora: No Pathogens Isolated"},{name:"Growth: Contaminations"}]),F=N(()=>k.value.map(a=>({NAME:a.name,COUNT:r.value[a.name]||0}))),p=(a,o,n)=>{ie({test:a,type:"General Counts",count:o,associated_ids:n,date_filter:m(s.value).format("YYYY-MM-DD")},G())};async function C(){i.value=!0;let a=m(s.value).format("M"),o=m(s.value).format("yyyy");const n={route:`${X.aggregateReports}culture/general_counts?year=${o}&month=${a}&report_id=${g.query.report_id}`,method:"GET",token:`${T.value}`},{data:d,error:w,pending:b}=await Z(n);i.value=b,d.value&&(r.value=d.value,i.value=!1,q(d.value.report_id),G().$toast.success("Report data generated successfully")),w.value&&(console.error(w.value),i.value=!1,G().$toast.error(ee))}const q=a=>{S.value=a;const n={...y.currentRoute.value.query,report_id:a};y.replace({query:n}).catch(d=>{console.error("Failed to replace route:",d)})};L(s,()=>{if(s){const o={...y.currentRoute.value.query,dateFrom:m(s.value).format("M/yyyy")};y.replace({query:o}).catch(n=>{console.error("Failed to replace route:",n)})}},{deep:!0});const Y=N(()=>g.query.dateRange!==void 0&&g.query.dateFrom!=="");return B(()=>{Y.value&&C()}),(a,o)=>{var E;const n=$("datepicker"),d=te,w=re,b=$("excel"),I=se,V=oe;return _(),h("div",null,[t("div",ue,[t("form",{onSubmit:o[1]||(o[1]=P(l=>C(),["prevent"])),class:"flex items-center space-x-5"},[t("div",me,[c(e(de),{class:"w-4 h-4 mr-2"}),v(" Filter by date "),t("div",pe,[c(n,{placeholder:"month & year",required:"","input-class-name":"custom-input",modelValue:e(s),"onUpdate:modelValue":o[0]||(o[0]=l=>z(s)?s.value=l:null),range:!1,format:"M/yyyy",position:"left"},null,8,["modelValue"])])]),t("div",fe,[c(d,{type:"submit",color:"primary",text:"Generate Report",icon:e(ce),click:()=>{},loading:e(i)},null,8,["icon","loading"])])],32),t("div",null,[c(b,{class:"btn btn-default",header:[`CULTURE & SENSITIVITY GENERAL COUNTS REPORT ${e(s)}`,e(x).details.name,e(x).details.address,e(x).details.phone,"",""],data:e(F),worksheet:"report-work-sheet",name:`culture_sensitivity_general_counts_report_${e(m)(e(s)).format("M_YYYY")}.xls`},{default:Q(()=>[c(w,{text:"Export Excel",icon:"excel.png"})]),_:1},8,["header","data","name"])])]),t("div",_e,[t("div",he,[ve,c(I)]),t("div",null,[t("h3",ye,[v(" Data for period: "),t("span",we,u(e(s)==""?"-":e(m)(e(s)).format("M/yyyy")),1)])]),R(e(r))&&!e(i)?(_(),h("table",xe,[t("thead",ge,[t("tr",be,[(_(!0),h(H,null,K(e(k),(l,A)=>(_(),h("th",{class:"px-2 py-2 border-r",key:A},u(l.name),1))),128))])]),t("tbody",null,[t("tr",Ge,[t("td",{class:"px-2 py-2 border-r hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:o[2]||(o[2]=l=>p("Growth",e(r).Growth.total,e(r).Growth.associated_ids))},u(e(r).Growth.total),1),t("td",{class:"px-2 py-2 border-r hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:o[3]||(o[3]=l=>p("No growth",e(r)["No growth"].total,e(r)["No growth"].associated_ids))},u(e(r)["No growth"].total),1),t("td",{class:"px-2 py-2 border-r hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:o[4]||(o[4]=l=>{p("Mixed growth; no predominant organism",e(r)["Mixed growth; no predominant organism"].total,e(r)["Mixed growth; no predominant organism"].associated_ids)})},u(e(r)["Mixed growth; no predominant organism"].total),1),t("td",{class:"px-2 py-2 border-r hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:o[5]||(o[5]=l=>{p("Growth of normal flora; no pathogens isolated",e(r)["Growth of normal flora; no pathogens isolated"].total,e(r)["Growth of normal flora; no pathogens isolated"].associated_ids)})},u(e(r)["Growth of normal flora; no pathogens isolated"].total),1),t("td",{class:"px-2 py-2 hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:o[6]||(o[6]=l=>p("Growth of contaminants",e(r)["Growth of contaminants"].total,e(r)["Growth of contaminants"].associated_ids))},u((E=e(r)["Growth of contaminants"])==null?void 0:E.total),1)])])],512)):M("",!0),J(t("div",Re,[c(V),ke],512),[[W,e(i)]]),!R(e(r))&&!e(i)?(_(),h("div",Ce,$e)):M("",!0)])])}}});export{Oe as default};
