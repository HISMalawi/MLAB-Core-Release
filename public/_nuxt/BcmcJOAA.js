import{_ as ue}from"./BBiETNY7.js";import{b as g,e as k,g as t,a as M,u as P,l as B,m as u,f as o,n as f,p as q,i as I,q as E,_ as j,v as N,t as T,F as Y,j as J,k as oe,s as $,r as A,d as me,c as pe,w as se,o as fe,h as b,x as R,y as _e}from"./Br_iYJbE.js";import{_ as Q}from"./BWngzJgz.js";import{e as ae}from"./D_g9DqRP.js";import{r as le,e as D,f as C,h as he}from"./Dog3sDT3.js";import{r as O}from"./BoyxTlis.js";import{r as W}from"./DTSB-ANa.js";import{r as ne}from"./Br7KoB9m.js";import{r as ee}from"./LdByUpVJ.js";import{S as G,h as X,Y as Z,G as z,V as K}from"./a0kEX_gA.js";import{_ as ve}from"./DRMfFlf3.js";import{r as ge,a as ie}from"./BxXqpYSD.js";import{r as xe}from"./AtAlRHB5.js";import{_ as ye}from"./_RoJ7CPk.js";import{u as we}from"./C7tJ_rpQ.js";import{u as F}from"./Dm23Mrta.js";import{P as be}from"./CsuZ4PXZ.js";import"./C3HP_w3b.js";import"./CsEX3TnJ.js";import"./tiZpgdZ8.js";import"./CKyme56o.js";import"./2-4F2Czp.js";import"./CLSVoOUE.js";import"./BIfGgD6z.js";function ke(n,e){return g(),k("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z","clip-rule":"evenodd"})])}const De={components:{TransitionRoot:G,TransitionChild:X,Dialog:Z,DialogPanel:z,DialogTitle:K,XMarkIcon:O,UserIcon:W},data(){return{open:!1,addIcon:le,saveIcon:ne,clearIcon:ee,departmentSelected:null,departments:new Array,rawDepartments:new Array,cookie:M("token"),roles:new Array,rawRoles:new Array,roleSelected:null,rawLocations:new Array,locations:new Array,locationSelected:null,firstName:"",middleName:"",lastName:"",username:"",sex:"",password:"",confirmPassword:"",dateOfBirth:"",loading:!1,maxDate:(()=>{const n=new Date;return n.setFullYear(n.getFullYear()-14),n.setDate(n.getDate()+1),n})()}},methods:{async loadRoles(){const n={route:D.roles,method:"GET",token:`${this.cookie}`},{data:e,error:a}=await C(n);e.value&&(this.rawRoles=e.value,e.value.map(m=>{this.roles.push(m.name)})),a.value&&console.error(a.value)},async loadLocations(){const n={route:D.locations,method:"GET",token:`${this.cookie}`},{data:e,error:a}=await C(n);e.value&&(this.rawLocations=e.value,e.value.map(m=>{this.locations.push(m.name)})),a.value&&console.error(a.value)},async loadDepartments(){const n={route:D.departments,method:"GET",token:`${this.cookie}`},{data:e,error:a}=await C(n);e.value&&(this.rawDepartments=e.value,e.value.map(m=>{this.departments.push(m.name)})),a.value&&console.error(a.value)},async submitForm(){this.loading=!0;const n=this.departmentSelected?this.departmentSelected.map(l=>{var d;return(d=this.rawDepartments.find(v=>l===v.name))==null?void 0:d.id}).filter(l=>l!==void 0).map(Number):[],e=this.roleSelected?this.roleSelected.map(l=>{var d;return(d=this.rawRoles.find(v=>l===v.name))==null?void 0:d.id}).filter(l=>l!==void 0):[],a=this.locationSelected?this.locationSelected.map(l=>{var d;return(d=this.rawLocations.find(v=>l===v.name))==null?void 0:d.id}).filter(l=>l!==void 0).map(Number):[],m={route:D.users,method:"POST",token:`${this.cookie}`,body:{person:{first_name:this.firstName,middle_name:this.middleName,last_name:this.lastName,sex:this.sex,date_of_birth:this.dateOfBirth},user:{username:this.username,password:this.password},roles:e,departments:n,lab_locations:a}},{data:s,error:i,pending:c}=await C(m);this.loading=c,s.value&&(this.handleClick(),P().$toast.success("User created successfully!"),this.$emit("update",!0),this.loading=!1),i.value&&(this.handleClick(),P().$toast.error(ae),this.loading=!1,console.error(i.value))},async init(){await this.loadDepartments(),await this.loadRoles(),await this.loadLocations(),this.handleClick()},clearForm(){this.$formkit.reset("submitForm")},handleClick(){this.open=!this.open}}},te="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6%2036C6%2031.0347%2017.9925%2028%2024%2028C30.0075%2028%2042%2031.0347%2042%2036V42H6V36Z'%20fill='%23333333'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M24%2024C28.4183%2024%2032%2020.4183%2032%2016C32%2011.5817%2028.4183%208%2024%208C19.5817%208%2016%2011.5817%2016%2016C16%2020.4183%2019.5817%2024%2024%2024ZM24%2026C29.5228%2026%2034%2021.5228%2034%2016C34%2010.4772%2029.5228%206%2024%206C18.4772%206%2014%2010.4772%2014%2016C14%2021.5228%2018.4772%2026%2024%2026Z'%20fill='%23333333'/%3e%3c/svg%3e",Ce=t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Ve={class:"fixed inset-0 overflow-y-auto"},Se={class:"flex min-h-full items-center justify-center p-4 text-center"},Te={class:"border-b px-3 py-3 flex items-center justify-between"},Ue=t("img",{src:te,class:"w-8 h-8 mr-2"},null,-1),Ae={class:"mt-2 space-y-3 px-5"},Ie={class:"grid grid-cols-2 gap-4"},$e={class:"grid grid-cols-2 gap-4"},qe={class:"grid grid-cols-2 gap-4"},Pe={class:"flex items-center"},Le=t("label",{class:"mr-5 font-medium text-lg"},"Sex",-1),Re={class:"flex items-center"},Fe=t("span",{class:"ml-2"},"Male",-1),Me={class:"flex items-center ml-2"},Ee=t("span",{class:"ml-2"},"Female",-1),Ne={class:"w-full flex flex-col"},Be={class:"w-full flex flex-col space-y-2"},je=t("label",{class:"font-medium"},"Select Role(s)",-1),Oe={class:"w-full flex flex-col"},Ge={class:"w-full flex flex-col space-y-2"},Xe=t("label",{class:"font-medium"},"Select Laboratory Location(s)",-1),Ze={class:"w-full flex flex-col"},ze={class:"w-full flex flex-col space-y-2"},Ke=t("label",{class:"font-medium"},"Select Lab Section(s)",-1),He={class:"px-5"},Ye=t("p",{class:"py-2 font-medium text-base"},"Date Of Birth",-1),Je={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Qe(n,e,a,m,s,i){const c=j,l=u("TransitionChild"),d=u("DialogTitle"),v=u("XMarkIcon"),x=u("FormKit"),h=u("multi-select"),S=u("datepicker"),w=Q,y=u("DialogPanel"),r=u("Dialog"),V=u("TransitionRoot");return g(),k("div",null,[t("div",null,[o(c,{text:"Add user",color:"primary",icon:s.addIcon,click:i.init},null,8,["icon","click"])]),o(V,{appear:"",show:s.open,as:"template"},{default:f(()=>[o(r,{as:"div",onClose:i.handleClick,class:"relative z-10"},{default:f(()=>[o(l,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:f(()=>[Ce]),_:1}),t("div",Ve,[t("div",Se,[o(l,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:f(()=>[o(y,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:f(()=>[t("div",Te,[o(d,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:f(()=>[Ue,q(" Add user ")]),_:1}),t("button",{onClick:e[0]||(e[0]=(...U)=>i.handleClick&&i.handleClick(...U))},[o(v,{class:"w-5 h-5"})])]),o(x,{type:"form",id:"submitForm","submit-label":"Update",onSubmit:i.submitForm,actions:!1},{default:f(({value:U})=>[t("div",Ae,[t("div",Ie,[o(x,{type:"text",label:"Username",validation:"required|matches:/^[a-zA-Z]+$/","validation-messages":{matches:"Username must contain only letters, no spaces or special characters"},modelValue:s.username,"onUpdate:modelValue":e[1]||(e[1]=p=>s.username=p)},null,8,["modelValue"]),o(x,{type:"text",label:"First name",modelValue:s.firstName,"onUpdate:modelValue":e[2]||(e[2]=p=>s.firstName=p),validation:"required|matches:/^[a-zA-Z]+$/","validation-messages":{matches:"First name must contain only letters, no spaces or special characters"}},null,8,["modelValue"])]),t("div",$e,[o(x,{type:"text",label:"Middle name",modelValue:s.middleName,"onUpdate:modelValue":e[3]||(e[3]=p=>s.middleName=p)},null,8,["modelValue"]),o(x,{type:"text",label:"Last name",modelValue:s.lastName,"onUpdate:modelValue":e[4]||(e[4]=p=>s.lastName=p),validation:"required|matches:/^[a-zA-Z]+$/","validation-messages":{matches:"Last name must contain only letters, no spaces or special characters"}},null,8,["modelValue"])]),o(x,{type:"group"},{default:f(()=>[t("div",qe,[o(x,{type:"password",label:"Password",name:"password",validation:"required",modelValue:s.password,"onUpdate:modelValue":e[5]||(e[5]=p=>s.password=p),"validation-visibility":"live"},null,8,["modelValue"]),o(x,{type:"password",label:"Confirm password",name:"password_confirm",validation:"required|confirm","validation-label":"Password confirmation","validation-visibility":"live"})])]),_:1}),t("div",Pe,[Le,t("label",Re,[I(t("input",{required:"","onUpdate:modelValue":e[6]||(e[6]=p=>s.sex=p),type:"radio",value:"M",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[E,s.sex]]),Fe]),t("label",Me,[I(t("input",{required:"","onUpdate:modelValue":e[7]||(e[7]=p=>s.sex=p),type:"radio",value:"F",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[E,s.sex]]),Ee])]),t("div",Ne,[t("div",Be,[je,o(h,{style:{"--ms-max-height":"none !important"},modelValue:s.roleSelected,"onUpdate:modelValue":e[8]||(e[8]=p=>s.roleSelected=p),options:s.roles,mode:"tags",searchable:!0,required:!0,clear:"",class:"outline-none focus:ring-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),t("div",Oe,[t("div",Ge,[Xe,o(h,{style:{"--ms-max-height":"none !important"},modelValue:s.locationSelected,"onUpdate:modelValue":e[9]||(e[9]=p=>s.locationSelected=p),options:s.locations,mode:"tags",searchable:!0,required:!0,clear:"",class:"outline-none focus:ring-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),t("div",Ze,[t("div",ze,[Ke,o(h,{style:{"--ms-max-height":"none !important"},modelValue:s.departmentSelected,"onUpdate:modelValue":e[10]||(e[10]=p=>s.departmentSelected=p),options:s.departments,mode:"tags",searchable:!0,required:!0,clear:"",class:"outline-none focus:ring-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])])]),t("div",He,[Ye,o(S,{range:!1,"input-class-name":"datepicker",format:"dd/MM/yyyy",position:"left",placeholder:"select date of birth",modelValue:s.dateOfBirth,"onUpdate:modelValue":e[11]||(e[11]=p=>s.dateOfBirth=p)},null,8,["modelValue"])]),t("div",Je,[o(w,{type:"button",click:()=>{i.clearForm()},text:"Clear form"},null,8,["click"]),o(c,{loading:s.loading,type:"submit",click:()=>{},color:"success",icon:s.saveIcon,text:"Save Changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const We=B(De,[["render",Qe]]),et={components:{TransitionRoot:G,TransitionChild:X,Dialog:Z,DialogPanel:z,DialogTitle:K,XMarkIcon:O,UserIcon:W},props:{data:{required:!0,type:Object}},data(){return{moment:he,open:!1,addIcon:le,viewIcon:ge,editIcon:ie,clearIcon:ee,details:{id:"",username:"",first_name:"",last_name:"",middle_name:"",sex:"",date_of_birth:"",lab_locations:new Array,roles:new Array,departments:new Array},loading:!1,cookie:M("token")}},methods:{async init(){this.loading=!0;const n={route:`${D.users}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:e,error:a,pending:m}=await C(n);this.loading=m,e.value&&(this.details=e.value,this.loading=!1,this.handleDialog()),a.value&&(console.error(a.value),this.loading=!1)},handleDialog(){this.open=!this.open}}},tt=t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),st={class:"fixed inset-0 overflow-y-auto"},ot={class:"flex min-h-full items-center justify-center p-4 text-center"},at={class:"border-b px-3 py-3 flex items-center justify-between"},lt=t("img",{src:te,class:"w-6 h-6 mr-2"},null,-1),nt={class:"flex items-center justify-center mx-auto my-20"},it={class:"space-y-3 px-5 py-5"},rt={class:"w-full flex flex-col space-y-1"},ct=t("label",{class:"font-semibold text-lg"},"Username",-1),dt={class:"text-base text-gray-600"},ut={class:"w-full flex flex-col space-y-1"},mt=t("label",{class:"font-semibold text-lg"},"First name",-1),pt={class:"text-base text-gray-600"},ft={class:"w-full flex flex-col space-y-1"},_t=t("label",{class:"font-semibold text-lg"},"Last name",-1),ht={class:"text-base text-gray-600"},vt={class:"w-full flex flex-col space-y-1"},gt=t("label",{class:"font-semibold text-lg"},"Date of birth",-1),xt={class:"text-base text-gray-600"},yt={class:"w-full flex flex-col space-y-1"},wt=t("label",{class:"font-semibold text-lg"},"Roles",-1),bt={class:"w-full flex flex-col space-y-1"},kt=t("label",{class:"font-semibold text-lg"},"Locations",-1),Dt={class:"w-full flex flex-col space-y-1"},Ct=t("label",{class:"font-semibold text-lg"},"Departments",-1);function Vt(n,e,a,m,s,i){const c=j,l=u("TransitionChild"),d=u("DialogTitle"),v=u("XMarkIcon"),x=oe,h=u("DialogPanel"),S=u("Dialog"),w=u("TransitionRoot");return g(),k("div",null,[t("div",null,[o(c,{text:"View",color:"primary",icon:s.viewIcon,click:i.init},null,8,["icon","click"])]),o(w,{appear:"",show:s.open,as:"template"},{default:f(()=>[o(S,{as:"div",onClose:i.handleDialog,class:"relative z-10"},{default:f(()=>[o(l,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:f(()=>[tt]),_:1}),t("div",st,[t("div",ot,[o(l,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:f(()=>[o(h,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:f(()=>[t("div",at,[o(d,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:f(()=>[lt,q(" View User Account ")]),_:1}),t("button",{onClick:e[0]||(e[0]=(...y)=>i.handleDialog&&i.handleDialog(...y))},[o(v,{class:"w-5 h-5"})])]),I(t("div",nt,[o(x,{loading:s.loading},null,8,["loading"])],512),[[N,s.loading]]),I(t("div",it,[t("div",rt,[ct,t("p",dt,T(s.details.username),1)]),t("div",ut,[mt,t("p",pt,T(s.details.first_name),1)]),t("div",ft,[_t,t("p",ht,T(s.details.last_name),1)]),t("div",vt,[gt,t("p",xt,T(s.details.date_of_birth),1)]),t("div",yt,[wt,(g(!0),k(Y,null,J(s.details.roles,(y,r)=>(g(),k("p",{class:"text-base text-gray-600",key:r},T(y.role_name),1))),128))]),t("div",bt,[kt,(g(!0),k(Y,null,J(s.details.lab_locations,(y,r)=>(g(),k("p",{class:"text-base text-gray-600",key:r},T(y.name),1))),128))]),t("div",Dt,[Ct,(g(!0),k(Y,null,J(s.details.departments,(y,r)=>(g(),k("p",{class:"text-base text-gray-600",key:r},T(y.name),1))),128))])],512),[[N,!s.loading]])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const St=B(et,[["render",Vt]]),Tt={components:{TransitionRoot:G,TransitionChild:X,Dialog:Z,DialogPanel:z,DialogTitle:K,XMarkIcon:O,UserIcon:W},data(){return{open:!1,editIcon:ie,saveIcon:ne,clearIcon:ee,departmentSelected:null,departments:new Array,rawDepartments:new Array,rawLocations:new Array,locations:new Array,locationSelected:null,cookie:M("token"),roles:new Array,rawRoles:new Array,roleSelected:null,firstName:"",middleName:"",lastName:"",username:"",sex:"",password:"",confirmPassword:"",dateOfBirth:"",loading:!1,fetching:!1,details:{id:"",username:"",first_name:"",last_name:"",middle_name:"",old_password:"",new_password:"",sex:"",date_of_birth:"",roles:new Array,lab_locations:new Array,departments:new Array}}},props:{data:{required:!0,type:Object}},methods:{handleClick(){this.open=!this.open},async init(){await this.loadRoles(),await this.loadDepartments(),await this.loadLocations(),this.handleClick(),this.fetching=!0;const n={route:`${D.users}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:e,error:a,pending:m}=await C(n);if(this.fetching=m,e.value){this.details=e.value,this.fetching=!1;const s=e.value.roles.map(({role_name:c})=>{var l;return(l=this.rawRoles.find(d=>c===d.name))==null?void 0:l.name}).filter(c=>c!==void 0);this.roleSelected=s;const i=e.value.departments.map(({name:c})=>{var l;return(l=this.rawDepartments.find(d=>c===d.name))==null?void 0:l.name}).filter(c=>c!==void 0);this.departmentSelected=i,this.locationSelected=e.value.lab_locations.map(({name:c})=>{var l;return(l=this.rawLocations.find(d=>c===d.name))==null?void 0:l.name}).filter(c=>c!==void 0)}a.value&&(console.error(a.value),this.fetching=!1)},async loadRoles(){const n={route:D.roles,method:"GET",token:`${this.cookie}`},{data:e,error:a}=await C(n);e.value&&(this.rawRoles=e.value,e.value.map(m=>{this.roles.push(m.name)})),a.value&&console.error(a.value)},async loadLocations(){const n={route:D.locations,method:"GET",token:`${this.cookie}`},{data:e,error:a}=await C(n);e.value&&(this.rawLocations=e.value,e.value.map(m=>{this.locations.push(m.name)})),a.value&&console.error(a.value)},async loadDepartments(){const n={route:D.departments,method:"GET",token:`${this.cookie}`},{data:e,error:a}=await C(n);e.value&&(this.rawDepartments=e.value,e.value.map(m=>{this.departments.push(m.name)})),a.value&&console.error(a.value)},async submitForm(){this.loading=!0;const n=this.departmentSelected?this.departmentSelected.map(l=>{var d;return(d=this.rawDepartments.find(v=>l===v.name))==null?void 0:d.id}).filter(l=>l!==void 0).map(Number):[],e=this.roleSelected?this.roleSelected.map(l=>{var d;return(d=this.rawRoles.find(v=>l===v.name))==null?void 0:d.id}).filter(l=>l!==void 0):[],a=this.locationSelected?this.locationSelected.map(l=>{var d;return(d=this.rawLocations.find(v=>l===v.name))==null?void 0:d.id}).filter(l=>l!==void 0).map(Number):[];console.log(a);const m={route:`${D.users}/${this.data.id}`,method:"PUT",token:`${this.cookie}`,body:{person:{first_name:this.details.first_name,middle_name:this.details.middle_name,last_name:this.details.last_name,sex:this.details.sex,date_of_birth:this.details.date_of_birth},user:{username:this.details.username,old_password:this.details.old_password,password:this.details.new_password},roles:e,departments:n,lab_locations:a}},{data:s,error:i,pending:c}=await C(m);this.loading=c,s.value&&(this.handleClick(),P().$toast.success("User updated successfully!"),this.loading=!1,this.$emit("update",!0)),i.value&&(console.error(i.value),this.handleClick(),P().$toast.error(ae),this.loading=!1)}}},Ut=t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),At={class:"mx-auto flex justify-center py-20 bg-white"},It={class:"fixed inset-0 overflow-y-auto"},$t={class:"flex min-h-full items-center justify-center p-4 text-center"},qt={class:"border-b px-3 py-3 flex items-center justify-between"},Pt=t("img",{src:te,class:"w-8 h-8 mr-2",alt:"person-icon"},null,-1),Lt={class:"mt-2 space-y-3 px-5 py-5"},Rt={class:"grid grid-cols-2 gap-4"},Ft={class:"grid grid-cols-2 gap-4"},Mt={class:"grid grid-cols-2 gap-4"},Et={class:"w-full flex flex-col space-y-2"},Nt={class:"w-full flex flex-col space-y-2"},Bt={class:"flex items-center"},jt=t("label",{class:"mr-5 font-medium text-lg"},"Sex",-1),Ot={class:"flex items-center"},Gt=t("span",{class:"ml-2"},"Male",-1),Xt={class:"flex items-center ml-2"},Zt=t("span",{class:"ml-2"},"Female",-1),zt={class:"w-full flex flex-col"},Kt={class:"w-full flex flex-col space-y-2"},Ht=t("label",{class:"font-medium"},"Select Role(s)",-1),Yt={class:"w-full flex flex-col"},Jt={class:"w-full flex flex-col space-y-2"},Qt=t("label",{class:"font-medium"},"Select Laboratory Location(s)",-1),Wt={class:"w-full flex flex-col"},es={class:"w-full flex flex-col space-y-2"},ts=t("label",{class:"font-medium"},"Select Lab Section(s)",-1),ss={class:"px-5"},os=t("p",{class:"py-2 font-medium text-base"},"Date Of Birth",-1),as={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function ls(n,e,a,m,s,i){const c=j,l=u("TransitionChild"),d=oe,v=u("DialogTitle"),x=u("XMarkIcon"),h=u("FormKit"),S=u("multi-select"),w=u("datepicker"),y=Q,r=u("DialogPanel"),V=u("Dialog"),U=u("TransitionRoot");return g(),k("div",null,[t("div",null,[o(c,{text:"Edit",color:"primary",icon:s.editIcon,click:i.init},null,8,["icon","click"])]),o(U,{appear:"",show:s.open,as:"template"},{default:f(()=>[o(V,{as:"div",onClose:i.handleClick,class:"relative z-10"},{default:f(()=>[o(l,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:f(()=>[Ut]),_:1}),I(t("div",At,[o(d)],512),[[N,s.fetching]]),I(t("div",It,[t("div",$t,[o(l,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:f(()=>[o(r,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:f(()=>[t("div",qt,[o(v,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:f(()=>[Pt,q(" Edit user ")]),_:1}),t("button",{onClick:e[0]||(e[0]=(...p)=>i.handleClick&&i.handleClick(...p))},[o(x,{class:"w-5 h-5"})])]),o(h,{type:"form","submit-label":"Update",onSubmit:i.submitForm,actions:!1},{default:f(({value:p})=>[t("div",Lt,[t("div",Rt,[o(h,{type:"text",label:"Username",modelValue:s.details.username,"onUpdate:modelValue":e[1]||(e[1]=_=>s.details.username=_),validation:"required|matches:/^[a-zA-Z]+$/","validation-messages":{matches:"Username must contain only letters and spaces"}},null,8,["modelValue"]),o(h,{type:"text",label:"First name",modelValue:s.details.first_name,"onUpdate:modelValue":e[2]||(e[2]=_=>s.details.first_name=_),validation:"required|matches:/^[a-zA-Z]+$/","validation-messages":{matches:"First name must contain only letters and spaces"}},null,8,["modelValue"])]),t("div",Ft,[o(h,{type:"text",label:"Middle name",modelValue:s.details.middle_name,"onUpdate:modelValue":e[3]||(e[3]=_=>s.details.middle_name=_)},null,8,["modelValue"]),o(h,{type:"text",label:"Last name",modelValue:s.details.last_name,"onUpdate:modelValue":e[4]||(e[4]=_=>s.details.last_name=_),validation:"required|matches:/^[a-zA-Z]+$/","validation-messages":{matches:"Last name must contain only letters and spaces"}},null,8,["modelValue"])]),o(h,{type:"group"},{default:f(()=>[t("div",Mt,[t("div",Et,[o(h,{type:"password",label:"New password",name:"password",modelValue:s.details.new_password,"onUpdate:modelValue":e[5]||(e[5]=_=>s.details.new_password=_),"validation-visibility":"live"},null,8,["modelValue"])]),t("div",Nt,[o(h,{type:"password",label:"Confirm new password",name:"password_confirm",validation:s.details.new_password&&"required|confirm","validation-label":"Password confirmation","validation-visibility":"live"},null,8,["validation"])])])]),_:1}),t("div",Bt,[jt,t("label",Ot,[I(t("input",{required:"","onUpdate:modelValue":e[6]||(e[6]=_=>s.details.sex=_),type:"radio",value:"M",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[E,s.details.sex]]),Gt]),t("label",Xt,[I(t("input",{required:"","onUpdate:modelValue":e[7]||(e[7]=_=>s.details.sex=_),type:"radio",value:"F",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[E,s.details.sex]]),Zt])]),t("div",zt,[t("div",Kt,[Ht,o(S,{style:{"--ms-max-height":"none !important"},modelValue:s.roleSelected,"onUpdate:modelValue":e[8]||(e[8]=_=>s.roleSelected=_),options:s.roles,mode:"tags",searchable:!0,required:!0,clear:"",class:"outline-none focus:ring-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),t("div",Yt,[t("div",Jt,[Qt,o(S,{style:{"--ms-max-height":"none !important"},modelValue:s.locationSelected,"onUpdate:modelValue":e[9]||(e[9]=_=>s.locationSelected=_),options:s.locations,mode:"tags",searchable:!0,required:!0,clear:"",class:"outline-none focus:ring-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),t("div",Wt,[t("div",es,[ts,o(S,{style:{"--ms-max-height":"none !important"},modelValue:s.departmentSelected,"onUpdate:modelValue":e[10]||(e[10]=_=>s.departmentSelected=_),options:s.departments,mode:"tags",searchable:!0,required:!0,clear:"",class:"outline-none focus:ring-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])])]),t("div",ss,[os,o(w,{range:!1,"input-class-name":"datepicker",format:"dd/MM/yyyy",position:"left",placeholder:"select date of birth",modelValue:s.details.date_of_birth,"onUpdate:modelValue":e[11]||(e[11]=_=>s.details.date_of_birth=_)},null,8,["modelValue"])]),t("div",as,[o(y,{type:"button",click:()=>{},text:"Clear form"}),o(c,{loading:s.loading,type:"submit",click:()=>{},color:"success",icon:s.saveIcon,text:"Save Changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])],512),[[N,!s.fetching]])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const ns=B(Tt,[["render",ls]]),is={components:{TransitionRoot:G,TransitionChild:X,Dialog:Z,DialogPanel:z,DialogTitle:K,XMarkIcon:O,ExclamationTriangleIcon:xe},data(){return{show:!1,disableIcon:ke,loading:!1,reason:"",cookie:M("token"),details:{id:"",username:"",first_name:"",last_name:"",middle_name:"",sex:"",date_of_birth:"",lab_locations:new Array,roles:new Array,departments:new Array}}},props:{data:{type:Object,required:!0}},methods:{async init(){this.loading=!0;const n={route:`${D.users}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:e,error:a,pending:m}=await C(n);this.loading=m,e.value&&(this.details=e.value,this.loading=!1,this.handleDialog()),a.value&&(console.error(a.value),this.loading=!1)},async deleteData(n){this.loading=!0;const e={route:`${D.users}/${n}`,method:"DELETE",token:`${this.cookie}`},{pending:a,error:m,data:s}=await C(e);this.loading=a,s.value&&(this.handleDialog(),P().$toast.success(`${s.value.message}`),this.loading=!1,this.$emit("update",!0),this.reason=""),m.value&&(console.log(s.value),this.loading=!1)},async activate(n){this.loading=!0;const e={route:`${D.users}/activate/${n}`,method:"PUT",token:`${this.cookie}`,body:{retired_reason:this.reason}},{pending:a,error:m,data:s}=await C(e);this.loading=a,s.value&&(this.handleDialog(),P().$toast.success(`${s.value.message}`),this.loading=!1,this.$emit("update",!0),this.reason=""),m.value&&(console.log(s.value),this.loading=!1)},handleDialog(){this.show=!this.show}}},rs={key:0},cs={key:1},ds=t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),us={class:"fixed inset-0 overflow-y-auto"},ms={class:"flex min-h-full items-center justify-center p-4 text-center"},ps={class:"border-b px-3 py-3 flex items-center justify-between"},fs={class:"mt-2 space-y-3 px-5"},_s={class:"rounded px-2 py-2"},hs={class:"font-semibold text-red-500"},vs={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function gs(n,e,a,m,s,i){const c=j,l=u("TransitionChild"),d=u("ExclamationTriangleIcon"),v=u("DialogTitle"),x=u("XMarkIcon"),h=u("FormKit"),S=Q,w=u("DialogPanel"),y=u("Dialog"),r=u("TransitionRoot");return g(),k("div",null,[t("div",null,[a.data.is_active?(g(),k("div",rs,[o(c,{click:i.init,color:"error",text:"Disable",icon:s.disableIcon},null,8,["click","icon"])])):$("",!0),a.data.is_active?$("",!0):(g(),k("div",cs,[o(c,{click:i.init,color:"success",text:"Enable",icon:s.disableIcon},null,8,["click","icon"])]))]),o(r,{appear:"",show:s.show,as:"template"},{default:f(()=>[o(y,{as:"div",class:"relative z-10"},{default:f(()=>[o(l,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:f(()=>[ds]),_:1}),t("div",us,[t("div",ms,[o(l,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:f(()=>[o(w,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:f(()=>[t("div",ps,[o(v,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:f(()=>[o(d,{class:"h-5 w-5 mr-2"}),q(" "+T(a.data.is_active?"Confirm disable":"Confirm activate"),1)]),_:1}),t("button",{onClick:e[0]||(e[0]=(...V)=>i.handleDialog&&i.handleDialog(...V))},[o(x,{class:"w-5 h-5"})])]),o(h,{type:"form","submit-label":"Update",onSubmit:e[2]||(e[2]=V=>a.data.is_active?i.deleteData(a.data.id):i.activate(a.data.id)),actions:!1},{default:f(({value:V})=>[t("div",fs,[t("div",_s,[q(" Do you want to "+T(a.data.is_active?"disable":"activate")+" ",1),t("span",hs,T(a.data.username),1),q(" account? Note that once this action is completed, it can not be undone ")]),o(h,{type:"textarea",label:"Reason",validation:"required",modelValue:s.reason,"onUpdate:modelValue":e[1]||(e[1]=U=>s.reason=U)},null,8,["modelValue"])]),t("div",vs,[o(S,{click:i.handleDialog,type:"button",text:"Cancel"},null,8,["click"]),o(c,{loading:s.loading,type:"submit",click:()=>{},color:"success",icon:s.disableIcon,text:"Continue"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const xs=B(is,[["render",gs]]),ys=()=>{const n=A([{text:"id",value:"id",sortable:!0},{text:"username",value:"username",sortable:!0},{text:"full name",value:"fullname",sortable:!0},{text:"sex",value:"sex",sortable:!0},{text:"actions",value:"actions"}]),e=A([{name:"Home",link:"/home"},{name:"Access Controls",link:"#"}]);return{HEADERS:n,PAGES:e}},ws={class:"py-5 px-5"},bs={class:"flex items-center justify-between py-5"},ks={class:"text-2xl font-semibold"},Ds={class:"flex justify-end w-full px-2 py-2 mb-2"},Cs={class:"py-2 flex items-center space-x-2"},Ys=me({__name:"user-accounts",setup(n){we({title:`${be.name.toUpperCase()} - User Accounts`});const e=A("List of users"),a=ys(),m=a.HEADERS.value,s=A([]),i=M("token"),c=A(!1),l=A(""),d=A(""),v=a.PAGES.value,x=A(0),h=A({page:1,rowsPerPage:25,sortBy:"name"}),S=pe(()=>s.value.map(r=>({id:r.id,is_active:r.is_active,username:r.username.charAt(0).toUpperCase()+r.username.slice(1),fullname:`${r.first_name} ${r.last_name}`,sex:r.sex})));async function w(){c.value=!0;const{page:r,rowsPerPage:V}=h.value,U={route:`${D.users}?page=${r}&per_page=${V}&search=${l.value}`,method:"GET",token:`${i.value}`},{data:p,error:_,pending:H}=await C(U);c.value=H,p.value&&(s.value=p.value.data,c.value=!1,x.value=p.value.meta.total_count),_.value&&(console.error(_.value),c.value=!1)}const y=r=>{typeof r=="object"&&(h.value=r)};return se(l,()=>{w()}),se(h,()=>{w()}),fe(()=>{w()}),(r,V)=>{const U=ue,p=We,_=ve,H=St,re=ns,ce=xs,de=ye;return g(),k("div",ws,[o(U,{pages:b(v)},null,8,["pages"]),t("div",bs,[t("h3",ks,T(b(e)),1),("usePermissions"in r?r.usePermissions:b(F))().can.manage("users")?(g(),R(p,{key:0,onUpdate:w})):$("",!0)]),t("div",Ds,[o(_,{search:b(l),"onUpdate:search":V[0]||(V[0]=L=>_e(l)?l.value=L:null)},null,8,["search"])]),("usePermissions"in r?r.usePermissions:b(F))().can.manage("users")?(g(),R(de,{key:0,headers:b(m),data:b(S),loading:b(c),searchField:"username",searchValue:b(d),serverItemsLength:b(x),serverOptions:b(h),onUpdate:y},{actions:f(({item:L})=>[t("div",Cs,[("usePermissions"in r?r.usePermissions:b(F))().can.manage("users")?(g(),R(H,{key:0,data:L},null,8,["data"])):$("",!0),("usePermissions"in r?r.usePermissions:b(F))().can.manage("users")?(g(),R(re,{key:1,data:L,onUpdate:w},null,8,["data"])):$("",!0),("usePermissions"in r?r.usePermissions:b(F))().can.manage("users")?(g(),R(ce,{key:2,data:L,onUpdate:w},null,8,["data"])):$("",!0)])]),_:1},8,["headers","data","loading","searchValue","serverItemsLength","serverOptions"])):$("",!0)])}}});export{Ys as default};
