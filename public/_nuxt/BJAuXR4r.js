import{l as P,b as u,e as m,F as v,j as x,g as e,P as T,a as E,u as I,m as k,i as g,v as U,f as n,t as C,n as O,U as R,s as V,aA as j,p as B,_ as L}from"./DkSHUfZG.js";import{_ as G}from"./BvEqexTj.js";import{r as $,_ as H}from"./DAN85N2r.js";import{u as K}from"./uQJ05scD.js";import{r as X,e as y,f,k as q,d as Y}from"./D2LBdSgo.js";import{P as z}from"./Bf5grz7u.js";import{r as M}from"./CFqEtL_8.js";import{r as J}from"./lQpKi9YL.js";import{r as Q}from"./neGiqG6Z.js";import{r as Z}from"./CLtT9xnK.js";import{r as ee}from"./DPnmkidM.js";import{r as te}from"./DPH2a7O9.js";import{r as se}from"./CH6bbBJF.js";import{a as oe}from"./BwUwUGKT.js";import{S as ne,h as le,Y as ae,G as ie,V as re}from"./C_hGcfdC.js";import{I as de,E as ue,j as me,A as ce,F as pe}from"./KwrjAXlL.js";import"./Bit5kMcC.js";import"./jXHX7K2g.js";import"./BIVUZcpC.js";import"./CUSkJlEU.js";import"./B5NVDA4R.js";import"./BzCrDE1y.js";import"./CEYBmAkp.js";import"./_yfpsPGK.js";import"./DthfA08H.js";import"./fnXoGXtg.js";const _e={},he={class:"flex flex-col space-y-2.5"},ge=e("div",{class:"w-full bg-gray-100 animate-pulse h-10 rounded"},null,-1),ye=e("div",{class:"w-1/2 bg-gray-100 animate-pulse h-10 rounded"},null,-1),fe=e("div",{class:"w-1/3 bg-gray-100 animate-pulse h-10 rounded"},null,-1),ve=e("div",{class:"w-1/2 bg-gray-100 animate-pulse h-10 rounded"},null,-1),xe=e("div",{class:"w-1/2 bg-gray-100 animate-pulse h-10 rounded"},null,-1),be=[ve,xe],Ve=e("div",{class:"w-48 flex items-center justify-end bg-gray-100 animate-pulse h-10 rounded"},null,-1);function we(i,t,a,c,s,p){return u(),m("div",he,[ge,ye,fe,(u(),m(v,null,x(12,h=>e("div",{class:"flex items-center space-x-2.5",key:h},be)),64)),Ve])}const ke=P(_e,[["render",we]]),Se={components:{TransitionRoot:ne,TransitionChild:le,Dialog:ae,DialogPanel:ie,DialogTitle:re,Listbox:de,ListboxLabel:ue,ListboxButton:me,ListboxOptions:ce,ListboxOption:pe,XMarkIcon:M,UserIcon:J,CheckCircleIcon:Q,InformationCircleIcon:Z,ChevronUpDownIcon:$},setup(){K({title:`${z.name.toUpperCase()} - Test Types`})},data(){return{open:!1,addIcon:X,saveIcon:ee,clearIcon:te,removeIcon:M,trashIcon:se,loadingSpecimens:!1,showMeasures:!1,measures:1,ranges:0,indicators:[{name:"",test_indicator_type:0,unit:"",description:"",indicator_ranges:[]}],numericRange:{max_age:0,min_age:0,lower_range:0,upper_range:0,interpretation:""},autocompleteRange:{value:"",interpretation:""},name:"",shortName:"",turnAroundTime:"",measureTypes:Array(),measureSelected:{name:"",id:0},loading:!1,updating:!1,editIcon:oe,id:(this._.provides[T]||this.$route).query.testType,patientSex:new Array({name:"Male",label:"Male",value:"M"},{name:"Female",label:"Female",value:"F"},{name:"Both",label:"Both",value:"Both"}),details:{name:"",short_name:"",expected_turn_around_time:{value:"",unit:""},test_indicator_type:{id:0,name:""},department:{id:0,name:""},specimens:{id:0,name:"",created_date:""},indicators:new Array,organisms:new Array},specimensSelected:new Array,rawOrganisms:new Array,organisms:new Array,organismsSelected:new Array,shouldPrintResults:!1,showCultureWorksheet:!1,timeTypes:new Array({name:"Month"},{name:"Weeks"},{name:"Days"},{name:"Hours"},{name:"Minutes"}),duration:{name:"-- select value --"},expected_turn_around_time:"",cookie:E("token"),rawSpecimens:new Array,specimens:new Array,departments:new Array,measureType:"",pages:[{name:"Home",link:"/home"},{name:"Test Catalog",link:"#"},{name:"Test Types",link:"/test-catalog/test-types"}]}},created(){this.init()},methods:{async init(){var s,p,h;this.loading=!0,await this.loadSpecimens(),await this.loadDepartments(),await this.loadTestTypeIndicators(),await this.loadOrganisms();const i={route:`${y.viewTestType}/${(this._.provides[T]||this.$route).query.testType}`,method:"GET",token:`${this.cookie}`},{data:t,error:a,pending:c}=await f(i);this.loading=c,t.value&&(this.details=t.value,this.specimensSelected=q(t.value.specimens),this.organismsSelected=q(t.value.organisms),this.showCultureWorksheet=t.value.organisms.length>0,this.shouldPrintResults=t.value.print_device,this.duration={name:((s=t.value.expected_turn_around_time)==null?void 0:s.unit)!==null?(p=t.value.expected_turn_around_time)==null?void 0:p.unit:"-- select value --"},this.expected_turn_around_time=(h=t.value.expected_turn_around_time)==null?void 0:h.value,this.loading=!1),a.value&&(console.error("error:",a.value),this.loading=!1)},async loadOrganisms(){const i={route:y.organisms,method:"GET",token:`${this.cookie}`},{error:t,data:a}=await f(i);a.value&&(this.rawOrganisms=a.value,a.value.map(c=>{this.organisms.push(c.name)})),t.value&&console.log(t.value)},async loadSpecimens(){const i={route:y.specimens,method:"GET",token:`${this.cookie}`},{data:t,pending:a,error:c}=await f(i);this.loadingSpecimens=a,t.value&&(this.loadingSpecimens=!1,this.rawSpecimens=t.value,t.value.map(s=>{this.specimens.push(s.name)})),c.value&&(this.loadingSpecimens=!1,console.error(c.value))},async loadDepartments(){const i={route:y.departments,method:"GET",token:`${this.cookie}`},{data:t,error:a}=await f(i);t.value&&(this.departments=t.value),a.value&&console.error("error:",a.value)},async loadTestTypeIndicators(){const i={route:`${y.testTypes}/test_indicator_types`,method:"GET",token:`${this.cookie}`},{data:t,error:a}=await f(i);t.value&&(this.measureTypes=t.value,this.measureSelected=t.value[0],this.measureType=this.measureSelected.name),a.value&&console.error(a.value)},addMeasure(i){i.push({name:"",test_indicator_type:this.measureSelected,unit:"",description:"",indicator_ranges:[]})},addRange(i,t){if(this.ranges=this.ranges+1,this.measureSelected.name=="Numeric")try{t.indicator_ranges.push(this.numericRange)}catch(a){console.error("error:",a)}else if(this.measureSelected.name==="Auto Complete")try{t.indicator_ranges.push({value:"",interpretation:""})}catch(a){console.error("error:",a)}},filterSpecimens(i,t){let a=new Array;return t.map(c=>{const s=i.filter(p=>p.name===c);a.push(s[0].id)}),a},async submitForm(){this.updating=!0,this.details.specimens=this.filterSpecimens(this.rawSpecimens,this.specimensSelected),this.details.department_id=this.details.department_id.id,this.details.organisms=this.showCultureWorksheet?Y(this.rawOrganisms,this.organismsSelected):new Array,this.details.expected_turn_around_time={value:this.expected_turn_around_time,unit:this.duration.name},this.details.print_device=this.shouldPrintResults;const i={route:`${y.testTypes}/${(this._.provides[T]||this.$route).query.testType}`,method:"PUT",token:`${this.cookie}`,body:this.details},{pending:t,data:a,error:c}=await f(i);this.updating=t,a.value&&(this.open=!1,I().$toast.success("Test type updated successfully!"),this.updating=!1,this.$emit("update",!0)),c.value&&(I().$toast.error("An error occurred, please try again!"),console.error("error:",c.value),this.updating=!1)},removeObjectKeys(i,t){(i=="rich_text"||i=="free_text")&&delete this.details[t]}}},Te={class:"px-5 py-5"},Ue={class:"flex items-center justify-between py-5"},Ce={class:"text-2xl font-semibold"},Ae={class:"mt-2 space-y-3"},Ie={class:"grid grid-cols-2 gap-4"},Re={class:"w-full flex"},qe={class:"py-1 ml-2"},Me=e("label",{class:"font-medium text-base"},"Duration",-1),Pe={class:"w-full flex items-center space-x-2"},Fe=e("label",{for:"showCultureWorksheet"},"Show Culture Worksheet?",-1),De={class:"w-full flex flex-col space-y-2"},Ne=e("label",{class:"font-medium"},"Organisms",-1),We={class:"w-full flex flex-col space-y-2"},Ee=e("label",{class:"font-medium"},"Specimens",-1),Oe={class:"w-full flex items-center space-x-2"},je=e("label",{for:"shouldPrintResults"},"Print Results On Small Label?",-1),Be={class:"w-full flex items-center"},Le={class:"w-full flex flex-col space-y-2"},Ge=e("label",{class:"font-medium"},"Lab section",-1),$e={class:"w-full flex"},He={class:"py-3 flex items-center justify-between"},Ke={class:"text-lg text-grameasuresy-700 font-semibold"},Xe=["onClick"],Ye={class:"grid grid-cols-4 gap-2 mb-3"},ze={class:"mt-1"},Je=e("label",{class:"font-medium"},"Type",-1),Qe={key:0},Ze={class:"flex items-center space-x-3"},et={class:"grid grid-cols-2 gap-2"},tt={class:""},st=e("label",{class:"mb-2 text-lg font-semibold text-gray-600"},"Age Range",-1),ot={class:"grid grid-cols-2 gap-2"},nt=e("label",{class:"-mb-2 font-semibold"},"Sex",-1),lt=["onUpdate:modelValue"],at=["value"],it={class:""},rt=e("label",{class:"mb-2 text-lg font-semibold text-gray-600"},"Measure Range",-1),dt={class:"grid grid-cols-2 gap-2"},ut={class:"-mt-20"},mt={class:"w-full items-center flex space-x-3"},ct={class:"flex items-center gap-2"},pt={class:"mt-8"},_t={class:"justify-end flex items-center space-x-3 px-3 py-2"};function ht(i,t,a,c,s,p){const h=ke,F=G,d=k("FormKit"),S=H,A=k("multi-select"),b=L,D=k("XMarkIcon"),N=k("InformationCircleIcon");return u(),m("div",Te,[g(e("div",null,[n(h)],512),[[U,s.loading]]),g(e("div",null,[n(F,{pages:s.pages},null,8,["pages"]),e("div",Ue,[e("h3",Ce,C(s.details.name),1)]),e("div",null,[n(d,{type:"form","submit-label":"Update",onSubmit:p.submitForm,actions:!1},{default:O(({value:gt})=>[e("div",Ae,[e("div",Ie,[n(d,{type:"text",label:"Name",validation:"required",modelValue:s.details.name,"onUpdate:modelValue":t[0]||(t[0]=o=>s.details.name=o)},null,8,["modelValue"]),n(d,{type:"text",label:"Short name",validation:"required",modelValue:s.details.short_name,"onUpdate:modelValue":t[1]||(t[1]=o=>s.details.short_name=o)},null,8,["modelValue"])]),e("div",Re,[n(d,{type:"number",label:"Expected Turn Around Time",validation:"required|number",modelValue:s.expected_turn_around_time,"onUpdate:modelValue":t[2]||(t[2]=o=>s.expected_turn_around_time=o)},null,8,["modelValue"]),e("div",qe,[Me,n(S,{items:s.timeTypes,modelValue:s.duration,"onUpdate:modelValue":t[3]||(t[3]=o=>s.duration=o)},null,8,["items","modelValue"])])]),e("div",Pe,[g(e("input",{id:"showCultureWorksheet",name:"showCultureWorksheet",type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=o=>s.showCultureWorksheet=o)},null,512),[[R,s.showCultureWorksheet]]),Fe]),g(e("div",De,[Ne,n(A,{style:{"--ms-max-height":"none !important"},modelValue:s.organismsSelected,"onUpdate:modelValue":t[5]||(t[5]=o=>s.organismsSelected=o),options:s.organisms,mode:"tags",clear:"",searchable:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])],512),[[U,s.showCultureWorksheet]]),e("div",We,[Ee,n(A,{style:{"--ms-max-height":"none !important"},modelValue:s.specimensSelected,"onUpdate:modelValue":t[6]||(t[6]=o=>s.specimensSelected=o),options:s.specimens,mode:"tags",required:"",clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])]),e("div",Oe,[g(e("input",{id:"shouldPrintResults",name:"shouldPrintResults",type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=o=>s.shouldPrintResults=o)},null,512),[[R,s.shouldPrintResults]]),je]),e("div",Be,[e("div",Le,[Ge,n(S,{items:s.departments,modelValue:s.details.department_id,"onUpdate:modelValue":t[8]||(t[8]=o=>s.details.department_id=o)},null,8,["items","modelValue"])])]),e("div",$e,[n(b,{type:"button",click:()=>{p.addMeasure(s.details.indicators)},color:"primary",text:"Add Measure",icon:s.addIcon},null,8,["click","icon"])]),s.details.indicators.length!=0?(u(!0),m(v,{key:0},x(s.details.indicators,(o,w)=>(u(),m("div",{key:w,class:"border py-3 px-3 rounded"},[e("div",He,[e("h3",Ke," Measures ("+C(w+1)+") ",1),e("button",{type:"button",onClick:()=>{s.details.indicators.splice(w,1)}},[n(D,{class:"w-5 h-5"})],8,Xe)]),e("div",Ye,[n(d,{type:"text",label:"Name",validation:"required",modelValue:o.name,"onUpdate:modelValue":l=>o.name=l},null,8,["modelValue","onUpdate:modelValue"]),e("div",ze,[Je,n(S,{items:s.measureTypes,modelValue:o.test_indicator_type,"onUpdate:modelValue":l=>o.test_indicator_type=l},null,8,["items","modelValue","onUpdate:modelValue"])]),n(d,{type:"text",label:"Unit",modelValue:o.unit,"onUpdate:modelValue":l=>o.unit=l},null,8,["modelValue","onUpdate:modelValue"]),n(d,{type:"text",label:"Description",modelValue:o.description,"onUpdate:modelValue":l=>o.description=l},null,8,["modelValue","onUpdate:modelValue"])]),o.test_indicator_type.name!="Free Text"?(u(),m("div",Qe,[n(b,{type:"button",click:()=>{p.addRange(w,o)},color:"primary",text:"Add New Range",icon:s.addIcon},null,8,["click","icon"])])):V("",!0),o.indicator_ranges.length>0&&o.test_indicator_type.name==="Numeric"?(u(!0),m(v,{key:1},x(o.indicator_ranges,(l,_)=>(u(),m("div",{class:"px-3 py-3",key:_},[e("div",Ze,[e("div",et,[e("div",tt,[st,e("div",ot,[n(d,{type:"number",label:"Minimum",validation:"required",modelValue:l.min_age,"onUpdate:modelValue":r=>l.min_age=r},null,8,["modelValue","onUpdate:modelValue"]),n(d,{type:"number",label:"Maximum",validation:"required",modelValue:l.max_age,"onUpdate:modelValue":r=>l.max_age=r},null,8,["modelValue","onUpdate:modelValue"]),e("div",null,[nt,g(e("select",{class:"w-full bg-white border px-2 py-2 focus:ring-none rounded","onUpdate:modelValue":r=>l.sex=r},[(u(!0),m(v,null,x(s.patientSex,(r,W)=>(u(),m("option",{key:W,value:r.name},C(r.name),9,at))),128))],8,lt),[[j,l.sex]])])])]),e("div",it,[rt,e("div",dt,[n(d,{type:"number",step:"any",number:"",label:"Minimum",validation:"required|float",modelValue:l.lower_range,"onUpdate:modelValue":r=>l.lower_range=r},null,8,["modelValue","onUpdate:modelValue"]),n(d,{type:"number",step:"any",number:"",label:"Maximum",validation:"required|float",modelValue:l.upper_range,"onUpdate:modelValue":r=>l.upper_range=r},null,8,["modelValue","onUpdate:modelValue"])])]),n(d,{type:"text",label:"Interpretation",modelValue:l.interpretation,"onUpdate:modelValue":r=>l.interpretation=r},null,8,["modelValue","onUpdate:modelValue"])]),e("div",ut,[n(b,{type:"button",color:"error",text:"Remove",icon:s.trashIcon,click:()=>{o.indicator_ranges.splice(_,1)}},null,8,["icon","click"])])])]))),128)):V("",!0),o.indicator_ranges.length!=0&&o.test_indicator_type.name==="Auto Complete"?(u(!0),m(v,{key:2},x(o.indicator_ranges,(l,_)=>(u(),m("div",{class:"px-3 py-3",key:_},[e("div",mt,[e("div",ct,[n(d,{type:"text",label:"Value",validation:"required",modelValue:l.value,"onUpdate:modelValue":r=>l.value=r},null,8,["modelValue","onUpdate:modelValue"]),n(d,{type:"text",label:"Interpretation",modelValue:l.interpretation,"onUpdate:modelValue":r=>l.interpretation=r},null,8,["modelValue","onUpdate:modelValue"])]),e("div",pt,[n(b,{type:"button",color:"error",text:"Remove",icon:s.trashIcon,click:()=>{o.indicator_ranges.splice(_,1)}},null,8,["icon","click"])])])]))),128)):V("",!0),s.ranges!=0&&o.test_indicator_type.name==="Free Text"?(u(!0),m(v,{key:3},x(s.ranges,(l,_)=>(u(),m("div",{class:"flex items-center px-3 py-3 rounded bg-gray-50 mt-3",key:_},[n(N,{class:"w-5 h-5 mr-2"}),B(" A text box will appear for results entry ")]))),128)):V("",!0)]))),128)):V("",!0)]),e("div",_t,[n(b,{type:"submit",click:()=>{},loading:s.updating,color:"success",icon:s.saveIcon,text:"Save Changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])])],512),[[U,!s.loading]])])}const Lt=P(Se,[["render",ht]]);export{Lt as default};
