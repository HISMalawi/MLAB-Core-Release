import{_ as A}from"./BvEqexTj.js";import{a as S,u as R,P as g,l as w,m as c,b as d,e as u,g as e,f as o,n as l,p as h,t as _,F as $,j as V,_ as T,x as P,s as j}from"./DkSHUfZG.js";import{_ as M}from"./BNCtDB5Q.js";import{S as D}from"./Bws7QizP.js";import{r as K}from"./CFqEtL_8.js";import{r as X}from"./lQpKi9YL.js";import{r as O}from"./BT_g8CmU.js";import{r as B}from"./D2LBdSgo.js";import{r as E}from"./DPnmkidM.js";import{r as G}from"./DPH2a7O9.js";import{r as F}from"./Bqk_Cgrm.js";import{S as H,h as Q,Y,G as z,V as L}from"./C_hGcfdC.js";import{_ as J}from"./DAN85N2r.js";import{u as W}from"./uQJ05scD.js";import{P as Z}from"./Bf5grz7u.js";import{r as ee}from"./CH6bbBJF.js";import"./Bit5kMcC.js";import"./jXHX7K2g.js";import"./DGb1bV5M.js";import"./B5NVDA4R.js";import"./BzCrDE1y.js";import"./CEYBmAkp.js";import"./BwUwUGKT.js";import"./_yfpsPGK.js";import"./DthfA08H.js";import"./KwrjAXlL.js";import"./fnXoGXtg.js";import"./BIVUZcpC.js";import"./neGiqG6Z.js";import"./CUSkJlEU.js";const te={props:{voucherId:{required:!0,type:String},requisitions:{required:!0,type:Array}},components:{TransitionRoot:H,TransitionChild:Q,Dialog:Y,DialogPanel:z,DialogTitle:L,XMarkIcon:K,UserIcon:X,TicketIcon:O},data(){return{open:!1,addIcon:B,saveIcon:E,clearIcon:G,completeIcon:F,loading:!1,name:"",description:"",cookie:S("token")}},methods:{async createStockOrder(){this.loading=!0;const t=new D,n={voucher_number:Number(this.voucherId),requisitions:this.requisitions.map(r=>({stock_item_id:r.stock_item.id,quantity_requested:r.quantity_requested}))},{data:i,error:a,pending:s}=await t.createStockOrder(`${this.cookie}`,n);this.loading=s,i.value&&(this.loading=!1,R().$toast.success(`Stock order ${(this._.provides[g]||this.$route).params.voucherId} created successfully`),this.handleClick(),this.$emit("update",!0)),a.value&&(this.loading=!1,console.error(a.value))},handleClick(){this.open=!this.open},clearForm(){this.$formkit.reset("submitForm")}}},oe=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),se={class:"fixed inset-0 overflow-y-auto"},re={class:"flex min-h-full items-center justify-center p-4 text-center"},ne={class:"border-b px-3 py-3 flex items-center justify-between"},ie={class:"py-5 px-5 space-y-3"},ce={class:"flex bg-gray-50 border-l-4 border-l-100 rounded-r px-2 py-2 items-center space-x-2"},ae={class:"mt-3"},le={class:"w-full"},de=e("thead",{clas:"w-full border-t border-l border-r"},[e("tr",{class:"border-b border-t border-r border-l rounded"},[e("th",{colspan:2,class:"text-left p-2"}," Requisitions ")]),e("tr",{class:"border-b border-t border-r border-l rounded"},[e("th",{class:"px-2 py-2 text-left border-r"}," Stock Item "),e("th",{class:"px-2 py-2 text-left"}," Quantity Being Requested ")])],-1),me={class:"px-2 py-2 border-r"},ue={class:"px-2 py-2"},pe={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function _e(t,n,i,a,s,r){const f=T,k=c("TransitionChild"),b=c("TicketIcon"),y=c("DialogTitle"),x=c("XMarkIcon"),I=M,m=c("FormKit"),v=c("DialogPanel"),p=c("Dialog"),N=c("TransitionRoot");return d(),u("div",null,[e("div",null,[o(f,{icon:s.completeIcon,text:"Complete",color:"primary",click:()=>{r.handleClick()}},null,8,["icon","click"])]),o(N,{appear:"",show:s.open,as:"template"},{default:l(()=>[o(p,{as:"div",onClose:r.handleClick,class:"relative z-10"},{default:l(()=>[o(k,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>[oe]),_:1}),e("div",se,[e("div",re,[o(k,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[o(v,{class:"w-full max-w-4xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[e("div",ne,[o(y,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:l(()=>[o(b,{class:"w-8 h-8 mr-2"}),h(" Order Checkout ")]),_:1}),e("button",{onClick:n[0]||(n[0]=(...q)=>r.handleClick&&r.handleClick(...q))},[o(x,{class:"w-5 h-5"})])]),o(m,{type:"form","submit-label":"Update",onSubmit:r.createStockOrder,actions:!1,id:"submitForm"},{default:l(({value:q})=>[e("div",ie,[e("div",ce,[o(b,{class:"h-5 w-5"}),e("p",null,[h("Voucher Number: "),e("strong",null,_((t._.provides[g]||t.$route).params.voucherId),1)])]),e("div",ae,[e("table",le,[de,e("tbody",null,[(d(!0),u($,null,V(i.requisitions,(C,U)=>(d(),u("tr",{key:U,class:"border-b border-t border-r border-l rounded"},[e("td",me,_(C.stock_item.name),1),e("td",ue,_(C.quantity_requested),1)]))),128))])])])]),e("div",pe,[o(I,{type:"button",click:()=>{},text:"Cancel"}),o(f,{loading:s.loading,type:"submit",click:()=>{},color:"success",icon:s.saveIcon,text:"Save changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const he=w(te,[["render",_e]]),fe={setup(){W({title:`${Z.name.toUpperCase()} - Create Stock Order`})},components:{TicketIcon:O},data(){return{header:"Create Stock Order",pages:[{name:"Home",link:"/home"},{name:"Stock Orders",link:"/stock-management/orders"}],cookie:S("token"),addIcon:B,deleteicon:ee,completeIcon:F,loading:!1,requisitions:new Array,stockItems:new Array}},created(){this.init()},methods:{async init(){const t=new D,{data:n,error:i}=await t.getStockItem(`${this.cookie}`);n.value&&(this.stockItems=n.value),i.value&&console.error(i.value)},addStockItem(){this.requisitions.push({stock_item:{name:"-- select item --",id:0},quantity_requested:0,id:0,batch_number:"",lot_number:""})},deleteStockItem(t){t>=0&&t<this.requisitions.length&&this.requisitions.splice(t,1)},isValidRequisitions(t){let n=!1;t.length>0&&(n=!0);let i=!1;for(const a of t)a.stock_item.name=="-- select item --"||a.quantity_requested==0?i=!1:i=!0;return n&&i},navigateOrders(t){t&&this.$router.push("/stock-management/orders")}}},ke={class:"px-5 py-5"},be={class:"py-5 flex items-center justify-between"},ye={class:"text-2xl font-semibold"},ve={class:"rounded border"},ge={class:"flex rounded-t justify-between bg-gray-50 border-b px-2 py-2 cursor-text"},xe={class:"flex items-center space-x-2"},Ie={class:"px-5 py-5"},qe=e("div",{class:"flex px-2 py-2 mb-4 rounded-r border-l-4 border-sky-100 bg-sky-50"},[h(" Click on the "),e("strong",{class:"mx-2"},'"Add Stock Item"'),h(" button to start creating your order requisition items ")],-1),Ce={class:"grid grid-cols-4 gap-4 mt-5"},Se={class:"flex flex-col space-y-2"},we=e("label",{class:"font-medium mb-0"},"Stock item",-1),$e={class:"mt-8"};function Ve(t,n,i,a,s,r){const f=A,k=c("TicketIcon"),b=he,y=T,x=J,I=c("FormKit");return d(),u("div",ke,[o(f,{pages:s.pages},null,8,["pages"]),e("div",be,[e("h3",ye,_(s.header),1)]),e("div",ve,[e("div",ge,[e("div",xe,[o(k,{class:"h-5 w-5"}),e("p",null,[h("Voucher Number: "),e("strong",null,_((t._.provides[g]||t.$route).params.voucherId),1)])]),r.isValidRequisitions(s.requisitions)?(d(),P(b,{key:0,onUpdate:r.navigateOrders,"voucher-id":`${(t._.provides[g]||t.$route).params.voucherId}`,requisitions:s.requisitions},null,8,["onUpdate","voucher-id","requisitions"])):j("",!0)]),e("div",Ie,[qe,o(y,{icon:s.addIcon,text:"Add Stock Item",color:"success",click:()=>{r.addStockItem()}},null,8,["icon","click"]),(d(!0),u($,null,V(s.requisitions,(m,v)=>(d(),u("div",{class:"flex flex-col space-y-3",key:v},[e("div",Ce,[e("div",Se,[we,o(x,{"is-searchable":!0,items:s.stockItems,modelValue:m.stock_item,"onUpdate:modelValue":p=>m.stock_item=p},null,8,["items","modelValue","onUpdate:modelValue"])]),o(I,{label:"Quantity requested",type:"number",validation:"required",modelValue:m.quantity_requested,"onUpdate:modelValue":p=>m.quantity_requested=p},null,8,["modelValue","onUpdate:modelValue"]),e("div",$e,[o(y,{icon:s.deleteicon,text:"Delete",color:"error",click:()=>{r.deleteStockItem(v)}},null,8,["icon","click"])])])]))),128))])])])}const it=w(fe,[["render",Ve]]);export{it as default};
