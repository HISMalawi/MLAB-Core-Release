import{_ as X}from"./Bz0K0IGU.js";import{_ as G}from"./DC2L4iA4.js";import{S as E,p as R,Y as S,G as A,V as F,q as $,z as j,s as k,x as r,b as h,e as D,f as s,y as i,g as t,j as C,t as g,h as y,X as N,_ as U,l as b,m as w,u as V,E as z,a as L,H as P,C as M,J as K}from"./Mfiulbk9.js";import{r as Y}from"./H02xEbv4.js";import{r as B}from"./Dj1LwFsw.js";import{_ as q}from"./BBIgpWSn.js";import{_ as J}from"./DyzbuwC8.js";import{r as Q}from"./DFEJ8LNl.js";import{_ as W}from"./MEi_HMIO.js";import{u as I}from"./CqIspz_h.js";import{P as Z}from"./Cym2IAMG.js";import{u as ee}from"./hBIwNBsI.js";import{r as te}from"./C_AcMCta.js";import"./CWIC1ZeM.js";import"./B-Vd1x1K.js";const se={components:{TransitionRoot:E,TransitionChild:R,Dialog:S,DialogPanel:A,DialogTitle:F,XMarkIcon:$},data(){return{viewIcon:Y,show:!1,editIcon:B,moment:j}},props:{data:{type:Object,required:!0}},methods:{handleClick(){this.show=!this.show}}},ae={class:"fixed inset-0 overflow-y-auto"},oe={class:"flex min-h-full items-center justify-center p-4 text-center"},ne={class:"border-b px-3 py-3 flex items-center justify-between"},ie={class:"space-y-3 px-5 py-5"},le={class:"w-full flex flex-col space-y-1"},re={class:"text-gray-600"},ce={class:"w-full flex flex-col space-y-1"},de={class:"text-gray-600"},ue={class:"w-full flex flex-col space-y-1"},me={class:"text-gray-600"},pe={class:"w-full flex flex-col space-y-1"},fe=["innerHTML"],_e={class:"w-full flex flex-col space-y-1"},he={class:"text-gray-600"};function ge(o,e,n,d,a,c){const m=U,u=r("TransitionChild"),f=r("DialogTitle"),_=r("XMarkIcon"),p=r("DialogPanel"),l=r("Dialog"),x=r("TransitionRoot");return h(),D("div",null,[s(m,{click:c.handleClick,color:"primary",text:"View",icon:a.viewIcon},null,8,["click","icon"]),s(x,{appear:"",show:a.show,as:"template"},{default:i(()=>[s(l,{as:"div",class:"relative z-10"},{default:i(()=>[s(u,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:i(()=>e[1]||(e[1]=[t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),t("div",ae,[t("div",oe,[s(u,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:i(()=>[s(p,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:i(()=>[t("div",ne,[s(f,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:i(()=>e[2]||(e[2]=[t("img",{src:q,class:"w-8 h-8 mr-2"},null,-1),C(" View drug ")])),_:1}),t("button",{onClick:e[0]||(e[0]=(...v)=>c.handleClick&&c.handleClick(...v))},[s(_,{class:"w-5 h-5"})])]),t("div",ie,[t("div",le,[e[3]||(e[3]=t("label",{class:"font-semibold text-lg"},"Name",-1)),t("p",re,g(n.data.name),1)]),t("div",ce,[e[4]||(e[4]=t("label",{class:"font-semibold text-lg"},"Short name",-1)),t("p",de,g(n.data.short_name),1)]),t("div",ue,[e[5]||(e[5]=t("label",{class:"font-semibold text-lg"},"Preferred name",-1)),t("p",me,g(n.data.preferred_name),1)]),t("div",pe,[e[6]||(e[6]=t("label",{class:"font-semibold text-lg"},"Description",-1)),t("div",{innerHTML:n.data.description||"No description available",class:"text-gray-600"},null,8,fe)]),t("div",_e,[e[7]||(e[7]=t("label",{class:"font-semibold text-lg"},"Date Created",-1)),t("p",he,g(a.moment(n.data.created_date).format("DATE_FORMAT"in o?o.DATE_FORMAT:y(N))),1)])])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const xe=k(se,[["render",ge]]),ve={components:{TransitionRoot:E,TransitionChild:R,Dialog:S,DialogPanel:A,DialogTitle:F,XMarkIcon:$},data(){return{editIcon:B,show:!1,saveIcon:Q,name:"",shortName:"",loading:!1}},props:{data:{type:Object,required:!0}},methods:{async init(){this.handleClick(),this.loading=!0;const o={route:`${b.drugs}/${this.data.id}`,method:"GET"},{pending:e,error:n,data:d}=await w(o);this.loading=e,d.value&&(this.shortName=d.value.short_name,this.name=d.value.name),n.value&&console.log(n.value)},async submitForm(){this.loading=!0;const o={route:`${b.drugs}/${this.data.id}`,method:"PUT",body:{preferred_name:this.data.preferred_name}},{pending:e,error:n,data:d}=await w(o);this.loading=e,d.value&&(this.handleClick(),V().$toast.success("Drug updated successfully!"),this.loading=!1,this.$emit("update",!0)),n.value&&(this.handleClick(),V().$toast.error(z),console.error(n.value),this.loading=!1)},clearForm(){this.$formkit.reset("editForm")},handleClick(){this.show=!this.show}}},ye={class:"fixed inset-0 overflow-y-auto"},be={class:"flex min-h-full items-center justify-center p-4 text-center"},we={class:"border-b px-3 py-3 flex items-center justify-between"},ke={class:"mt-2 space-y-3"},De={class:"w-full flex items-center px-5"},Ce={class:"w-full flex flex-col space-y-2"},Te={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Ve(o,e,n,d,a,c){const m=U,u=r("TransitionChild"),f=r("DialogTitle"),_=r("XMarkIcon"),p=r("FormKit"),l=J,x=r("DialogPanel"),v=r("Dialog"),O=r("TransitionRoot");return h(),D("div",null,[s(m,{click:c.init,text:"Edit",color:"success",icon:a.editIcon},null,8,["click","icon"]),s(O,{appear:"",show:a.show,as:"template"},{default:i(()=>[s(v,{as:"div",class:"relative z-10"},{default:i(()=>[s(u,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:i(()=>e[2]||(e[2]=[t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),t("div",ye,[t("div",be,[s(u,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:i(()=>[s(x,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:i(()=>[t("div",we,[s(f,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:i(()=>e[3]||(e[3]=[C(" Edit drug ")])),_:1}),t("button",{onClick:e[0]||(e[0]=(...T)=>c.handleClick&&c.handleClick(...T))},[s(_,{class:"w-5 h-5"})])]),s(p,{type:"form",id:"editForm","submit-label":"Update",onSubmit:c.submitForm,actions:!1},{default:i(({value:T})=>[t("div",ke,[t("div",De,[t("div",Ce,[s(p,{type:"text",label:"Preferred name",validation:"required",modelValue:n.data.preferred_name,"onUpdate:modelValue":e[1]||(e[1]=H=>n.data.preferred_name=H)},null,8,["modelValue"])])])]),t("div",Te,[s(l,{type:"button",click:()=>{c.clearForm()},text:"Clear form"},null,8,["click"]),s(m,{loading:a.loading,type:"submit",click:()=>{},color:"success",icon:a.saveIcon,text:"Save changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const Pe=k(ve,[["render",Ve]]),Me={setup(){ee({title:`${Z.name.toUpperCase()} - Drugs`})},data(){return{header:"List Of Drugs",drugs:new Array,pages:[{name:"Home",link:"/home"},{name:"Test Catalog",link:"#"}],loading:!1,search:"",searchValue:"",cookie:L("token"),headers:[{text:"id",value:"id",sortable:!0},{text:"name",value:"name",sortable:!0},{text:"preferred name",value:"preferred_name",sortable:!0},{text:"nlims code",value:"nlims_code",sortable:!1},{text:"description",value:"description",sortable:!0,html:!0},{text:"date created",value:"created_date"},{text:"actions",value:"actions"}]}},components:{MagnifyingGlassIcon:te},created(){this.init()},methods:{updateSearch(o){this.searchValue=o,this.search=o},async init(){this.loading=!0;const o={route:b.drugs,method:"GET",token:`${this.cookie}`},{pending:e,error:n,data:d}=await w(o);this.loading=e,d.value&&(this.drugs=d.value.map(a=>({...a,created_date:j(a.created_date).format(N)})),this.loading=!1),n.value&&(console.log(n.value),this.loading=!1)},updateDrugs(o){o&&(this.search="",this.searchValue="",this.init())}}},Ie={class:"py-5 px-5"},Ee={class:"flex justify-end w-full px-2 py-2 mb-2"},Re=["innerHTML"],Se={class:"py-2 flex items-center space-x-2"};function Ae(o,e,n,d,a,c){const m=X,u=G,f=xe,_=Pe,p=W;return h(),D("div",Ie,[s(m,{pages:a.pages},null,8,["pages"]),e[2]||(e[2]=t("div",{class:"flex items-center justify-between py-5"},[t("div",{class:"text-2xl font-semibold flex items-center uppercase"},[t("img",{src:q,alt:"report-icon",class:"w-8 h-8 mr-2"}),C(" Drugs ")])],-1)),t("div",Ee,[("usePermissions"in o?o.usePermissions:y(I))().can.manage("test_catalog")?(h(),P(u,{key:0,search:a.search,"onUpdate:search":e[0]||(e[0]=l=>a.search=l),onUpdate:c.updateSearch,modelValue:a.search,"onUpdate:modelValue":e[1]||(e[1]=l=>a.search=l)},null,8,["search","onUpdate","modelValue"])):M("",!0)]),("usePermissions"in o?o.usePermissions:y(I))().can.manage("test_catalog")?(h(),P(p,{key:0,headers:a.headers,data:a.drugs,loading:a.loading,"search-value":a.searchValue},{"item-description":i(({item:l})=>[t("div",{class:K(["line-clamp-1",l.description?"":"italic text-sm text-zinc-600"]),innerHTML:l.description||"No description available"},null,10,Re)]),actions:i(({item:l})=>[t("div",Se,[s(f,{data:l},null,8,["data"]),s(_,{data:l,onUpdate:c.updateDrugs},null,8,["data","onUpdate"])])]),_:1},8,["headers","data","loading","search-value"])):M("",!0)])}const Je=k(Me,[["render",Ae]]);export{Je as default};
