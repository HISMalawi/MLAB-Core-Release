import{_ as Bt}from"./FSyX_QAo.js";import{d as ce,r as h,c as re,b3 as Je,a8 as D,bv as et,b9 as xe,b7 as _t,b8 as It,ba as Fe,bw as Et,bx as Ut,aH as tt,by as zt,b4 as Nt,b5 as Zt,b6 as Gt,a9 as pe,ad as st,F as me,a6 as Pe,o as ot,au as yt,bz as bt,aa as Ye,ac as Ke,bA as he,be as ue,bb as Yt,bc as vt,a7 as lt,af as ve,bB as de,bC as We,b as L,e as B,g as e,f as l,z as $,h as s,j as le,W as Kt,H as se,_ as fe,q as ye,x as nt,y as G,t as N,i as Ee,v as at,O as Be,a as Le,w as _e,Y as ke,p as ie,G as $e,V as Se,S as Te,B as Ue,l as X,m as W,u as oe,E as ne,bD as Wt,bE as Xt,bF as Qt,C as we,A as gt,s as wt,bG as xt,M as Jt,bH as Xe,a5 as Ie,a_ as es,K as J,bI as ts,a4 as Ct,P as ht,$ as ss,L as ae,k as Ve,n as os,aA as ls,bJ as ns,ah as as,bK as rs,Q as is,aB as cs,bL as us,bM as ds}from"./fgAWut4R.js";import{_ as kt}from"./BVbKE4I5.js";import{_ as ps}from"./Ci7Ng8Ag.js";import{s as ms}from"./Cko9ZNcE.js";import{_ as fs}from"./DE6e198x.js";import{_ as vs}from"./CKbIrI_V.js";import{_ as De}from"./L5n-gEtE.js";import{u as Ce}from"./DJSU0WEk.js";import{r as Ae}from"./Cd7L_-og.js";import{u as Me}from"./D6yQ1IsZ.js";import{r as Qe}from"./D8pjOZ1d.js";import{r as hs}from"./6j2HxL9b.js";import{r as _s}from"./HAhuK3C-.js";import{_ as ys}from"./CHqtq72T.js";import{u as bs}from"./DHxBKYG_.js";import{P as gs}from"./D60l4UIm.js";import{r as ws}from"./C73pKObq.js";import{r as xs}from"./CcwhGEz4.js";import{r as Cs}from"./Bn_PUTpw.js";import{r as ks,a as $s}from"./BLzvIpLK.js";import"./CRggh57R.js";import"./Qv-HZX4d.js";import"./b5sOyOyw.js";import"./C5yTkR2T.js";import"./CepswtFc.js";import"./BMlEGhQ0.js";import"./xRdLAUoX.js";import"./CLX9t2Lo.js";import"./DKDwsOy3.js";import"./DWLeWjtr.js";var Ss=(u=>(u[u.Open=0]="Open",u[u.Closed=1]="Closed",u))(Ss||{});let $t=Symbol("PopoverContext");function rt(u){let t=lt($t,null);if(t===null){let c=new Error(`<${u} /> is missing a parent <${Pt.name} /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(c,rt),c}return t}let Ts=Symbol("PopoverGroupContext");function St(){return lt(Ts,null)}let Tt=Symbol("PopoverPanelContext");function Ps(){return lt(Tt,null)}let Pt=ce({name:"Popover",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(u,{slots:t,attrs:c,expose:V}){var o;let f=h(null);V({el:f,$el:f});let p=h(1),a=h(null),x=h(null),w=h(null),b=h(null),S=re(()=>Je(f)),q=re(()=>{var v,m;if(!D(a)||!D(b))return!1;for(let I of document.querySelectorAll("body > *"))if(Number(I==null?void 0:I.contains(D(a)))^Number(I==null?void 0:I.contains(D(b))))return!0;let r=et(),n=r.indexOf(D(a)),_=(n+r.length-1)%r.length,C=(n+1)%r.length,k=r[_],y=r[C];return!((v=D(b))!=null&&v.contains(k))&&!((m=D(b))!=null&&m.contains(y))}),M={popoverState:p,buttonId:h(null),panelId:h(null),panel:b,button:a,isPortalled:q,beforePanelSentinel:x,afterPanelSentinel:w,togglePopover(){p.value=xe(p.value,{0:1,1:0})},closePopover(){p.value!==1&&(p.value=1)},close(v){M.closePopover();let m=v?v instanceof HTMLElement?v:v.value instanceof HTMLElement?D(v):D(M.button):D(M.button);m==null||m.focus()}};_t($t,M),It(re(()=>xe(p.value,{0:Fe.Open,1:Fe.Closed})));let j={buttonId:M.buttonId,panelId:M.panelId,close(){M.closePopover()}},A=St(),z=A==null?void 0:A.registerPopover,[O,T]=Et(),R=Ut({mainTreeNodeRef:A==null?void 0:A.mainTreeNodeRef,portals:O,defaultContainers:[a,b]});function g(){var v,m,r,n;return(n=A==null?void 0:A.isFocusWithinPopoverGroup())!=null?n:((v=S.value)==null?void 0:v.activeElement)&&(((m=D(a))==null?void 0:m.contains(S.value.activeElement))||((r=D(b))==null?void 0:r.contains(S.value.activeElement)))}return tt(()=>z==null?void 0:z(j)),zt((o=S.value)==null?void 0:o.defaultView,"focus",v=>{var m,r;v.target!==window&&v.target instanceof HTMLElement&&p.value===0&&(g()||a&&b&&(R.contains(v.target)||(m=D(M.beforePanelSentinel))!=null&&m.contains(v.target)||(r=D(M.afterPanelSentinel))!=null&&r.contains(v.target)||M.closePopover()))},!0),Nt(R.resolveContainers,(v,m)=>{var r;M.closePopover(),Zt(m,Gt.Loose)||(v.preventDefault(),(r=D(a))==null||r.focus())},re(()=>p.value===0)),()=>{let v={open:p.value===0,close:M.close};return pe(me,[pe(T,{},()=>st({theirProps:{...u,...c},ourProps:{ref:f},slot:v,slots:t,attrs:c,name:"Popover"})),pe(R.MainTreeNode)])}}}),Vs=ce({name:"PopoverButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(u,{attrs:t,slots:c,expose:V}){var o;let f=(o=u.id)!=null?o:`headlessui-popover-button-${Pe()}`,p=rt("PopoverButton"),a=re(()=>Je(p.button));V({el:p.button,$el:p.button}),ot(()=>{p.buttonId.value=f}),yt(()=>{p.buttonId.value=null});let x=St(),w=x==null?void 0:x.closeOthers,b=Ps(),S=re(()=>b===null?!1:b.value===p.panelId.value),q=h(null),M=`headlessui-focus-sentinel-${Pe()}`;S.value||tt(()=>{p.button.value=D(q)});let j=ms(re(()=>({as:u.as,type:t.type})),q);function A(v){var m,r,n,_,C;if(S.value){if(p.popoverState.value===1)return;switch(v.key){case ve.Space:case ve.Enter:v.preventDefault(),(r=(m=v.target).click)==null||r.call(m),p.closePopover(),(n=D(p.button))==null||n.focus();break}}else switch(v.key){case ve.Space:case ve.Enter:v.preventDefault(),v.stopPropagation(),p.popoverState.value===1&&(w==null||w(p.buttonId.value)),p.togglePopover();break;case ve.Escape:if(p.popoverState.value!==0)return w==null?void 0:w(p.buttonId.value);if(!D(p.button)||(_=a.value)!=null&&_.activeElement&&!((C=D(p.button))!=null&&C.contains(a.value.activeElement)))return;v.preventDefault(),v.stopPropagation(),p.closePopover();break}}function z(v){S.value||v.key===ve.Space&&v.preventDefault()}function O(v){var m,r;u.disabled||(S.value?(p.closePopover(),(m=D(p.button))==null||m.focus()):(v.preventDefault(),v.stopPropagation(),p.popoverState.value===1&&(w==null||w(p.buttonId.value)),p.togglePopover(),(r=D(p.button))==null||r.focus()))}function T(v){v.preventDefault(),v.stopPropagation()}let R=bt();function g(){let v=D(p.panel);if(!v)return;function m(){xe(R.value,{[de.Forwards]:()=>he(v,ue.First),[de.Backwards]:()=>he(v,ue.Last)})===We.Error&&he(et().filter(r=>r.dataset.headlessuiFocusGuard!=="true"),xe(R.value,{[de.Forwards]:ue.Next,[de.Backwards]:ue.Previous}),{relativeTo:D(p.button)})}m()}return()=>{let v=p.popoverState.value===0,m={open:v},{...r}=u,n=S.value?{ref:q,type:j.value,onKeydown:A,onClick:O}:{ref:q,id:f,type:j.value,"aria-expanded":p.popoverState.value===0,"aria-controls":D(p.panel)?p.panelId.value:void 0,disabled:u.disabled?!0:void 0,onKeydown:A,onKeyup:z,onClick:O,onMousedown:T};return pe(me,[st({ourProps:n,theirProps:{...t,...r},slot:m,attrs:t,slots:c,name:"PopoverButton"}),v&&!S.value&&p.isPortalled.value&&pe(Ye,{id:M,features:Ke.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:g})])}}}),Ms=ce({name:"PopoverPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},focus:{type:Boolean,default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(u,{attrs:t,slots:c,expose:V}){var o;let f=(o=u.id)!=null?o:`headlessui-popover-panel-${Pe()}`,{focus:p}=u,a=rt("PopoverPanel"),x=re(()=>Je(a.panel)),w=`headlessui-focus-sentinel-before-${Pe()}`,b=`headlessui-focus-sentinel-after-${Pe()}`;V({el:a.panel,$el:a.panel}),ot(()=>{a.panelId.value=f}),yt(()=>{a.panelId.value=null}),_t(Tt,a.panelId),tt(()=>{var T,R;if(!p||a.popoverState.value!==0||!a.panel)return;let g=(T=x.value)==null?void 0:T.activeElement;(R=D(a.panel))!=null&&R.contains(g)||he(D(a.panel),ue.First)});let S=Yt(),q=re(()=>S!==null?(S.value&Fe.Open)===Fe.Open:a.popoverState.value===0);function M(T){var R,g;switch(T.key){case ve.Escape:if(a.popoverState.value!==0||!D(a.panel)||x.value&&!((R=D(a.panel))!=null&&R.contains(x.value.activeElement)))return;T.preventDefault(),T.stopPropagation(),a.closePopover(),(g=D(a.button))==null||g.focus();break}}function j(T){var R,g,v,m,r;let n=T.relatedTarget;n&&D(a.panel)&&((R=D(a.panel))!=null&&R.contains(n)||(a.closePopover(),((v=(g=D(a.beforePanelSentinel))==null?void 0:g.contains)!=null&&v.call(g,n)||(r=(m=D(a.afterPanelSentinel))==null?void 0:m.contains)!=null&&r.call(m,n))&&n.focus({preventScroll:!0})))}let A=bt();function z(){let T=D(a.panel);if(!T)return;function R(){xe(A.value,{[de.Forwards]:()=>{var g;he(T,ue.First)===We.Error&&((g=D(a.afterPanelSentinel))==null||g.focus())},[de.Backwards]:()=>{var g;(g=D(a.button))==null||g.focus({preventScroll:!0})}})}R()}function O(){let T=D(a.panel);if(!T)return;function R(){xe(A.value,{[de.Forwards]:()=>{let g=D(a.button),v=D(a.panel);if(!g)return;let m=et(),r=m.indexOf(g),n=m.slice(0,r+1),_=[...m.slice(r+1),...n];for(let C of _.slice())if(C.dataset.headlessuiFocusGuard==="true"||v!=null&&v.contains(C)){let k=_.indexOf(C);k!==-1&&_.splice(k,1)}he(_,ue.First,{sorted:!1})},[de.Backwards]:()=>{var g;he(T,ue.Previous)===We.Error&&((g=D(a.button))==null||g.focus())}})}R()}return()=>{let T={open:a.popoverState.value===0,close:a.close},{focus:R,...g}=u,v={ref:a.panel,id:f,onKeydown:M,onFocusout:p&&a.popoverState.value===0?j:void 0,tabIndex:-1};return st({ourProps:v,theirProps:{...t,...g},attrs:t,slot:T,slots:{...c,default:(...m)=>{var r;return[pe(me,[q.value&&a.isPortalled.value&&pe(Ye,{id:w,ref:a.beforePanelSentinel,features:Ke.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:z}),(r=c.default)==null?void 0:r.call(c,...m),q.value&&a.isPortalled.value&&pe(Ye,{id:b,ref:a.afterPanelSentinel,features:Ke.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:O})])]}},features:vt.RenderStrategy|vt.Static,visible:q.value,name:"PopoverPanel"})}}});function Ls(u,t){return L(),B("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M14.47 2.47a.75.75 0 0 1 1.06 0l6 6a.75.75 0 0 1 0 1.06l-6 6a.75.75 0 1 1-1.06-1.06l4.72-4.72H9a5.25 5.25 0 1 0 0 10.5h3a.75.75 0 0 1 0 1.5H9a6.75 6.75 0 0 1 0-13.5h10.19l-4.72-4.72a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})])}function Vt(u,t){return L(),B("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v6c0 .414.336.75.75.75h4.5a.75.75 0 0 0 0-1.5h-3.75V6Z","clip-rule":"evenodd"})])}function Ge(u,t){return L(),B("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M15.73 5.5h1.035A7.465 7.465 0 0 1 18 9.625a7.465 7.465 0 0 1-1.235 4.125h-.148c-.806 0-1.534.446-2.031 1.08a9.04 9.04 0 0 1-2.861 2.4c-.723.384-1.35.956-1.653 1.715a4.499 4.499 0 0 0-.322 1.672v.633A.75.75 0 0 1 9 22a2.25 2.25 0 0 1-2.25-2.25c0-1.152.26-2.243.723-3.218.266-.558-.107-1.282-.725-1.282H3.622c-1.026 0-1.945-.694-2.054-1.715A12.137 12.137 0 0 1 1.5 12.25c0-2.848.992-5.464 2.649-7.521C4.537 4.247 5.136 4 5.754 4H9.77a4.5 4.5 0 0 1 1.423.23l3.114 1.04a4.5 4.5 0 0 0 1.423.23ZM21.669 14.023c.536-1.362.831-2.845.831-4.398 0-1.22-.182-2.398-.52-3.507-.26-.85-1.084-1.368-1.973-1.368H19.1c-.445 0-.72.498-.523.898.591 1.2.924 2.55.924 3.977a8.958 8.958 0 0 1-1.302 4.666c-.245.403.028.959.5.959h1.053c.832 0 1.612-.453 1.918-1.227Z"})])}function Ds(u,t){return L(),B("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z","clip-rule":"evenodd"})])}function As(u,t){return L(),B("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.625 9.75a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375m-13.5 3.01c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.184-4.183a1.14 1.14 0 0 1 .778-.332 48.294 48.294 0 0 0 5.83-.498c1.585-.233 2.708-1.626 2.708-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"})])}function Hs(u,t){return L(),B("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 10.5v6m3-3H9m4.06-7.19-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})])}const js={class:"px-5 py-3"},Rs={class:"flex items-end justify-end space-x-2 border-t px-4 py-2"},Os=ce({__name:"FilterWards",props:{wards:{type:Array,required:!0}},emits:["update:items-selected"],setup(u,{emit:t}){const c=t,V=u,o=re(()=>V.wards.map(a=>a.name)),f=h([]),p=a=>{c("update:items-selected",f.value),a()};return(a,x)=>{const w=ps,b=fe;return L(),B("div",null,[l(s(Pt),{class:"relative"},{default:$(({close:S})=>[l(s(Vs),{class:"bg-gray-50 text-zinc-500 flex items-center space-x-2 rounded border px-2 py-1.5"},{default:$(()=>x[1]||(x[1]=[e("svg",{class:"mr-2",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 48 48"},[e("path",{fill:"currentColor","fill-rule":"evenodd",d:"M29 6v2c0 1.306.835 2.418 2 2.83V12h-1a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-6a1 1 0 0 0-1-1h-1v-1h5v12.066H20.11a.3.3 0 0 1-.218-.09l-.366-.37l.369-.367a3.77 3.77 0 0 0 .001-5.333l-1.8-1.8a3.77 3.77 0 0 0-5.333-.003l-.704.704a3.95 3.95 0 0 0-3.892 1.021a4.034 4.034 0 0 0 0 5.676l.833.839V34H6v2h3.05a3.5 3.5 0 1 0 4.899 0h20.102a3.5 3.5 0 1 0 4.899 0H42v-2h-4v-3h.066C40.24 31 42 29.224 42 27.033a3.97 3.97 0 0 0-2-3.455V11a2 2 0 0 0-2-2h-6a1 1 0 0 1-1-1V6zM13.826 16.868l4.29 4.32l.365-.364a1.77 1.77 0 0 0 0-2.504l-1.8-1.8a1.77 1.77 0 0 0-2.504-.002zM36 34H11v-8.644l5.275 5.311c.212.213.498.333.797.333H36z","clip-rule":"evenodd"})],-1),le(" Filter By Wards ")])),_:1}),l(Kt,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"translate-y-1 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-1 opacity-0"},{default:$(()=>[l(s(Ms),{class:"absolute z-10 mt-0 w-screen bg-white border shadow-2xl rounded max-w-2xl transform px-4 sm:px-0 lg:max-w-3xl"},{default:$(()=>[e("div",js,[l(w,{placeholder:"click to select wards",label:"Select ward(s)",mode:"tags",items:s(o),"items-selected":s(f),"onUpdate:itemsSelected":x[0]||(x[0]=q=>se(f)?f.value=q:null)},null,8,["items","items-selected"])]),e("div",Rs,[l(b,{text:"Apply",icon:s(Ls),color:"primary",click:()=>{p(S)}},null,8,["icon","click"])])]),_:2},1024)]),_:2},1024)]),_:1})])}}}),qs={props:{value:{type:Object,required:!0},close:{type:Boolean,required:!0},color:{required:!1,type:String,default:"green"},icon:{required:!1,type:Object}},methods:{removeLabel(){this.$emit("update",this.value)}},components:{XMarkIcon:ye}},Fs={class:"text-sm"};function Bs(u,t,c,V,o,f){const p=G("XMarkIcon");return L(),B("div",{class:Be(["flex items-center space-x-2 px-2 py-1 text-white rounded",`bg-${c.color}-500`])},[e("p",Fs,N(c.value.value),1),Ee(e("button",{onClick:t[0]||(t[0]=(...a)=>f.removeLabel&&f.removeLabel(...a)),class:"ml-2"},[l(p,{class:"w-4 h-4"})],512),[[at,c.close]])],2)}const Is=nt(qs,[["render",Bs]]),Es={class:"fixed inset-0 overflow-y-auto"},Us={class:"flex min-h-full items-center justify-center p-4 text-center"},zs={class:"border-b px-3 py-3 flex items-center justify-between"},Ns={class:"mt-2 space-y-3 pb-40"},Zs={class:"w-full flex flex-col space-y-2 px-5"},Gs={class:"w-full flex flex-col space-y-2 px-5"},Ys={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},Ks=ce({__name:"index",props:{item:{}},emits:["update"],setup(u,{emit:t}){const c=t,V=u,o=h(!1),f=Ue,p=Ae,a=h([]),x=h(!1),w=h([]),b=h([]),S=h([]),q=Ce(),M=h("-- select department"),j=Le("token"),A=Ce(),z=h(0);async function O(){g();const m=A.department,r=A.user.departments.find(n=>n.name===m);r&&(z.value=Number(r.id)),M.value=m,S.value=A.user.departments,await T(z.value)}async function T(m){var k;const r=(k=V.item.client)!=null&&k.sex.match(/f/i)?"Female":"Male",n={route:`${X.specimenTestTypes}?department_id=${m}&specimen_id=${V.item.specimen_id}&sex=${r}`,method:"GET",token:`${j.value}`},{error:_,data:C}=await W(n);C.value&&(b.value=C.value,w.value=C.value),_.value&&console.error("error: ",_.value)}async function R(){x.value=!0;let m=a.value.map(k=>({specimen:V.item.specimen_id,test_type:k}));const r=q.locations.find(k=>k.name===q.selectedLocation);if(!r){oe().$toast.error("Location not found"),x.value=!1;return}const n={route:`${X.addTestOrder}`,method:"POST",token:`${j.value}`,body:{order_id:V.item.order_id,lab_location:(r==null?void 0:r.id)||0,tests:m}},{data:_,error:C}=await W(n);_.value&&(oe().$toast.success("Tests added to current order successfully!"),x.value=!1,c("update",!0),g()),C.value&&(g(),console.error("error: ",C.value),oe().$toast.error(ne),x.value=!1)}function g(){o.value=!o.value}function v(){a.value=[]}return _e(M,(m,r)=>{if(m!==r){const n=A.user.departments.find(_=>_.name===m);n&&(z.value=Number(n.id),T(z.value))}}),(m,r)=>{const n=fe,_=G("multi-select"),C=De,k=G("FormKit");return L(),B("div",null,[e("div",null,[l(n,{text:"Add test to current order",color:"warning",icon:s(f),click:()=>{O()}},null,8,["icon","click"])]),l(s(Te),{appear:"",show:o.value,as:"template"},{default:$(()=>[l(s(ke),{as:"div",onClose:g,class:"relative z-10"},{default:$(()=>[l(s(ie),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:$(()=>r[2]||(r[2]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",Es,[e("div",Us,[l(s(ie),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:$(()=>[l(s($e),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:$(()=>[e("div",zs,[l(s(Se),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:$(()=>r[3]||(r[3]=[e("svg",{class:"w-6 h-6 mr-2",xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64"},[e("path",{fill:"currentColor",d:"M43.191 40.403h5.498a.775.775 0 1 0 0-1.55h-5.498a.775.775 0 0 0 0 1.55m12.544-23.651H36.222V32.08h19.513zM54.319 30.78H37.622V18.059h16.697zM22.771 17.262H19.6v3.171h-3.171v3.171H19.6v3.171h3.171v-3.171h3.17v-3.171h-3.17z"}),e("path",{fill:"currentColor",d:"M43.191 22.323h5.498a.775.775 0 0 0 0-1.55h-5.498a.775.775 0 0 0 0 1.55"}),e("path",{fill:"currentColor",d:"M55.612.547H9.042C4.479.547.766 4.26.766 8.825v46.568c0 4.565 3.713 8.278 8.276 8.278h46.57c4.564 0 8.277-3.712 8.277-8.278V8.825c0-4.564-3.714-8.278-8.277-8.278M9.252 11.361v10.416H7.693a.533.533 0 0 1-.534-.534V7.802c0-.455.339-.825.805-.825h6.887c.464 0 .805.369.805.824v.789h10.648c.296 0 .534.239.534.532v3.023h-9.089v-.791c0-.454-.339-.823-.807-.823h-6.883c-.467 0-.806.375-.806.831zM30.49 28.617H11.881a.53.53 0 0 1-.534-.532V14.644c0-.455.339-.825.804-.825h6.885c.466 0 .807.369.807.823v.789H30.49c.296 0 .534.239.534.532v12.121a.53.53 0 0 1-.535.532zm26.644 27.286H34.828V15.316h22.306z"}),e("path",{fill:"currentColor",d:"M55.735 34.831H36.222v15.33h19.513zm-1.406 14.022H37.634V36.135h16.695z"})],-1),le(" Add Test To Current Order ")])),_:1}),e("button",{onClick:g},[l(s(ye),{class:"w-5 h-5"})])]),l(k,{type:"form","submit-label":"Update",onSubmit:R,actions:!1,id:"submitForm"},{default:$(()=>[e("div",Ns,[e("div",Zs,[r[4]||(r[4]=e("label",{class:"font-medium"},"Department",-1)),l(_,{style:{"--ms-max-height":"none !important"},modelValue:M.value,"onUpdate:modelValue":r[0]||(r[0]=y=>M.value=y),options:S.value.map(y=>y.name),searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])]),e("div",Gs,[r[5]||(r[5]=e("label",{class:"font-medium"},"Tests",-1)),l(_,{style:{"--ms-max-height":"none !important"},modelValue:a.value,"onUpdate:modelValue":r[1]||(r[1]=y=>a.value=y),options:w.value,mode:"tags",searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),e("div",Ys,[l(C,{type:"button",click:()=>v(),text:"Clear form"},null,8,["click"]),l(n,{loading:x.value,type:"submit",click:()=>{},color:"success",icon:s(p),text:"Save changes"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),Ws={class:"fixed inset-0 overflow-y-auto"},Xs={class:"flex min-h-full items-center justify-center p-4 text-center"},Qs={class:"border-b px-3 py-3 flex items-center justify-between"},Js={class:"mt-2 space-y-3 pb-40"},eo={class:"w-full flex flex-col space-y-2 px-5"},to={class:"w-full flex flex-col space-y-2 px-5"},so={class:"w-full flex flex-col space-y-2 px-5"},oo={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},lo=ce({__name:"index",props:{color:{},item:{}},emits:["update"],setup(u,{emit:t}){const c=t,V=u,o=h(!1),f=Ue,p=Ae,a=h(!1),x=h([]),w=h([]),b=h([]),S=h([]),q=Ce(),M=h("-- select department"),j=h(""),A=h([]),z=h([]),O=Le("token"),T=Ce(),R=h(0),{$toast:g}=oe();async function v(){_();const k=T.department,y=T.user.departments.find(I=>I.name===k);y&&(R.value=Number(y.id)),M.value=k,S.value=T.user.departments,await m(R.value)}async function m(k){var Z;const y=(Z=V.item.client)!=null&&Z.sex.match(/f/i)?"Female":"Male",I={route:`${X.specimens}?department_id=${k}&specimen_id=${V.item.specimen_id}&sex=${y}`,method:"GET",token:`${O.value}`},{error:E,data:H}=await W(I);H.value&&(w.value=H.value,x.value=H.value.map(Y=>Y.name)),E.value&&console.error("error: ",E.value)}async function r(){var Z;if(!j.value){z.value=[];return}const k=w.value.find(Y=>Y.name===j.value);if(!k){z.value=[];return}const y=(Z=V.item.client)!=null&&Z.sex.match(/f/i)?"Female":"Male",I={route:`specimen/test_types?specimen_id=${k.id}&department_id=${R.value}&sex=${y}`,method:"GET",token:`${O.value}`},{error:E,data:H}=await W(I);H.value&&(b.value=H.value,z.value=H.value,A.value=[]),E.value&&(console.error("error: ",E.value),z.value=[])}async function n(){a.value=!0;const k=w.value.find(Y=>Y.name===j.value);if(!k){g.error("Please select a valid specimen"),a.value=!1;return}let y=A.value.map(Y=>({specimen:k.id.toString(),test_type:Y}));const I=q.locations.find(Y=>Y.name===q.selectedLocation);if(!I){g.error("Location not found"),a.value=!1;return}const E={route:`${X.addOrderToEncounter}`,method:"POST",token:`${O.value}`,body:{encounter_id:V.item.encounter_id,lab_location:(I==null?void 0:I.id)||0,tests:y}},{data:H,error:Z}=await W(E);H.value&&(a.value=!1,c("update",H.value),_()),Z.value&&(_(),console.error("error: ",Z.value),g.error(ne),a.value=!1)}function _(){o.value=!o.value}function C(){j.value="",A.value=[],z.value=[]}return _e(M,(k,y)=>{if(k!==y){const I=T.user.departments.find(E=>E.name===k);I&&(R.value=Number(I.id),m(R.value),j.value="",A.value=[],z.value=[])}}),_e(j,()=>{r()}),(k,y)=>{const I=fe,E=G("multi-select"),H=De,Z=G("FormKit");return L(),B("div",null,[e("div",null,[l(I,{text:"Add order to encounter",color:V.color,icon:s(f),click:()=>{v()}},null,8,["color","icon","click"])]),l(s(Te),{appear:"",show:s(o),as:"template"},{default:$(()=>[l(s(ke),{as:"div",onClose:_,class:"relative z-10"},{default:$(()=>[l(s(ie),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:$(()=>y[3]||(y[3]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",Ws,[e("div",Xs,[l(s(ie),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:$(()=>[l(s($e),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:$(()=>[e("div",Qs,[l(s(Se),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:$(()=>y[4]||(y[4]=[e("svg",{class:"w-6 h-6 mr-2",xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64"},[e("path",{fill:"currentColor",d:"M43.191 40.403h5.498a.775.775 0 1 0 0-1.55h-5.498a.775.775 0 0 0 0 1.55m12.544-23.651H36.222V32.08h19.513zM54.319 30.78H37.622V18.059h16.697zM22.771 17.262H19.6v3.171h-3.171v3.171H19.6v3.171h3.171v-3.171h3.17v-3.171h-3.17z"}),e("path",{fill:"currentColor",d:"M43.191 22.323h5.498a.775.775 0 0 0 0-1.55h-5.498a.775.775 0 0 0 0 1.55"}),e("path",{fill:"currentColor",d:"M55.612.547H9.042C4.479.547.766 4.26.766 8.825v46.568c0 4.565 3.713 8.278 8.276 8.278h46.57c4.564 0 8.277-3.712 8.277-8.278V8.825c0-4.564-3.714-8.278-8.277-8.278M9.252 11.361v10.416H7.693a.533.533 0 0 1-.534-.534V7.802c0-.455.339-.825.805-.825h6.887c.464 0 .805.369.805.824v.789h10.648c.296 0 .534.239.534.532v3.023h-9.089v-.791c0-.454-.339-.823-.807-.823h-6.883c-.467 0-.806.375-.806.831zM30.49 28.617H11.881a.53.53 0 0 1-.534-.532V14.644c0-.455.339-.825.804-.825h6.885c.466 0 .807.369.807.823v.789H30.49c.296 0 .534.239.534.532v12.121a.53.53 0 0 1-.535.532zm26.644 27.286H34.828V15.316h22.306z"}),e("path",{fill:"currentColor",d:"M55.735 34.831H36.222v15.33h19.513zm-1.406 14.022H37.634V36.135h16.695z"})],-1),le(" Add Order To Encounter ")])),_:1}),e("button",{onClick:_},[l(s(ye),{class:"w-5 h-5"})])]),l(Z,{type:"form","submit-label":"Update",onSubmit:n,actions:!1,id:"submitForm"},{default:$(()=>[e("div",Js,[e("div",eo,[y[5]||(y[5]=e("label",{class:"font-medium"},"Department",-1)),l(E,{style:{"--ms-max-height":"none !important"},modelValue:s(M),"onUpdate:modelValue":y[0]||(y[0]=Y=>se(M)?M.value=Y:null),options:s(S).map(Y=>Y.name),searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])]),e("div",to,[y[6]||(y[6]=e("label",{class:"font-medium"},"Specimen",-1)),l(E,{style:{"--ms-max-height":"none !important"},modelValue:s(j),"onUpdate:modelValue":y[1]||(y[1]=Y=>se(j)?j.value=Y:null),options:s(x),searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])]),e("div",so,[y[7]||(y[7]=e("label",{class:"font-medium"},"Test Types",-1)),l(E,{style:{"--ms-max-height":"none !important"},modelValue:s(A),"onUpdate:modelValue":y[2]||(y[2]=Y=>se(A)?A.value=Y:null),options:s(z),mode:"tags",searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),e("div",oo,[l(H,{type:"button",click:()=>C(),text:"Clear form"},null,8,["click"]),l(I,{loading:s(a),type:"submit",click:()=>{},color:"success",icon:s(p),text:"Save changes"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),no={components:{TransitionRoot:Te,TransitionChild:ie,Dialog:ke,DialogPanel:$e,DialogTitle:Se,XMarkIcon:ye,PhoneIcon:Wt,EnvelopeIcon:Xt,MapPinIcon:Qt},data(){return{moment:we,viewIcon:gt,show:this.open,addIcon:wt,checkIcon:Qe,editIcon:Ue,acceptIcon:xt,printerIcon:Jt,cookie:Le("token"),authStore:Ce(),details:{},loading:!1,verifying:!1,zebraPrinting:!1}},props:{open:{type:Boolean,required:!1}},methods:{async init(u){this.loading=!0;const t={route:`${X.tests}/${u.id}`,method:"GET",token:`${this.cookie}`},{data:c,error:V,pending:o}=await W(t);this.loading=o,c.value&&(this.details=c.value,typeof this.details=="object"&&this.handleClick()),V.value&&(this.loading=!1,console.error(V.value),oe().$toast.error(ne))},async printBBResults(){const u={route:X.printOutZebra,method:"POST",token:`${this.cookie}`,body:{order_id:this.details.order_id,tests:[this.details.id],is_cross_match:!0}},{data:t,error:c,pending:V}=await W(u);if(this.zebraPrinting=V,t.value){this.zebraPrinting=!1;const o=new FileReader;o.onload=()=>{const f=URL.createObjectURL(t.value),p=document.createElement("a");p.href=f,p.setAttribute("download",`${Date.now()}.lbl`),p.click(),URL.revokeObjectURL(f)},o.readAsText(t.value),oe().$toast.success("Results printed successfully!")}c.value&&(this.zebraPrinting=!1,oe().$toast.error(ne),console.error(c.value))},async changeStatus(u,t){this.verifying=!0;const c={route:`${X.testStatus}/${t}/${u}`,method:"PUT",token:`${this.cookie}`},{data:V,error:o,pending:f}=await W(c);this.verifying=f,V.value&&(this.verifying=!1,oe().$toast.success(`${this.details.test_type_name} test for ${this.details.client.first_name} ${this.details.client.middle_name!==null?this.details.client.middle_name:""} ${this.details.client.last_name} verified successfully!`),this.viewReport(!0)),o.value&&(console.error(o.value),this.verifying=!1)},updateChanges(){this.$emit("update",!0)},updateNewOrder(u){this.$emit("order",u),this.handleClick()},handleClick(){this.show=!this.show},printAccessionNumber(){return Xe.printSpecimenLabel(this.details.accession_number)},printTrackingNumber(){return Xe.printTrackingNumber(this.details.tracking_number)},viewReport(u=!1){return this.$router.push(`/reports/daily/patient-report/${this.details.client.id}?order_id=${this.details.order_id}&printer=${u}`)},getRequestedBy(u){let t="";return u.forEach(c=>{c.status.name==="pending"&&(t=`${c.initiator.first_name} ${c.initiator.last_name}`)}),Ie(t)},isRejectedOrVoided(u){return new Set(["voided","test-rejected","rejected","not-done"]).has(u.toLowerCase())},isCompletedByCurrentUserOrSuperAdmin(u){const t=this.authStore.user,c=u.completed_by;if(c){if(c.id!==t.id)return!0;if(c.is_super_admin===!0)return!0}return!1},getTurnAroundTime(u){const t=new Date(u.created_date),c=u.status_trail.find(S=>S.status.name.toLowerCase()==="verified");if(!c)return"In progress...";const o=new Date(c.created_date).getTime()-t.getTime(),f=Math.floor(o/1e3),p=Math.floor(f/(3600*24)),a=Math.floor(f%(3600*24)/3600),x=Math.floor(f%3600/60),w=f%60,b=[];return p>0&&b.push(`${p} day${p>1?"s":""}`),a>0&&b.push(`${a} hour${a>1?"s":""}`),x>0&&b.push(`${x} minute${x>1?"s":""}`),w>0&&b.push(`${w} second${w>1?"s":""}`),b.length>0?b.join(", "):"0 seconds"}}},ao="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M27%2015V4H10C9.44772%204%209%204.44772%209%205V43C9%2043.5523%209.44772%2044%2010%2044H38C38.5523%2044%2039%2043.5523%2039%2043V16H28C27.4477%2016%2027%2015.5523%2027%2015ZM29%2014V4.58579L38.4142%2014H29ZM17%2019C17%2018.4477%2017.4477%2018%2018%2018H23C25.2091%2018%2027%2019.7909%2027%2022C27%2024.0759%2025.4186%2025.7825%2023.3948%2025.9808L27%2029.5859L30.2929%2026.293L31.7072%2027.7072L28.4142%2031.0001L31.7071%2034.293L30.2928%2035.7072L27%2032.4143L23.7072%2035.7072L22.2929%2034.293L25.5858%2031.0001L20.5857%2026H19V33H17V25V19ZM23%2024H19V20H23C24.1046%2020%2025%2020.8954%2025%2022C25%2023.1046%2024.1046%2024%2023%2024Z'%20fill='currentColor'/%3e%3c/svg%3e",ro="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M19%204C18.4477%204%2018%204.44772%2018%205V8C18%208.55228%2018.4477%209%2019%209H20V11.2729C19.4174%2011.4788%2019%2012.0344%2019%2012.6875V39C19%2041.7614%2021.2386%2044%2024%2044C26.7614%2044%2029%2041.7614%2029%2039V12.6875C29%2012.0344%2028.5826%2011.4788%2028%2011.2729V9H29C29.5523%209%2030%208.55228%2030%208V5C30%204.44772%2029.5523%204%2029%204H19ZM22%2011.6875V9H26V11.6875C26%2012.3406%2026.4174%2012.8962%2027%2013.1021V18H21V13.1021C21.5826%2012.8962%2022%2012.3406%2022%2011.6875Z'%20fill='currentColor'/%3e%3c/svg%3e",io="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M28.7526%206.3415C28.4782%206.02797%2028.0383%205.91736%2027.6483%206.0639C27.2583%206.21043%2027%206.58339%2027%207V14C27%2015.1046%2027.8954%2016%2029%2016H35C35.3924%2016%2035.7485%2015.7705%2035.9106%2015.4132C36.0728%2015.0559%2036.011%2014.6368%2035.7526%2014.3415L28.7526%206.3415ZM20.75%2023H19.25L20%2021.2L20.75%2023ZM27.5576%205L37%2015.3866V40C37%2041.6569%2035.6569%2043%2034%2043H14C12.3431%2043%2011%2041.6569%2011%2040V8C11%206.34315%2012.3431%205%2014%205H27.5576ZM21.8462%2015.2308C21.5356%2014.4855%2020.8074%2014%2020%2014C19.1926%2014%2018.4644%2014.4855%2018.1538%2015.2308L13.1538%2027.2308C12.729%2028.2504%2013.2112%2029.4213%2014.2308%2029.8462C15.2504%2030.271%2016.4213%2029.7888%2016.8462%2028.7692L17.5833%2027H22.4167L23.1538%2028.7692C23.5787%2029.7888%2024.7496%2030.271%2025.7692%2029.8462C26.7888%2029.4213%2027.271%2028.2504%2026.8462%2027.2308L26.7432%2026.9837C26.8273%2026.9944%2026.913%2027%2027%2027H28V28C28%2029.1046%2028.8954%2030%2030%2030C31.1046%2030%2032%2029.1046%2032%2028V27H33C34.1046%2027%2035%2026.1046%2035%2025C35%2023.8954%2034.1046%2023%2033%2023H32V22C32%2020.8954%2031.1046%2020%2030%2020C28.8954%2020%2028%2020.8954%2028%2022V23H27C26.3521%2023%2025.7762%2023.3081%2025.4107%2023.7857L21.8462%2015.2308ZM15%2031C13.8954%2031%2013%2031.8954%2013%2033C13%2034.1046%2013.8954%2035%2015%2035C13.8954%2035%2013%2035.8954%2013%2037C13%2038.1046%2013.8954%2039%2015%2039H27C28.1046%2039%2029%2038.1046%2029%2037C29%2035.8962%2028.1058%2035.0012%2027.0023%2035H33C34.1046%2035%2035%2034.1046%2035%2033C35%2031.8954%2034.1046%2031%2033%2031L15%2031Z'%20fill='currentColor'%20stroke='%23333333'%20stroke-width='2'%20stroke-linejoin='round'/%3e%3c/svg%3e",Mt="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M40%2024.0005C40%2027.3142%2037.3137%2030.0005%2034%2030.0005H32.566L27.7629%2024.9453C27.9142%2024.6638%2028%2024.3419%2028%2024C28%2022.8954%2027.1046%2022%2026%2022H24.9645L21.1644%2018.0005H34C37.3137%2018.0005%2040%2020.6868%2040%2024.0005ZM36%2023.9995C36%2023.1711%2035.3284%2022.4995%2034.5%2022.4995C33.6716%2022.4995%2033%2023.1711%2033%2023.9995C33%2024.8279%2033.6716%2025.4995%2034.5%2025.4995C35.3284%2025.4995%2036%2024.8279%2036%2023.9995ZM30.752%2023.25C31.1673%2023.25%2031.504%2023.5858%2031.504%2024C31.504%2024.4142%2031.1673%2024.75%2030.752%2024.75C30.3367%2024.75%2030%2024.4142%2030%2024C30%2023.5858%2030.3367%2023.25%2030.752%2023.25Z'%20fill='%23333333'/%3e%3cpath%20d='M12%2024C12%2022.8954%2012.8954%2022%2014%2022H16.6881L12.9715%2018.0883C10.1478%2018.5761%208%2021.0375%208%2024.0005C8%2027.3142%2010.6863%2030.0005%2014%2030.0005H24.2896L20.4886%2026H14C12.8954%2026%2012%2025.1046%2012%2024Z'%20fill='%23333333'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M44%2024C44%2035.0457%2035.0457%2044%2024%2044C12.9543%2044%204%2035.0457%204%2024C4%2012.9543%2012.9543%204%2024%204C35.0457%204%2044%2012.9543%2044%2024ZM42%2024C42%2029.1085%2039.8719%2033.7199%2036.4539%2036.9962L11.6573%2010.8981C14.8798%207.86121%2019.2226%206%2024%206C33.9411%206%2042%2014.0589%2042%2024ZM24%2042C28.1125%2042%2031.9028%2040.6209%2034.9338%2038.2999L10.2781%2012.35C7.60984%2015.4897%206%2019.5569%206%2024C6%2033.9411%2014.0589%2042%2024%2042Z'%20fill='%23333333'/%3e%3c/svg%3e",co={key:0},uo={class:"fixed inset-0 overflow-y-auto"},po={class:"flex min-h-full items-center justify-center text-center"},mo={class:"border-b px-3 py-3 flex items-center justify-between"},fo={class:"flex items-center justify-center mx-auto my-20"},vo={class:"grid grid-cols-3 gap-4 px-5 py-5"},ho={class:"rounded border"},_o={class:"w-full space-y-2 py-2"},yo={class:"w-full flex justify-between px-4 py-1"},bo={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},go={class:"w-full flex justify-between px-4 py-1"},wo={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},xo={class:"rounded border"},Co={class:"w-full space-y-2 py-2"},ko={class:"w-full flex justify-between px-4 py-1"},$o={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},So={class:"w-full flex justify-between px-4 py-1"},To={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Po={class:"w-full flex justify-between px-4 py-1"},Vo={class:"rounded border max-h-72 overflow-y-auto"},Mo={class:"w-full space-y-2 py-2"},Lo={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Do={class:"w-full flex justify-between px-4 py-1"},Ao={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Ho={class:"w-full flex justify-between px-4 py-1"},jo={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Ro={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Oo={class:"w-full flex justify-between px-4 py-1"},qo={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Fo={class:"mx-5 rounded border mb-5"},Bo={class:"flex items-center justify-between bg-gray-50 px-4 py-2 border-b rounded-t"},Io={class:"justify-end flex items-center space-x-3"},Eo={key:0},Uo={class:"flex items-center space-x-1"},zo=["innerHTML"],No={key:1,class:"text-xs"},Zo={key:1,class:"px-4 py-2 flex items-center"},Go={class:"text-lg font-semibold"},Yo={class:"text-base text-gray-600 font-normal"},Ko={key:2,class:"px-2.5 py-2.5 border-t"};function Wo(u,t,c,V,o,f){const p=vs,a=G("TransitionChild"),x=G("DialogTitle"),w=G("XMarkIcon"),b=os,S=fe,q=Ks,M=lo,j=G("DialogPanel"),A=G("Dialog"),z=G("TransitionRoot");return L(),B("div",null,[es(u.$slots,"default",{onClick:t[0]||(t[0]=(...O)=>f.init&&f.init(...O))}),o.details!==null&&o.details.client!==void 0?(L(),B("div",co,[l(p,{class:"hidden",ref:"corePrinter",orderId:`${o.details.order_id}`,id:`${o.details.client.id}`},null,8,["orderId","id"])])):J("",!0),l(z,{appear:"",show:o.show,as:"template"},{default:$(()=>[l(A,{as:"div",class:"relative z-10"},{default:$(()=>[l(a,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:$(()=>t[2]||(t[2]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",uo,[e("div",po,[l(a,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:$(()=>[l(j,{class:"w-full max-w-7xl m-20 transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:$(()=>[e("div",mo,[l(x,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:$(()=>t[3]||(t[3]=[e("img",{src:ao,class:"w-8 h-8 mr-2"},null,-1),le(" View Test ")])),_:1}),e("button",{onClick:t[1]||(t[1]=(...O)=>f.handleClick&&f.handleClick(...O))},[l(w,{class:"w-5 h-5"})])]),Ee(e("div",fo,[l(b,{loading:o.loading},null,8,["loading"])],512),[[at,o.loading]]),e("div",vo,[e("div",ho,[t[8]||(t[8]=e("div",{class:"px-2 py-2 bg-gray-50 border-b rounded-t"},[e("h3",{class:"text-lg font-semibold text-black flex items-center"},[e("img",{src:ts,class:"w-7 h-7 mr-1"}),le(" Patient ")])],-1)),e("div",_o,[e("div",yo,[t[4]||(t[4]=e("h3",{class:"font-semibold"},"Patient Number",-1)),e("p",null,N(o.details.client.id),1)]),e("div",bo,[t[5]||(t[5]=e("h3",{class:"font-semibold"},"Name",-1)),e("p",null,N(("capitalize"in u?u.capitalize:s(Ie))(`${o.details.client.first_name} ${o.details.client.middle_name!==null?o.details.client.middle_name:""} ${o.details.client.last_name}`)),1)]),e("div",go,[t[6]||(t[6]=e("h3",{class:"font-semibold"},"Sex",-1)),e("p",null,N(o.details.client.sex),1)]),e("div",wo,[t[7]||(t[7]=e("h3",{class:"font-semibold"},"Age",-1)),e("p",null,N(("calculateAge"in u?u.calculateAge:s(Ct))(o.details.client.date_of_birth)),1)])])]),e("div",xo,[t[14]||(t[14]=e("div",{class:"px-2 py-2 bg-gray-50 border-b rounded-t"},[e("h3",{class:"text-lg font-semibold text-black flex items-center"},[e("img",{src:ro,class:"w-7 h-7 mr-1"}),le(" Specimen ")])],-1)),e("div",Co,[e("div",ko,[t[9]||(t[9]=e("h3",{class:"font-semibold"},"Specimen Type",-1)),e("p",null,N(o.details.specimen_type),1)]),e("div",$o,[t[10]||(t[10]=e("h3",{class:"font-semibold"},"Tracking Number",-1)),e("p",null,N(o.details.tracking_number),1)]),e("div",So,[t[11]||(t[11]=e("h3",{class:"font-semibold"},"Accession Number",-1)),e("p",null,N(o.details.accession_number),1)]),e("div",To,[t[12]||(t[12]=e("h3",{class:"font-semibold"},"Status",-1)),e("p",null,N(("capitalize"in u?u.capitalize:s(Ie))(o.details.order_status.split("-").join(" "))),1)]),e("div",Po,[t[13]||(t[13]=e("h3",{class:"font-semibold"},"Turn Around Time",-1)),e("p",null,N(f.getTurnAroundTime(o.details)),1)])])]),e("div",Vo,[t[23]||(t[23]=e("div",{class:"px-2 py-2 bg-gray-50 border-b rounded-t flex items-center"},[e("img",{src:io,class:"w-7 h-7 mr-1"}),e("h3",{class:"text-lg font-semibold text-black"},"Test")],-1)),e("div",Mo,[e("div",Lo,[t[15]||(t[15]=e("h3",{class:"font-semibold"},"Name",-1)),e("p",null,N(o.details.test_type_name),1)]),e("div",Do,[t[16]||(t[16]=e("h3",{class:"font-semibold"},"Date Registered",-1)),e("p",null,N(o.moment(o.details.created_date).format("DATE_FORMAT"in u?u.DATE_FORMAT:s(ht))),1)]),e("div",Ao,[t[17]||(t[17]=e("h3",{class:"font-semibold"},"Receipt Date",-1)),e("p",null,N(o.moment(o.details.created_date).format("DATE_FORMAT"in u?u.DATE_FORMAT:s(ht))),1)]),e("div",Ho,[t[18]||(t[18]=e("h3",{class:"font-semibold"},"Test Status",-1)),e("p",null,N(("capitalizeStr"in u?u.capitalizeStr:s(ss))(o.details.status.split("-").join(" "))),1)]),e("div",jo,[t[19]||(t[19]=e("h3",{class:"font-semibold"},"Ward/Location",-1)),e("p",null,N(o.details.requesting_ward),1)]),e("div",Ro,[t[20]||(t[20]=e("h3",{class:"font-semibold"},"Request Origin",-1)),e("p",null,N(o.details.request_origin),1)]),e("div",Oo,[t[21]||(t[21]=e("h3",{class:"font-semibold"},"Registered By",-1)),e("p",null,N(f.getRequestedBy(o.details.status_trail)),1)]),e("div",qo,[t[22]||(t[22]=e("h3",{class:"font-semibold"},"Requested By",-1)),e("p",null,N(o.details.requested_by),1)])])])]),e("div",Fo,[e("div",Bo,[t[24]||(t[24]=e("h3",{class:"text-lg font-semibold text-black"},"Results",-1)),e("div",Io,[o.details.status.toLowerCase()==="completed"&&("usePermissions"in u?u.usePermissions:s(Me))().can.verify("test_results")&&f.isCompletedByCurrentUserOrSuperAdmin(o.details)?(L(),ae(S,{key:0,icon:o.checkIcon,text:"Authorize",click:()=>{f.changeStatus("verified",o.details.id)},color:"success",loading:o.verifying},null,8,["icon","click","loading"])):J("",!0),(o.details.status.toLowerCase()==="completed"||o.details.status.toLowerCase()==="verified"||o.details.status.toLowerCase()==="test-rejected")&&("usePermissions"in u?u.usePermissions:s(Me))().can.view("reports")?(L(),ae(S,{key:1,icon:o.viewIcon,text:"View Report",click:f.viewReport,color:"primary"},null,8,["icon","click"])):J("",!0),l(q,{item:o.details,onUpdate:f.updateChanges,color:"primary"},null,8,["item","onUpdate"]),l(M,{item:o.details,onUpdate:f.updateNewOrder,color:"primary"},null,8,["item","onUpdate"]),l(S,{icon:o.printerIcon,text:"Print Accession Number",click:f.printAccessionNumber,color:"primary"},null,8,["icon","click"]),l(S,{icon:o.printerIcon,color:"success",text:"Print Tracking Number",click:f.printTrackingNumber},null,8,["icon","click"])])]),f.isRejectedOrVoided(o.details.status)?(L(),B("div",Zo,[t[26]||(t[26]=e("img",{src:Mt,class:"w-6 h-6 mr-2",alt:"no-result-svg"},null,-1)),e("h3",Go,[t[25]||(t[25]=le(" Test Rejected: ")),e("span",Yo,N(o.details.rejection_reason),1)])])):(L(),B("div",Eo,[(L(!0),B(me,null,Ve(o.details.indicators,(O,T)=>{var R;return L(),B("div",{class:Be(o.details.indicators.length!==T+1?"w-full px-5 py-2 border-b border-dotted flex justify-between items-center":"w-full px-5 py-2 flex justify-between items-center"),key:T},[e("h3",null,N(O.name),1),e("div",Uo,[O.result?(L(),B("p",{key:0,innerHTML:O.result.value?O.result.value:"Not done"},null,8,zo)):J("",!0),(R=O.result)!=null&&R.value?(L(),B("span",No,N(O==null?void 0:O.unit),1)):J("",!0)])],2)}),128))])),o.details.test_type_name=="Cross-match"&&o.details.status.toLowerCase()=="verified"?(L(),B("div",Ko,[l(S,{loading:o.zebraPrinting,click:()=>{f.printBBResults()},text:"Print results",color:"primary",icon:o.printerIcon},null,8,["loading","click","icon"])])):J("",!0)])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const Xo=nt(no,[["render",Wo]]),Qo={class:"fixed inset-0 overflow-y-auto"},Jo={class:"flex min-h-full items-center justify-center p-4 text-center"},el={class:"border-b px-3 py-3 flex items-center justify-between"},tl={class:"mt-2 space-y-3 px-5 py-5"},sl={class:"w-full border border-dotted rounded"},ol={class:"flex items-center space-x-1"},ll=["innerHTML"],nl={key:1,class:"text-xs"},al={class:"w-full flex items-center"},rl={class:"w-full flex flex-col space-y-2"},il={class:"w-full flex flex-col space-y-2"},cl={class:"w-full flex flex-col space-y-2"},ul={class:"flex items-center space-x-2"},dl={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},pl=ce({__name:"index",props:{item:{}},emits:["update"],setup(u,{emit:t}){const c=u,V=t,o=h(),f=h(!1),p=Ae,a=h(""),x=h(""),w=h(!1),b=h(!1),S=h(!1),q=h([]),{$toast:M}=oe(),j=h({name:"select ward",id:0}),A=async()=>{const{data:r,error:n}=await W({route:X.sections,method:"GET"});r.value&&(q.value=r.value.data),n.value&&console.error(n.value)},z=async()=>{w.value=!0,await A();const r={route:`${X.tests}/${c.item.id}`,method:"GET"},{data:n,error:_,pending:C}=await W(r);w.value=C,n.value&&(w.value=!1,o.value=n.value,j.value=q.value.find(k=>k.name==n.value.requesting_ward)||{name:"select ward",id:0},g()),_.value&&(w.value=!1,console.error(_.value),M.error(ne))},O=()=>{x.value=""},T=()=>{const r=new Date,n=r.getFullYear(),_=String(r.getMonth()+1).padStart(2,"0"),C=String(r.getDate()).padStart(2,"0"),k=String(r.getHours()).padStart(2,"0"),y=String(r.getMinutes()).padStart(2,"0");x.value=`${n}-${_}-${C}T${k}:${y}`},R=async()=>{b.value=!0;const r={route:`${X.processCrossMatch}`,method:"POST",body:{post_crossmatch_process:{facility_section_id:j.value.id,test_id:c.item.id,collected_by:a.value,collection_date:x.value}}},{data:n,error:_,pending:C}=await W(r);b.value=C,n.value&&(M.success("Collection details saved successfully!"),g(),b.value=!1,v(),V("update",!0)),_.value&&(console.error(_.value),M.error(ne),b.value=!1)},g=()=>{f.value=!f.value};async function v(){var k,y;const r={route:X.printOutZebra,method:"POST",body:{order_id:(k=o.value)==null?void 0:k.order_id,tests:[(y=o.value)==null?void 0:y.id],is_cross_match:!0}},{data:n,error:_,pending:C}=await W(r);if(S.value=C,n.value){S.value=!1;const I=new FileReader;I.onload=()=>{const E=URL.createObjectURL(n.value),H=document.createElement("a");H.href=E,H.setAttribute("download",`${Date.now()}.lbl`),H.click(),URL.revokeObjectURL(E)},I.readAsText(n.value),M.success("Results printed successfully!")}_.value&&(S.value=!1,M.error(ne),console.error(_.value))}const m=()=>{a.value="",x.value="",j.value={name:"select ward",id:0}};return(r,n)=>{const _=fe,C=G("FormKit"),k=kt,y=G("datepicker"),I=De;return L(),B("div",null,[e("div",null,[l(_,{text:"Collect",color:"primary",icon:s(Hs),click:()=>{z()},loading:s(w)},null,8,["icon","click","loading"])]),l(s(Te),{appear:"",show:s(f),as:"template"},{default:$(()=>[l(s(ke),{as:"div",onClose:g,class:"relative z-10"},{default:$(()=>[l(s(ie),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:$(()=>n[3]||(n[3]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",Qo,[e("div",Jo,[l(s(ie),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:$(()=>[l(s($e),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:$(()=>[e("div",el,[l(s(Se),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:$(()=>n[4]||(n[4]=[e("svg",{class:"w-8 h-8 mr-2",xmlns:"http://www.w3.org/2000/svg",width:"512",height:"512",viewBox:"0 0 512 512"},[e("path",{fill:"currentColor",d:"m118.2 55l-2.5 5.02C108.9 73.86 99.93 79 91.97 79s-16.99-5.17-23.92-19.03l-16.1 8.06C61.02 86.17 75.99 97 91.97 97c14.43 0 27.93-8.91 37.03-24h82v419h18V73h81.8c7.3 11.92 17.2 19.95 28.2 22.82V119h18V95.84c12.5-3.24 23.7-13.13 31.1-27.81l-16.2-8.06C365 73.83 356 79 348 79s-17-5.17-23.9-19.03L321.6 55zm171.1 82c-1.3 3-3.9 9.6-5.4 19.8c-1.9 12.9-2.9 29.5-2.9 47.2c0 33.5 3.8 70.9 10.5 93.5c14 6 35.3 9.5 56.5 9.5s42.5-3.5 56.5-9.5c6.7-22.6 10.5-60 10.5-93.5c0-17.7-1-34.3-2.9-47.2c-1.5-10.2-4.1-16.8-5.4-19.8zm5.3 77c35.3 7.2 70.6 10.5 105.9 0c-.5 24-2.4 45-10.2 69.6c-28.9 3-56.5 11.4-89.9-3.9zm91.1 107.7c-5.8 1.1-11.8 1.9-17.9 2.4c.7 3.1 1.5 6.6 2.3 10.6c2.4 11.4 4.4 25.3 3.9 32.7v.1c-.4 6.3-3 13.3-6.2 21.1s-6.9 16.5-7.7 26.7c-1.2 14.7 1.4 34.1 4.1 50.4s5.6 29.4 5.6 29.4l17.6-4s-2.9-12.6-5.5-28.3c-2.5-15.8-4.7-35-3.8-46.1c.5-6.4 3.2-13.4 6.4-21.3s6.9-16.6 7.5-26.8c.7-11.5-1.8-25.6-4.2-37.5c-.7-3.4-1.5-6.6-2.1-9.4m-74.7.1v24.5h18v-22.1c-6.1-.5-12.2-1.3-18-2.4"})],-1),le(" Blood collection ")])),_:1}),e("button",{type:"button",onClick:g},[l(s(ye),{class:"w-5 h-5"})])]),l(C,{type:"form","submit-label":"Update",onSubmit:R,actions:!1,id:"collectionForm"},{default:$(({value:E})=>{var H;return[e("div",tl,[e("div",null,[n[5]||(n[5]=e("h3",{class:"text-lg font-semibold text-black"},"Results",-1)),e("div",sl,[(L(!0),B(me,null,Ve((H=s(o))==null?void 0:H.indicators,(Z,Y)=>{var He,je;return L(),B("div",{class:Be(((He=s(o))==null?void 0:He.indicators.length)!==Y+1?"w-full px-5 py-2 border-b border-dotted flex justify-between items-center":"w-full px-5 py-2 flex justify-between items-center"),key:Y},[e("h3",null,N(Z.name),1),e("div",ol,[Z.result?(L(),B("p",{key:0,innerHTML:Z.result.value?Z.result.value:"Not done"},null,8,ll)):J("",!0),(je=Z.result)!=null&&je.value?(L(),B("span",nl,N(Z==null?void 0:Z.unit),1)):J("",!0)])],2)}),128))])]),e("div",al,[e("div",rl,[l(C,{type:"text",label:"Person's Name",validation:"required",modelValue:s(a),"onUpdate:modelValue":n[0]||(n[0]=Z=>se(a)?a.value=Z:null)},null,8,["modelValue"])])]),e("div",il,[n[6]||(n[6]=e("label",{class:"font-medium"},"Designated ward",-1)),l(k,{isSearchable:"",items:s(q),modelValue:s(j),"onUpdate:modelValue":n[1]||(n[1]=Z=>se(j)?j.value=Z:null),class:Be(s(j).name=="select ward"&&"text-gray-600")},null,8,["items","modelValue","class"])]),e("div",cl,[n[7]||(n[7]=e("label",{class:"font-medium"},"Collection Time",-1)),e("div",ul,[l(y,{required:"",position:"left",onCleared:O,placeholder:"select collection date and time",range:!1,format:"dd/MM/yyyy HH:mm:ss","input-class-name":"datepicker",modelValue:s(x),"onUpdate:modelValue":n[2]||(n[2]=Z=>se(x)?x.value=Z:null)},null,8,["modelValue"]),l(_,{text:"Now",color:"primary",click:()=>{T()},icon:s(Vt)},null,8,["click","icon"])])])]),e("div",dl,[l(I,{type:"button",text:"Clear form",click:m}),l(_,{loading:s(b),type:"submit",color:"success",icon:s(p),click:()=>{},text:"Save details"},null,8,["loading","icon"])])]}),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),ml={class:"fixed inset-0 overflow-y-auto"},fl={class:"flex min-h-full items-center justify-center p-4 text-center"},vl={class:"border-b px-3 py-3 flex items-center justify-between"},hl={class:"mt-2 space-y-3 px-5 py-5"},_l={class:"mt-2"},yl={key:0,class:"space-y-3"},bl={class:"w-full flex flex-col space-y-2"},gl={class:"flex items-center space-x-2"},wl={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},xl=ce({__name:"index",props:{item:{}},emits:["update"],setup(u,{emit:t}){const c=u,V=t,o=h(),f=h(!1),p=Ae,a=h(""),x=h(!1),w=h(""),b=h(""),S=h(""),q=h(!1),M=h(!1),j=h(!1),{$toast:A}=oe(),z=async()=>{q.value=!0;const r={route:`${X.tests}/${c.item.id}`,method:"GET"},{data:n,error:_,pending:C}=await W(r);q.value=C,n.value&&(q.value=!1,o.value=n.value,g()),_.value&&(q.value=!1,console.error(_.value),A.error(ne))},O=()=>{S.value=""},T=()=>{const r=new Date,n=r.getFullYear(),_=String(r.getMonth()+1).padStart(2,"0"),C=String(r.getDate()).padStart(2,"0"),k=String(r.getHours()).padStart(2,"0"),y=String(r.getMinutes()).padStart(2,"0");S.value=`${n}-${_}-${C}T${k}:${y}`},R=async()=>{M.value=!0;const r={route:`${X.processCrossMatch}`,method:"POST",body:{post_crossmatch_process:{facility_section_id:c.item.post_crossmatch_process.facility_section_id,test_id:c.item.id,transfusion_outcome:a.value,returned:x.value,returned_by:b.value,returned_date:S.value,returned_reason:w.value}}},{data:n,error:_,pending:C}=await W(r);M.value=C,n.value&&(A.success("Transfusion outcome saved successfully!"),g(),M.value=!1,v(),V("update",!0)),_.value&&(console.error(_.value),A.error(ne),M.value=!1)},g=()=>{f.value=!f.value};async function v(){var k,y;const r={route:X.printOutZebra,method:"POST",body:{order_id:(k=o.value)==null?void 0:k.order_id,tests:[(y=o.value)==null?void 0:y.id],is_cross_match:!0}},{data:n,error:_,pending:C}=await W(r);if(j.value=C,n.value){j.value=!1;const I=new FileReader;I.onload=()=>{const E=URL.createObjectURL(n.value),H=document.createElement("a");H.href=E,H.setAttribute("download",`${Date.now()}.lbl`),H.click(),URL.revokeObjectURL(E)},I.readAsText(n.value),A.success("Results printed successfully!")}_.value&&(j.value=!1,A.error(ne),console.error(_.value))}const m=()=>{a.value="",x.value=!0,b.value="",S.value="",w.value=""};return(r,n)=>{const _=fe,C=G("FormKit"),k=G("datepicker"),y=De;return L(),B("div",null,[e("div",null,[l(_,{text:"Outcome",color:"success",icon:s(As),click:()=>{z()},loading:s(q)},null,8,["icon","click","loading"])]),l(s(Te),{appear:"",show:s(f),as:"template"},{default:$(()=>[l(s(ke),{as:"div",onClose:g,class:"relative z-10"},{default:$(()=>[l(s(ie),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:$(()=>n[5]||(n[5]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",ml,[e("div",fl,[l(s(ie),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:$(()=>[l(s($e),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:$(()=>[e("div",vl,[l(s(Se),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:$(()=>n[6]||(n[6]=[e("svg",{class:"w-8 h-8 mr-2",xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64"},[e("path",{fill:"currentColor",d:"M55.407.547H8.833C4.271.547.559 4.26.559 8.824v46.568c0 4.565 3.713 8.279 8.274 8.279h46.574c4.564 0 8.276-3.713 8.276-8.279V8.824c0-4.564-3.712-8.277-8.276-8.277M35.358 16.592a6.583 6.583 0 0 1 6.584 6.584c0 3.634-2.949 6.586-6.584 6.586s-6.584-2.952-6.584-6.586a6.583 6.583 0 0 1 6.584-6.584M8.191 18.675v-5.269h5.269V8.137h5.269v5.269h5.269v5.269h-5.269v5.268H13.46v-5.268zM52.64 53.058c-.488 0-.957-.095-1.385-.267l-5.862-1.631v5.843H25.044V51.16l-5.86 1.631a3.7 3.7 0 0 1-1.385.267a3.755 3.755 0 0 1-3.112-5.853l9.4-12.889c1.02-1.398 2.445-2.955 5.45-2.955H40.9c3.004 0 4.43 1.558 5.449 2.955l9.399 12.889a3.74 3.74 0 0 1 .642 2.099a3.757 3.757 0 0 1-3.752 3.754z"}),e("path",{fill:"currentColor",d:"M25.043 35.868v7.816l.712-.24c5.242-1.545 7.281 5.376 2.04 6.918l-.168.047l7.592 2.513l7.593-2.513l-.171-.047c-5.238-1.542-3.199-8.463 2.039-6.918l.716.24v-7.816l-10.177 3.325z"})],-1),le(" Transfusion outcome ")])),_:1}),e("button",{type:"button",onClick:g},[l(s(ye),{class:"w-5 h-5"})])]),l(C,{type:"form","submit-label":"Update",onSubmit:R,actions:!1,id:"collectionForm"},{default:$(({value:I})=>[e("div",hl,[l(C,{type:"text",label:"Transfusion Outcome",modelValue:s(a),"onUpdate:modelValue":n[0]||(n[0]=E=>se(a)?a.value=E:null),validation:"required"},null,8,["modelValue"]),e("div",_l,[e("label",null,[Ee(e("input",{type:"checkbox","onUpdate:modelValue":n[1]||(n[1]=E=>se(x)?x.value=E:null)},null,512),[[ls,s(x)]]),n[7]||(n[7]=le(" Is it returned? "))])]),s(x)?(L(),B("div",yl,[l(C,{type:"text",label:"Returned By",modelValue:s(b),"onUpdate:modelValue":n[2]||(n[2]=E=>se(b)?b.value=E:null),validation:"required"},null,8,["modelValue"]),e("div",bl,[n[8]||(n[8]=e("label",{class:"font-medium"},"Returned Date",-1)),e("div",gl,[l(k,{required:"",position:"left",onCleared:O,placeholder:"select collection date and time",range:!1,format:"dd/MM/yyyy HH:mm:ss","input-class-name":"datepicker",modelValue:s(S),"onUpdate:modelValue":n[3]||(n[3]=E=>se(S)?S.value=E:null)},null,8,["modelValue"]),l(_,{text:"Now",color:"primary",click:()=>{T()},icon:s(Vt)},null,8,["click","icon"])])]),l(C,{type:"textarea",label:"Returned Reason",modelValue:s(w),"onUpdate:modelValue":n[4]||(n[4]=E=>se(w)?w.value=E:null),validation:"required"},null,8,["modelValue"])])):J("",!0)]),e("div",wl,[l(y,{type:"button",text:"Clear form",click:()=>{m()}},null,8,["click"]),l(_,{loading:s(M),type:"submit",color:"success",icon:s(p),click:()=>{},text:"Save details"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),Cl={components:{TransitionRoot:Te,TransitionChild:ie,Dialog:ke,DialogPanel:$e,DialogTitle:Se,XMarkIcon:ye,UserIcon:hs},data(){return{open:!1,addIcon:wt,saveIcon:Ae,clearIcon:_s,name:"",description:"",loading:!1,cookie:Le("token"),reasons:new Array,reasonsSelected:"",rawReasons:new Array}},props:{item:{required:!0,type:Object},text:{type:String,required:!0},action:{type:String,required:!0},icon:{type:[Object,Function],required:!0}},methods:{async init(){this.handleClick();const u={route:X.rejectionReasons,method:"GET",token:`${this.cookie}`},{error:t,data:c}=await W(u);c.value&&(this.rawReasons=c.value,c.value.map(V=>{this.reasons.push(V.description)})),t.value&&console.error(t.value)},async submitForm(){this.loading=!0;let u=null;this.rawReasons.map(f=>{f.description===this.reasonsSelected&&(u=f.id)});const t={route:`${X.testStatus}/${this.item.id}/${this.action}?status_reason_id=${u}&person_talked_to=${this.name}`,method:"PUT",token:`${this.cookie}`,body:{}},{data:c,error:V,pending:o}=await W(t);this.loading=o,c.value&&(oe().$toast.success(`Test action "${this.text}" done successfully!`),this.handleClick(),this.loading=!1,this.$emit("update",!0)),V.value&&(console.error(V.value),oe().$toast.error(ne),this.loading=!1)},handleClick(){this.open=!this.open},resetForm(){this.reasonsSelected="",this.$formkit.reset("rejectionForm")}}},kl={class:"fixed inset-0 overflow-y-auto"},$l={class:"flex min-h-full items-center justify-center p-4 text-center"},Sl={class:"border-b px-3 py-3 flex items-center justify-between"},Tl={class:"mt-2 space-y-3 px-5 py-5"},Pl={class:"space-y-2"},Vl={class:"border-b border-dotted text-gray-600"},Ml={class:"space-y-2"},Ll={class:"border-b border-dotted text-gray-600"},Dl={class:"space-y-2"},Al={class:"border-b border-dotted text-gray-600"},Hl={class:"w-full flex items-center"},jl={class:"w-full flex flex-col space-y-2"},Rl={class:"w-full flex flex-col space-y-2 pb-40"},Ol={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function ql(u,t,c,V,o,f){const p=fe,a=G("TransitionChild"),x=G("DialogTitle"),w=G("XMarkIcon"),b=G("FormKit"),S=G("multi-select"),q=De,M=G("DialogPanel"),j=G("Dialog"),A=G("TransitionRoot");return L(),B("div",null,[e("div",null,[l(p,{text:c.text,color:"error",icon:c.icon,click:f.init},null,8,["text","icon","click"])]),l(A,{appear:"",show:o.open,as:"template"},{default:$(()=>[l(j,{as:"div",onClose:f.handleClick,class:"relative z-10"},{default:$(()=>[l(a,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:$(()=>t[3]||(t[3]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",kl,[e("div",$l,[l(a,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:$(()=>[l(M,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:$(()=>[e("div",Sl,[l(x,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:$(()=>[t[4]||(t[4]=e("img",{src:Mt,class:"w-8 h-8 mr-2"},null,-1)),le(" "+N(c.text.charAt(0).toUpperCase()+c.text.slice(1))+" Reason ",1)]),_:1}),e("button",{onClick:t[0]||(t[0]=(...z)=>f.handleClick&&f.handleClick(...z))},[l(w,{class:"w-5 h-5"})])]),l(b,{type:"form","submit-label":"Update",onSubmit:f.submitForm,actions:!1,id:"rejectionForm"},{default:$(({value:z})=>[e("div",Tl,[e("div",Pl,[t[5]||(t[5]=e("h3",{class:"font-medium"},"Test Type",-1)),e("p",Vl,N(c.item.test_type_name),1)]),e("div",Ml,[t[6]||(t[6]=e("h3",{class:"font-medium"},"Specimen",-1)),e("p",Ll,N(c.item.specimen_type),1)]),e("div",Dl,[t[7]||(t[7]=e("h3",{class:"font-medium"},"Accession Number",-1)),e("p",Al,N(c.item.accession_number),1)]),e("div",Hl,[e("div",jl,[l(b,{type:"text",label:"Person Talked To",validation:c.text.toLowerCase()!=="void"?"required":"",modelValue:o.name,"onUpdate:modelValue":t[1]||(t[1]=O=>o.name=O)},null,8,["validation","modelValue"])])]),e("div",Rl,[t[8]||(t[8]=e("label",{class:"font-medium"},"Select Reason(s)",-1)),l(S,{style:{"--ms-max-height":"none !important"},modelValue:o.reasonsSelected,"onUpdate:modelValue":t[2]||(t[2]=O=>o.reasonsSelected=O),options:o.reasons,searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),e("div",Ol,[l(q,{type:"button",text:"Clear form",click:f.resetForm},null,8,["click"]),l(p,{loading:o.loading,type:"submit",click:()=>{},color:"success",icon:o.saveIcon,text:"Save changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const Fl=nt(Cl,[["render",ql]]),Bl={class:"py-5 px-5"},Il={class:"flex items-center space-x-2 py-5"},El={class:"text-2xl font-semibold uppercase"},Ul={class:"flex justify-between items-center w-full py-2 mb-2"},zl={class:"flex items-center space-x-2"},Nl={class:"relative z-10 w-40"},Zl={class:"w-44"},Gl={class:"pt-1"},Yl={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},Kl={class:"w-72 ml-2"},Wl={class:"py-3 flex items-center space-x-3"},Xl={class:"py-2 flex items-center"},Ql={class:"w-full flex items-center justify-between space-x-2"},Jl={key:0,class:"flex items-center space-x-2"},en={key:0,class:"flex items-center space-x-2"},An=ce({__name:"index",setup(u){const t=Ce(),c=ns(),V=as(),{$toast:o,$metadata:f}=oe();bs({title:`${gs.name.toUpperCase()} - ${t.department} Tests`});const p=h(!1),a=h(0),x=h(),w=h(["",""]),b=h(""),S=h("Tests Lists"),q=h([{name:"Home",link:"/home"}]),M=h([{text:"PATIENT NO",value:"client.id",sortable:!0},{text:"PATIENT NAME",value:"name",sortable:!0},{text:"ACCESSION NO",value:"accession_number",sortable:!0},{text:"TEST",value:"test_type_name",sortable:!0},{text:"LOCATION",value:"requesting_ward",sortable:!0},{text:"ORDER STATUS",value:"order_status",sortable:!0},{text:"STATUS",value:"status",sortable:!0},{text:"DATE REGISTERED",value:"created_date",sortable:!0},{text:"ACTIONS",value:"actions",sortable:!1}]),j=h([{text:"Results",color:"primary",icon:ws,status:"completed",show:"started",permission:"enter_test_results"},{text:"Accept",color:"success",icon:Qe,status:"pending",show:"not-collected",permission:"accept_test_specimen"},{text:"Start",color:"warning",icon:Ds,status:"started",show:"pending",permission:"start_test"},{text:"Authorize",color:"success",status:"verified",icon:Qe,show:"completed",permission:"verify_test_results"}]),A=i=>{const d=[{name:"Reject",icon:Ge,action:"rejected",permission:"void_test"},{name:"Void",icon:Ge,action:"voided",permission:"void_test"},{name:"Notdone",icon:Ge,action:"not_done",permission:"void_test"}];return i.toLowerCase()==="verified"?d.filter(P=>P.name.toLowerCase()==="void"):d},z=h([]),O=rs(),T=h({name:"select status"}),R=h("accession_number"),g=h(""),v=Le("token"),m=h(!1),r=h(!0),n=h(0),_=h([]),C=h({page:1,rowsPerPage:20,sortBy:"name"}),k=h([]),y=h([]),I=i=>{a.value==i?a.value=0:a.value=i},E=async i=>{m.value=!0;const d={route:`${X.nlimsTestSearch}?tracking_number=${i.replace(/\$$/,"")}`,method:"GET",token:`${v.value}`},{data:P,error:U}=await W(d);P.value&&(ds(P.value).then(K=>{const ee={...c.query,search:K};V.replace({query:ee}),b.value=K,g.value=K,H()}).catch(K=>{console.error("error routing to merged test: ",K)}),m.value=!1),U.value&&(console.error(U.value),o.error(`${U.value.data.error}`),m.value=!1)},H=async()=>{Z(),m.value=!0;const{page:i,rowsPerPage:d}=C.value;let P=ct(t.user.departments,t.department),U=ct(t.locations,t.selectedLocation),K=T.value.name==="select status"?"":T.value.name!==void 0&&T.value.name;const ee=w.value[0].toString()!==""?we(w.value[0].toString()).format("YYYY-MM-DD"):"",ze=w.value[1].toString()!==""?we(w.value[1].toString()).format("YYYY-MM-DD"):"",Ne={route:`${X.tests}?minimal=true&page=${i}&per_page=${d}&status=${K.toString().toLowerCase()}&search=${b.value}&department_id=${P}&lab_location=${U}&start_date=${ee}&end_date=${ze}&facility_sections=${_.value}`,method:"GET",token:`${v.value}`},{data:ge,error:Re,pending:Ze}=await W(Ne);m.value=Ze,ge.value&&(ge.value.data.length==0&&o.warning("No tests found within the specified period"),z.value=ge.value.data.map(Q=>{var Oe,qe,F,te;return{...Q,name:`${Ie(`${(Oe=Q.client)==null?void 0:Oe.first_name} ${((qe=Q.client)==null?void 0:qe.middle_name)!==null?Q.client.middle_name:""} ${(F=Q.client)==null?void 0:F.last_name}`)} (${Q.client.sex}, ${Ct((te=Q.client)==null?void 0:te.date_of_birth)} yrs)`,order_status:`${Q.order_status!==null?(Q.order_status.charAt(0).toUpperCase()+Q.order_status.slice(1)).split("-").join(" "):""}`,status:`${Q.status!==null?Q.status.charAt(0).toUpperCase()+Q.status.slice(1):""}`,created_date:we(Q.created_date).utcOffset(2).format(cs)}}),n.value=ge.value.meta.total_count,m.value=!1),Re.value&&(console.error(Re.value.data),o.error(ne),m.value=!1)},Z=async()=>{const i={route:`${X.testStatus}/all`,method:"GET",token:`${v.value}`},{data:d,error:P}=await W(i);d.value&&(k.value=d.value.map(U=>({id:U.id,name:U.name.charAt(0).toUpperCase()+U.name.slice(1)}))),P.value&&console.error(P.value)},Y=async(i,d)=>{m.value=!0;const P={route:`${X.testStatus}/${d}/${i}`,method:"PUT",token:`${v.value}`,body:{}},{data:U,error:K,pending:ee}=await W(P);m.value=ee,U.value&&(H(),m.value=!1),K.value&&(console.error(K.value),m.value=!1)},He=async i=>{us(i)||(o.success(`Order with accession number ${i.accession_number} has been created successfully!`),await O.alertConfirmation({message:"Do you want to print specimen label?"})&&await Xe.printSpecimenLabel(i.accession_number)),H()},je=async(i,d)=>{m.value=!0;const P={route:`${X.orderStatus}/${i}`,method:"PUT",token:`${v.value}`,body:{order_id:d}},{data:U,error:K,pending:ee}=await W(P);m.value=ee,U.value&&(H(),m.value=!1),K.value&&(console.error(K.value),m.value=!1)},it=(i,d)=>{i.status==="completed"?d.test_type_name.toLowerCase().includes("culture")?ut(d,`/tests/result/culture-sensitivity?accession_number=${d.accession_number}&test_id=${d.id}`):ut(d,`/tests/result?accession_number=${d.accession_number}&test_id=${d.id}`):i.status==="verified"?mt(d):i.status!==""&&Y(i.status,d.id)},ct=(i,d)=>{const P=i.find(U=>U.name===d);return P?P.id:null},be=i=>{if(a.value=0,typeof i=="object"){C.value=i;const d={...c.query,page:i.page,rowsPerPage:i.rowsPerPage};V.replace({query:d})}H(),p.value=!1},Lt=()=>{g.value="",b.value="",H()},Dt=i=>{b.value=i,g.value=i;const d={...c.query,search:i};V.replace({query:d}),i!==""?Ht(i)?E(i):be(i):H()},At=i=>{if(i){_.value=i;for(let d=y.value.length-1;d>=0;d--){const P=y.value[d];P.origin==="wards"&&!i.includes(P.value)&&y.value.splice(d,1)}i.forEach(d=>{y.value.some(P=>P.origin==="wards"&&P.value===d)||y.value.push({origin:"wards",value:d})}),H()}},ut=(i,d)=>{V.push(d)},Ht=i=>/^(x|l).*\d/.test(i.toLowerCase()),dt=i=>{if(i.name!=="select status"){const P=y.value.find(U=>U.origin==="statuses");P?P.value=i.name:y.value.push({origin:"statuses",value:i.name})}T.value=i;const d={...c.query,status:i.name.toLowerCase()=="select status"?"":i.name.toLowerCase()};V.replace({query:d}),d.status!==""&&H()},jt=i=>{if(i.origin==="statuses"&&T.value.name!=="select status"&&dt({name:"select status"}),i.origin==="wards"){const P=_.value.indexOf(i.value);P!==-1&&_.value.splice(P,1)}const d=y.value.findIndex(P=>P.origin===i.origin);d!==-1&&y.value.splice(d,1),H()},Rt=i=>{const d=t.user,P=i.completed_by;if(P){if(P.id!==d.id)return!0;if(P.is_super_admin===!0)return!0}return!1},Ot=(i,d)=>{const{hasPermission:P}=Me(),U=i.status.toLowerCase(),K=d.show.toLowerCase();if(U===K){const ee=Rt(i);return U==="pending"&&i.order_status.toLowerCase()==="specimen not collected"?!1:d.permission?ee&&P.value(String(d.permission)):ee}return!1},qt=i=>{const d=new Set(["rejected","not-done","voided"]),P=new Set(["specimen not collected"]);return!d.has(i.status.toLowerCase())&&P.has(i.order_status.toLowerCase())},pt=i=>{const{can:d}=Me();return!new Set(["voided","test-rejected","rejected","not-done"]).has(i.status.toLowerCase())&&d.void("test")},Ft=()=>{w.value=["",""]},mt=i=>{x!==null&&x.value.init(i)};return _e(()=>t.department,(i,d)=>{i!==d&&H()}),_e(()=>t.selectedLocation,(i,d)=>{i!==d&&H()}),_e(w,(i,d)=>{if(r.value){r.value=!1;return}if(i!==d){const P=i[0].toString()!==""?we(i[0].toString()).format("YYYY-MM-DD"):"",U=i[1].toString()!==""?we(i[1].toString()).format("YYYY-MM-DD"):"",K={...c.query,from:P,to:U};V.replace({query:K}),H()}},{deep:!0}),_e(T,i=>{dt(i)},{deep:!0}),ot(()=>{var i,d,P,U,K,ee;C.value={page:Number(c.query.page?c.query.page:1),rowsPerPage:Number(c.query.rowsPerPage?c.query.rowsPerPage:20)},T.value=c.query.status?{name:c.query.status.toString()}:{name:"select status"},b.value=(i=c.query.search)!=null&&i.toString()?(d=c.query.search)==null?void 0:d.toString():"",w.value=[`${(P=c.query.from)!=null&&P.toString()?(U=c.query.from)==null?void 0:U.toString():""}`,`${(K=c.query.to)!=null&&K.toString()?(ee=c.query.to)==null?void 0:ee.toString():""}`],H()}),(i,d)=>{const P=Bt,U=fe,K=kt,ee=Os,ze=G("datepicker"),Ne=fs,ge=Is,Re=Xo,Ze=pl,Q=xl,Oe=Fl,qe=ys;return L(),B("div",Bl,[l(P,{pages:s(q)},null,8,["pages"]),e("div",Il,[d[3]||(d[3]=is('<svg class="w-auto h-8" xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><g fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"><path d="M18.142 4L4 18.142l7.778 7.778L25.92 11.778zm-1.328 4.35l-1.415 1.415l4.95 4.95l1.414-1.415zm-3.536 3.536L11.864 13.3l4.95 4.95l1.414-1.414zm-3.536 3.536l-1.414 1.414l4.95 4.95l1.414-1.415z"></path><path d="m11.864 23.2l11.314-11.314l17.677 17.678a8 8 0 1 1-11.313 11.313zm2.828 0l16.264 16.263a6 6 0 0 0 8.485-8.485L23.178 14.714z"></path><path d="m19.642 23.907l7.779-7.778l12.02 12.02l-7.778 7.779zm2.829 0l9.192 9.192l4.95-4.95l-9.192-9.192z"></path><path d="M27.066 29.917c-1.414.707-3.182 2.475-3.536 3.536l6.718 6.717a7 7 0 0 0 9.9-9.899l-2.122-2.12l-6.363 6.363z"></path><path d="m24.755 33.263l6.2 6.2a6 6 0 0 0 8.486-8.485l-1.415-1.414l-6.363 6.364l-4.755-4.755a9.3 9.3 0 0 0-1.3 1.087a7.3 7.3 0 0 0-.853 1.003m-.562-2.418c.712-.712 1.593-1.406 2.426-1.822l.12-.06l.656-.132l4.268 4.268l6.363-6.363l2.83 2.828a8 8 0 1 1-11.314 11.313l-7.072-7.07l.083-.585l.029-.085c.253-.761.924-1.605 1.611-2.292"></path></g></svg>',1)),e("h3",El,N(s(S)),1)]),e("div",Ul,[e("div",zl,[l(U,{text:"Refresh",color:"warning",icon:s(xs),click:()=>{Lt()},loading:s(m)},null,8,["icon","click","loading"]),e("div",Nl,[l(K,{items:s(k),modelValue:s(T),"onUpdate:modelValue":d[0]||(d[0]=F=>se(T)?T.value=F:null)},null,8,["items","modelValue"])]),e("div",Zl,[l(ee,{wards:s(f).wards,"onUpdate:itemsSelected":At},null,8,["wards"])]),e("div",Gl,[e("div",Yl,[l(s(Cs),{class:"w-5 h-5 mr-2"}),d[4]||(d[4]=le(" Date Range ")),e("div",Kl,[l(ze,{required:"",position:"left",onCleared:Ft,placeholder:"select start & end date",range:!0,format:"dd/MM/yyyy","input-class-name":"datepicker",modelValue:s(w),"onUpdate:modelValue":d[1]||(d[1]=F=>se(w)?w.value=F:null)},null,8,["modelValue"])])])])]),l(Ne,{onUpdate:Dt,search:s(b),"onUpdate:search":d[2]||(d[2]=F=>se(b)?b.value=F:null)},null,8,["search"])]),e("div",Wl,[(L(!0),B(me,null,Ve(s(y),(F,te)=>(L(),ae(ge,{value:F,close:"",color:"green",key:te,onUpdate:jt},null,8,["value"]))),128))]),l(qe,{headers:s(M),data:s(z),loading:s(m),searchField:s(R),searchValue:s(g),serverItemsLength:s(n),serverOptions:s(C),onUpdate:be},{actions:$(({item:F})=>[e("div",Xl,[e("div",Ql,[s(a)!==F.id?(L(),B("div",Jl,[l(Re,{ref_key:"testsDialog",ref:x,onUpdate:be,onOrder:He},{default:$(()=>[l(U,{color:"primary",text:"View",icon:s(gt),click:()=>{mt(F)}},null,8,["icon","click"])]),_:2},1536),F.status.toLowerCase()=="verified"&&F.test_type_name.toLowerCase()=="cross-match"&&F.post_crossmatch_process===null?(L(),ae(Ze,{key:0,item:F,onUpdate:be},null,8,["item"])):J("",!0),F.status.toLowerCase()=="verified"&&F.test_type_name.toLowerCase()=="cross-match"&&F.post_crossmatch_process!==null&&F.post_crossmatch_process.transfusion_outcome===null?(L(),ae(Q,{key:1,item:F,onUpdate:be},null,8,["item"])):J("",!0),F.status.toLowerCase()==="completed"&&("usePermissions"in i?i.usePermissions:s(Me))().can.edit("test_results")?(L(),ae(U,{key:2,click:()=>{it({status:"completed"},F)},text:"Edit",color:"success",icon:s(Ue)},null,8,["click","icon"])):J("",!0),(L(!0),B(me,null,Ve(s(j),(te,ft)=>Ee((L(),ae(U,{color:te.color,text:te.text,icon:te.icon,click:()=>{it(te,F)},key:ft},null,8,["color","text","icon","click"])),[[at,Ot(F,te)]])),128)),qt(F)?(L(),ae(U,{key:3,color:"success",text:"Accept",icon:s(xt),click:()=>je("accepted",F.order_id)},null,8,["icon","click"])):J("",!0)])):J("",!0),pt(F)?(L(),ae(U,{key:1,click:()=>I(F.id),color:"",text:"",icon:s(p)==!0?s(ks):s($s)},null,8,["click","icon"])):J("",!0)]),pt(F)&&s(a)==F.id?(L(),B("div",en,[(L(!0),B(me,null,Ve(A(F.status),(te,ft)=>(L(),ae(Oe,{key:te.name,item:F,text:te.name,icon:te.icon,action:te.action,onUpdate:be},null,8,["item","text","icon","action"]))),128))])):J("",!0)])]),_:1},8,["headers","data","loading","searchField","searchValue","serverItemsLength","serverOptions"]),d[5]||(d[5]=e("div",{id:"tests-container"},null,-1))])}}});export{An as default};
