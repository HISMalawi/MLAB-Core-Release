import{_ as re}from"./Breadcrumb.vue.8ff2b6d4.js";import{_ as ne}from"./Dropdown.1e8bc329.js";import{l as P,_ as j,o as n,c as l,d as e,F as k,r as E,t as o,k as s,j as $,h as S,B as i,u as le,K as U,G as z,f as ce,b as m,D as R,g as de,p as M,a as H,e as pe}from"./entry.ad4aba20.js";import{_ as ie}from"./Address.vue.542cb173.js";import{d as J}from"./constants.060e48ac.js";import{h as V,d as ue,e as C,f as N}from"./fetch.5019f737.js";import{_ as me}from"./Loader.04cfad00.js";import{u as _e}from"./vue.f36acd1f.bf45fb5c.js";import{_ as fe}from"./report.f1156e35.js";import{_ as he}from"./logo.c764db13.js";import{_ as be}from"./page.e5e4c551.js";import{k as ye}from"./vue-doc-download.5a050509.js";import{u as ve}from"./facility.3aab2e3f.js";import{P as xe}from"./package.00b14c4a.js";import{r as $e}from"./FunnelIcon.9908961f.js";import{r as ge}from"./ArrowPathIcon.4f8264cd.js";import{r as Te}from"./DocumentTextIcon.f0c7314a.js";import"./nuxt-link.5507b38f.js";import"./HomeIcon.d2a4a580.js";import"./listbox.6bf033a9.js";import"./hidden.d4abb7ca.js";import"./use-text-value.36050435.js";import"./CheckIcon.d58d2707.js";import"./CheckCircleIcon.9f3da900.js";import"./MagnifyingGlassIcon.3c05ce5b.js";import"./transition.bf38d962.js";import"./XMarkIcon.81c841af.js";import"./PencilSquareIcon.d20f2125.js";import"./PrinterIcon.a64525c6.js";const ke=P({props:{data:{required:!0,type:Object}},data(){return{moment:V,headers:[{name:"Patient ID"},{name:"Visit No"},{name:"Patient Name"},{name:"Accession Number"},{name:"Specimen"},{name:"Receipt Date"},{name:"Tests"},{name:"Performed By"},{name:"Results"},{name:"Remarks"},{name:"Results Entry Date"},{name:"Authorized By"}],reportData:this.data}}}),Ee={class:"w-full overflow-x-auto"},De={class:"w-full text-left overflow-y-auto"},we={class:"uppercase bg-gray-100"},Re={class:"border-b"},Se={class:"px-2 py-2 font-normal border-r"},Ae={class:"px-2 py-2 font-normal border-r"},Ce={class:"px-2 py-2 font-normal border-r"},Ne={class:"px-2 py-2 font-normal border-r"},Ve={class:"px-2 py-2 font-normal border-r"},Pe={class:"px-2 py-2 font-normal border-r"},Le={class:"px-2 py-2 font-normal border-r"},Me={class:"px-2 py-2 font-normal border-r"},je={class:"px-2 py-2 font-normal border-r"},Be={key:0,class:"font-medium"},Ie={class:"px-2 py-2 font-normal border-r"},Oe={class:"px-2 py-2 font-normal border-r"},qe={class:"px-2 py-2 font-normal"};function Fe(a,D,b,g,_,w){return n(),l("div",Ee,[e("table",De,[e("thead",we,[e("tr",Re,[(n(!0),l(k,null,E(a.headers,(t,h)=>(n(),l("th",{class:"uppercase py-2 px-2 border-r",key:h},o(t.name),1))),128))])]),e("tbody",null,[(n(!0),l(k,null,E(a.data.data,(t,h)=>(n(),l("tr",{class:"bg-white border-b",key:h},[e("th",Se,o(t.patient_id),1),e("th",Ae,o(t.visit_no),1),e("th",Ce,o(t.patient_name),1),e("th",Ne,o(t.accession_number),1),e("th",Ve,o(t.specimen),1),e("th",Pe,o(a.moment(t.receipt_date).format("dateFormat"in a?a.dateFormat:s(J))),1),e("th",Le,o(t.test),1),e("th",Me,o(t.performed_by),1),e("th",je,[(n(!0),l(k,null,E(t.results,(p,u)=>(n(),l("p",{key:u},[p!=null&&p!==""?(n(),l("span",Be,o(`${u}:`),1)):$("",!0),S(" "+o(p),1)]))),128))]),e("th",Ie,o(t.remarks),1),e("th",Oe,o(a.moment(t.result_date).format("dateFormat"in a?a.dateFormat:s(J))),1),e("th",qe,o(t.authorized_by),1)]))),128))])])])}const Ye=j(ke,[["render",Fe]]),Ge=P({props:{data:{required:!0,type:Object}},data(){var a;return{details:(a=this.data)==null?void 0:a.data}},methods:{removeDuplicates(a){return a.filter((b,g)=>a.findIndex(_=>_.patient_no===b.patient_no)===g)}}}),Ue=e("div",{class:"px-3 py-3 uppercase"}," SUMMARY ",-1),ze={class:"w-full text-left"},He=e("thead",{class:"uppercase bg-gray-100"},[e("tr",{class:"border-b"},[e("th",{class:"uppercase py-2 px-2 border-r"}," TOTAL VISITS "),e("th",{class:"uppercase py-2 px-2 border-r"}," MALE "),e("th",{class:"uppercase py-2 px-2 border-r"}," FEMALE ")])],-1),Je={class:"px-2 py-2 font-normal border-r border-b"},Ke={class:"px-2 py-2 font-normal border-r border-b"},Xe={class:"px-2 py-2 font-normal border-r border-b"},Qe={class:"w-full text-left mt-10"},We=e("thead",{class:"uppercase bg-gray-100"},[e("tr",{class:"border-b"},[e("th",{class:"uppercase py-2 px-2 border-r"}," PATIENT NO "),e("th",{class:"uppercase py-2 px-2 border-r"}," PATIENT NAME "),e("th",{class:"uppercase py-2 px-2 border-r"}," AGE "),e("th",{class:"uppercase py-2 px-2 border-r"}," SEX "),e("th",{class:"uppercase py-2 px-2 border-r"}," ACCESSION NUMBER "),e("th",{class:"uppercase py-2 px-2 border-r"}," SPECIMEN TYPE "),e("th",{class:"uppercase py-2 px-2 border-r"}," TESTS ")])],-1),Ze={class:"px-2 py-2 font-normal border-r border-b"},et={class:"px-2 py-2 font-normal border-r border-b"},tt={class:"px-2 py-2 font-normal border-r border-b"},st={class:"px-2 py-2 font-normal border-r border-b"},ot={class:"px-2 py-2 font-normal border-r border-b"},at={class:"px-2 py-2 font-normal border-r border-b"},rt={class:"px-2 py-2 font-normal border-r border-b space-y-1"};function nt(a,D,b,g,_,w){return n(),l("div",null,[Ue,e("table",ze,[He,e("tbody",null,[e("tr",null,[e("th",Je,o(a.data.visits),1),e("th",Ke,o(a.removeDuplicates(a.details).filter(t=>t.gender=="M").length),1),e("th",Xe,o(a.removeDuplicates(a.details).filter(t=>t.gender=="F").length),1)])])]),e("div",null,[e("table",Qe,[We,e("tbody",null,[(n(!0),l(k,null,E(a.details,(t,h)=>(n(),l("tr",{key:h},[e("th",Ze,o(t.patient_no),1),e("th",et,o(t.patient_name),1),e("th",tt,o(("calculateAge"in a?a.calculateAge:s(ue))(t.dob)),1),e("th",st,o(t.gender),1),e("th",ot,o(t.accession_number),1),e("th",at,o(t.specimen),1),e("th",rt,[(n(!0),l(k,null,E(t.test_type,(p,u)=>(n(),l("p",{key:u},o(p),1))),128))])]))),128))])])])])}const lt=j(Ge,[["render",nt]]),ct=P({props:{data:{required:!0,type:Object}},data(){var a;return{details:(a=this.data)==null?void 0:a.data}}}),dt={class:"w-full text-left"},pt=e("thead",{class:"uppercase bg-gray-100"},[e("tr",{class:"border-b"},[e("th",{class:"uppercase py-2 px-2 border-r"}," ACCESSION NUMBER "),e("th",{class:"uppercase py-2 px-2 border-r"}," SPECIMEN "),e("th",{class:"uppercase py-2 px-2 border-r"}," RECEIPT DATE "),e("th",{class:"uppercase py-2 px-2 border-r"}," TESTS "),e("th",{class:"uppercase py-2 px-2 border-r"}," LAB selection "),e("th",{class:"uppercase py-2 px-2 border-r"}," REJECTION REASON "),e("th",{class:"uppercase py-2 px-2 border-r"}," PERSON TALKED TO "),e("th",{class:"uppercase py-2 px-2 border-r"}," DATE REJECTED ")])],-1),it={class:"px-2 py-2 font-normal border-r border-b"},ut={class:"px-2 py-2 font-normal border-r border-b"},mt={class:"px-2 py-2 font-normal border-r border-b"},_t={class:"px-2 py-2 font-normal border-r border-b"},ft={class:"px-2 py-2 font-normal border-r border-b"},ht={class:"px-2 py-2 font-normal border-r border-b"},bt={class:"px-2 py-2 font-normal border-r border-b"},yt={class:"px-2 py-2 font-normal border-r border-b"};function vt(a,D,b,g,_,w){return n(),l("div",null,[e("table",dt,[pt,e("tbody",null,[(n(!0),l(k,null,E(a.details,(t,h)=>(n(),l("tr",{key:h},[e("th",it,o(t.accession_number),1),e("th",ut,o(t.specimen),1),e("th",mt,o(t.receipt_date),1),e("th",_t,o(t.test),1),e("th",ft,o(t.department),1),e("th",ht,o(t.rejection_reason),1),e("th",bt,o(t.person_talked_to),1),e("th",yt,o(t.test_status_date),1)]))),128))])])])}const xt=j(ct,[["render",vt]]),$t={class:"px-5 py-5"},gt=e("div",{class:"flex items-center py-5"},[e("img",{src:fe,alt:"report-icon",class:"w-8 h-8 mr-2"}),e("h3",{class:"text-2xl font-semibold uppercase"}," Daily Log Report ")],-1),Tt={class:"flex items-center"},kt={class:"bg-white flex space-x-5 py-5 flex-wrap"},Et={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},Dt={class:"w-72 ml-2"},wt={class:"flex flex-col"},Rt={class:"flex flex-col"},St={class:"flex flex-col"},At={class:"flex flex-col"},Ct={class:"border rounded"},Nt={class:"flex items-center justify-between px-5 py-5 border-b"},Vt=e("div",{class:"flex flex-col space-y-2"},[e("img",{src:he,alt:"app-logo",class:"w-24 h-24 object-cover"}),e("h3",{class:"text-xl font-semibold"}," DAILY LOG REPORT ")],-1),Pt={class:"px-5 py-5"},Lt={key:0,class:"text-lg font-semibold"},Mt={class:"text-md font-normal"},jt={class:"text-lg font-semibold"},Bt={class:"text-md font-normal"},It={key:0,class:"w-full border-t"},Ot={key:1,class:"w-full flex flex-col items-center justify-center space-y-2 py-10"},qt=e("img",{src:be,alt:"page-icon",class:"object-cover w-20 h-20"},null,-1),Ft=e("p",null,"Data not found, please generate report",-1),Yt=[qt,Ft],Gt={key:2,class:"mx-auto justify-center flex flex-col items-center space-y-3 py-10"},Ut=e("p",{class:"text-base"},[S("Generating report, please wait"),e("span",{class:"animate-ping"},"...")],-1),$s=P({__name:"daily-log",setup(a){_e({title:`${xe.name} - Daily Log Reports`}),ve();const D=i([{name:"Home",link:"/home"},{name:"Reports",link:"#"}]),b=le("token"),g=i([]),_=i({name:"select department"}),w=i([]),t=i({name:"select test type"}),h=i([]),p=i({name:"select test status"}),u=i([]),v=i({}),B=i(0),K=i([{name:"Test record",value:"test_record"},{name:"Patient record",value:"patient_record"}]),f=i({name:"select report type",value:"select report type"}),x=i(!1),I=U(()=>u.value[0]?V(u.value[0]).format("YYYY-MM-DD"):""),O=U(()=>u.value[1]?V(u.value[1]).format("YYYY-MM-DD"):"");async function X(){const c={route:C.departments,method:"GET",token:`${b.value}`},{data:r,error:d}=await N(c);r.value&&(g.value=r.value),d.value&&console.error(d.value)}async function q(){const c={route:`${C.testTypes}/by_department?department_id=${_.value.id}`,method:"GET",token:`${b.value}`},{data:r,error:d}=await N(c);r.value&&(w.value=r.value),d.value&&console.error(d.value)}function L(c){let r="";return c=="select department"||c==="select test type"||c==="select test status"?r="":r=c,r}async function Q(){const c={route:`${C.testStatus}/all`,method:"GET",token:`${b.value}`},{data:r,error:d}=await N(c);r.value&&(h.value=r.value),d.value&&console.error(d.value)}async function W(){var c;if(x.value=!0,f.value.value!="select report type"){let r=`from=${I.value}&to=${O.value}&department=${L(_.value.name)}&report_type=${f.value.value}&test_status=${L(p.value.name)}&test_type=${L(t.value.name)}`;const{data:d,error:A,pending:T}=await N({route:`${C.dailyReports}/daily_log?${r}`,method:"GET",token:`${b.value}`});x.value=T,d.value&&(x.value=!1,((c=d.value)==null?void 0:c.data.length)==0&&H().$toast.warning("No data found for specified parameters"),v.value=d.value,f.value.value=="test_record"&&Z(d.value)),A.value&&(x.value=!1,console.error(A.value))}else H().$toast.warning("Please select the report type before generating the report"),x.value=!1}function Z(c){c.data.map(r=>{(r.test_status.toLowerCase()==="completed"||r.test_status.toLowerCase()==="verified")&&(B.value+=1)})}return z(()=>_.value,()=>{q()}),z(()=>f.value,()=>{v.value=[]}),X(),q(),Q(),(c,r)=>{var Y,G;const d=re,A=ce("datepicker"),T=ne,F=pe,ee=ie,te=Ye,se=lt,oe=xt,ae=me;return n(),l("div",$t,[m(d,{pages:s(D)},null,8,["pages"]),gt,e("div",Tt,[e("div",kt,[e("div",Et,[m(s($e),{class:"w-5 h-5 mr-2"}),S(" Filter By Date Range "),e("div",Dt,[m(A,{required:"",position:"left",placeholder:"select start & end date",range:!0,"input-class-name":"datepicker",modelValue:s(u),"onUpdate:modelValue":r[0]||(r[0]=y=>R(u)?u.value=y:null)},null,8,["modelValue"])])]),e("div",wt,[m(T,{items:s(g),modelValue:s(_),"onUpdate:modelValue":r[1]||(r[1]=y=>R(_)?_.value=y:null)},null,8,["items","modelValue"])]),e("div",Rt,[m(T,{items:s(w),modelValue:s(t),"onUpdate:modelValue":r[2]||(r[2]=y=>R(t)?t.value=y:null)},null,8,["items","modelValue"])]),e("div",St,[m(T,{items:s(h),modelValue:s(p),"onUpdate:modelValue":r[3]||(r[3]=y=>R(p)?p.value=y:null)},null,8,["items","modelValue"])]),e("div",At,[m(T,{items:s(K),modelValue:s(f),"onUpdate:modelValue":r[4]||(r[4]=y=>R(f)?f.value=y:null)},null,8,["items","modelValue"])]),m(F,{color:"primary",text:"Generate Report",icon:s(ge),loading:s(x),click:()=>W()},null,8,["icon","loading","click"]),m(s(ye),{element:"export-container",filename:`daily_${s(f).value}_${s(V)(new Date).format("yyy_MM_DD")}`},{default:de(()=>[m(F,{icon:s(Te),click:()=>{},text:"Export to Excel",color:"success"},null,8,["icon"])]),_:1},8,["filename"])])]),e("div",Ct,[e("div",Nt,[Vt,m(ee)]),e("div",Pt,[s(f).value=="test_record"&&s(p).name!=="test-rejected"?(n(),l("h3",Lt,[S("Test Record: "),e("span",Mt,o(s(B))+" Complete tests",1)])):$("",!0),e("h3",jt,[S("Tests Performed Period: "),e("span",Bt,o(s(I))+" - "+o(s(O)),1)])]),((G=(Y=s(v))==null?void 0:Y.data)==null?void 0:G.length)>0?(n(),l("div",It,[s(f).value=="test_record"&&s(p).name!=="test-rejected"?(n(),M(te,{key:0,data:s(v)},null,8,["data"])):$("",!0),s(f).value=="patient_record"?(n(),M(se,{key:1,data:s(v)},null,8,["data"])):$("",!0),s(p).name=="test-rejected"?(n(),M(oe,{key:2,data:s(v)},null,8,["data"])):$("",!0)])):$("",!0),s(v).length==0&&!s(x)?(n(),l("div",Ot,Yt)):$("",!0),s(x)&&s(v).length==0?(n(),l("div",Gt,[m(ae),Ut])):$("",!0)])])}}});export{$s as default};
