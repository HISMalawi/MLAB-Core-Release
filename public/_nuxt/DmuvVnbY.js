import{_ as ke}from"./ucPVlGIa.js";import{b as k,e as q,g as e,d as pe,r as l,a as se,u as te,y as S,f as s,h as t,z as u,Y as le,p as Y,G as ne,V as ie,k as X,q as re,H as L,i as Z,I as ae,J as $e,S as de,s as ge,l as O,m as G,_ as ce,C as Ce,A as Ve,B as he,x as xe,v as oe,t as R,F as ue,j as me,n as ye,D as Ue,K as H,c as De,w as fe,o as Se,L as W}from"./CnHVHtNb.js";import{_ as be}from"./dNe-8R2B.js";import{_ as ve}from"./B_Awot1K.js";import{r as we}from"./DXtvsuug.js";import{_ as Ae}from"./BvHVvoZk.js";import{r as Ie}from"./DGfQsrMy.js";import{r as Pe}from"./BB8zdY6n.js";import{_ as Te}from"./D79OLBMa.js";import{u as Le}from"./Bnl9n6mh.js";import{u as ee}from"./ijQJjDmU.js";import{P as qe}from"./O-3ebvIT.js";import"./BZb3bzVo.js";import"./n6mkMIpm.js";import"./CRaEjCo-.js";import"./DCavMtdm.js";function Fe(V,d){return k(),q("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z","clip-rule":"evenodd"})])}const _e="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6%2036C6%2031.0347%2017.9925%2028%2024%2028C30.0075%2028%2042%2031.0347%2042%2036V42H6V36Z'%20fill='%23333333'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M24%2024C28.4183%2024%2032%2020.4183%2032%2016C32%2011.5817%2028.4183%208%2024%208C19.5817%208%2016%2011.5817%2016%2016C16%2020.4183%2019.5817%2024%2024%2024ZM24%2026C29.5228%2026%2034%2021.5228%2034%2016C34%2010.4772%2029.5228%206%2024%206C18.4772%206%2014%2010.4772%2014%2016C14%2021.5228%2018.4772%2026%2024%2026Z'%20fill='%23333333'/%3e%3c/svg%3e",Me=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Ee={class:"fixed inset-0 overflow-y-auto"},je={class:"flex min-h-full items-center justify-center p-4 text-center"},Be={class:"border-b px-3 py-3 flex items-center justify-between"},Re=e("img",{src:_e,alt:"user-icon",class:"w-8 h-8 mr-2"},null,-1),Ne={class:"mt-2 space-y-3 px-5"},ze={class:"grid grid-cols-2 gap-4"},Ze={class:"grid grid-cols-2 gap-4"},Oe={class:"grid grid-cols-2 gap-4"},Ge={class:"w-full flex items-center"},Ke=e("label",{class:"mr-5 font-medium text-lg"},"Sex",-1),He={class:"flex items-center"},Xe=e("span",{class:"ml-2"},"Male",-1),Ye={class:"flex items-center ml-2"},Je=e("span",{class:"ml-2"},"Female",-1),Qe={class:"mt-10 justify-end flex items-center space-x-3 px-3 py-2 border-t"},We=pe({__name:"index",setup(V){const d=l(!1),p=ge,$=we,n=l([]),x=l([]),v=l([]),U=se("token"),F=l([]),P=l([]),A=l([]),g=l([]),B=l([]),y=l([]),_=l(""),o=l(""),b=l(""),C=l(""),I=l(""),E=l(""),M=l(!1),{$metadata:c}=te(),N=async()=>{M.value=!0;const w=n.value?n.value.map(h=>{var T;return(T=v.value.find(Q=>h===Q.name))==null?void 0:T.id}).filter(h=>h!==void 0):[],a=A.value?A.value.map(h=>{var T;return(T=P.value.find(Q=>h===Q.name))==null?void 0:T.id}).filter(h=>h!==void 0):[],j=y.value?y.value.map(h=>{var T;return(T=g.value.find(Q=>h===Q.name))==null?void 0:T.id}).filter(h=>h!==void 0).map(Number):[],D={route:O.users,method:"POST",token:`${U.value}`,body:{person:{first_name:_.value,middle_name:o.value,last_name:b.value,sex:I.value},user:{username:C.value,password:E.value},roles:a,departments:w,lab_locations:j}},{data:m,error:f,pending:r}=await G(D);M.value=r;const{$toast:i}=te();m.value&&(K(),i.success("User created successfully!"),M.value=!1),f.value&&(K(),i.error(f.value),M.value=!1,console.error(f.value))},J=()=>{P.value=c.roles,F.value=P.value.map(w=>w.name),g.value=c.locations,B.value=g.value.map(w=>w.name),v.value=c.departments,x.value=v.value.map(w=>w.name)},z=async()=>{J(),K()},K=()=>{d.value=!d.value};return(w,a)=>{const j=ce,D=S("FormKit"),m=be,f=ve;return k(),q("div",null,[e("div",null,[s(j,{text:"Add user",color:"primary",icon:t(p),click:()=>{z()}},null,8,["icon","click"])]),s(t(de),{appear:"",show:t(d),as:"template"},{default:u(()=>[s(t(le),{as:"div",onClose:K,class:"relative z-10"},{default:u(()=>[s(t(Y),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>[Me]),_:1}),e("div",Ee,[e("div",je,[s(t(Y),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[s(t(ne),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[e("div",Be,[s(t(ie),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:u(()=>[Re,X(" Add user ")]),_:1}),e("button",{onClick:K},[s(t(re),{class:"w-5 h-5"})])]),s(D,{type:"form",id:"submitForm","submit-label":"Update",onSubmit:N,actions:!1},{default:u(()=>[e("div",Ne,[e("div",ze,[s(D,{type:"text",label:"Username",validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"Username must contain only letters, no spaces or special characters"},modelValue:t(C),"onUpdate:modelValue":a[0]||(a[0]=r=>L(C)?C.value=r:null)},null,8,["modelValue"]),s(D,{type:"text",label:"First name",modelValue:t(_),"onUpdate:modelValue":a[1]||(a[1]=r=>L(_)?_.value=r:null),validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"First name must contain only letters, no spaces or special characters"}},null,8,["modelValue"])]),e("div",Ze,[s(D,{type:"text",label:"Middle name",modelValue:t(o),"onUpdate:modelValue":a[2]||(a[2]=r=>L(o)?o.value=r:null)},null,8,["modelValue"]),s(D,{type:"text",label:"Last name",modelValue:t(b),"onUpdate:modelValue":a[3]||(a[3]=r=>L(b)?b.value=r:null),validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"Last name must contain only letters, no spaces or special characters"}},null,8,["modelValue"])]),s(D,{type:"group"},{default:u(()=>[e("div",Oe,[s(D,{type:"password",label:"Password",name:"password",validation:"required",modelValue:t(E),"onUpdate:modelValue":a[4]||(a[4]=r=>L(E)?E.value=r:null),"validation-visibility":"live"},null,8,["modelValue"]),s(D,{type:"password",label:"Confirm password",name:"password_confirm",validation:"required|confirm","validation-label":"Password confirmation","validation-visibility":"live"})])]),_:1}),e("div",Ge,[Ke,e("label",He,[Z(e("input",{required:"","onUpdate:modelValue":a[5]||(a[5]=r=>L(I)?I.value=r:null),type:"radio",value:"M",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[ae,t(I)]]),Xe]),e("label",Ye,[Z(e("input",{required:"","onUpdate:modelValue":a[6]||(a[6]=r=>L(I)?I.value=r:null),type:"radio",value:"F",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[ae,t(I)]]),Je])]),s(m,{label:"Select Role(s)","items-selected":t(A),"onUpdate:itemsSelected":a[7]||(a[7]=r=>L(A)?A.value=r:null),items:t(F),mode:"tags"},null,8,["items-selected","items"]),s(m,{label:"Select Laboratory Location(s)","items-selected":t(y),"onUpdate:itemsSelected":a[8]||(a[8]=r=>L(y)?y.value=r:null),items:t(B),mode:"tags"},null,8,["items-selected","items"]),s(m,{label:"Select Lab Section(s)","items-selected":t(n),"onUpdate:itemsSelected":a[9]||(a[9]=r=>L(n)?n.value=r:null),items:t(x),mode:"tags"},null,8,["items-selected","items"])]),e("div",Qe,[s(f,{type:"button",click:()=>{t($e)("submitForm")},text:"Clear form"},null,8,["click"]),s(j,{loading:t(M),type:"submit",click:()=>{},color:"success",icon:t($),text:"Save Changes"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),et={components:{TransitionRoot:de,TransitionChild:Y,Dialog:le,DialogPanel:ne,DialogTitle:ie,XMarkIcon:re,UserIcon:Ie},props:{data:{required:!0,type:Object}},data(){return{moment:Ce,open:!1,addIcon:ge,viewIcon:Ve,editIcon:he,clearIcon:Pe,details:{id:"",username:"",first_name:"",last_name:"",middle_name:"",sex:"",date_of_birth:"",lab_locations:new Array,roles:new Array,departments:new Array},loading:!1,cookie:se("token")}},methods:{async init(){this.loading=!0;const V={route:`${O.users}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:d,error:p,pending:$}=await G(V);this.loading=$,d.value&&(this.details=d.value,this.loading=!1,this.handleDialog()),p.value&&(console.error(p.value),this.loading=!1)},handleDialog(){this.open=!this.open}}},tt=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),st={class:"fixed inset-0 overflow-y-auto"},at={class:"flex min-h-full items-center justify-center p-4 text-center"},ot={class:"border-b px-3 py-3 flex items-center justify-between"},lt=e("img",{src:_e,class:"w-6 h-6 mr-2"},null,-1),nt={class:"flex items-center justify-center mx-auto my-20"},it={class:"space-y-3 px-5 py-5"},rt={class:"w-full flex flex-col space-y-1"},dt=e("label",{class:"font-semibold text-lg"},"Username",-1),ct={class:"text-base text-gray-600"},ut={class:"w-full flex flex-col space-y-1"},mt=e("label",{class:"font-semibold text-lg"},"First name",-1),pt={class:"text-base text-gray-600"},vt={class:"w-full flex flex-col space-y-1"},_t=e("label",{class:"font-semibold text-lg"},"Last name",-1),ft={class:"text-base text-gray-600"},gt={class:"w-full flex flex-col space-y-1"},ht=e("label",{class:"font-semibold text-lg"},"Roles",-1),xt={class:"w-full flex flex-col space-y-1"},yt=e("label",{class:"font-semibold text-lg"},"Locations",-1),bt={class:"w-full flex flex-col space-y-1"},wt=e("label",{class:"font-semibold text-lg"},"Departments",-1);function kt(V,d,p,$,n,x){const v=ce,U=S("TransitionChild"),F=S("DialogTitle"),P=S("XMarkIcon"),A=ye,g=S("DialogPanel"),B=S("Dialog"),y=S("TransitionRoot");return k(),q("div",null,[e("div",null,[s(v,{text:"View",color:"primary",icon:n.viewIcon,click:x.init},null,8,["icon","click"])]),s(y,{appear:"",show:n.open,as:"template"},{default:u(()=>[s(B,{as:"div",onClose:x.handleDialog,class:"relative z-10"},{default:u(()=>[s(U,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>[tt]),_:1}),e("div",st,[e("div",at,[s(U,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[s(g,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[e("div",ot,[s(F,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:u(()=>[lt,X(" View User Account ")]),_:1}),e("button",{onClick:d[0]||(d[0]=(..._)=>x.handleDialog&&x.handleDialog(..._))},[s(P,{class:"w-5 h-5"})])]),Z(e("div",nt,[s(A,{loading:n.loading},null,8,["loading"])],512),[[oe,n.loading]]),Z(e("div",it,[e("div",rt,[dt,e("p",ct,R(n.details.username),1)]),e("div",ut,[mt,e("p",pt,R(n.details.first_name),1)]),e("div",vt,[_t,e("p",ft,R(n.details.last_name),1)]),e("div",gt,[ht,(k(!0),q(ue,null,me(n.details.roles,(_,o)=>(k(),q("p",{class:"text-base text-gray-600",key:o},R(_.role_name),1))),128))]),e("div",xt,[yt,(k(!0),q(ue,null,me(n.details.lab_locations,(_,o)=>(k(),q("p",{class:"text-base text-gray-600",key:o},R(_.name),1))),128))]),e("div",bt,[wt,(k(!0),q(ue,null,me(n.details.departments,(_,o)=>(k(),q("p",{class:"text-base text-gray-600",key:o},R(_.name),1))),128))])],512),[[oe,!n.loading]])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const $t=xe(et,[["render",kt]]),Ct=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Vt={class:"mx-auto flex justify-center py-20 bg-white"},Ut={class:"fixed inset-0 overflow-y-auto"},Dt={class:"flex min-h-full items-center justify-center p-4 text-center"},St={class:"border-b px-3 py-3 flex items-center justify-between"},At=e("img",{src:_e,class:"w-8 h-8 mr-2",alt:"person-icon"},null,-1),It={class:"mt-2 space-y-3 px-5 py-5"},Pt={class:"grid grid-cols-2 gap-4"},Tt={class:"grid grid-cols-2 gap-4"},Lt={class:"grid grid-cols-2 gap-4"},qt={class:"w-full flex flex-col space-y-2"},Ft={class:"w-full flex flex-col space-y-2"},Mt={class:"flex items-center"},Et=e("label",{class:"mr-5 font-medium text-lg"},"Sex",-1),jt={class:"flex items-center"},Bt=e("span",{class:"ml-2"},"Male",-1),Rt={class:"flex items-center ml-2"},Nt=e("span",{class:"ml-2"},"Female",-1),zt={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},Zt=pe({__name:"index",props:{data:{}},emits:["update"],setup(V,{emit:d}){const p=V,$=l(!1),n=he,x=we,v=l([]),U=l([]),F=l([]),P=l([]),A=l([]),g=l([]),B=se("token"),y=l([]),_=l([]),o=l([]),b=l(!1),C=l(!1),I=d,{$toast:E,$metadata:M}=te(),c=l({id:"",username:"",first_name:"",last_name:"",middle_name:"",old_password:"",new_password:"",sex:"",date_of_birth:"",roles:[],lab_locations:[],departments:[]}),N=()=>{$.value=!$.value},J=()=>{_.value=M.roles,y.value=_.value.map(w=>w.name),P.value=M.locations,A.value=P.value.map(w=>w.name),F.value=M.departments,U.value=F.value.map(w=>w.name)},z=async()=>{J(),N(),C.value=!0;const w={route:`${O.users}/${p.data.id}`,method:"GET",token:`${B.value}`},{data:a,error:j,pending:D}=await G(w);C.value=D,a.value&&(c.value=a.value,C.value=!1,o.value=a.value.roles.map(({role_name:m})=>{var f;return(f=_.value.find(r=>m===r.name))==null?void 0:f.name}).filter(m=>m!==void 0),v.value=a.value.departments.map(({name:m})=>{var f;return(f=F.value.find(r=>m===r.name))==null?void 0:f.name}).filter(m=>m!==void 0),g.value=a.value.lab_locations.map(({name:m})=>{var f;return(f=P.value.find(r=>m===r.name))==null?void 0:f.name}).filter(m=>m!==void 0)),j.value&&(console.error(j.value),C.value=!1)},K=async()=>{b.value=!0;const w=v.value?v.value.map(i=>{var h;return(h=F.value.find(T=>i===T.name))==null?void 0:h.id}).filter(i=>i!==void 0).map(Number):[],a=o.value?o.value.map(i=>{var h;return(h=_.value.find(T=>i===T.name))==null?void 0:h.id}).filter(i=>i!==void 0):[],j=g.value?g.value.map(i=>{var h;return(h=P.value.find(T=>i===T.name))==null?void 0:h.id}).filter(i=>i!==void 0).map(Number):[],D={route:`${O.users}/${p.data.id}`,method:"PUT",token:`${B.value}`,body:{person:{first_name:c.value.first_name,middle_name:c.value.middle_name,last_name:c.value.last_name,sex:c.value.sex,date_of_birth:c.value.date_of_birth},user:{username:c.value.username,old_password:c.value.old_password,password:c.value.new_password},roles:a,departments:w,lab_locations:j}},{data:m,error:f,pending:r}=await G(D);b.value=r,m.value&&(N(),E.success("User updated successfully!"),b.value=!1,I("update",!0)),f.value&&(console.error(f.value),N(),E.error(errorMessage),b.value=!1)};return(w,a)=>{const j=ce,D=ye,m=S("FormKit"),f=be,r=ve;return k(),q("div",null,[e("div",null,[s(j,{text:"Edit",color:"primary",icon:t(n),click:z},null,8,["icon"])]),s(t(de),{appear:"",show:t($),as:"template"},{default:u(()=>[s(t(le),{as:"div",onClose:N,class:"relative z-10"},{default:u(()=>[s(t(Y),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>[Ct]),_:1}),Z(e("div",Vt,[s(D)],512),[[oe,t(C)]]),Z(e("div",Ut,[e("div",Dt,[s(t(Y),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[s(t(ne),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[e("div",St,[s(t(ie),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:u(()=>[At,X(" Edit user ")]),_:1}),e("button",{onClick:N},[s(t(re),{class:"w-5 h-5"})])]),s(m,{type:"form","submit-label":"Update",onSubmit:K,actions:!1},{default:u(()=>[e("div",It,[e("div",Pt,[s(m,{type:"text",label:"Username",modelValue:t(c).username,"onUpdate:modelValue":a[0]||(a[0]=i=>t(c).username=i),validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"Username must contain only letters and spaces"}},null,8,["modelValue"]),s(m,{type:"text",label:"First name",modelValue:t(c).first_name,"onUpdate:modelValue":a[1]||(a[1]=i=>t(c).first_name=i),validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"First name must contain only letters and spaces"}},null,8,["modelValue"])]),e("div",Tt,[s(m,{type:"text",label:"Middle name",modelValue:t(c).middle_name,"onUpdate:modelValue":a[2]||(a[2]=i=>t(c).middle_name=i)},null,8,["modelValue"]),s(m,{type:"text",label:"Last name",modelValue:t(c).last_name,"onUpdate:modelValue":a[3]||(a[3]=i=>t(c).last_name=i),validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"Last name must contain only letters and spaces"}},null,8,["modelValue"])]),s(m,{type:"group"},{default:u(()=>[e("div",Lt,[e("div",qt,[s(m,{type:"password",label:"New password",name:"password",modelValue:t(c).new_password,"onUpdate:modelValue":a[4]||(a[4]=i=>t(c).new_password=i),"validation-visibility":"live"},null,8,["modelValue"])]),e("div",Ft,[s(m,{type:"password",label:"Confirm new password",name:"password_confirm",validation:t(c).new_password&&"required|confirm","validation-label":"Password confirmation","validation-visibility":"live"},null,8,["validation"])])])]),_:1}),e("div",Mt,[Et,e("label",jt,[Z(e("input",{required:"","onUpdate:modelValue":a[5]||(a[5]=i=>t(c).sex=i),type:"radio",value:"M",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[ae,t(c).sex]]),Bt]),e("label",Rt,[Z(e("input",{required:"","onUpdate:modelValue":a[6]||(a[6]=i=>t(c).sex=i),type:"radio",value:"F",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[ae,t(c).sex]]),Nt])]),s(f,{label:"Select Role(s)","items-selected":t(o),"onUpdate:itemsSelected":a[7]||(a[7]=i=>L(o)?o.value=i:null),items:t(y),mode:"tags"},null,8,["items-selected","items"]),s(f,{label:"Select Laboratory Location(s)","items-selected":t(g),"onUpdate:itemsSelected":a[8]||(a[8]=i=>L(g)?g.value=i:null),items:t(A),mode:"tags"},null,8,["items-selected","items"]),s(f,{label:"Select Lab Section(s)","items-selected":t(v),"onUpdate:itemsSelected":a[9]||(a[9]=i=>L(v)?v.value=i:null),items:t(U),mode:"tags"},null,8,["items-selected","items"])]),e("div",zt,[s(r,{type:"button",click:()=>{},text:"Clear form"}),s(j,{loading:t(b),type:"submit",click:()=>{},color:"success",icon:t(x),text:"Save Changes"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])],512),[[oe,!t(C)]])]),_:1})]),_:1},8,["show"])])}}}),Ot={components:{TransitionRoot:de,TransitionChild:Y,Dialog:le,DialogPanel:ne,DialogTitle:ie,XMarkIcon:re,ExclamationTriangleIcon:Ue},data(){return{show:!1,disableIcon:Fe,loading:!1,reason:"",cookie:se("token"),details:{id:"",username:"",first_name:"",last_name:"",middle_name:"",sex:"",date_of_birth:"",lab_locations:new Array,roles:new Array,departments:new Array}}},props:{data:{type:Object,required:!0}},methods:{async init(){this.loading=!0;const V={route:`${O.users}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:d,error:p,pending:$}=await G(V);this.loading=$,d.value&&(this.details=d.value,this.loading=!1,this.handleDialog()),p.value&&(console.error(p.value),this.loading=!1)},async deleteData(V){this.loading=!0;const d={route:`${O.users}/${V}`,method:"DELETE",token:`${this.cookie}`},{pending:p,error:$,data:n}=await G(d);this.loading=p,n.value&&(this.handleDialog(),te().$toast.success(`${n.value.message}`),this.loading=!1,this.$emit("update",!0),this.reason=""),$.value&&(console.log(n.value),this.loading=!1)},async activate(V){this.loading=!0;const d={route:`${O.users}/activate/${V}`,method:"PUT",token:`${this.cookie}`,body:{retired_reason:this.reason}},{pending:p,error:$,data:n}=await G(d);this.loading=p,n.value&&(this.handleDialog(),te().$toast.success(`${n.value.message}`),this.loading=!1,this.$emit("update",!0),this.reason=""),$.value&&(console.log(n.value),this.loading=!1)},handleDialog(){this.show=!this.show}}},Gt={key:0},Kt={key:1},Ht=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Xt={class:"fixed inset-0 overflow-y-auto"},Yt={class:"flex min-h-full items-center justify-center p-4 text-center"},Jt={class:"border-b px-3 py-3 flex items-center justify-between"},Qt={class:"mt-2 space-y-3 px-5"},Wt={class:"rounded px-2 py-2"},es={class:"font-semibold text-red-500"},ts={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function ss(V,d,p,$,n,x){const v=ce,U=S("TransitionChild"),F=S("ExclamationTriangleIcon"),P=S("DialogTitle"),A=S("XMarkIcon"),g=S("FormKit"),B=ve,y=S("DialogPanel"),_=S("Dialog"),o=S("TransitionRoot");return k(),q("div",null,[e("div",null,[p.data.is_active?(k(),q("div",Gt,[s(v,{click:x.init,color:"error",text:"Disable",icon:n.disableIcon},null,8,["click","icon"])])):H("",!0),p.data.is_active?H("",!0):(k(),q("div",Kt,[s(v,{click:x.init,color:"success",text:"Enable",icon:n.disableIcon},null,8,["click","icon"])]))]),s(o,{appear:"",show:n.show,as:"template"},{default:u(()=>[s(_,{as:"div",class:"relative z-10"},{default:u(()=>[s(U,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>[Ht]),_:1}),e("div",Xt,[e("div",Yt,[s(U,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[s(y,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[e("div",Jt,[s(P,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:u(()=>[s(F,{class:"h-5 w-5 mr-2"}),X(" "+R(p.data.is_active?"Confirm disable":"Confirm activate"),1)]),_:1}),e("button",{onClick:d[0]||(d[0]=(...b)=>x.handleDialog&&x.handleDialog(...b))},[s(A,{class:"w-5 h-5"})])]),s(g,{type:"form","submit-label":"Update",onSubmit:d[2]||(d[2]=b=>p.data.is_active?x.deleteData(p.data.id):x.activate(p.data.id)),actions:!1},{default:u(({value:b})=>[e("div",Qt,[e("div",Wt,[X(" Do you want to "+R(p.data.is_active?"disable":"activate")+" ",1),e("span",es,R(p.data.username),1),X(" account? Note that once this action is completed, it can not be undone ")]),s(g,{type:"textarea",label:"Reason",validation:"required",modelValue:n.reason,"onUpdate:modelValue":d[1]||(d[1]=C=>n.reason=C)},null,8,["modelValue"])]),e("div",ts,[s(B,{click:x.handleDialog,type:"button",text:"Cancel"},null,8,["click"]),s(v,{loading:n.loading,type:"submit",click:()=>{},color:"success",icon:n.disableIcon,text:"Continue"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const as=xe(Ot,[["render",ss]]),os=()=>{const V=l([{text:"id",value:"id",sortable:!0},{text:"username",value:"username",sortable:!0},{text:"full name",value:"fullname",sortable:!0},{text:"sex",value:"sex",sortable:!0},{text:"actions",value:"actions"}]),d=l([{name:"Home",link:"/home"},{name:"Access Controls",link:"#"}]);return{HEADERS:V,PAGES:d}},ls={class:"py-5 px-5"},ns={class:"flex items-center justify-between py-5"},is={class:"text-2xl font-semibold"},rs={class:"flex justify-end w-full px-2 py-2 mb-2"},ds={class:"py-2 flex items-center space-x-2"},Vs=pe({__name:"user-accounts",setup(V){Le({title:`${qe.name.toUpperCase()} - User Accounts`});const d=l("List of users"),p=os(),$=p.HEADERS.value,n=l([]),x=se("token"),v=l(!1),U=l(""),F=l(""),P=p.PAGES.value,A=l(0),g=l({page:1,rowsPerPage:25,sortBy:"name"}),B=De(()=>n.value.map(o=>({id:o.id,is_active:o.is_active,username:o.username.charAt(0).toUpperCase()+o.username.slice(1),fullname:`${o.first_name} ${o.last_name}`,sex:o.sex})));async function y(){v.value=!0;const{page:o,rowsPerPage:b}=g.value,C={route:`${O.users}?page=${o}&per_page=${b}&search=${U.value}`,method:"GET",token:`${x.value}`},{data:I,error:E,pending:M}=await G(C);v.value=M,I.value&&(n.value=I.value.data,v.value=!1,A.value=I.value.meta.total_count),E.value&&(console.error(E.value),v.value=!1)}const _=o=>{typeof o=="object"&&(g.value=o)};return fe(U,()=>{y()}),fe(g,()=>{y()}),Se(()=>{y()}),(o,b)=>{const C=ke,I=We,E=Ae,M=$t,c=Zt,N=as,J=Te;return k(),q("div",ls,[s(C,{pages:t(P)},null,8,["pages"]),e("div",ns,[e("h3",is,R(t(d)),1),("usePermissions"in o?o.usePermissions:t(ee))().can.manage("users")?(k(),W(I,{key:0,onUpdate:y})):H("",!0)]),e("div",rs,[s(E,{search:t(U),"onUpdate:search":b[0]||(b[0]=z=>L(U)?U.value=z:null)},null,8,["search"])]),("usePermissions"in o?o.usePermissions:t(ee))().can.manage("users")?(k(),W(J,{key:0,headers:t($),data:t(B),loading:t(v),searchField:"username",searchValue:t(F),serverItemsLength:t(A),serverOptions:t(g),onUpdate:_},{actions:u(({item:z})=>[e("div",ds,[("usePermissions"in o?o.usePermissions:t(ee))().can.manage("users")?(k(),W(M,{key:0,data:z},null,8,["data"])):H("",!0),("usePermissions"in o?o.usePermissions:t(ee))().can.manage("users")?(k(),W(c,{key:1,data:z,onUpdate:y},null,8,["data"])):H("",!0),("usePermissions"in o?o.usePermissions:t(ee))().can.manage("users")?(k(),W(N,{key:2,data:z,onUpdate:y},null,8,["data"])):H("",!0)])]),_:1},8,["headers","data","loading","searchValue","serverItemsLength","serverOptions"])):H("",!0)])}}});export{Vs as default};
