import{u as C,a as p,_ as D,f as s,o as T,c as I,b as o,g as r,d as l,h as S,e as V}from"./entry.615ec979.js";import{h as F,E as R}from"./jspdf.es.min.488096ed.js";import{a as A,f,e as _}from"./fetch.25d6bbff.js";import{r as B}from"./XMarkIcon.4d88407f.js";import{r as g}from"./PrinterIcon.9be93a85.js";import{S as E,h as U,U as j,G as q,V as G}from"./transition.d4665360.js";const N={components:{TransitionRoot:E,TransitionChild:U,Dialog:j,DialogPanel:q,DialogTitle:G,XMarkIcon:B,ExclamationTriangleIcon:A,PrinterIcon:g},data(){return{show:!1,printIcon:g,cookie:C("token"),printers:new Array,selectedPrinter:"",loading:!1,zebraPrinting:!1}},methods:{async init(){this.handleClick();const{data:n,error:e,pending:c}=await f({route:_.printers,method:"GET",token:`${this.cookie}`});n.value&&(this.printers=new Array,n.value.map(i=>{this.printers.push(i.name)})),e.value&&console.error(e.value)},async generatePDF(){this.loading=!0;const n=document.querySelector(".print-container"),e=await F(n,{width:n.offsetWidth,height:n.offsetHeight}),c=e.toDataURL("image/jpeg"),i=new R({orientation:"portrait",unit:"px",format:[e.width,e.height]}),t=i.internal.pageSize.getWidth(),a=e.height*t/e.width;i.addImage(c,"JPEG",0,0,t,a);const d=i.output("blob");await this.submitForm(d)},async submitForm(n){let e=new FormData;e.append("pdf",n,"patient-name"),e.append("printer_name",this.selectedPrinter);const c={route:_.generalPrint,method:"POST",token:`${this.cookie}`,body:e},{data:i,error:t,pending:a}=await f(c);this.loading=a,i.value&&(i.value.printed?p().$toast.success("Report printed successfully!"):p().$toast.warning("Could not print report!"),this.loading=!1,this.$emit("update",!0),this.handleClick()),t.value&&(this.loading=!1,console.error(t.value),p().$toast.error("An error occurred while printing report"),this.handleClick())},handleClick(){this.show=!this.show}}},z=l("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),M={class:"fixed inset-0 overflow-y-auto"},W={class:"flex top-0 items-center justify-center p-4 text-center"},X={class:"border-b px-3 py-3 flex items-center justify-between"},H={class:"py-5 px-5"},K={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function J(n,e,c,i,t,a){const d=V,m=s("TransitionChild"),v=s("PrinterIcon"),w=s("DialogTitle"),x=s("XMarkIcon"),u=s("FormKit"),y=s("DialogPanel"),b=s("Dialog"),k=s("TransitionRoot");return T(),I("div",null,[o(d,{click:a.init,color:"primary",text:"Print",icon:t.printIcon},null,8,["click","icon"]),o(k,{appear:"",show:t.show,as:"template"},{default:r(()=>[o(b,{as:"div",class:"relative z-10"},{default:r(()=>[o(m,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:r(()=>[z]),_:1}),l("div",M,[l("div",W,[o(m,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:r(()=>[o(y,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:r(()=>[l("div",X,[o(w,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:r(()=>[o(v,{class:"h-5 w-5 mr-2"}),S(" Print ")]),_:1}),l("button",{onClick:e[0]||(e[0]=(...h)=>a.handleClick&&a.handleClick(...h))},[o(x,{class:"w-5 h-5"})])]),o(u,{type:"form","submit-label":"Update",onSubmit:a.generatePDF,actions:!1},{default:r(({value:h})=>[l("div",H,[o(u,{validation:"required",label:"Select a printer",type:"radio",modelValue:t.selectedPrinter,"onUpdate:modelValue":e[1]||(e[1]=P=>t.selectedPrinter=P),options:t.printers},null,8,["modelValue","options"])]),l("div",K,[o(d,{click:()=>{},loading:t.loading,type:"submit",icon:t.printIcon,text:"Print",color:"success"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const ee=D(N,[["render",J]]);export{ee as _};
