import{_ as Q}from"./B38OGO74.js";import{S as E,p as I,Y as M,G as O,V as j,q,s as W,a as U,l as D,m as C,u as S,E as B,x as F,y as c,b,e as $,g as e,f as t,z as l,k as T,_ as P,D as H,A as Z,B as Y,C as ee,i as G,v as X,t as V,n as te,d as oe,r as A,h,L as K,K as z}from"./DaVfplCl.js";import{_ as se}from"./Bzs5pQIk.js";import{_ as R}from"./B0t_sj3-.js";import{r as ae}from"./DQxuftN6.js";import{r as J}from"./CkZqa6SV.js";import{r as ne}from"./Ba1YopIZ.js";import{_ as ie}from"./CPUPa6f5.js";import{_ as N}from"./BaJf9vfg.js";import{r as le}from"./CemrLY-G.js";import{_ as re}from"./CzqI9CSL.js";import{u as L}from"./B9Jk58qt.js";import{u as ce}from"./MuIwof8c.js";import{P as de}from"./Dr0mg474.js";import{r as ue}from"./zVsiTWFb.js";import"./CaCwXEk-.js";import"./Bk1fID9q.js";import"./BYI7uPfh.js";import"./B5Ij5f4J.js";const me={components:{TransitionRoot:E,TransitionChild:I,Dialog:M,DialogPanel:O,DialogTitle:j,XMarkIcon:q,UserIcon:ae},data(){return{open:!1,addIcon:W,saveIcon:J,clearIcon:ne,name:"",description:"",drugSelected:null,loading:!1,drugs:new Array,rawDrugs:new Array,cookie:U("token")}},methods:{async init(){this.handleModal();const a={route:D.drugs,method:"GET",token:`${this.cookie}`},{pending:s,error:i,data:r}=await C(a);this.loading=s,r.value&&(this.rawDrugs=r.value,r.value.map(o=>{this.drugs.push(o.name)})),i.value&&console.error(i.value)},async submitForm(){this.loading=!0;const a=this.drugSelected.map(n=>{const d=this.rawDrugs.find(p=>p.name===n);return d?d.id:null}).filter(n=>n!==null),s={route:D.organisms,method:"POST",token:`${this.cookie}`,body:{name:this.name,description:this.description,drugs:a}},{data:i,error:r,pending:o}=await C(s);this.loading=o,i.value&&(this.handleModal(),S().$toast.success(`${this.name} organism created sucessfully!`),this.name="",this.description="",this.drugSelected=null,this.loading=!1,this.$emit("update",!0)),r.value&&(this.handleModal(),console.error(r.value),S().$toast.error(B),this.loading=!1)},handleModal(){this.open=!this.open},clearForm(){this.$formkit.reset("submitForm"),this.drugSelected=null}}},pe=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),_e={class:"fixed inset-0 overflow-y-auto"},fe={class:"flex min-h-full items-center justify-center p-4 text-center"},he={class:"border-b px-3 py-3 flex items-center justify-between"},ge={class:"mt-2 space-y-3"},ve={class:"w-full flex items-center px-5"},xe={class:"w-full flex flex-col space-y-2"},ye={class:"w-full flex items-center px-5 space-x-3"},we={class:"w-full flex flex-col space-y-2"},be={class:"w-full pb-20 px-5"},ke={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function De(a,s,i,r,o,n){const d=P,p=c("TransitionChild"),g=c("DialogTitle"),w=c("XMarkIcon"),m=c("FormKit"),v=se,_=R,f=c("DialogPanel"),x=c("Dialog"),k=c("TransitionRoot");return b(),$("div",null,[e("div",null,[t(d,{text:"Create organism",color:"primary",icon:o.addIcon,click:n.init},null,8,["icon","click"])]),t(k,{appear:"",show:o.open,as:"template"},{default:l(()=>[t(x,{as:"div",onClose:n.handleModal,class:"relative z-10"},{default:l(()=>[t(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>[pe]),_:1}),e("div",_e,[e("div",fe,[t(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[t(f,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[e("div",he,[t(g,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:l(()=>[T(" Create organism ")]),_:1}),e("button",{onClick:s[0]||(s[0]=(...y)=>n.handleModal&&n.handleModal(...y))},[t(w,{class:"w-5 h-5"})])]),t(m,{type:"form","submit-label":"Update",onSubmit:n.submitForm,actions:!1,id:"submitForm"},{default:l(({value:y})=>[e("div",ge,[e("div",ve,[e("div",xe,[t(m,{type:"text",label:"Name",validation:"required",modelValue:o.name,"onUpdate:modelValue":s[1]||(s[1]=u=>o.name=u)},null,8,["modelValue"])])]),e("div",ye,[e("div",we,[t(m,{type:"textarea",label:"Description",validation:"required",modelValue:o.description,"onUpdate:modelValue":s[2]||(s[2]=u=>o.description=u)},null,8,["modelValue"])])]),e("div",be,[t(v,{label:"Drugs","items-selected":o.drugSelected,"onUpdate:itemsSelected":s[3]||(s[3]=u=>o.drugSelected=u),items:o.drugs,mode:"tags"},null,8,["items-selected","items"])])]),e("div",ke,[t(_,{type:"button",click:()=>{n.clearForm()},text:"Clear form"},null,8,["click"]),t(d,{loading:o.loading,type:"submit",click:()=>{},color:"success",icon:o.saveIcon,text:"Save changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const Ce=F(me,[["render",De]]),$e={components:{TransitionRoot:E,TransitionChild:I,Dialog:M,DialogPanel:O,DialogTitle:j,XMarkIcon:q,ExclamationTriangleIcon:H},data(){return{viewIcon:Z,show:!1,loading:!1,editIcon:Y,moment:ee,cookie:U("token"),organism:{}}},props:{data:{type:Object,required:!0}},methods:{handleClick(){this.show=!this.show},async init(){this.handleClick(),this.loading=!0;const a={route:`${D.organisms}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:s,error:i,pending:r}=await C(a);this.loading=r,s.value&&(this.organism=s.value,this.loading=!1),i.value&&(console.error("error loading organism data: ",i.value),this.loading=!1)}}},Te=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Se={class:"fixed inset-0 overflow-y-auto"},Ve={class:"flex min-h-full items-center justify-center p-4 text-center"},Ie={class:"border-b px-3 py-3 flex items-center justify-between"},Ue=e("img",{src:N,class:"w-8 h-8 mr-2"},null,-1),Ee={class:"flex items-center justify-center mx-auto my-20"},Me={class:"space-y-3 px-5 py-5"},Oe={class:"w-full flex flex-col space-y-1"},je=e("label",{class:"font-semibold text-lg"},"Name",-1),qe={class:"underline text-black"},Fe={class:"w-full flex flex-col space-y-1"},Pe=e("label",{class:"font-semibold text-lg"},"Description",-1),Ae={key:0,class:"underline text-black"},Be={key:1,class:"bg-red-50 py-2 px-2 flex items-center space-x-2"},Re=e("p",{class:"text-red-500 font-medium"}," Description not found ",-1),Ne={class:"w-full flex flex-col space-y-1"},Ge=e("label",{class:"font-semibold text-lg"},"Drugs",-1),Xe={class:"underline text-black"};function Ke(a,s,i,r,o,n){const d=P,p=c("TransitionChild"),g=c("DialogTitle"),w=c("XMarkIcon"),m=te,v=c("ExclamationTriangleIcon"),_=c("DialogPanel"),f=c("Dialog"),x=c("TransitionRoot");return b(),$("div",null,[t(d,{click:n.init,color:"primary",text:"View",icon:o.viewIcon},null,8,["click","icon"]),t(x,{appear:"",show:o.show,as:"template"},{default:l(()=>[t(f,{as:"div",class:"relative z-10"},{default:l(()=>[t(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>[Te]),_:1}),e("div",Se,[e("div",Ve,[t(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[t(_,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>{var k,y;return[e("div",Ie,[t(g,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>[Ue,T(" View organism ")]),_:1}),e("button",{onClick:s[0]||(s[0]=(...u)=>n.handleClick&&n.handleClick(...u))},[t(w,{class:"w-5 h-5"})])]),G(e("div",Ee,[t(m,{loading:o.loading},null,8,["loading"])],512),[[X,o.loading]]),G(e("div",Me,[e("div",Oe,[je,e("p",qe,V(o.organism.name),1)]),e("div",Fe,[Pe,o.organism.description?(b(),$("p",Ae,V(o.organism.description),1)):(b(),$("div",Be,[t(v,{class:"w-5 h-5 text-red-500 rounded-md"}),Re]))]),e("div",Ne,[Ge,e("p",Xe,V((y=(k=o.organism.drugs)==null?void 0:k.map(u=>u.name))==null?void 0:y.join(", ")),1)])],512),[[X,!o.loading]])]}),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const ze=F($e,[["render",Ke]]),Le={components:{TransitionRoot:E,TransitionChild:I,Dialog:M,DialogPanel:O,DialogTitle:j,XMarkIcon:q},data(){return{editIcon:Y,show:!1,saveIcon:J,drugSelected:new Array,cookie:U("token"),drugs:new Array,rawDrugs:new Array,loading:!1}},props:{data:{type:Object,required:!0}},methods:{async loadDrugs(){const a={route:D.drugs,method:"GET",token:`${this.cookie}`},{error:s,data:i}=await C(a);i.value&&(this.rawDrugs=i.value,i.value.map(r=>{this.drugs.push(r.name)})),s.value&&console.error(s.value)},async init(){await this.loadDrugs(),this.handleClick(),this.drugSelected=new Array;const a={route:`${D.organisms}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{error:s,data:i}=await C(a);i.value&&i.value.drugs.map(r=>{this.drugSelected.push(r.name)}),s.value&&console.error(s.value)},async submitForm(){this.loading=!0;let a=new Array;this.drugSelected.map(n=>{this.rawDrugs.filter(d=>{n==d.name&&a.push(Number(d.id))})}),this.data.drugs=a;const s={route:`${D.organisms}/${this.data.id}`,method:"PUT",token:`${this.cookie}`,body:this.data},{pending:i,error:r,data:o}=await C(s);this.loading=i,o.value&&(this.show=!1,S().$toast.success("Organism updated successfully!"),this.loading=!1,this.$emit("update",!0)),r.value&&(this.show=!1,console.error(r.value),this.loading=!1,S().$toast.error(B))},updateDrugs(a){this.drugSelected=a},handleClick(){this.show=!this.show},clearForm(){this.$formkit.reset("submitForm")}}},He=e("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-25"},null,-1),Ye={class:"fixed inset-0 overflow-y-auto"},Je={class:"flex min-h-full items-center justify-center p-4 text-center"},Qe={class:"border-b px-3 py-3 flex items-center justify-between"},We=e("img",{src:N,class:"w-8 h-8 mr-2"},null,-1),Ze={class:"mt-2 space-y-3"},et={class:"w-full flex items-center px-5"},tt={class:"w-full flex flex-col space-y-2"},ot={class:"w-full flex items-center px-5 space-x-3"},st={class:"w-full flex flex-col space-y-2"},at={class:"w-full pb-20 px-5"},nt={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function it(a,s,i,r,o,n){const d=P,p=c("TransitionChild"),g=c("DialogTitle"),w=c("XMarkIcon"),m=c("FormKit"),v=c("multi-select"),_=R,f=c("DialogPanel"),x=c("Dialog"),k=c("TransitionRoot");return b(),$("div",null,[t(d,{click:n.init,text:"Edit",color:"success",icon:o.editIcon},null,8,["click","icon"]),t(k,{appear:"",show:o.show,as:"template"},{default:l(()=>[t(x,{as:"div",class:"relative z-10"},{default:l(()=>[t(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>[He]),_:1}),e("div",Ye,[e("div",Je,[t(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[t(f,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[e("div",Qe,[t(g,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>[We,T(" Edit organism ")]),_:1}),e("button",{onClick:s[0]||(s[0]=(...y)=>n.handleClick&&n.handleClick(...y))},[t(w,{class:"w-5 h-5"})])]),t(m,{type:"form","submit-label":"Update",onSubmit:n.submitForm,actions:!1,id:"submitForm"},{default:l(({value:y})=>[e("div",Ze,[e("div",et,[e("div",tt,[t(m,{type:"text",label:"Name",validation:"required",modelValue:i.data.name,"onUpdate:modelValue":s[1]||(s[1]=u=>i.data.name=u)},null,8,["modelValue"])])]),e("div",ot,[e("div",st,[t(m,{type:"textarea",label:"Description",validation:"required",modelValue:i.data.description,"onUpdate:modelValue":s[2]||(s[2]=u=>i.data.description=u)},null,8,["modelValue"])])]),e("div",at,[t(v,{label:"Drugs",modelValue:o.drugSelected,"onUpdate:modelValue":s[3]||(s[3]=u=>o.drugSelected=u),options:o.drugs,mode:"tags",clear:"",searchable:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),e("div",nt,[t(_,{text:"Clear form",type:"button",click:()=>{n.clearForm()}},null,8,["click"]),t(d,{loading:o.loading,type:"submit",click:()=>{},color:"success",icon:o.saveIcon,text:"Save changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const lt=F(Le,[["render",it]]),rt=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),ct={class:"fixed inset-0 overflow-y-auto"},dt={class:"flex min-h-full items-center justify-center p-4 text-center"},ut={class:"border-b px-3 py-3 flex items-center justify-between"},mt={class:"mt-2 space-y-3 px-5"},pt={class:"rounded px-2 py-2"},_t={class:"font-semibold text-red-500"},ft={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},ht=oe({__name:"index",props:{data:{type:Object,required:!0}},emits:["update"],setup(a,{emit:s}){const i=a,r=s,o=A(!1),n=le,d=A(!1),p=U("token"),g=A("");async function w(v){d.value=!0;const _={route:`${D.organisms}/${v}`,method:"DELETE",token:`${p.value}`,body:{retired_reason:g.value}},{error:f,data:x}=await C(_);x.value&&(m(),S().$toast.success("Drug deleted successfully!"),d.value=!1,r("update",!0)),f.value&&(S().$toast.error(B),d.value=!1)}function m(){o.value=!o.value}return(v,_)=>{const f=P,x=c("FormKit"),k=R;return b(),$("div",null,[t(f,{click:m,color:"error",text:"Delete",icon:h(n)},null,8,["icon"]),t(h(E),{appear:"",show:o.value,as:"template"},{default:l(()=>[t(h(M),{as:"div",class:"relative z-10"},{default:l(()=>[t(h(I),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>[rt]),_:1}),e("div",ct,[e("div",dt,[t(h(I),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[t(h(O),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[e("div",ut,[t(h(j),{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>[t(h(H),{class:"h-5 w-5 mr-2"}),T(" Confirm delete ")]),_:1}),e("button",{onClick:m},[t(h(q),{class:"w-5 h-5"})])]),t(x,{type:"form","submit-label":"Update",onSubmit:_[1]||(_[1]=y=>w(a.data.id)),actions:!1},{default:l(({value:y})=>[e("div",mt,[e("div",pt,[T(" Do you really want to delete "),e("span",_t,V(i.data.name),1),T("? Note that once this action is completed, it can not be undone ")]),t(x,{type:"textarea",label:"Reason",validation:"required",modelValue:g.value,"onUpdate:modelValue":_[0]||(_[0]=u=>g.value=u)},null,8,["modelValue"])]),e("div",ft,[t(k,{click:()=>{m()},type:"button",text:"Cancel"},null,8,["click"]),t(f,{loading:d.value,type:"submit",click:()=>{},color:"error",icon:h(n),text:"Delete"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),gt={setup(){ce({title:`${de.name.toUpperCase()} - Organisms`})},data(){return{header:"Organisms",loading:!1,search:"",searchValue:"",headers:[{text:"id",value:"id",sortable:!0},{text:"name",value:"name",sortable:!0},{text:"description",value:"description"},{text:"actions",value:"actions"}],organisms:[],pages:[{name:"Home",link:"/home"},{name:"Test Catalog",link:"#"}],cookie:U("token")}},components:{MagnifyingGlassIcon:ue},created(){this.init()},methods:{updateSearch(a){this.searchValue=a,this.search=a},async init(){this.loading=!0;const a={route:D.organisms,method:"GET",token:`${this.cookie}`},{data:s,error:i,pending:r}=await C(a);this.loading=r,s.value&&(this.organisms=s.value,this.loading=!1),i.value&&(console.error(i.value),this.loading=!1)},updateOrganisms(a){a&&this.init()}}},vt={class:"py-5 px-5"},xt={class:"flex items-center justify-between py-5"},yt={class:"text-2xl font-semibold flex items-center uppercase"},wt=e("img",{src:N,alt:"report-icon",class:"w-8 h-8 mr-2"},null,-1),bt={class:"flex items-center space-x-3"},kt={class:"flex justify-end w-full px-2 py-2 mb-2"},Dt={class:"py-2 flex items-center space-x-2"};function Ct(a,s,i,r,o,n){const d=Q,p=Ce,g=ie,w=ze,m=lt,v=ht,_=re;return b(),$("div",vt,[t(d,{pages:o.pages},null,8,["pages"]),e("div",xt,[e("div",yt,[wt,T(" "+V(o.header),1)]),e("div",bt,[("usePermissions"in a?a.usePermissions:h(L))().can.manage("test_catalog")?(b(),K(p,{key:0,onUpdate:n.updateOrganisms},null,8,["onUpdate"])):z("",!0)])]),e("div",kt,[t(g,{search:o.search,onUpdate:n.updateSearch},null,8,["search","onUpdate"])]),("usePermissions"in a?a.usePermissions:h(L))().can.manage("test_catalog")?(b(),K(_,{key:0,headers:o.headers,data:o.organisms,loading:o.loading,"search-value":o.searchValue,"search-field":"name"},{actions:l(({item:f})=>[e("div",Dt,[t(w,{data:f},null,8,["data"]),t(m,{data:f,onUpdate:n.updateOrganisms},null,8,["data","onUpdate"]),t(v,{data:f,onUpdate:n.updateOrganisms},null,8,["data","onUpdate"])])]),_:1},8,["headers","data","loading","search-value"])):z("",!0)])}const Kt=F(gt,[["render",Ct]]);export{Kt as default};
