import{_ as I}from"./Breadcrumb.vue.045bd783.js";import{_ as B}from"./SearchBar.d5f1cae2.js";import{u as S,a as A,_ as j,o as n,c as a,b as d,d as e,w as g,v,F as u,r as m,t as y,e as q}from"./entry.a061692d.js";import{_ as E}from"./Loader.c099e152.js";import{u as L}from"./vue.f36acd1f.0b4f2453.js";import{e as h,f as _}from"./fetch.1d637d4b.js";import{P as R}from"./package.e5cbe000.js";import{r as U}from"./AdjustmentsVerticalIcon.923a6f9d.js";import{r as G}from"./ArrowDownTrayIcon.6ecffc37.js";import{r as N}from"./MagnifyingGlassIcon.8954957c.js";import{r as T}from"./InformationCircleIcon.3215f789.js";import{r as V}from"./EllipsisVerticalIcon.ecd79f58.js";import"./nuxt-link.246d5749.js";import"./HomeIcon.eefa6f73.js";import"./XMarkIcon.2a91e852.js";import"./constants.5ff314f3.js";import"./transition.34c9747b.js";import"./hidden.2e8968f2.js";import"./PencilSquareIcon.a9348a41.js";import"./PrinterIcon.63d7d5dd.js";const D={setup(){L({title:`${R.name.toUpperCase()} - Permissions`})},data(){return{filterIcon:U,saveIcon:G,pages:[{name:"Home",link:"/home"},{name:"Access Controls",link:"#"}],search:"",privileges:new Array,roles:new Array,cookie:S("token"),loading:!1}},components:{MagnifyingGlassIcon:N,InformationCircleIcon:T,EllipsisVerticalIcon:V},created(){this.init(),this.loadRoles()},computed:{filteredPrivileges(){if(!this.search)return this.privileges;const t=this.search.toLowerCase();return this.privileges.filter(s=>s.display_name.toLowerCase().includes(t))}},methods:{async init(){this.loading=!0;const t={route:h.privileges,method:"GET",token:`${this.cookie}`},{data:s,pending:r,error:i}=await _(t);s.value&&(this.privileges=s.value,this.loading=!1),i.value&&(console.error(i.value),this.loading=!1)},async loadRoles(){const t={route:h.roles,method:"GET",token:`${this.cookie}`},{data:s,error:r}=await _(t);s.value&&(this.roles=s.value),r.value&&console.error(r.value)},async update(){this.loading=!0;const t={route:`${h.roles}/update_permissions`,method:"PUT",token:`${this.cookie}`,body:{role_privileges:this.roles}},{data:s,pending:r,error:i}=await _(t);s.value&&(this.loading=!1,A().$toast.success("Permissions updated successfully!"),this.init(),this.loadRoles()),i.value&&(this.loading=!1,console.error(i.value))},updatePermissions(t,s,r){t.target.checked?s.privileges.push(r):s.privileges.map((i,o)=>{i.id===r.id&&s.privileges.splice(o,1)})},updateSearch(t){this.search=t}}},F={class:"px-5 py-5"},H=e("div",{class:"flex items-center justify-between py-5"},[e("h3",{class:"text-2xl font-semibold"},"Permissions")],-1),$={class:"flex items-center space-x-3 justify-between"},M={class:"w-full mt-5 rounded"},z={class:"flex items-center mx-auto justify-center py-20"},J={class:"overflow-x-auto mb-20 rounded"},K={class:"table-auto w-full border-collapse border rounded"},O={class:"border-b"},Q=e("th",{class:"px-20 py-2 text-left uppercase font-semibold border sticky left-0 bg-white"},"Permissions",-1),W={class:"border-r sticky left-0 bg-white"},X={class:"space-y-2 border-l border-r"},Y={class:"flex items-center justify-between border-b py-2 px-4 hover:bg-gray-100 transition duration-150 hover:font-medium"},Z=["checked","onChange"];function ee(t,s,r,i,o,c){const b=I,k=B,x=q,w=E;return n(),a("div",F,[d(b,{pages:o.pages},null,8,["pages"]),H,e("div",$,[d(k,{search:o.search,onUpdate:c.updateSearch},null,8,["search","onUpdate"]),d(x,{loading:o.loading,click:()=>{c.update()},text:"Save changes",color:"success",icon:o.saveIcon},null,8,["loading","click","icon"])]),e("div",M,[g(e("div",z,[d(w,{loading:o.loading},null,8,["loading"])],512),[[v,o.loading]]),g(e("div",J,[e("table",K,[e("thead",O,[e("tr",null,[Q,(n(!0),a(u,null,m(o.roles,l=>(n(),a("th",{class:"px-4 py-2 text-left uppercase font-semibold",key:l.id},y(l.name),1))),128))])]),e("tbody",null,[(n(!0),a(u,null,m(c.filteredPrivileges,(l,C)=>(n(),a("tr",{key:C},[e("td",W,[e("div",X,[e("div",Y,[e("p",null,y(l.display_name),1)])])]),(n(!0),a(u,null,m(o.roles,(f,P)=>(n(),a("td",{class:"border px-4 py-2",key:P},[e("input",{type:"checkbox",checked:f.privileges.filter(p=>p.name==l.name).length>0,class:"mr-2 leading-tight",onChange:p=>{c.updatePermissions(p,f,l)}},null,40,Z)]))),128))]))),128))])])],512),[[v,!o.loading]])])])}const ke=j(D,[["render",ee]]);export{ke as default};
