import{_ as ee}from"./Breadcrumb.vue.e4889425.js";import{_ as te}from"./Dropdown.aed25248.js";import{_ as oe,f as k,o as _,p as ae,l as se,B as n,u as re,K as V,c as y,b as s,k as t,d as e,t as c,g as P,h as N,D as F,F as ne,r as le,n as ie,j as S,w as ce,v as de,a as w,e as me}from"./entry.504e3567.js";import{_ as ue}from"./ExportButton.vue.0e10509e.js";import{_ as pe}from"./Address.vue.e3af014d.js";import{_ as _e}from"./Loader.d8ed2750.js";import{B as fe,C as he,b as ve,c as ge,g as xe,f as ye,p as be,a as Te}from"./index.0557a3c2.js";import{u as we}from"./vue.f36acd1f.ccd3f3bb.js";import{d as Y,e as $e}from"./constants.47b80c98.js";import{_ as ke}from"./report.a0ff4e5a.js";import{_ as Re}from"./logo.5f424d1d.js";import{_ as De}from"./page.ba54a0c5.js";import{h as $,f as j,e as O}from"./fetch.b3082bb9.js";import{u as Ae}from"./facility.a25c7714.js";import{P as Ce}from"./package.9dfae452.js";import{r as Ee}from"./FunnelIcon.b505e276.js";import{r as Be}from"./ArrowPathIcon.823809c9.js";import"./nuxt-link.09b9e00f.js";import"./HomeIcon.a5863fa5.js";import"./listbox.eafb7ff1.js";import"./hidden.5732ecbe.js";import"./use-text-value.f9ac41f9.js";import"./CheckIcon.bd56c467.js";import"./CheckCircleIcon.4018c96a.js";import"./MagnifyingGlassIcon.ff9decc0.js";import"./transition.ac68d846.js";import"./XMarkIcon.a83fbe3b.js";import"./PencilSquareIcon.7237cab8.js";import"./PrinterIcon.39289cb1.js";he.register(ve,ge,xe,ye,be,Te);const Ve={components:{Bar:fe},props:{chartData:{required:!0,type:Object}},data(){return{data:this.chartData,options:{responsive:!0,maintainAspectRatio:!1}}},watch:{chartData:{handler(R){this.data=R},deep:!0}}};function Fe(R,U,D,u,f,A){const C=k("Bar");return _(),ae(C,{data:f.data,options:f.options},null,8,["data","options"])}const Ne=oe(Ve,[["render",Fe]]),Ue={class:"px-5 py-5"},Me=e("img",{src:ke,alt:"report-icon",class:"w-8 h-8 mr-2"},null,-1),Pe={class:"flex justify-between items-center"},Se={class:"w-full flex items-center space-x-3"},Ye={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},je={class:"w-72 ml-2"},Oe={class:"w-48"},qe={class:"w-48"},Ge={class:"w-48"},Ie={class:"border rounded mt-10",id:"print-container"},Le={class:"flex items-center justify-between px-5 py-5 border-b"},He=e("div",{class:"flex flex-col space-y-2"},[e("img",{src:Re,alt:"app-logo",class:"w-24 h-24 object-cover"}),e("h3",{class:"text-xl font-semibold"}," TURN AROUND TIME REPORT ")],-1),Ke={class:"m-3"},ze={class:"font-semibold mb-2"},We={class:"text-normal font-normal"},Je={class:"w-full rounded"},Qe=e("thead",null,[e("tr",{class:"border-t bg-gray-100 border-b"},[e("th",{class:"text-left px-2 py-2 border-r"},"Test Type"),e("th",{class:"text-left px-2 py-2 border-r"},"Turn Around Time"),e("th",{class:"text-left px-2 py-2"},"Average Turn Around Time")])],-1),Xe={class:"text-left px-2 py-2 border-l border-b"},Ze={class:"text-left px-2 py-2 border-l border-b"},et={class:"text-left px-2 py-2 border-l border-r border-b"},tt={key:0,class:"w-full flex flex-col items-center justify-center space-y-2 py-10"},ot=e("img",{src:De,alt:"page-icon",class:"object-cover w-20 h-20"},null,-1),at=e("p",null,"Data not found, please generate report",-1),st=[ot,at],rt={class:"mx-auto justify-center flex flex-col items-center space-y-3 py-10"},nt=e("p",null,[N("Generating report, please wait"),e("span",{class:"animate-ping"},"...")],-1),lt={class:"px-5 py-5 flex flex-col items-center"},it=e("h3",{class:"text-lg font-medium"},"Average Turn Around Time",-1),ct={class:"mt-1"},dt={key:0,style:{height:"400px"}},mt="Turn Around Time Report",Ot=se({__name:"turn-around-time",setup(R){we({title:`${Ce.name.toUpperCase()} - Turn Around Time Reports`});const U=n([{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"Aggregate Reports",link:"#"}]),D=n([]),u=n({name:"select department",id:0}),f=n(""),A=n(""),C=n([{name:"Minutes"},{name:"Hours"},{name:"Days"},{name:"Weeks"}]),h=n({name:"select unit"}),d=n(!1),p=n([]),E=Ae(),M=re("token"),B=n({}),i=n(new Array("","")),q=()=>{i.value=new Array("","")},v=V(()=>i.value[0]?$(i.value[0]).format("YYYY-MM-DD"):""),g=V(()=>i.value[1]?$(i.value[1]).format("YYYY-MM-DD"):""),G=V(()=>p.value.length>0?p.value.map(o=>({"TEST TYPE":o.test_type,"TURN AROUND TIME":o.turn_around_time,AVERAGE:o.average})):[]);async function I(){const{data:o,error:a}=await j({route:O.departments,method:"GET",token:`${M.value}`});o.value&&(D.value=o.value),a.value&&console.error(a.value)}async function L(){d.value=!0,B.value={};let o=`from=${v.value}&to=${g.value}&department=${u.value.id}&unit=${h.value.name.toLowerCase()}`;const a={route:`${O.aggregateReports}turn_around_time?${o}`,method:"GET",token:`${M.value}`},{data:r,error:b,pending:T}=await j(a);d.value=T,r.value&&(d.value=!1,p.value=r.value.data,B.value={labels:r.value.data.map(m=>m.test_type),datasets:[{label:"Turn Around Time",backgroundColor:"#0284c7",data:r.value.data.map(m=>m.average)},{label:"Average Turn Around Time",backgroundColor:"#030712",data:r.value.data.map(m=>K(m.turn_around_time))}]},r.value.data.length>0?w().$toast.success("Report data generated successfully"):w().$toast.warning(`No data found in period ${v} - ${g}`)),b.value&&(d.value=!1,console.error(b.value),w().$toast.error($e))}function H(){const o=u.value.name==="select department"||h.value.name==="select unit";return o&&w().$toast.warning("Please select a department and unit"),!o}function K(o){const a=/\d+/,r=o==null?void 0:o.match(a);return r?parseInt(r[0]):0}return I(),(o,a)=>{const r=ee,b=k("datepicker"),T=te,m=me,z=k("FormKit"),W=ue,J=k("excel"),Q=pe,X=_e,Z=Ne;return _(),y("div",Ue,[s(r,{pages:t(U)},null,8,["pages"]),e("div",{class:"flex items-center py-5"},[Me,e("h3",{class:"text-2xl font-semibold uppercase"},c(mt))]),e("div",Pe,[s(z,{type:"form","submit-label":"Update",onSubmit:a[3]||(a[3]=x=>H()&&L()),actions:!1,id:"submitForm"},{default:P(({value:x})=>[e("div",Se,[e("div",Ye,[s(t(Ee),{class:"w-5 h-5 mr-2"}),N(" Filter By Date Range "),e("div",je,[s(b,{onCleared:q,required:"",position:"left",placeholder:"select start & end date",range:!0,"input-class-name":"datepicker",modelValue:t(i),"onUpdate:modelValue":a[0]||(a[0]=l=>F(i)?i.value=l:null),format:"dd/MM/yyyy"},null,8,["modelValue"])])]),e("div",Oe,[s(T,{items:t(D),modelValue:t(u),"onUpdate:modelValue":a[1]||(a[1]=l=>F(u)?u.value=l:null)},null,8,["items","modelValue"])]),e("div",qe,[s(T,{items:t(C),modelValue:t(h),"onUpdate:modelValue":a[2]||(a[2]=l=>F(h)?h.value=l:null)},null,8,["items","modelValue"])]),e("div",Ge,[s(m,{type:"submit",color:"primary",text:"Generate Report",icon:t(Be),click:()=>{},loading:t(d)},null,8,["icon","loading"])])])]),_:1}),s(J,{class:"btn btn-default",header:[`TURN AROUND TIME REPORT ${t(v)} - ${t(g)}`,t(E).details.name,t(E).details.address,t(E).details.phone],data:t(G),worksheet:"report-work-sheet",name:`turn_around_time_${t(v)}_to_${t(g)}.xls`},{default:P(()=>[s(W,{text:"Export Excel"})]),_:1},8,["header","data","name"])]),e("div",Ie,[e("div",Le,[He,s(Q)]),e("div",Ke,[e("h3",ze,[N("Tests Performed Period: "),e("span",We,c(t(v))+" - "+c(t(g)),1)])]),e("div",null,[e("table",Je,[Qe,e("tbody",null,[(_(!0),y(ne,null,le(t(p),(x,l)=>(_(),y("tr",{key:l,class:ie({"bg-white":l%2===0,"bg-gray-100":l%2!==0})},[e("td",Xe,c(x.test_type),1),e("td",Ze,c(x.turn_around_time),1),e("td",et,c(x.average),1)],2))),128))])])]),t(p).length==0&&!t(d)?(_(),y("div",tt,st)):S("",!0),ce(e("div",rt,[s(X),nt],512),[[de,t(d)]])]),e("div",lt,[it,e("p",ct,"From: "+c(t(f)!=""?t($)(t(f)).format("dateFormat"in o?o.dateFormat:t(Y)):"")+" -:- To: "+c(t(A)!=""?t($)(t(A)).format("dateFormat"in o?o.dateFormat:t(Y)):""),1)]),t(p).length>0?(_(),y("div",dt,[s(Z,{"chart-data":t(B)},null,8,["chart-data"])])):S("",!0)])}}});export{Ot as default};
