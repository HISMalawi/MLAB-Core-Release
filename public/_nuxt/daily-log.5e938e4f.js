import{_ as L}from"./Breadcrumb.6b2e0aaf.js";import{_ as j}from"./Dropdown.eea5b9cc.js";import{l as E,_ as v,o as n,c as l,d as e,F as y,r as b,t as r,k as D,j as f,h as k,u as B,a as R,f as V,b as u,g as q,p as $,e as O}from"./entry.07439091.js";import{d as C}from"./constants.06d305c2.js";import{h as T,i as F,e as x,f as g}from"./fetch.b0dbeb5a.js";import{u as Y}from"./vue.f36acd1f.70ff2b88.js";import{k as U}from"./vue-doc-download.2c8f7211.js";import{u as G}from"./facility.9663b28a.js";import{P as z}from"./package.d411c004.js";import{r as H}from"./XMarkIcon.03d2e3cf.js";import{y as J,j as W,W as X}from"./popover.66e7c789.js";import{r as K}from"./AdjustmentsVerticalIcon.a12db7f8.js";import{r as Q}from"./DocumentTextIcon.f4b85975.js";import{r as Z}from"./ArrowUpOnSquareIcon.7759f6bb.js";import{r as ee}from"./CheckIcon.37e05f54.js";import{r as te}from"./ArrowPathIcon.e0098bbf.js";import{_ as se}from"./logo.b25abaa2.js";import"./nuxt-link.93f30edb.js";import"./HomeIcon.42729c2c.js";import"./CheckCircleIcon.7d8087ad.js";import"./MagnifyingGlassIcon.d683f9e4.js";import"./listbox.932c8cac.js";import"./hidden.0c3ab281.js";import"./use-text-value.4499ba3e.js";import"./transition.d75289e9.js";import"./PencilSquareIcon.ac5eab04.js";import"./PrinterIcon.0139b369.js";const oe=E({props:{data:{required:!0,type:Object}},data(){return{moment:T,headers:[{name:"Patient ID"},{name:"Visit No"},{name:"Patient Name"},{name:"Accession Number"},{name:"Specimen"},{name:"Receipt Date"},{name:"Tests"},{name:"Performed By"},{name:"Results"},{name:"Remarks"},{name:"Results Entry Date"},{name:"Authorized By"}],reportData:this.data}}}),re={class:"w-full overflow-x-auto"},ae={class:"w-full text-left overflow-y-auto"},ne={class:"uppercase bg-gray-100"},le={class:"border-b"},ce={class:"px-2 py-2 font-normal border-r"},pe={class:"px-2 py-2 font-normal border-r"},de={class:"px-2 py-2 font-normal border-r"},ie={class:"px-2 py-2 font-normal border-r"},me={class:"px-2 py-2 font-normal border-r"},ue={class:"px-2 py-2 font-normal border-r"},_e={class:"px-2 py-2 font-normal border-r"},he={class:"px-2 py-2 font-normal border-r"},fe={class:"px-2 py-2 font-normal border-r"},ye={key:0,class:"font-medium"},be={class:"px-2 py-2 font-normal border-r"},xe={class:"px-2 py-2 font-normal border-r"},ge={class:"px-2 py-2 font-normal"};function Te(t,a,c,m,s,_){return n(),l("div",re,[e("table",ae,[e("thead",ne,[e("tr",le,[(n(!0),l(y,null,b(t.headers,(o,p)=>(n(),l("th",{class:"uppercase py-2 px-2 border-r",key:p},r(o.name),1))),128))])]),e("tbody",null,[(n(!0),l(y,null,b(t.data.data,(o,p)=>(n(),l("tr",{class:"bg-white border-b",key:p},[e("th",ce,r(o.patient_id),1),e("th",pe,r(o.visit_no),1),e("th",de,r(o.patient_name),1),e("th",ie,r(o.accession_number),1),e("th",me,r(o.specimen),1),e("th",ue,r(t.moment(o.receipt_date).format("dateFormat"in t?t.dateFormat:D(C))),1),e("th",_e,r(o.test),1),e("th",he,r(o.performed_by),1),e("th",fe,[(n(!0),l(y,null,b(o.results,(d,h)=>(n(),l("p",{key:h},[d!=null&&d!==""?(n(),l("span",ye,r(`${h}:`),1)):f("",!0),k(" "+r(d),1)]))),128))]),e("th",be,r(o.remarks),1),e("th",xe,r(t.moment(o.result_date).format("dateFormat"in t?t.dateFormat:D(C))),1),e("th",ge,r(o.authorized_by),1)]))),128))])])])}const ve=v(oe,[["render",Te]]),$e=E({props:{data:{required:!0,type:Object}},data(){var t;return{details:(t=this.data)==null?void 0:t.data}},methods:{removeDuplicates(t){return t.filter((c,m)=>t.findIndex(s=>s.patient_no===c.patient_no)===m)}}}),De=e("div",{class:"px-3 py-3 uppercase"}," SUMMARY ",-1),ke={class:"w-full text-left"},Ee=e("thead",{class:"uppercase bg-gray-100"},[e("tr",{class:"border-b"},[e("th",{class:"uppercase py-2 px-2 border-r"}," TOTAL VISITS "),e("th",{class:"uppercase py-2 px-2 border-r"}," MALE "),e("th",{class:"uppercase py-2 px-2 border-r"}," FEMALE ")])],-1),Se={class:"px-2 py-2 font-normal border-r border-b"},we={class:"px-2 py-2 font-normal border-r border-b"},Ae={class:"px-2 py-2 font-normal border-r border-b"},Re={class:"w-full text-left mt-10"},Ve=e("thead",{class:"uppercase bg-gray-100"},[e("tr",{class:"border-b"},[e("th",{class:"uppercase py-2 px-2 border-r"}," PATIENT NO "),e("th",{class:"uppercase py-2 px-2 border-r"}," PATIENT NAME "),e("th",{class:"uppercase py-2 px-2 border-r"}," AGE "),e("th",{class:"uppercase py-2 px-2 border-r"}," SEX "),e("th",{class:"uppercase py-2 px-2 border-r"}," ACCESSION NUMBER "),e("th",{class:"uppercase py-2 px-2 border-r"}," SPECIMEN TYPE "),e("th",{class:"uppercase py-2 px-2 border-r"}," TESTS ")])],-1),Ce={class:"px-2 py-2 font-normal border-r border-b"},Ne={class:"px-2 py-2 font-normal border-r border-b"},Pe={class:"px-2 py-2 font-normal border-r border-b"},Me={class:"px-2 py-2 font-normal border-r border-b"},Ie={class:"px-2 py-2 font-normal border-r border-b"},Le={class:"px-2 py-2 font-normal border-r border-b"},je={class:"px-2 py-2 font-normal border-r border-b space-y-1"};function Be(t,a,c,m,s,_){return n(),l("div",null,[De,e("table",ke,[Ee,e("tbody",null,[e("tr",null,[e("th",Se,r(t.data.visits),1),e("th",we,r(t.removeDuplicates(t.details).filter(o=>o.gender=="M").length),1),e("th",Ae,r(t.removeDuplicates(t.details).filter(o=>o.gender=="F").length),1)])])]),e("div",null,[e("table",Re,[Ve,e("tbody",null,[(n(!0),l(y,null,b(t.details,(o,p)=>(n(),l("tr",{key:p},[e("th",Ce,r(o.patient_no),1),e("th",Ne,r(o.patient_name),1),e("th",Pe,r(("calculateAge"in t?t.calculateAge:D(F))(o.dob)),1),e("th",Me,r(o.gender),1),e("th",Ie,r(o.accession_number),1),e("th",Le,r(o.specimen),1),e("th",je,[(n(!0),l(y,null,b(o.test_type,(d,h)=>(n(),l("p",{key:h},r(d),1))),128))])]))),128))])])])])}const qe=v($e,[["render",Be]]),Oe=E({props:{data:{required:!0,type:Object}},data(){var t;return{details:(t=this.data)==null?void 0:t.data}}}),Fe={class:"w-full text-left"},Ye=e("thead",{class:"uppercase bg-gray-100"},[e("tr",{class:"border-b"},[e("th",{class:"uppercase py-2 px-2 border-r"}," ACCESSION NUMBER "),e("th",{class:"uppercase py-2 px-2 border-r"}," SPECIMEN "),e("th",{class:"uppercase py-2 px-2 border-r"}," RECEIPT DATE "),e("th",{class:"uppercase py-2 px-2 border-r"}," TESTS "),e("th",{class:"uppercase py-2 px-2 border-r"}," LAB selection "),e("th",{class:"uppercase py-2 px-2 border-r"}," REJECTION REASON "),e("th",{class:"uppercase py-2 px-2 border-r"}," PERSON TALKED TO "),e("th",{class:"uppercase py-2 px-2 border-r"}," DATE REJECTED ")])],-1),Ue={class:"px-2 py-2 font-normal border-r border-b"},Ge={class:"px-2 py-2 font-normal border-r border-b"},ze={class:"px-2 py-2 font-normal border-r border-b"},He={class:"px-2 py-2 font-normal border-r border-b"},Je={class:"px-2 py-2 font-normal border-r border-b"},We={class:"px-2 py-2 font-normal border-r border-b"},Xe={class:"px-2 py-2 font-normal border-r border-b"},Ke={class:"px-2 py-2 font-normal border-r border-b"};function Qe(t,a,c,m,s,_){return n(),l("div",null,[e("table",Fe,[Ye,e("tbody",null,[(n(!0),l(y,null,b(t.details,(o,p)=>(n(),l("tr",{key:p},[e("th",Ue,r(o.accession_number),1),e("th",Ge,r(o.specimen),1),e("th",ze,r(o.receipt_date),1),e("th",He,r(o.test),1),e("th",Je,r(o.department),1),e("th",We,r(o.rejection_reason),1),e("th",Xe,r(o.person_talked_to),1),e("th",Ke,r(o.test_status_date),1)]))),128))])])])}const Ze=v(Oe,[["render",Qe]]),et={setup(){Y({title:`${z.name} - Daily Log Reports`})},components:{XMarkIcon:H,Popover:J,PopoverButton:W,PopoverPanel:X,ExportToExcel:U},data(){return{moment:T,filtersIcon:K,wordIcon:Q,viewIcon:Z,checkIcon:ee,generateIcon:te,facility:G(),pages:[{name:"Home",link:"/home"},{name:"Reports",link:"#"}],selectedRole:{name:"Administrator"},filters:[],cookie:B("token"),departments:new Array,selectedDepartment:{name:"-- select department --"},testTypes:new Array,selectedtTestType:{name:"-- select test type --"},testStatuses:new Array,selectedTestStatus:{name:"-- select test status --"},startDate:"",endDate:"",reportData:{},completeTests:0,reportTypes:new Array({name:"Test record",value:"test_record"},{name:"Patient record",value:"patient_record"}),reportType:{name:"-- select report type --",value:"-- select report type --"},loading:!1}},created(){this.getDepartments(),this.getTestStatuses()},methods:{async getDepartments(){const t={route:x.departments,method:"GET",token:`${this.cookie}`},{data:a,error:c,pending:m}=await g(t);a.value&&(this.departments=a.value),c.value},async getTestTypes(){const t={route:`${x.testTypes}/by_department?department_id=${this.selectedDepartment.id}`,method:"GET",token:`${this.cookie}`},{data:a,error:c,pending:m}=await g(t);a.value&&(this.testTypes=a.value),c.value},async getTestStatuses(){const t={route:`${x.testStatus}/all`,method:"GET",token:`${this.cookie}`},{data:a,error:c,pending:m}=await g(t);a.value&&(this.testStatuses=a.value),c.value&&console.error(c.value)},checkStatus(t){let a="";return t=="-- select department --"||t==="-- select test type --"||t==="-- select test status --"?a="":a=t,a},async generateReport(){var t;if(this.loading=!0,this.reportType.value!="-- select report type --"){let a=this.startDate!=""?T(this.startDate).format("YYYY-MM-DD"):"",c=this.endDate!=""?T(this.endDate).format("YYYY-MM-DD"):"",m=`from=${a}&to=${c}&department=${this.checkStatus(this.selectedDepartment.name)}&report_type=${this.reportType.value}&test_status=${this.checkStatus(this.selectedTestStatus.name)}&test_type=${this.checkStatus(this.selectedtTestType.name)}`;const s={route:`${x.dailyReports}/daily_log?${m}`,method:"GET",token:`${this.cookie}`},{data:_,error:o,pending:p}=await g(s);this.loading=p,_.value&&(this.loading=!1,((t=_.value)==null?void 0:t.data.length)==0&&R().$toast.warning("No data found for specified parameters"),this.reportData=_.value,this.reportType.value=="test_record"&&this.calculateCompleteTests(_.value)),o.value&&(this.loading=!1,console.error(o.value))}else R().$toast.warning("Please select the report type before generating the report"),this.loading=!1},calculateCompleteTests(t){t.data.map(a=>{(a.test_status.toLowerCase()==="completed"||a.test_status.toLowerCase()==="verified")&&(this.completeTests+=1)})}},watch:{selectedDepartment:{handler(t){t&&this.getTestTypes()},deep:!0},reportType:{handler(t){this.reportData=new Array},deep:!0}}},tt={class:"px-5 py-5"},st={class:"flex items-center justify-between"},ot={class:"bg-white flex space-x-5 py-5 flex-wrap"},rt={class:"w-52"},at=e("p",{class:"text-lg font-medium mb-1"},"Start date",-1),nt={class:"w-52"},lt=e("p",{class:"text-lg font-medium mb-1"},"End date",-1),ct={class:"flex flex-col"},pt=e("p",{class:"text-lg font-medium"},"Laboratory section",-1),dt={class:"flex flex-col"},it=e("p",{class:"text-lg font-medium"},"Test type",-1),mt={class:"flex flex-col"},ut=e("p",{class:"text-lg font-medium"},"Test status",-1),_t={class:"mb-5 flex items-center space-x-5"},ht={class:"flex flex-col"},ft=e("p",{class:"text-lg font-medium"},"Report type",-1),yt={class:"mt-8 flex items-center space-x-5"},bt={key:0,class:"border rounded",id:"export-container"},xt={class:"flex items-center justify-between px-5 bg-gray-50 rounded-t border-b"},gt=e("img",{src:se,alt:"app-logo",class:"w-24 h-24 object-cover"},null,-1),Tt={class:"space-y-2 py-5"},vt={class:"uppercase font-medium"},$t={class:"uppercase font-medium"},Dt={class:"uppercase font-medium"},kt=e("p",{class:"uppercase font-medium underline"},"Laboratory Report",-1),Et={class:"px-5 py-5"},St={key:0,class:"text-lg font-semibold"},wt={class:"text-md font-normal"},At={class:"text-lg font-semibold"},Rt={class:"text-md font-normal"},Vt={class:"w-full border-t"};function Ct(t,a,c,m,s,_){var S,w,A;const o=L,p=V("datepicker"),d=j,h=O,N=V("ExportToExcel"),P=ve,M=qe,I=Ze;return n(),l("div",tt,[u(o,{pages:s.pages},null,8,["pages"]),e("div",st,[e("div",ot,[e("div",rt,[at,u(p,{position:"left",placeholder:"-- start date --",format:"dd/MM/yyyy","input-classes":"border rounded px-2 py-1.5 block focus:outline-none focus:ring-2 focus:ring-sky-500 transition duration-150 focus:border-none",range:!1,shortcuts:!1,modelValue:s.startDate,"onUpdate:modelValue":a[0]||(a[0]=i=>s.startDate=i)},null,8,["modelValue"])]),e("div",nt,[lt,u(p,{placeholder:"-- end date --",format:"dd/MM/yyyy","input-classes":"border rounded px-2 py-1.5 block focus:outline-none focus:ring-2 focus:ring-sky-500 transition duration-150 focus:border-none",range:!1,shortcuts:!1,modelValue:s.endDate,"onUpdate:modelValue":a[1]||(a[1]=i=>s.endDate=i)},null,8,["modelValue"])]),e("div",ct,[pt,u(d,{items:s.departments,modelValue:s.selectedDepartment,"onUpdate:modelValue":a[2]||(a[2]=i=>s.selectedDepartment=i)},null,8,["items","modelValue"])]),e("div",dt,[it,u(d,{items:s.testTypes,modelValue:s.selectedtTestType,"onUpdate:modelValue":a[3]||(a[3]=i=>s.selectedtTestType=i)},null,8,["items","modelValue"])]),e("div",mt,[ut,u(d,{items:s.testStatuses,modelValue:s.selectedTestStatus,"onUpdate:modelValue":a[4]||(a[4]=i=>s.selectedTestStatus=i)},null,8,["items","modelValue"])])])]),e("div",_t,[e("div",ht,[ft,u(d,{items:s.reportTypes,modelValue:s.reportType,"onUpdate:modelValue":a[5]||(a[5]=i=>s.reportType=i)},null,8,["items","modelValue"])]),e("div",yt,[u(h,{color:"primary",text:"Generate Report",icon:s.generateIcon,loading:s.loading,click:()=>_.generateReport()},null,8,["icon","loading","click"]),u(N,{element:"export-container",filename:`daily_${s.reportType.value}_${s.moment(new Date).format("yyy_MM_DD")}`},{default:q(()=>[u(h,{icon:s.wordIcon,click:()=>{},text:"Export to Excel",color:"success"},null,8,["icon"])]),_:1},8,["filename"])])]),((w=(S=s.reportData)==null?void 0:S.data)==null?void 0:w.length)>0?(n(),l("div",bt,[e("div",xt,[gt,e("div",Tt,[e("p",vt,r(s.facility.details.name),1),e("p",$t,r(s.facility.details.address),1),e("p",Dt,r(s.facility.details.phone),1),kt])]),e("div",Et,[s.reportType.value=="test_record"&&s.selectedTestStatus.name!=="test-rejected"?(n(),l("h3",St,[k("Test Record: "),e("span",wt,r(s.completeTests)+" Complete tests",1)])):f("",!0),e("h3",At,[k("Date: "),e("span",Rt,r((A=s.reportData)==null?void 0:A.from),1)])]),e("div",Vt,[s.reportType.value=="test_record"&&s.selectedTestStatus.name!=="test-rejected"?(n(),$(P,{key:0,data:s.reportData},null,8,["data"])):f("",!0),s.reportType.value=="patient_record"?(n(),$(M,{key:1,data:s.reportData},null,8,["data"])):f("",!0),s.selectedTestStatus.name=="test-rejected"?(n(),$(I,{key:2,data:s.reportData},null,8,["data"])):f("",!0)])])):f("",!0)])}const ns=v(et,[["render",Ct]]);export{ns as default};
