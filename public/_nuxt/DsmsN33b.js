import{u as L,r as m,c as p,b1 as y,b2 as H}from"./DV-4n8jq.js";function S(n,e){const o=e/n*100;return 2/Math.PI*100*Math.atan(o/50)}function q(n={}){const{duration:e=2e3,throttle:o=200,hideDelay:P=500,resetDelay:b=400}=n,k=n.estimatedProgress||S,i=L(),a=m(0),r=m(!1),d=m(!1);let f=!1,g,v,h,_;const I=()=>{d.value=!1,T(0)};function T(t=0){if(!i.isHydrating){if(t>=100)return s();u(),a.value=t<0?0:t,o?v=setTimeout(()=>{r.value=!0,D()},o):(r.value=!0,D())}}function x(){h=setTimeout(()=>{r.value=!1,_=setTimeout(()=>{a.value=0},b)},P)}function s(t={}){a.value=100,f=!0,u(),F(),t.error&&(d.value=!0),t.force?(a.value=0,r.value=!1):x()}function F(){clearTimeout(h),clearTimeout(_)}function u(){clearTimeout(v),cancelAnimationFrame(g)}function D(){f=!1;let t;function l(c){if(f)return;t??(t=c);const M=c-t;a.value=Math.max(0,Math.min(100,k(e,M))),g=requestAnimationFrame(l)}g=requestAnimationFrame(l)}let A=()=>{};{const t=i.hook("page:loading:start",()=>{I()}),l=i.hook("page:loading:end",()=>{s()}),c=i.hook("vue:error",()=>s());A=()=>{c(),t(),l(),u()}}return{_cleanup:A,progress:p(()=>a.value),isLoading:p(()=>r.value),error:p(()=>d.value),start:I,set:T,finish:s,clear:u}}function C(n={}){const e=L(),o=e._loadingIndicator=e._loadingIndicator||q(n);return y()&&(e._loadingIndicatorDeps=e._loadingIndicatorDeps||0,e._loadingIndicatorDeps++,H(()=>{e._loadingIndicatorDeps--,e._loadingIndicatorDeps===0&&(o._cleanup(),delete e._loadingIndicator)})),o}export{C as u};
