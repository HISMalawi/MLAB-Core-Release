import{_ as ee}from"./Breadcrumb.vue.6f7f01db.js";import{a as E,b as _,_ as O,g as y,o as v,c as T,e as s,d as e,h as u,i as G,F as L,r as N,p as U,k as B,f as R,m as te,s as w,l as f,t as z,u as se}from"./entry.5bdb8488.js";import{_ as ae}from"./Dropdown.4d3ae079.js";import{_ as K}from"./OutlinedButton.f18d48ca.js";import{e as g}from"./constants.b04a9525.js";import{r as P,e as x,f as b,d as oe}from"./fetch.7dc9d831.js";import{r as H}from"./ArrowDownTrayIcon.1d4f2a31.js";import{r as M}from"./XMarkIcon.49b75dff.js";import{S as X,h as q,U as J,G as Q,V as W}from"./transition.ad4c8a99.js";import{_ as ie}from"./index.7b59240b.js";import{_ as le}from"./SearchBar.5d48c2eb.js";import{a as ne}from"./PencilSquareIcon.551b626a.js";import{_ as re}from"./Datatable.d21eac23.js";import"./nuxt-link.e30313a8.js";import"./HomeIcon.db590299.js";import"./listbox.61dbc330.js";import"./hidden.b0c25628.js";import"./use-text-value.54a66864.js";import"./CheckIcon.79090b5a.js";import"./CheckCircleIcon.ba0cf2d5.js";import"./MagnifyingGlassIcon.d967f597.js";import"./network.3c519541.js";import"./PrinterIcon.df26e017.js";import"./virus.d91a3fb0.js";import"./Loader.2016ba72.js";const ce={components:{TransitionRoot:X,TransitionChild:q,Dialog:J,DialogPanel:Q,DialogTitle:W},data(){return{open:!1,loading:!1,saving:!1,cookie:E("token"),disabled:!0,diseases:new Array,testTypes:new Array,selectedTestType:{name:""},items:new Array,plusIcon:P,saveIcon:H,addIcon:P,removeIcon:M,surveillanceItems:new Array}},methods:{adjustVisibility(){this.open=!this.open},addItem(){this.surveillanceItems.push({testType:this.testTypes[0],diseases:this.diseases[0]})},removeItem(i){this.surveillanceItems.splice(i,1)},async loadDiseases(){this.loading=!0;const i={route:x.disease.index,method:"GET",token:`${this.cookie}`},{data:c,error:n,pending:a}=await b(i);return c.value&&(this.diseases=c.value),this.loading=!1,n.value&&(this.loading=!1,_().$toast.error(`${g}`)),{data:c,error:n,pending:a}},async loadTestTypes(){this.adjustVisibility();const i=await this.loadDiseases();this.loading=!0;const c={route:x.testTypes,method:"GET",token:`${this.cookie}`},{data:n,error:a,pending:t}=await b(c);n.value&&(console.log(n.value),this.testTypes=n.value.test_types,this.surveillanceItems.push({testType:this.testTypes[0],diseases:i.data.value[0]})),this.loading=!1,a.value&&(this.loading=!1,_().$toast.error(`${g}`))},async handleSubmitForm(){this.saving=!0;const i=this.surveillanceItems.map(o=>({test_types_id:o.testType.id,diseases_id:o.diseases.id})),c={route:x.surveillance.create,method:"POST",token:`${this.cookie}`,body:{surveillance:{data:i}}},{data:n,pending:a,error:t}=await b(c);this.saving=a,n.value&&(this.closeForm(),_().$toast.success("Surviellance add successfully!"),this.$emit("update",!0),this.saving=!1),t.value&&(_().$toast.error(`${g}`),this.saving=!1)},closeForm(){this.open=!1,this.items=[{test_types_id:"",diseases_id:""}]}}},de=s("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),ue={class:"fixed inset-0 overflow-y-auto"},pe={class:"flex min-h-full items-center justify-center p-4 text-center"},me={class:"border-b px-3 py-3 flex items-center justify-between"},_e={class:"mt-2 space-y-3 px-5 py-5"},ve={class:"w-full col-span-4 flex items-center space-x-3"},he={class:"w-1/2"},fe=s("label",{for:""},"Test type",-1),ye={class:"w-1/2"},ge=s("label",{for:""},"Disease",-1),xe={class:"flex items-center space-x-3 pt-7"},be={class:"mt-3 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function ke(i,c,n,a,t,o){const d=R,r=y("TransitionChild"),S=y("DialogTitle"),$=y("XMarkIcon"),I=ae,C=K,D=y("FormKit"),V=y("DialogPanel"),A=y("Dialog"),F=y("TransitionRoot");return v(),T("div",null,[s("div",null,[e(d,{text:"Add Surveillance",color:"primary",icon:t.plusIcon,click:o.loadTestTypes},null,8,["icon","click"])]),e(F,{appear:"",show:t.open,as:"template"},{default:u(()=>[e(A,{as:"div",onClose:o.closeForm,class:"relative z-10"},{default:u(()=>[e(r,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>[de]),_:1}),s("div",ue,[s("div",pe,[e(r,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[e(V,{class:"w-full max-w-4xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[s("div",me,[e(S,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:u(()=>[G(" Surveillance Setup ")]),_:1}),s("button",{onClick:c[0]||(c[0]=(...h)=>o.adjustVisibility&&o.adjustVisibility(...h))},[e($,{class:"w-5 h-5"})])]),e(D,{type:"form","submit-label":"Save",onSubmit:o.handleSubmitForm,actions:!1},{default:u(()=>[s("div",_e,[(v(!0),T(L,null,N(t.surveillanceItems,(h,p)=>(v(),T("div",{class:"grid grid-cols-5 gap-2",key:p},[s("div",ve,[s("div",he,[fe,e(I,{items:t.testTypes,"model-value":h.testType},null,8,["items","model-value"])]),s("div",ye,[ge,e(I,{items:t.diseases,"model-value":h.diseases},null,8,["items","model-value"])]),s("div",xe,[e(d,{icon:t.addIcon,text:"Add",color:"primary",click:()=>{o.addItem()},type:"button"},null,8,["icon","click"]),t.surveillanceItems.length>1?(v(),U(d,{key:0,icon:t.removeIcon,text:"Remove",color:"error",click:()=>{o.removeItem(p)}},null,8,["icon","click"])):B("",!0)])])]))),128))]),s("div",be,[e(C,{type:"button",text:"Close",click:o.closeForm},null,8,["click"]),e(d,{type:"submit",color:"success",icon:t.saveIcon,click:()=>{},text:"Save",loading:t.saving},null,8,["icon","loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const we=O(ce,[["render",ke]]),Te=s("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Se={class:"fixed inset-0 overflow-y-auto"},Ie={class:"flex min-h-full items-center justify-center p-4 text-center"},$e={class:"border-b px-3 py-3 flex items-center justify-between"},Ce={class:"mt-2 space-y-3 px-5 py-5"},De={class:"w-full grid grid-cols-1 gap-1"},Ve={class:"mt-3 justify-end flex items-center space-x-3 px-3 py-2 border-t"},Ae=te({__name:"index",props:{id:{}},emits:["action-completed"],setup(i,{emit:c}){const n=w(!1),a=w(!1),t=E("token");w(!0);const o=w([]),d=w([]),r=w({test_type_id:-1,disease_id:-1}),S=w([{test_types_id:"",diseases_id:""}]),$=i,I=c,C=()=>{D(),V(),n.value=!n.value},D=async()=>{a.value=!0;const p={route:x.disease.index,method:"GET",token:`${t.value}`},l=await b(p);l.data.value&&(o.value=[],o.value.push({label:"- Select from the list",value:""}),l.data.value.map((m,k)=>o.value.push({label:m.name,value:m.id}))),a.value=!1,l.error.value&&(a.value=!1,_().$toast.error(`${g}`))},V=async()=>{a.value=!0;const p={route:x.testTypes,method:"GET",token:`${t.value}`},l=await b(p);l.data.value&&(d.value.push({label:"- Select from the list",value:""}),l.data.value.test_types.map((m,k)=>d.value.push({label:m.name,value:m.id}))),a.value=!1,l.error.value&&(a.value=!1,_().$toast.error(`${g}`))},A=async()=>{a.value=!0;const p={route:`${x.surveillance.edit}/${$.id}`,method:"GET",token:`${t.value}`},l=await b(p);l.data.value&&(r.value.test_type_id=l.data.value.test_types_id,r.value.disease_id=l.data.value.diseases_id,C()),a.value=!1,l.error.value&&(a.value=!1,_().$toast.error(`${g}`))},F=async()=>{a.value=!0;const p={route:x.surveillance.update,method:"PATCH",token:t.value,body:{surveillance:{data:[{diseases_id:r.value.disease_id,test_types_id:r.value.test_type_id}]}}},{data:l,pending:m,error:k}=await b(p);a.value=m,l.value&&(h(),_().$toast.success("Surveillance add successfully!"),I("action-completed",[])),k.value&&(_().$toast.error(`${g}`),a.value=!1)},h=()=>{n.value=a.value=!1,S.value=[{test_types_id:r.value.test_type_id,diseases_id:r.value.disease_id}]};return(p,l)=>{const m=R,k=y("FormKit"),Y=K;return v(),T("div",null,[s("div",null,[e(m,{text:"Edit",color:"primary",icon:f(ne),click:A},null,8,["icon"])]),e(f(X),{appear:"",show:n.value,as:"template"},{default:u(()=>[e(f(J),{as:"div",onClose:h,class:"relative z-10"},{default:u(()=>[e(f(q),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>[Te]),_:1}),s("div",Se,[s("div",Ie,[e(f(q),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[e(f(Q),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[s("div",$e,[e(f(W),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:u(()=>[G(z("Edit Surveillance Details"))]),_:1}),s("button",{onClick:h},[e(f(M),{class:"w-5 h-5"})])]),e(k,{type:"form","submit-label":"Save",onSubmit:F,actions:!1},{default:u(()=>[s("div",Ce,[s("div",De,[(v(!0),T(L,null,N(S.value,(Ge,Z)=>(v(),T("div",{class:"relative shadow-none border-2 p-3 mb-3 border-gray-100 text-left box-border space-x-4 grid grid-cols-4 rounded",key:Z},[d.value.length?(v(),U(k,{key:0,type:"select",label:"Test type",modelValue:r.value.test_type_id,"onUpdate:modelValue":l[0]||(l[0]=j=>r.value.test_type_id=j),placeholder:"Select test type",validation:"required",options:d.value,class:"w-full"},null,8,["modelValue","options"])):B("",!0),o.value.length?(v(),U(k,{key:1,type:"select",label:"Disease",modelValue:r.value.disease_id,"onUpdate:modelValue":l[1]||(l[1]=j=>r.value.disease_id=j),placeholder:"Select disease",validation:"required",options:o.value},null,8,["modelValue","options"])):B("",!0)]))),128))])]),s("div",Ve,[e(Y,{type:"button",text:"Close",click:h}),e(m,{type:"submit",color:"success",icon:f(H),click:()=>{},text:"Save",loading:a.value},null,8,["icon","loading"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),Fe={setup(){se({title:"IBLIS - Surveillance"})},data(){return{pages:new Array({name:"Home",link:"/home"},{name:"Test Catalog",link:"#"}),serverItemsLength:0,loading:!1,items:new Array,cookie:E("token"),header:"Surveillance",search:"",searchValue:"",headers:[{text:"Test Type",value:"test_type",sortable:!0},{text:"Disease",value:"disease"},{text:"Actions",value:"actions",width:18}],serverOptions:{page:1,rowsPerPage:25,sortBy:"test_type"}}},created(){this.init()},methods:{updateSearch(i){this.searchValue=i,this.search=i,this.init()},async init(){this.loading=!0;const{page:i,rowsPerPage:c}=this.serverOptions,n={route:oe(x.surveillance.index,{page:i,page_size:c,search:this.search}),method:"GET",token:`${this.cookie}`},{data:a,error:t,pending:o}=await b(n);a.value&&(this.items=[],a.value.data.map((d,r)=>{this.items.push({id:d.id,test_type:d.test_type.name,disease:d.disease.name})}),this.serverItemsLength=a.value.total),this.loading=!1,t.value&&(this.loading=!1,_().$toast.error(`${g}`))},updateSurveillance(i){typeof i=="object"&&(this.serverOptions=i),this.init()}}},je={class:"px-5 py-5"},Ue={class:"flex items-center justify-between py-5"},Be={class:"text-2xl font-semibold"},qe={class:"flex items-center space-x-3"},Ee={class:"flex justify-end w-full px-2 py-2 mb-2"},Pe={class:"py-2 flex items-center space-x-2"};function Oe(i,c,n,a,t,o){const d=ee,r=we,S=ie,$=le,I=Ae,C=re;return v(),T("div",je,[e(d,{pages:t.pages},null,8,["pages"]),s("div",Ue,[s("h3",Be,z(t.header),1),s("div",qe,[e(r,{onUpdate:o.updateSurveillance},null,8,["onUpdate"]),e(S)])]),s("div",Ee,[e($,{search:t.search,onUpdate:o.updateSearch},null,8,["search","onUpdate"])]),e(C,{headers:t.headers,data:t.items,serverOptions:t.serverOptions,loading:t.loading,serverItemsLength:t.serverItemsLength,searchField:"test_type",searchValue:t.searchValue,onUpdate:o.updateSurveillance},{actions:u(({item:D})=>[s("div",Pe,[e(I,{id:D.id,onUpdate:o.updateSurveillance},null,8,["id","onUpdate"])])]),_:1},8,["headers","data","serverOptions","loading","serverItemsLength","searchValue","onUpdate"])])}const pt=O(Fe,[["render",Oe]]);export{pt as default};
