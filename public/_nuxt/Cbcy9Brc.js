import{_ as V}from"./BBiETNY7.js";import{a as C,u as p,l as q,m as f,b as t,e as r,f as l,g as e,t as n,F as h,j as v,z as T,x as w,s as _,p as B,n as b,_ as F}from"./Br_iYJbE.js";import{u as N}from"./C7tJ_rpQ.js";import{e as k,f as S}from"./Dog3sDT3.js";import{u as g}from"./CLSVoOUE.js";import{P as j}from"./CsuZ4PXZ.js";import{r as O}from"./Br7KoB9m.js";import{r as A}from"./IuRR0rJH.js";import{a as D}from"./BxXqpYSD.js";import{_ as z}from"./BUesi3xw.js";import"./C3HP_w3b.js";import"./CsEX3TnJ.js";import"./D_g9DqRP.js";import"./tiZpgdZ8.js";import"./a0kEX_gA.js";import"./2-4F2Czp.js";import"./AtAlRHB5.js";import"./BoyxTlis.js";import"./CKyme56o.js";import"./BIfGgD6z.js";const H={name:"settings",setup(){N({title:`${j.name.toUpperCase()} - Settings`})},data(){return{saveIcon:O,pages:[{name:"Home",link:"/home"}],tabs:["Personal Information","Credentials"],activeTab:0,loading:!1,updating:!1,cookie:C("token"),oldPassword:"",newPassword:"",username:"",authStore:g()}},methods:{async changePassword(){this.loading=!0;const u={route:`${k.users}/change_password/${this.authStore.user.id}`,method:"PUT",token:`${this.cookie}`,body:{user:{old_password:this.oldPassword,password:this.newPassword}}},{data:a,error:i,pending:m}=await S(u);if(this.loading=m,a.value){const{logUserOut:s}=g();this.loading=!1,p().$toast.success("Password changed successfully!"),s(),this.$router.push("/")}i.value&&(this.loading=!1,p().$toast.error(`${i.value.data.error}`),console.error(i.value))},async changeUsername(){this.updating=!0;const u={route:`${k.users}/change_username/${this.authStore.user.id}`,method:"PUT",token:`${this.cookie}`,body:{user:{username:this.username}}},{data:a,error:i,pending:m}=await S(u);if(this.updating=m,a.value){const{logUserOut:s}=g();this.updating=!1,p().$toast.success("Username changed successfully!"),s(),this.$router.push("/")}i.value&&(this.updating=!1,p().$toast.error(`${i.value.data.error}`),console.error(i.value))}},components:{IdentificationIcon:A,PencilSquareIcon:D}},K={class:"px-5 py-5"},L={class:"mt-5 flex items-center space-x-3"},R=e("div",null,[e("img",{src:z,class:"w-16 h-16 mr-2 object-cover rounded-full",alt:"user-icon"})],-1),E={class:"space-y-0.5"},M={class:"text-lg font-semibold uppercase"},G={class:"font-normal"},J={class:"py-5"},Q={class:"w-full flex items-center border-b"},W=["onClick"],X={key:0},Y={class:"py-3 space-y-2.5"},Z={class:"grid grid-cols-3 gap-2"},$={class:"w-full flex flex-col space-y-1"},ee=e("label",{class:"font-semibold text-lg"},"Username",-1),se={class:"underline"},oe={class:"w-full flex flex-col space-y-1"},te=e("label",{class:"font-semibold text-lg"},"First name",-1),ae={class:"underline"},le={class:"w-full flex flex-col space-y-1"},ne=e("label",{class:"font-semibold text-lg"},"Middle name",-1),re={class:"underline"},ie={class:"w-full flex flex-col space-y-1"},ce=e("label",{class:"font-semibold text-lg"},"Last name",-1),de={class:"underline"},ue={class:"w-full flex flex-col space-y-1"},me=e("label",{class:"font-semibold text-lg"},"Date Of Birth",-1),pe={class:"underline"},_e={class:"w-full flex flex-col space-y-1"},fe=e("label",{class:"font-semibold text-lg"},"Roles",-1),he={class:"flex flex-wrap gap-2"},ve={class:"w-full flex flex-col space-y-1"},be=e("label",{class:"font-semibold text-lg"},"Departments",-1),ge={class:"flex flex-wrap gap-2"},ye={key:1},xe={class:"border-b pb-2"},we=e("div",{class:"py-3"},[e("h3",{class:"text-xl font-semibold"},"Username"),e("p",null,"Please enter your desired username below and save changes. ")],-1),ke={class:"flex items-center justify-end space-x-2 mt-5"},Se=e("div",{class:"py-3"},[e("h3",{class:"text-xl font-semibold"},"Password"),e("p",null,"Please enter your current password to change your password")],-1),Pe={class:"py-3 space-y-2.5"},Ue={class:"flex items-center justify-end space-x-2 mt-5"};function Ie(u,a,i,m,s,y){const P=V,U=f("IdentificationIcon"),I=f("PencilSquareIcon"),c=f("FormKit"),x=F;return t(),r("div",K,[l(P,{pages:s.pages},null,8,["pages"]),e("div",L,[R,e("div",E,[e("h3",M,n(s.authStore.user.username),1),e("p",G,n(`${s.authStore.user.first_name} ${s.authStore.user.last_name}`),1)])]),e("div",J,[e("div",Q,[(t(!0),r(h,null,v(s.tabs,(d,o)=>(t(),r("button",{key:o,onClick:Ve=>s.activeTab=o,class:T(s.activeTab==o?"flex items-center px-1.5 py-2 text-white border-b-2 border-sky-600 bg-sky-500 font-medium":"px-2 py-2 hover:bg-sky-200 font-medium hover:text-sky-500 transition duration-150 flex items-center")},[o==0?(t(),w(U,{key:0,class:"w-5 h-5 mr-2"})):_("",!0),o==1?(t(),w(I,{key:1,class:"w-5 h-5 mr-2"})):_("",!0),B(" "+n(d),1)],10,W))),128))]),s.activeTab===0?(t(),r("div",X,[e("div",Y,[e("div",Z,[e("div",$,[ee,e("p",se,n(s.authStore.user.username),1)]),e("div",oe,[te,e("p",ae,n(s.authStore.user.first_name),1)]),e("div",le,[ne,e("p",re,n(s.authStore.user.middle_name),1)]),e("div",ie,[ce,e("p",de,n(s.authStore.user.last_name),1)]),e("div",ue,[me,e("p",pe,n(s.authStore.user.date_of_birth),1)])]),e("div",_e,[fe,e("div",he,[(t(!0),r(h,null,v(s.authStore.user.roles,(d,o)=>(t(),r("div",{key:o,class:"border rounded px-3 py-1.5"},n(d.role_name),1))),128))])]),e("div",ve,[be,e("div",ge,[(t(!0),r(h,null,v(s.authStore.user.departments,(d,o)=>(t(),r("div",{key:o,class:"border rounded px-3 py-1.5"},n(d.name),1))),128))])])])])):_("",!0),s.activeTab===1?(t(),r("div",ye,[e("div",xe,[we,l(c,{type:"form","submit-label":"Update",onSubmit:y.changeUsername,actions:!1},{default:b(({value:d})=>[l(c,{type:"text",name:"username",label:"Username",validation:"required",modelValue:s.username,"onUpdate:modelValue":a[0]||(a[0]=o=>s.username=o)},null,8,["modelValue"]),e("div",ke,[l(x,{type:"submit",icon:s.saveIcon,text:"Save changes",color:"success",click:()=>{},loading:s.updating},null,8,["icon","loading"])])]),_:1},8,["onSubmit"])]),Se,l(c,{type:"form","submit-label":"Update",onSubmit:y.changePassword,actions:!1},{default:b(({value:d})=>[e("div",Pe,[l(c,{type:"password",label:"Old password",validation:"required",modelValue:s.oldPassword,"onUpdate:modelValue":a[1]||(a[1]=o=>s.oldPassword=o)},null,8,["modelValue"]),l(c,{type:"group"},{default:b(()=>[l(c,{type:"password",name:"password",label:"Password",validation:"required",modelValue:s.newPassword,"onUpdate:modelValue":a[2]||(a[2]=o=>s.newPassword=o),"validation-visibility":"live"},null,8,["modelValue"]),l(c,{type:"password",label:"Confirm new password",name:"password_confirm",validation:"required|confirm","validation-label":"Password confirmation","validation-visibility":"live"})]),_:1})]),e("div",Ue,[l(x,{type:"submit",icon:s.saveIcon,text:"Save changes",color:"success",click:()=>{},loading:s.loading},null,8,["icon","loading"])])]),_:1},8,["onSubmit"])])):_("",!0)])])}const We=q(H,[["render",Ie]]);export{We as default};
