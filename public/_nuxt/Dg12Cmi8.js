import{_ as I}from"./CUGREwii.js";import{a as q,P as c,C as v,O as b,u as _,E as y,x as O,y as x,b as m,e as h,f as r,g as e,t as a,k as $,F as N,j as R,i as A,v as U,K as P,_ as j}from"./JEpZiKDn.js";import{_ as C,a as E}from"./CE6jSk6s.js";import{u as M}from"./Bl4Rx-lb.js";import{S as f}from"./DyLJy2jF.js";import{P as T}from"./DObdreHM.js";import{r as B}from"./CMCcGaRQ.js";import{r as F}from"./BhA5OI8I.js";import{r as K}from"./CyqCFtoG.js";import{r as Q}from"./DCXmAMWk.js";import{r as H}from"./D6_522nX.js";import{_ as L}from"./IQzdcCmk.js";import"./DGM4Jn_4.js";import"./Cd90EHgg.js";import"./wJ75NN9-.js";import"./Drn6De9M.js";const G={setup(){M({title:`${T.name.toUpperCase()} - Approve Stock Order`})},components:{TicketIcon:B},data(){return{header:"Approve Stock Order",checkIcon:F,allIcon:K,rejectIcon:Q,pages:[{name:"Home",link:"/home"},{name:"Stock Orders",link:"/stock-management/orders"}],cookie:q("token"),deleteicon:H,loading:!1,approving:!1,verifying:!1,requisitions:new Array,voidReason:"",issuerName:"",issuerDesignation:"",issuerPhone:"",issuerSignature:"",approverName:"",approverDesignation:"",approverPhone:"",approverSignature:"",issuedDate:"",approvedDate:""}},created(){this.init()},methods:{async init(){this.loading=!0;const o=new f,{data:i,error:d,pending:n}=await o.getStockOrder(`${this.cookie}`,`${(this._.provides[c]||this.$route).query.order_id}`);this.loading=n,i.value&&(this.requisitions=i.value.stock_requisitions,this.loading=!1,i.value.stock_pharmacy_approver_and_issuers.map(s=>{s.record_type=="issuer"?(this.issuerName=s.name,this.issuerPhone=s.phone_number,this.issuerDesignation=s.designation,this.issuerSignature=s.signature,this.issuedDate=v(s.created_date).format(b)):(this.approverName=s.name,this.approverPhone=s.phone_number,this.approverDesignation=s.designation,this.approverSignature=s.signature,this.approvedDate=v(s.created_date).format(b))})),d.value&&(console.error(d.value),this.loading=!1)},async approveStockOrder(){this.approving=!0;const o=new f;let i=this.requisitions.map(p=>p.id);const{data:d,error:n,pending:s}=await o.approveStockOrder(`${this.cookie}`,{stock_order_id:`${(this._.provides[c]||this.$route).query.order_id}`,stock_requisition_ids:i});this.approving=s,d.value&&(this.approving=!1,this.$router.push("/stock-management/orders"),_().$toast.success(`Stock order request #${(this._.provides[c]||this.$route).params.voucherId} approved successfully`)),n.value&&(console.error(n.value),_().$toast.error(y),this.approving=!1)},async approveRequisition(o){this.loading=!0;const i=new f,{data:d,error:n,pending:s}=await i.approveStockOrderRequisition(`${this.cookie}`,{stock_requisition_id:o});this.loading=s,d.value&&(this.loading=!1,_().$toast.success("Stock order requisition approved successfully")),n.value&&(console.error(n.value),_().$toast.error(y),this.loading=!1)}}},z={class:"px-5 py-5"},J={class:"py-5 flex items-center justify-between"},W={class:"text-2xl font-semibold"},X={class:"px-4 py-2 bg-gray-50 flex items-center justify-between"},Y={class:"flex items-center space-x-2"},Z={class:"flex items-center space-x-3 justify-end"},ee={class:"rounded border mt-5"},se=e("div",{class:"flex items-center space-x-3 bg-gray-50 py-2 rounded-t px-2 border-b"},[e("img",{src:L,class:"w-6 h-6"}),e("h3",{class:"text-lg font-semibold"},"Pharmacy")],-1),oe={class:"w-full grid grid-cols-2 gap-5 py-5 px-5"},te={class:"col-span-1 flex flex-col space-y-2"},re={class:"w-full flex items-center space-x-2"},ae=e("p",{class:"w-72 font-medium"},"Issued by: ",-1),ie={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ne={class:"w-full flex items-center space-x-2"},de=e("p",{class:"w-72 font-medium"},"Designation: ",-1),le={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ce={class:"w-full flex items-center space-x-2"},pe=e("p",{class:"w-72 font-medium"},"Signature: ",-1),ue={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},_e={class:"w-full flex items-center space-x-2"},me=e("p",{class:"w-72 font-medium"},"Date:",-1),he={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},fe={class:"col-span-1 flex flex-col space-y-2"},ge={class:"w-full flex items-center space-x-2"},ve=e("p",{class:"w-72 font-medium"},"Approved by: ",-1),be={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ye={class:"w-full flex items-center space-x-2"},xe=e("p",{class:"w-72 font-medium"},"Designation: ",-1),ke={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},we={class:"w-full flex items-center space-x-2"},Se=e("p",{class:"w-72 font-medium"},"Signature: ",-1),Ve={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},De={class:"w-full flex items-center space-x-2"},Ie=e("p",{class:"w-72 font-medium"},"Date:",-1),qe={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Oe={key:0,class:"grid grid-cols-5 gap-4 mt-5"},$e={class:"flex flex-col space-y-2"},Ne={class:"flex items-center space-x-2 pt-8"};function Re(o,i,d,n,s,p){const k=I,w=x("TicketIcon"),g=j,S=C,u=x("FormKit"),V=E;return m(),h("div",z,[r(k,{pages:s.pages},null,8,["pages"]),e("div",J,[e("h3",W,a(s.header),1)]),e("div",X,[e("div",Y,[r(w,{class:"h-5 w-5"}),e("p",null,[$("Voucher Number: "),e("strong",null,a((o._.provides[c]||o.$route).params.voucherId),1)])]),e("div",Z,[r(g,{loading:s.approving,icon:s.allIcon,text:"Approve Order",color:"success",click:p.approveStockOrder},null,8,["loading","icon","click"]),r(S,{stockId:`${(o._.provides[c]||o.$route).query.order_id}`,orderId:`${(o._.provides[c]||o.$route).params.voucherId}`},null,8,["stockId","orderId"])])]),e("div",ee,[se,e("div",oe,[e("div",te,[e("div",re,[ae,e("span",ie,a(s.issuerName),1)]),e("div",ne,[de,e("span",le,a(s.issuerDesignation),1)]),e("div",ce,[pe,e("span",ue,a(s.issuerSignature),1)]),e("div",_e,[me,e("span",he,a(s.issuedDate),1)])]),e("div",fe,[e("div",ge,[ve,e("span",be,a(s.approverName),1)]),e("div",ye,[xe,e("span",ke,a(s.approverDesignation),1)]),e("div",we,[Se,e("span",Ve,a(s.issuerSignature),1)]),e("div",De,[Ie,e("span",qe,a(s.approvedDate),1)])])])]),(m(!0),h(N,null,R(s.requisitions,(t,D)=>A((m(),h("div",{class:"flex flex-col space-y-3",key:D},[t.requisition_status.toLowerCase()!=="rejected"?(m(),h("div",Oe,[e("div",$e,[r(u,{label:"Stock item",disabled:!0,modelValue:t.item.name,"onUpdate:modelValue":l=>t.item.name=l},null,8,["modelValue","onUpdate:modelValue"])]),r(u,{label:"Quantity requested",type:"number",disabled:!0,modelValue:t.quantity_requested,"onUpdate:modelValue":l=>t.quantity_requested=l},null,8,["modelValue","onUpdate:modelValue"]),r(u,{label:"Quantity issued",type:"number",disabled:!0,modelValue:t.quantity_issued,"onUpdate:modelValue":l=>t.quantity_issued=l},null,8,["modelValue","onUpdate:modelValue"]),r(u,{label:"Quantity collected",type:"number",disabled:!0,modelValue:t.quantity_collected,"onUpdate:modelValue":l=>t.quantity_collected=l},null,8,["modelValue","onUpdate:modelValue"]),e("div",Ne,[r(g,{text:"Approve",icon:s.checkIcon,color:"success",click:()=>{p.approveRequisition(t.id)}},null,8,["icon","click"]),r(V,{onUpdate:p.init,data:t,orderId:`${(o._.provides[c]||o.$route).params.voucherId}`},null,8,["onUpdate","data","orderId"])])])):P("",!0)])),[[U,!s.loading]])),128))])}const Je=O(G,[["render",Re]]);export{Je as default};
