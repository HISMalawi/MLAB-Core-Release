import{a as C,b as p,_ as D,g as a,o as T,c as I,d as o,h as r,e as l,i as S,f as V}from"./entry.64b6b942.js";import{h as F,E as R}from"./jspdf.es.min.168aff09.js";import{a as q,e as f,f as _}from"./fetch.8fd817fe.js";import{r as A}from"./XMarkIcon.64f3f5c2.js";import{r as g}from"./PrinterIcon.5a175993.js";import{S as B,h as E,U,G as j,V as G}from"./transition.5b1867a1.js";const N={components:{TransitionRoot:B,TransitionChild:E,Dialog:U,DialogPanel:j,DialogTitle:G,XMarkIcon:A,ExclamationTriangleIcon:q,PrinterIcon:g},data(){return{show:!1,printIcon:g,cookie:C("token"),printers:new Array,selectedPrinter:"",loading:!1,zebraPrinting:!1}},methods:{async init(){this.handleClick();const c={route:f.printers,method:"GET",token:`${this.cookie}`},{data:e,error:s,pending:n}=await _(c);e.value&&(this.printers=new Array,e.value.map(t=>{this.printers.push(t.name)})),s.value&&console.error(s.value)},async generatePDF(){this.loading=!0;const c=document.querySelector(".print-container"),e=await F(c),s=e.toDataURL("image/jpeg"),n=new R,t=n.internal.pageSize.getWidth(),i=e.height*t/e.width;n.addImage(s,"JPEG",0,0,t,i);const d=n.output("blob");await this.submitForm(d)},async submitForm(c){let e=new FormData;e.append("pdf",c,"patient-name"),e.append("printer_name",this.selectedPrinter);const s={route:f.generalPrint,method:"POST",token:`${this.cookie}`,body:e},{data:n,error:t,pending:i}=await _(s);this.loading=i,n.value&&(n.value.printed?p().$toast.success("Report printed successfully!"):p().$toast.warning("Could not print report!"),this.loading=!1,this.$emit("update",!0),this.handleClick()),t.value&&(this.loading=!1,console.error(t.value),p().$toast.error("An error occurred while printing report"),this.handleClick())},handleClick(){this.show=!this.show}}},z=l("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),M={class:"fixed inset-0 overflow-y-auto"},X={class:"flex top-0 items-center justify-center p-4 text-center"},K={class:"border-b px-3 py-3 flex items-center justify-between"},W={class:"py-5 px-5"},H={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function J(c,e,s,n,t,i){const d=V,m=a("TransitionChild"),v=a("PrinterIcon"),y=a("DialogTitle"),w=a("XMarkIcon"),u=a("FormKit"),x=a("DialogPanel"),b=a("Dialog"),k=a("TransitionRoot");return T(),I("div",null,[o(d,{click:i.init,color:"primary",text:"Print",icon:t.printIcon},null,8,["click","icon"]),o(k,{appear:"",show:t.show,as:"template"},{default:r(()=>[o(b,{as:"div",class:"relative z-10"},{default:r(()=>[o(m,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:r(()=>[z]),_:1}),l("div",M,[l("div",X,[o(m,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:r(()=>[o(x,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:r(()=>[l("div",K,[o(y,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:r(()=>[o(v,{class:"h-5 w-5 mr-2"}),S(" Print ")]),_:1}),l("button",{onClick:e[0]||(e[0]=(...h)=>i.handleClick&&i.handleClick(...h))},[o(w,{class:"w-5 h-5"})])]),o(u,{type:"form","submit-label":"Update",onSubmit:i.generatePDF,actions:!1},{default:r(({value:h})=>[l("div",W,[o(u,{validation:"required",label:"Select a printer",type:"radio",modelValue:t.selectedPrinter,"onUpdate:modelValue":e[1]||(e[1]=P=>t.selectedPrinter=P),options:t.printers},null,8,["modelValue","options"])]),l("div",H,[o(d,{click:()=>{},loading:t.loading,type:"submit",icon:t.printIcon,text:"Print",color:"success"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const ee=D(N,[["render",J]]);export{ee as _};
