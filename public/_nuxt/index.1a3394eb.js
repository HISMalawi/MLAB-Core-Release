import{_ as ce}from"./Breadcrumb.b0c0412c.js";import{o as p,c as g,d as e,_ as O,f as c,t as u,w as D,v as U,b as r,n as te,u as B,a as I,g as h,h as L,e as V,k as R,F as q,r as F,j as $,an as de,ao as ue,p as A}from"./entry.791399ec.js";import{r as me,_ as pe}from"./Dropdown.607d272b.js";import{_ as he}from"./SearchBar.3bd38df9.js";import{r as N}from"./XMarkIcon.235914cb.js";import{_ as _e}from"./Loader.0e90c75f.js";import{_ as se}from"./OutlinedButton.9b05dec9.js";import{e as E,d as X,f as fe}from"./constants.713ae7a7.js";import{u as z,e as w,f as k,l as ge,m as be,n as ye,h as j,r as oe,o as ne,P as Z,i as G,d as ie,s as xe,S as ve}from"./fetch.b60ef317.js";import{r as re}from"./UserIcon.cb5ef96e.js";import{a as H,r as we}from"./PencilSquareIcon.ffacbd25.js";import{r as ae}from"./ArrowDownTrayIcon.8463c16f.js";import{r as le}from"./ArrowUturnLeftIcon.a3472ebe.js";import{S as Y,h as K,U as W,G as J,V as Q}from"./transition.f6288412.js";import{r as ke}from"./PrinterIcon.9d4d78fd.js";import{_ as Te}from"./Datatable.3b86044c.js";import{u as Se}from"./vue.f36acd1f.8530d91e.js";import{P as Ce}from"./package.d411c004.js";import{r as Ie}from"./MagnifyingGlassIcon.4c928ac3.js";import{r as Ae}from"./ChevronDownIcon.51947d7c.js";import{r as $e}from"./CheckIcon.4b9566d6.js";import{r as Re}from"./CheckCircleIcon.f3db3db8.js";import{r as ee}from"./SquaresPlusIcon.b0571e34.js";import{r as je}from"./AdjustmentsVerticalIcon.e5380d27.js";import{r as M}from"./CheckBadgeIcon.d038bfcb.js";import{a as De,r as Ue}from"./ChevronRightIcon.f061e5fc.js";import{r as Oe}from"./ArchiveBoxXMarkIcon.6b4158d5.js";import{r as P}from"./HandThumbDownIcon.79656318.js";import{r as Le}from"./ArrowPathIcon.04123d3a.js";import{B as Ne,N as Pe,K as qe,H as Fe,U as Be}from"./listbox.e9c3a7ec.js";import{M as Ve,R as Ee,h as Me,y as Xe}from"./menu.8df02a07.js";import{j as ze,y as Ge,W as He}from"./popover.59cfb4b9.js";import"./nuxt-link.1af0fd3d.js";import"./HomeIcon.bfaa9779.js";import"./hidden.63232384.js";import"./use-text-value.83d37c68.js";function Ye(t,o){return p(),g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M12.97 3.97a.75.75 0 011.06 0l7.5 7.5a.75.75 0 010 1.06l-7.5 7.5a.75.75 0 11-1.06-1.06l6.22-6.22H3a.75.75 0 010-1.5h16.19l-6.22-6.22a.75.75 0 010-1.06z","clip-rule":"evenodd"})])}function Ke(t,o){return p(),g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M14.47 2.47a.75.75 0 011.06 0l6 6a.75.75 0 010 1.06l-6 6a.75.75 0 11-1.06-1.06l4.72-4.72H9a5.25 5.25 0 100 10.5h3a.75.75 0 010 1.5H9a6.75 6.75 0 010-13.5h10.19l-4.72-4.72a.75.75 0 010-1.06z","clip-rule":"evenodd"})])}function We(t,o){return p(),g("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.348c1.295.712 1.295 2.573 0 3.285L7.28 19.991c-1.25.687-2.779-.217-2.779-1.643V5.653z","clip-rule":"evenodd"})])}const Je={props:{value:{type:Object,required:!0},close:{type:Boolean,required:!0},color:{required:!1,type:String,default:"green"},icon:{required:!1,type:Object}},methods:{removeLabel(){this.$emit("update",this.value)}},components:{XMarkIcon:N}},Qe={class:"text-sm"};function Ze(t,o,n,a,s,i){const f=c("XMarkIcon");return p(),g("button",{class:te(["flex items-center space-x-2 px-2 py-1 text-white rounded",`bg-${n.color}-500`])},[e("p",Qe,u(n.value.text),1),D(e("button",{onClick:o[0]||(o[0]=(..._)=>i.removeLabel&&i.removeLabel(..._))},[r(f,{class:"w-4 h-4"})],512),[[U,n.close]])],2)}const et=O(Je,[["render",Ze]]),tt={components:{TransitionRoot:Y,TransitionChild:K,Dialog:W,DialogPanel:J,DialogTitle:Q,XMarkIcon:N,UserIcon:re},props:{item:{required:!0,type:Object}},data(){return{open:!1,editIcon:H,saveIcon:ae,clearIcon:le,name:"",description:"",testTypesSelected:null,loading:!1,testTypes:new Array,rawTestTypes:new Array,cookie:B("token"),authStore:z()}},methods:{async init(){this.handleClick();let t=null;this.authStore.user.departments.map(i=>{i.name===this.authStore.department&&(t=i.id)});const o={route:`${w.specimenTestTypes}?department_id=${t}&specimen_id=${this.item.specimen_id}`,method:"GET",token:`${this.cookie}`},{pending:n,error:a,data:s}=await k(o);s.value&&(this.rawTestTypes=s.value,this.testTypes=s.value),a.value&&console.log(a.value)},async submitForm(){this.loading=!0;let t=new Array;this.testTypesSelected.map(i=>{t.push({specimen:this.item.specimen_id,test_type:i})});const o={route:`${w.addTestOrder}`,method:"POST",token:`${this.cookie}`,body:{order_id:this.item.order_id,tests:t}},{pending:n,error:a,data:s}=await k(o);s.value&&(this.handleClick(),I().$toast.success("Tests added to current order successfully!"),this.loading=!1,this.$emit("update",!0)),a.value&&(this.handleClick(),console.log(a.value),I().$toast.error(E),this.loading=!1)},handleClick(){this.open=!this.open},resetForm(){this.testTypesSelected=null}}},st=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),ot={class:"fixed inset-0 overflow-y-auto"},nt={class:"flex min-h-full items-center justify-center p-4 text-center"},it={class:"border-b px-3 py-3 flex items-center justify-between"},rt={class:"mt-2 space-y-3 pb-40"},at={class:"w-full flex flex-col space-y-2 px-5"},lt=e("label",{class:"font-medium"},"Tests",-1),ct={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function dt(t,o,n,a,s,i){const f=V,_=c("TransitionChild"),T=c("DialogTitle"),b=c("XMarkIcon"),y=c("multi-select"),S=se,m=c("FormKit"),x=c("DialogPanel"),v=c("Dialog"),l=c("TransitionRoot");return p(),g("div",null,[e("div",null,[r(f,{text:"Add test to current order",color:"warning",icon:s.editIcon,click:i.init},null,8,["icon","click"])]),r(l,{appear:"",show:s.open,as:"template"},{default:h(()=>[r(v,{as:"div",onClose:i.handleClick,class:"relative z-10"},{default:h(()=>[r(_,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:h(()=>[st]),_:1}),e("div",ot,[e("div",nt,[r(_,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:h(()=>[r(x,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:h(()=>[e("div",it,[r(T,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:h(()=>[L(" Add Test To Current Order ")]),_:1}),e("button",{onClick:o[0]||(o[0]=(...d)=>i.handleClick&&i.handleClick(...d))},[r(b,{class:"w-5 h-5"})])]),r(m,{type:"form","submit-label":"Update",onSubmit:i.submitForm,actions:!1,id:"submitForm"},{default:h(({value:d})=>[e("div",rt,[e("div",at,[lt,r(y,{style:{"--ms-max-height":"none !important"},modelValue:s.testTypesSelected,"onUpdate:modelValue":o[1]||(o[1]=C=>s.testTypesSelected=C),options:s.testTypes,mode:"tags",searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),e("div",ct,[r(S,{type:"button",click:()=>i.resetForm(),text:"Clear form"},null,8,["click"]),r(f,{loading:s.loading,type:"submit",click:()=>{},color:"success",icon:s.saveIcon,text:"Save changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const ut=O(tt,[["render",dt]]),mt={components:{TransitionRoot:Y,TransitionChild:K,Dialog:W,DialogPanel:J,DialogTitle:Q,XMarkIcon:N,PhoneIcon:ge,EnvelopeIcon:be,MapPinIcon:ye},data(){return{moment:j,viewIcon:we,show:this.open,addIcon:oe,editIcon:H,acceptIcon:ne,printerIcon:ke,cookie:B("token"),details:{},loading:!1}},props:{data:{type:Object,required:!0},open:{type:Boolean,required:!1}},methods:{async init(){this.loading=!0;const t={route:`${w.tests}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:o,error:n,pending:a}=await k(t);this.loading=a,o.value&&(this.details=o.value,typeof this.details=="object"&&this.handleClick()),n.value&&(this.loading=!1,console.error(n.value),I().$toast.error(E))},updateChanges(){this.show=!1,this.$emit("update",!0)},handleClick(){this.show=!this.show},printAccessionNumber(){return Z.printSpecimenLabel(this.details.accession_number)},printTrackingNumber(){return Z.printTrackingNumber(this.details.tracking_number)},viewReport(){return this.$router.push(`/reports/daily/patient-report/${this.details.client.id}?order_id=${this.details.order_id}`)},getRequestedBy(t){let o="";return t.map(n=>{n.status.name==="pending"&&(o=`${n.initiator.first_name} ${n.initiator.last_name}`)}),G(o)}}},pt=""+new URL("prescription_document.18f957e1.svg",import.meta.url).href,ht=""+new URL("test_tube.2b522cf2.svg",import.meta.url).href,_t=""+new URL("i_exam_qualification.dd473ba6.svg",import.meta.url).href,ft=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),gt={class:"fixed inset-0 overflow-y-auto"},bt={class:"flex min-h-full items-center justify-center text-center"},yt={class:"border-b px-3 py-3 flex items-center justify-between"},xt=e("img",{src:pt,class:"w-8 h-8 mr-2"},null,-1),vt={class:"flex items-center justify-center mx-auto my-20"},wt={class:"grid grid-cols-3 gap-4 px-5 py-5"},kt={class:"rounded border"},Tt=e("div",{class:"px-2 py-2 bg-gray-50 border-b rounded-t"},[e("h3",{class:"text-lg font-semibold text-black flex items-center"},[e("img",{src:de,class:"w-7 h-7 mr-1"}),L(" Patient ")])],-1),St={class:"w-full space-y-2 py-2"},Ct={class:"w-full flex justify-between px-4 py-1"},It=e("h3",{class:"font-semibold"},"Patient Number",-1),At={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},$t=e("h3",{class:"font-semibold"},"Name",-1),Rt={class:"w-full flex justify-between px-4 py-1"},jt=e("h3",{class:"font-semibold"},"Sex",-1),Dt={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Ut=e("h3",{class:"font-semibold"},"Age",-1),Ot={class:"rounded border"},Lt=e("div",{class:"px-2 py-2 bg-gray-50 border-b rounded-t"},[e("h3",{class:"text-lg font-semibold text-black flex items-center"},[e("img",{src:ht,class:"w-7 h-7 mr-1"}),L(" Specimen ")])],-1),Nt={class:"w-full space-y-2 py-2"},Pt={class:"w-full flex justify-between px-4 py-1"},qt=e("h3",{class:"font-semibold"},"Specimen Type",-1),Ft={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Bt=e("h3",{class:"font-semibold"},"Tracking Number",-1),Vt={class:"w-full flex justify-between px-4 py-1"},Et=e("h3",{class:"font-semibold"},"Accession Number",-1),Mt={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Xt=e("h3",{class:"font-semibold"},"Status",-1),zt={class:"rounded border max-h-72 overflow-y-auto"},Gt=e("div",{class:"px-2 py-2 bg-gray-50 border-b rounded-t flex items-center"},[e("img",{src:_t,class:"w-7 h-7 mr-1"}),e("h3",{class:"text-lg font-semibold text-black"},"Test")],-1),Ht={class:"w-full space-y-2 py-2"},Yt={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Kt=e("h3",{class:"font-semibold"},"Name",-1),Wt={class:"w-full flex justify-between px-4 py-1"},Jt=e("h3",{class:"font-semibold"},"Date Registered",-1),Qt={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Zt=e("h3",{class:"font-semibold"},"Receipt Date",-1),es={class:"w-full flex justify-between px-4 py-1"},ts=e("h3",{class:"font-semibold"},"Test Status",-1),ss={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},os=e("h3",{class:"font-semibold"},"Ward/Location",-1),ns={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},is=e("h3",{class:"font-semibold"},"Request Origin",-1),rs={class:"w-full flex justify-between px-4 py-1"},as=e("h3",{class:"font-semibold"},"Registered By",-1),ls={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},cs=e("h3",{class:"font-semibold"},"Requested By",-1),ds={class:"mx-5 rounded border mb-5"},us={class:"flex items-center justify-between bg-gray-50 px-4 py-2 border-b rounded-t"},ms=e("h3",{class:"text-lg font-semibold text-black"},"Results",-1),ps={class:"justify-end flex items-center space-x-3"},hs=["innerHTML"];function _s(t,o,n,a,s,i){const f=V,_=c("TransitionChild"),T=c("DialogTitle"),b=c("XMarkIcon"),y=_e,S=ut,m=c("DialogPanel"),x=c("Dialog"),v=c("TransitionRoot");return p(),g("div",null,[r(f,{click:i.init,color:"primary",text:"View",icon:s.viewIcon},null,8,["click","icon"]),r(v,{appear:"",show:s.show,as:"template"},{default:h(()=>[r(x,{as:"div",class:"relative z-10"},{default:h(()=>[r(_,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:h(()=>[ft]),_:1}),e("div",gt,[e("div",bt,[r(_,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:h(()=>[r(m,{class:"w-full max-w-7xl m-20 transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:h(()=>[e("div",yt,[r(T,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:h(()=>[xt,L(" View Test ")]),_:1}),e("button",{onClick:o[0]||(o[0]=(...l)=>i.handleClick&&i.handleClick(...l))},[r(b,{class:"w-5 h-5"})])]),D(e("div",vt,[r(y,{loading:s.loading},null,8,["loading"])],512),[[U,s.loading]]),e("div",wt,[e("div",kt,[Tt,e("div",St,[e("div",Ct,[It,e("p",null,u(s.details.client.id),1)]),e("div",At,[$t,e("p",null,u(("capitalize"in t?t.capitalize:R(G))(`${s.details.client.first_name} ${s.details.client.middle_name} ${s.details.client.last_name}`)),1)]),e("div",Rt,[jt,e("p",null,u(s.details.client.sex),1)]),e("div",Dt,[Ut,e("p",null,u(("calculateAge"in t?t.calculateAge:R(ie))(s.details.client.date_of_birth)),1)])])]),e("div",Ot,[Lt,e("div",Nt,[e("div",Pt,[qt,e("p",null,u(s.details.specimen_type),1)]),e("div",Ft,[Bt,e("p",null,u(s.details.tracking_number),1)]),e("div",Vt,[Et,e("p",null,u(s.details.accession_number),1)]),e("div",Mt,[Xt,e("p",null,u(s.details.status),1)])])]),e("div",zt,[Gt,e("div",Ht,[e("div",Yt,[Kt,e("p",null,u(s.details.test_type_name),1)]),e("div",Wt,[Jt,e("p",null,u(s.moment(s.details.created_date).format("dateFormat"in t?t.dateFormat:R(X))),1)]),e("div",Qt,[Zt,e("p",null,u(s.moment(s.details.updated_date).format("dateFormat"in t?t.dateFormat:R(X))),1)]),e("div",es,[ts,e("p",null,u(s.details.status),1)]),e("div",ss,[os,e("p",null,u(s.details.requesting_ward),1)]),e("div",ns,[is,e("p",null,u(s.details.request_origin),1)]),e("div",rs,[as,e("p",null,u(i.getRequestedBy(s.details.status_trail)),1)]),e("div",ls,[cs,e("p",null,u(s.details.requested_by),1)])])])]),e("div",ds,[e("div",us,[ms,e("div",ps,[r(f,{icon:s.viewIcon,text:"View Report",click:i.viewReport,color:"primary"},null,8,["icon","click"]),r(S,{item:s.details,onUpdate:i.updateChanges,color:"primary"},null,8,["item","onUpdate"]),r(f,{icon:s.printerIcon,text:"Print Accession Number",click:i.printAccessionNumber,color:"primary"},null,8,["icon","click"]),r(f,{icon:s.printerIcon,color:"success",text:"Print Tracking Number",click:i.printTrackingNumber},null,8,["icon","click"])])]),(p(!0),g(q,null,F(s.details.indicators,(l,d)=>(p(),g("div",{class:te(s.details.indicators.length!==d+1?"w-full px-5 py-2 border-b border-dotted flex justify-between items-center":"w-full px-5 py-2 flex justify-between items-center"),key:d},[e("h3",null,u(l.name),1),e("div",null,[l.result?(p(),g("p",{key:0,innerHTML:l.result.value?l.result.value:"Not done"},null,8,hs)):$("",!0)])],2))),128))])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const fs=O(mt,[["render",_s]]),gs={components:{TransitionRoot:Y,TransitionChild:K,Dialog:W,DialogPanel:J,DialogTitle:Q,XMarkIcon:N,UserIcon:re},data(){return{open:!1,addIcon:oe,saveIcon:ae,clearIcon:le,name:"",description:"",loading:!1,cookie:B("token"),reasons:new Array,reasonsSelected:"",rawReasons:new Array}},props:{item:{required:!0,type:Object},text:{type:String,required:!0},action:{type:String,required:!0},icon:{type:[Object,Function],required:!0}},methods:{async init(){this.handleClick();const t={route:w.rejectionReasons,method:"GET",token:`${this.cookie}`},{error:o,data:n}=await k(t);n.value&&(this.rawReasons=n.value,n.value.map(a=>{this.reasons.push(a.description)})),o.value&&console.error(o.value)},async submitForm(){this.loading=!0;let t=null;this.rawReasons.map(i=>{i.description===this.reasonsSelected&&(t=i.id)});const o={route:`${w.testStatus}/${this.item.id}/${this.action}?status_reason_id=${t}&person_talked_to=${this.name}`,method:"PUT",token:`${this.cookie}`,body:{}},{data:n,error:a,pending:s}=await k(o);this.loading=s,n.value&&(I().$toast.success(`Test action "${this.text}" done successfully!`),this.handleClick(),this.loading=!1,this.$emit("update",!0)),a.value&&(console.error(a.value),I().$toast.error(E),this.loading=!1)},handleClick(){this.open=!this.open},resetForm(){this.$formkit.reset("rejectionForm")}}},bs=""+new URL("rdt_result_no_test.6a8034c1.svg",import.meta.url).href,ys=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),xs={class:"fixed inset-0 overflow-y-auto"},vs={class:"flex min-h-full items-center justify-center p-4 text-center"},ws={class:"border-b px-3 py-3 flex items-center justify-between"},ks=e("img",{src:bs,class:"w-8 h-8 mr-2"},null,-1),Ts={class:"mt-2 space-y-3 px-5 py-5"},Ss={class:"space-y-2"},Cs=e("h3",{class:"font-medium"},"Test Type",-1),Is={class:"border-b border-dotted text-gray-600"},As={class:"space-y-2"},$s=e("h3",{class:"font-medium"},"Specimen",-1),Rs={class:"border-b border-dotted text-gray-600"},js={class:"space-y-2"},Ds=e("h3",{class:"font-medium"},"Accession Number",-1),Us={class:"border-b border-dotted text-gray-600"},Os={class:"w-full flex items-center"},Ls={class:"w-full flex flex-col space-y-2"},Ns={class:"w-full flex flex-col space-y-2 pb-40"},Ps=e("label",{class:"font-medium"},"Select Reason(s)",-1),qs={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Fs(t,o,n,a,s,i){const f=V,_=c("TransitionChild"),T=c("DialogTitle"),b=c("XMarkIcon"),y=c("FormKit"),S=c("multi-select"),m=se,x=c("DialogPanel"),v=c("Dialog"),l=c("TransitionRoot");return p(),g("div",null,[e("div",null,[r(f,{text:n.text,color:"error",icon:n.icon,click:i.init},null,8,["text","icon","click"])]),r(l,{appear:"",show:s.open,as:"template"},{default:h(()=>[r(v,{as:"div",onClose:i.handleClick,class:"relative z-10"},{default:h(()=>[r(_,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:h(()=>[ys]),_:1}),e("div",xs,[e("div",vs,[r(_,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:h(()=>[r(x,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:h(()=>[e("div",ws,[r(T,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:h(()=>[ks,L(" "+u(n.text.charAt(0).toUpperCase()+n.text.slice(1))+" Reason ",1)]),_:1}),e("button",{onClick:o[0]||(o[0]=(...d)=>i.handleClick&&i.handleClick(...d))},[r(b,{class:"w-5 h-5"})])]),r(y,{type:"form","submit-label":"Update",onSubmit:i.submitForm,actions:!1,id:"rejectionForm"},{default:h(({value:d})=>[e("div",Ts,[e("div",Ss,[Cs,e("p",Is,u(n.item.test_type_name),1)]),e("div",As,[$s,e("p",Rs,u(n.item.specimen_type),1)]),e("div",js,[Ds,e("p",Us,u(n.item.accession_number),1)]),e("div",Os,[e("div",Ls,[r(y,{type:"text",label:"Person Talked To",validation:"required",modelValue:s.name,"onUpdate:modelValue":o[1]||(o[1]=C=>s.name=C)},null,8,["modelValue"])])]),e("div",Ns,[Ps,r(S,{style:{"--ms-max-height":"none !important"},modelValue:s.reasonsSelected,"onUpdate:modelValue":o[2]||(o[2]=C=>s.reasonsSelected=C),options:s.reasons,searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),e("div",qs,[r(m,{type:"button",text:"Clear form",click:i.resetForm},null,8,["click"]),r(f,{loading:s.loading,type:"submit",click:()=>{},color:"success",icon:s.saveIcon,text:"Save changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const Bs=O(gs,[["render",Fs]]),Vs={components:{MagnifyingGlassIcon:Ie,Listbox:Ne,ListboxButton:Pe,ListboxLabel:qe,ListboxOptions:Fe,ListboxOption:Be,ChevronUpDownIcon:me,ArrowRightIcon:Ye,ChevronDownIcon:Ae,Menu:Ve,MenuButton:Ee,MenuItems:Me,MenuItem:Xe,CheckIcon:$e,PopoverButton:ze,Popover:Ge,PopoverPanel:He,XMarkIcon:N,CheckCircleIcon:Re},setup(){const t=z();Se({title:`${Ce.name.toUpperCase()} - ${t.department} Tests`})},data(){return{moment:j,addIcon:ee,filterIcon:je,applyIcon:Ke,acceptIcon:ne,moreActions:!1,okIcon:M,moreIcon:De,lessIcon:Ue,clearIcon:Oe,dropIcon:P,editIcon:H,refreshIcon:Le,dateRange:[],search:"",header:"Tests Lists",pages:[{name:"Home",link:"/home"}],headers:[{text:"PATIENT",value:"name",sortable:!0},{text:"ACCESSION NO",value:"accession_number",sortable:!0},{text:"TEST",value:"test_type_name",sortable:!0},{text:"LOCATION",value:"requesting_ward",sortable:!0},{text:"ORDER STATUS",value:"order_status",sortable:!0},{text:"STATUS",value:"status",sortable:!0},{text:"DATE REGISTERED",value:"created_date",sortable:!0},{text:"ACTIONS",value:"actions"}],statuses:[{text:"Results",color:"primary",icon:ee,status:"completed",show:"started"},{text:"Accept",color:"success",icon:M,status:"pending",show:"not-collected"},{text:"Start",color:"warning",icon:We,status:"started",show:"pending"},{text:"Authorize",color:"success",status:"verified",icon:M,show:"completed"}],rejectStatuses:[{name:"Reject",icon:P,action:"rejected"},{name:"Void",icon:P,action:"voided"},{name:"Not-done",icon:P,action:"not_done"}],changing:!1,data:new Array,statusSelected:{name:"select status"},searchField:"accession_number",searchValue:"",cookie:B("token"),loading:!1,serverItemsLength:0,serverOptions:{page:1,rowsPerPage:25,sortBy:"name"},authStore:z(),testStatuses:new Array,filters:new Array,i18n:ue()}},created(){this.init()},methods:{async searchNlims(t){this.loading=!0;const o={route:`${w.nlimsTestSearch}?tracking_number=${t.replace(/\$$/,"")}`,method:"GET",token:`${this.cookie}`},{data:n,error:a}=await k(o);n.value&&(xe(n.value),this.loading=!1),a.value&&(console.error(a.value),I().$toast.error(`${a.value.data.error}`),this.loading=!1)},async init(){this.loadStatuses(),this.loading=!0;const{t}=this.i18n;for(var o=0;o<this.headers.length;++o)switch(this.headers[o].text){case"PATIENT":this.headers[o].text=t("patient");break;case"ACCESSION NO":this.headers[o].text=t("ACCESSION_NO");break;case"TEST":this.headers[o].text=t("TEST");break;case"LOCATION":this.headers[o].text=t("LOCATION");break;case"ORDER STATUS":this.headers[o].text=t("ORDER_STATUS");break;case"STATUS":this.headers[o].text=t("STATUS");break;case"DATE REGISTERED":this.headers[o].text=t("DATE_REGISTERED");break;case"ACTIONS":this.headers[o].text=t("ACTIONS");break}this.statusSelected.name==="select status"&&(this.statusSelected.name=t("select_status"));const{page:n,rowsPerPage:a}=this.serverOptions;let s=this.getIdFromName(this.authStore.user.departments,this.authStore.department),i=this.statusSelected.name==="select status"?"":this.statusSelected.name;const f=this.dateRange!==null&&this.dateRange.length>0?j(this.dateRange[0]).format("YYYY-MM-DD"):"",_=this.dateRange!==null&&this.dateRange.length>1?j(this.dateRange[1]).format("YYYY-MM-DD"):"",T={route:`${w.tests}?minimal=true&page=${n}&per_page=${a}&status=${i.toLowerCase()}&search=${this.search}&department_id=${s}&start_date=${f}&end_date=${_}`,method:"GET",token:`${this.cookie}`},{data:b,error:y,pending:S}=await k(T);this.loading=S,b.value&&(this.data=b.value.data.map(m=>{var x,v,l,d;return{...m,name:`${G(((x=m.client)==null?void 0:x.first_name)+" "+((v=m.client)==null?void 0:v.middle_name)+" "+((l=m.client)==null?void 0:l.last_name))}(${m.client.sex}, ${ie((d=m.client)==null?void 0:d.date_of_birth)} yrs)`,order_status:`${m.order_status!==null?(m.order_status.charAt(0).toUpperCase()+m.order_status.slice(1)).split("-").join(" "):""}`,status:`${m.status!==null?m.status.charAt(0).toUpperCase()+m.status.slice(1):""}`,created_date:j(m.created_date).format(X)}}),this.serverItemsLength=b.value.meta.total_count,this.loading=!1),y.value&&(console.error(y.value.data),I().$toast.error(E),this.loading=!1)},async loadStatuses(){const t={route:`${w.testStatus}/all`,method:"GET",token:`${this.cookie}`},{data:o,error:n}=await k(t);o.value&&(this.testStatuses=o.value.map(a=>({id:a.id,name:a.name.charAt(0).toUpperCase()+a.name.slice(1)}))),n.value&&console.error(n.value)},async changeStatus(t,o){this.loading=!0;const n={route:`${w.testStatus}/${o}/${t}`,method:"PUT",token:`${this.cookie}`,body:{}},{data:a,error:s,pending:i}=await k(n);this.loading=i,a.value&&(this.init(),this.loading=!1),s.value&&(console.error(s.value),this.loading=!1)},async changeOrderStatus(t,o){this.loading=!0;const n={route:`${w.orderStatus}/${t}`,method:"PUT",token:`${this.cookie}`,body:{order_id:o}},{data:a,error:s,pending:i}=await k(n);this.loading=i,a.value&&(this.init(),this.loading=!1),s.value&&(console.error(s.value),this.loading=!1)},checkStatus(t,o){t.status==="completed"?o.test_type_name.toLowerCase().includes("culture")?this.redirect(o,`/tests/result/culture-sensitivity?accession_number=${o.accession_number}&test_id=${o.id}`):this.redirect(o,`/tests/result?accession_number=${o.accession_number}&test_id=${o.id}`):t.status!==""?this.changeStatus(t.status,o.id):this.printTest(o)},printTest(t){print()},statusList(t,o){for(var n="",a=0;a<t.length;++a)n=ve(t[a].name,o),t[a].name=n;return t},chaStatusSelected(t,o){t.name==="select status"?this.statusSelected.name=o("select_status"):this.statusSelected=t},getIdFromName(t,o){const n=t.find(a=>a.name===o);return n?n.id:null},updateTests(t){typeof t=="object"&&(this.serverOptions=t),this.init(),this.moreActions=!1},refreshTests(){this.searchValue="",this.search="",this.init()},update(t){this.search=t,this.searchValue=t,t!==""?this.checkTrackingNumber(t)?this.searchNlims(t):this.updateTests(t):this.init()},handleClick(){this.moreActions=!this.moreActions},redirect(t,o){this.$router.push(o)},checkTrackingNumber(t){return/^(x|l).*\d/.test(t.toLowerCase())},updateOnStatus(t){if(t.name!=="select status"){const o=this.filters.find(n=>n.origin==="statuses");o?o.value=t.name:this.filters.push({origin:"statuses",value:t.name})}this.statusSelected=t,this.init()},removeFilter(t){t.origin==="statuses"&&this.statusSelected.name!=="select status"&&this.updateOnStatus({name:"select status"});const o=this.filters.findIndex(n=>n.origin===t.origin);o!==-1&&this.filters.splice(o,1),this.init()},isCompletedByCurrentUserOrSuperAdmin(t){const o=this.authStore.user,n=t.completed_by;if(n){if(n.id!==o.id)return!0;if(n.is_super_admin===!0)return!0}return!1},shouldDisplayButton(t,o){const n=t.status.toLowerCase(),a=o.show.toLowerCase();if(n===a){const s=this.isCompletedByCurrentUserOrSuperAdmin(t);return n==="pending"&&t.order_status.toLowerCase()==="specimen not collected"?!1:s}return!1},hideRejectActions(t){return!["voided","test-rejected","verified"].includes(t.toLowerCase())}},watch:{authStore:{handler(){this.init()},deep:!0},dateRange:{handler(){this.init()},deep:!0},statusSelected:{handler(t){this.updateOnStatus(t)},deep:!0}}},Es={class:"py-5 px-5"},Ms={class:"flex items-center justify-between py-5"},Xs={class:"text-2xl font-semibold"},zs={class:"flex justify-between items-center w-full py-2 mb-2"},Gs={class:"flex items-center space-x-2"},Hs={class:"relative z-10 w-40"},Ys={class:"w-72 pt-1"},Ks={class:"py-3 flex items-center space-x-3"},Ws={class:"py-2 flex items-center"},Js={class:"w-full flex items-center justify-between space-x-2"},Qs={class:"flex items-center space-x-2"},Zs={key:0,class:"flex items-center space-x-2"},eo=e("div",{id:"tests-container"},null,-1);function to(t,o,n,a,s,i){const f=ce,_=V,T=pe,b=c("datepicker"),y=he,S=et,m=fs,x=Bs,v=Te;return p(),g("div",Es,[r(f,{pages:s.pages},null,8,["pages"]),e("div",Ms,[e("h3",Xs,u(t.$t("Tests_Lists")),1)]),e("div",zs,[e("div",Gs,[r(_,{text:t.$t("Refresh"),color:"warning",icon:s.refreshIcon,click:()=>{i.refreshTests()},loading:s.loading},null,8,["text","icon","click","loading"]),e("div",Hs,[r(T,{items:i.statusList(s.testStatuses,t.$t),modelValue:s.statusSelected,"onUpdate:modelValue":o[0]||(o[0]=l=>s.statusSelected=l)},null,8,["items","modelValue"])]),e("div",Ys,[r(b,{placeholder:t.$t("start_enddate"),range:"","input-classes":"border font-normal rounded px-2 py-1.5 block focus:outline-none focus:ring-2 focus:ring-sky-500 transition duration-150 focus:border-none",modelValue:s.dateRange,"onUpdate:modelValue":o[1]||(o[1]=l=>s.dateRange=l),format:"datePickerFormat"in t?t.datePickerFormat:R(fe)},null,8,["placeholder","modelValue","format"])])]),r(y,{onUpdate:i.update,search:s.search},null,8,["onUpdate","search"])]),e("div",Ks,[(p(!0),g(q,null,F(s.filters,(l,d)=>(p(),A(S,{value:{origin:"statuses",text:l.value},close:"",color:"green",key:d,onUpdate:i.removeFilter},null,8,["value","onUpdate"]))),128))]),r(v,{headers:s.headers,data:s.data,loading:s.loading,searchField:s.searchField,searchValue:s.searchValue,serverItemsLength:s.serverItemsLength,serverOptions:s.serverOptions,onUpdate:i.updateTests},{actions:h(({item:l})=>[e("div",Ws,[e("div",Js,[D(e("div",Qs,[r(m,{data:l,onUpdate:i.updateTests},null,8,["data","onUpdate"]),l.status.toLowerCase()==="completed"?(p(),A(_,{key:0,click:()=>{i.checkStatus({status:"completed"},l)},text:"Edit",color:"success",icon:s.editIcon},null,8,["click","icon"])):$("",!0),(p(!0),g(q,null,F(s.statuses,(d,C)=>D((p(),A(_,{color:d.color,text:d.text,icon:d.icon,click:()=>{i.checkStatus(d,l)},key:C},null,8,["color","text","icon","click"])),[[U,i.shouldDisplayButton(l,d)]])),128)),l.order_status.toLowerCase()==="specimen not collected"?(p(),A(_,{key:1,color:"success",text:"Accept",icon:s.acceptIcon,click:()=>i.changeOrderStatus("accepted",l.order_id)},null,8,["icon","click"])):$("",!0)],512),[[U,!s.moreActions]]),i.hideRejectActions(l.status)?(p(),A(_,{key:0,click:i.handleClick,color:"",text:"",icon:s.moreActions==!0?s.lessIcon:s.moreIcon},null,8,["click","icon"])):$("",!0)]),i.hideRejectActions(l.status)?D((p(),g("div",Zs,[i.hideRejectActions(l.status)?(p(!0),g(q,{key:0},F(s.rejectStatuses,(d,C)=>(p(),A(x,{item:l,key:C,text:d.name,icon:d.icon,action:d.action,onUpdate:i.updateTests},null,8,["item","text","icon","action","onUpdate"]))),128)):$("",!0)],512)),[[U,s.moreActions]]):$("",!0)])]),_:1},8,["headers","data","loading","searchField","searchValue","serverItemsLength","serverOptions","onUpdate"]),eo])}const Fo=O(Vs,[["render",to]]);export{Fo as default};
