import{_ as pe}from"./CGGtvusN.js";import{_ as _e}from"./C0tqYChS.js";import{b as i,e as d,g as t,S as fe,p as ye,Y as be,G as he,V as ve,q as ge,a as Y,u as B,s as xe,x as S,f as u,y as D,j as I,t as c,F as U,k as z,_ as J,d as ke,r as k,c as R,o as we,w as O,h as a,H as $e,C as w,A as H,i as Ce,bc as Ne,l as Se,m as W}from"./D6i_IOc_.js";import{S as Z}from"./v49nXNIB.js";import{r as De}from"./DlFmXbdc.js";import{r as Te}from"./DZMBDnl3.js";import{r as Ae}from"./-mp5v0R0.js";import{_ as Me}from"./BM3s60a1.js";import{_ as Ve}from"./D2qt2bNp.js";import{P as Ie}from"./BZSIQZRS.js";import{u as Be}from"./DWAwhHUi.js";import{r as Fe}from"./BD3CNGGh.js";import{r as je}from"./CfwkTFBk.js";import{r as Le}from"./nQf0Gylo.js";import"./By9LU-fN.js";import"./DWXm4k5R.js";import"./DvwXNZux.js";import"./BwU-8tyK.js";import"./CcV7c9GQ.js";import"./DgPl_XGR.js";import"./B-kA0EYn.js";import"./CuTMbTZk.js";import"./DnZ6mysu.js";function Ee(x,n){return i(),d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M7.502 6h7.128A3.375 3.375 0 0 1 18 9.375v9.375a3 3 0 0 0 3-3V6.108c0-1.505-1.125-2.811-2.664-2.94a48.972 48.972 0 0 0-.673-.05A3 3 0 0 0 15 1.5h-1.5a3 3 0 0 0-2.663 1.618c-.225.015-.45.032-.673.05C8.662 3.295 7.554 4.542 7.502 6ZM13.5 3A1.5 1.5 0 0 0 12 4.5h4.5A1.5 1.5 0 0 0 15 3h-1.5Z","clip-rule":"evenodd"}),t("path",{"fill-rule":"evenodd",d:"M3 9.375C3 8.339 3.84 7.5 4.875 7.5h9.75c1.036 0 1.875.84 1.875 1.875v11.25c0 1.035-.84 1.875-1.875 1.875h-9.75A1.875 1.875 0 0 1 3 20.625V9.375ZM6 12a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V12Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75ZM6 15a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V15Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75ZM6 18a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V18Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75Z","clip-rule":"evenodd"})])}function X(x,n){return i(),d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{d:"M12.378 1.602a.75.75 0 0 0-.756 0L3 6.632l9 5.25 9-5.25-8.622-5.03ZM21.75 7.93l-9 5.25v9l8.628-5.032a.75.75 0 0 0 .372-.648V7.93ZM11.25 22.18v-9l-9-5.25v8.57a.75.75 0 0 0 .372.648l8.628 5.033Z"})])}const Re={components:{TransitionRoot:fe,TransitionChild:ye,Dialog:be,DialogPanel:he,DialogTitle:ve,XMarkIcon:ge},data(){return{transferIcon:De,saveIcon:Te,show:!1,loading:!1,editIcon:Ae,cookie:Y("token")}},props:{data:{type:Object,required:!0},disableCheckout:{type:Boolean,required:!0}},computed:{filteredRequisitions(){return this.data.requisitions.map(x=>({stock_item_name:x.stock_item.name,stock_item_id:x.stock_item.id,quantity:x.quantity_requested,lot:x.lot_number,batch:x.batch_number}))}},methods:{async submitForm(){const x=this.filteredRequisitions.map(async n=>{const $=new Z,N={stock_item_id:n.stock_item_id,quantity:n.quantity,batch:n.batch,lot:n.lot};try{const{data:f,error:v}=await $.checkStockQuantity(`${this.cookie}`,N);if(f.value&&!f.value.deduction_allowed)throw new Error(f.value.message||`Insufficient stock for ${n.stock_item_name}`);if(v.value)throw new Error(`Could not verify stock for ${n.stock_item_name}`);return!0}catch(f){throw f}});try{this.loading=!0,await Promise.all(x);const n=new Z,$={sending_to:this.data.sendingTo,stock_status_reason:this.data.reason,stock_items:this.filteredRequisitions},{data:N,error:f,pending:v}=await n.stockOutTransaction(`${this.cookie}`,$);this.loading=v,N.value&&(this.loading=!1,B().$toast.success(N.value.message),this.handleClick(),this.$router.push("/stock-management/issue")),f.value&&(this.loading=!1,console.error(f.value),B().$toast.error("Failed to process stock transaction"),this.handleClick())}catch(n){this.loading=!1,console.error("Stock validation failed:",n),B().$toast.error(n.message||"Stock validation failed. Please check quantities.")}},handleClick(){this.show=!this.show}}},Ze={class:"fixed inset-0 overflow-y-auto"},Qe={class:"flex min-h-full items-center justify-center p-4 text-center"},qe={class:"border-b px-3 py-3 flex items-center justify-between"},He={class:"py-5 px-5"},Ue={class:"w-full flex items-center space-x-2"},ze={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Ke={class:"w-full flex items-center space-x-2 mt-2"},Pe={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Ge={class:"w-full"},Oe={class:"border-b border-t border-r border-l rounded"},We={class:"px-2 py-2 border-r"},Xe={class:"px-2 py-2 border-r"},Ye={class:"px-2 py-2 border-r"},Je={class:"px-2 py-2"},et={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function tt(x,n,$,N,f,v){const _=J,h=S("TransitionChild"),y=S("DialogTitle"),T=S("XMarkIcon"),A=S("FormKit"),F=S("DialogPanel"),j=S("Dialog"),L=S("TransitionRoot");return i(),d("div",null,[u(_,{click:v.handleClick,color:"success",text:"Transfer",icon:f.transferIcon,disabled:$.disableCheckout},null,8,["click","icon","disabled"]),u(L,{appear:"",show:f.show,as:"template"},{default:D(()=>[u(j,{as:"div",class:"relative z-10"},{default:D(()=>[u(h,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:D(()=>n[1]||(n[1]=[t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),t("div",Ze,[t("div",Qe,[u(h,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:D(()=>[u(F,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:D(()=>[t("div",qe,[u(y,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:D(()=>n[2]||(n[2]=[t("img",{src:Me,class:"w-8 h-8 mr-2"},null,-1),I(" Checkout Stock Transfer ")])),_:1}),t("button",{onClick:n[0]||(n[0]=(...b)=>v.handleClick&&v.handleClick(...b))},[u(T,{class:"w-5 h-5"})])]),u(A,{type:"form","submit-label":"Update",onSubmit:v.submitForm,actions:!1,id:"submitForm"},{default:D(({value:b})=>[t("div",He,[t("div",Ue,[n[3]||(n[3]=t("p",{class:"w-72 font-medium"},"To: ",-1)),t("span",ze,c($.data.sendingTo),1)]),t("div",Ke,[n[4]||(n[4]=t("p",{class:"w-72 font-medium"},"Reason for transfer: ",-1)),t("span",Pe,c($.data.reason),1)]),n[6]||(n[6]=t("div",{class:"bg-blue-50 border border-blue-200 rounded px-3 py-2 mt-4"},[t("div",{class:"flex items-center"},[t("svg",{class:"w-5 h-5 text-blue-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})]),t("p",{class:"text-blue-700 text-sm"}," Stock quantities will be validated before processing to ensure availability. ")])],-1)),n[7]||(n[7]=t("div",{class:"bg-gray-50 px-2 py-2 border rounded-t mt-4"},[t("h3",{class:"font-semibold"},"Stock Out Items")],-1)),t("table",Ge,[n[5]||(n[5]=t("thead",{clas:"w-full border-l border-r"},[t("tr",{class:"border-b border-r border-l rounded"},[t("th",{class:"px-2 py-2 text-left border-r"}," Item "),t("th",{class:"px-2 py-2 text-left border-r"}," Quantity "),t("th",{class:"px-2 py-2 text-left border-r"}," Batch "),t("th",{class:"px-2 py-2 text-left"}," Lot ")])],-1)),t("tbody",null,[(i(!0),d(U,null,z(v.filteredRequisitions,(M,V)=>(i(),d("tr",Oe,[t("td",We,c(M.stock_item_name),1),t("td",Xe,c(M.quantity),1),t("td",Ye,c(M.batch),1),t("td",Je,c(M.lot),1)]))),256))])])]),t("div",et,[u(_,{loading:f.loading,type:"submit",click:()=>{},color:"success",icon:f.transferIcon,text:"Continue"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const st=xe(Re,[["render",tt]]),ot={class:"px-5 py-5"},at={class:"flex items-center justify-between py-5"},nt={class:"flex items-center space-x-3"},lt={class:"w-full mt-2 grid grid-cols-1 lg:grid-cols-4 gap-6"},rt={class:"lg:col-span-1 order-2 lg:order-2"},it={class:"bg-gray-50 border border-gray-200 rounded-lg"},dt={class:"bg-gray-100 px-4 py-3 border-b border-gray-200 rounded-t-lg"},ct={class:"font-semibold text-lg text-gray-800 flex items-center"},ut={class:"flex flex-col space-y-4 px-5 py-5"},mt={class:"w-full flex flex-col space-y-2"},pt={key:0,class:"w-full flex flex-col space-y-2"},_t={class:"font-medium text-gray-700"},ft={class:"w-full flex flex-col space-y-2"},yt={key:0,class:"mt-4 bg-gray-50 border border-gray-200 rounded-lg"},bt={class:"bg-gray-100 px-4 py-3 border-b border-gray-200 rounded-t-lg"},ht={class:"font-semibold text-lg text-gray-800 flex items-center"},vt={class:"px-4 py-4 space-y-2 text-sm text-gray-700"},gt={class:"flex justify-between"},xt={class:"font-semibold"},kt={key:0,class:"flex justify-between"},wt={class:"font-semibold"},$t={key:1,class:"flex justify-between"},Ct={class:"font-semibold"},Nt={key:2,class:"flex justify-between"},St={class:"font-semibold"},Dt={class:"lg:col-span-3 order-1 lg:order-1"},Tt={class:"bg-gray-50 border border-gray-200 rounded-lg"},At={class:"bg-gray-100 px-4 py-3 border-b border-gray-200 rounded-t-lg flex items-center justify-between"},Mt={class:"font-semibold text-lg text-gray-800 flex items-center"},Vt={class:"px-5 py-5"},It={key:0,class:"space-y-4"},Bt={class:"flex items-center justify-between mb-4 pb-2 border-b border-gray-200"},Ft={class:"text-sm font-semibold text-gray-900 flex items-center"},jt={class:"bg-gray-100 text-gray-800 px-2 py-1 rounded-full text-xs mr-2"},Lt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Et={class:"flex flex-col space-y-2"},Rt={class:"relative"},Zt=["onUpdate:modelValue","onFocus","onBlur","placeholder"],Qt={key:0,class:"relative"},qt={class:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-64 overflow-y-auto"},Ht={key:0,class:"px-4 py-3 text-gray-500 text-center"},Ut={key:1},zt=["onMousedown"],Kt={class:"flex flex-col"},Pt={class:"font-medium text-gray-900 text-sm"},Gt={class:"text-xs text-gray-600 mt-1 flex items-center space-x-4"},Ot={class:"flex items-center"},Wt={class:"ml-1"},Xt={class:"flex items-center"},Yt={class:"ml-1"},Jt={class:"flex items-center text-green-500"},es={class:"ml-1"},ts={key:1,class:"text-xs text-gray-600 bg-gray-100 p-3 rounded"},ss={class:"grid grid-cols-2 gap-2"},os={class:"flex justify-between"},as={class:"font-medium"},ns={class:"flex justify-between"},ls={class:"font-medium"},rs={class:"flex justify-between"},is={class:"font-medium text-green-500"},ds={key:0,class:"flex justify-between"},cs={class:"font-medium"},us={class:"flex flex-col space-y-2"},ms={key:0,class:"text-xs text-gray-500"},ps={key:1,class:"text-center py-16 bg-white rounded-lg border-2 border-dashed border-gray-300"},Es=ke({__name:"transfer-stock",setup(x){Be({title:`${Ie.name.toUpperCase()} - Transfer Stock`});const n=je,$=Le,{$toast:N,$metadata:f}=B(),v=k([]),_=k({name:"select destination"}),h=k(""),y=k([]),T=k([]),A=Y("token"),F=k([]),j=k([]),L=k([]),b=k({name:"select item"}),M=k([{name:"Home",link:"/home"},{name:"Stock Management",link:"#"},{name:"Transactions",link:"/stock-management/transactions"}]),V=k({id:0,value:!1}),K=R(()=>{const e={Department:{items:F,placeholder:"select department"},Facility:{items:j,placeholder:"select facility"},Ward:{items:L,placeholder:"select ward"}}[_.value.name];return e?(b.value={name:e.placeholder},e.items.value):[]}),ee=R(()=>{const s=[];return T.value.forEach(e=>{const r=e.batches?e.batches.split(",").map(o=>o.trim()).filter(o=>o):[],p=e.lots?e.lots.split(",").map(o=>o.trim()).filter(o=>o):[];if(r.length>0&&p.length>0)r.forEach(o=>{p.forEach(m=>{const C=e.name.length>30?`${e.name.substring(0,30)}...`:e.name;s.push({...e,name:`${C}
Batch: ${o||"N/A"} | Lot: ${m||"N/A"}`,displayName:e.name,batch_number:o,lot_number:m,available_quantity:e.quantity||0,uniqueKey:`${e.id}-${o}-${m}`})})});else if(r.length>0)r.forEach(o=>{const m=e.name.length>30?`${e.name.substring(0,30)}...`:e.name;s.push({...e,name:`${m}
Batch: ${o||"N/A"} | Lot: N/A`,displayName:e.name,batch_number:o,lot_number:"",available_quantity:e.quantity||0,uniqueKey:`${e.id}-${o}-`})});else if(p.length>0)p.forEach(o=>{const m=e.name.length>30?`${e.name.substring(0,30)}...`:e.name;s.push({...e,name:`${m}
Batch: N/A | Lot: ${o||"N/A"}`,displayName:e.name,batch_number:"",lot_number:o,available_quantity:e.quantity||0,uniqueKey:`${e.id}--${o}`})});else{const o=e.name.length>30?`${e.name.substring(0,30)}...`:e.name;s.push({...e,name:`${o}
Batch: N/A | Lot: N/A`,displayName:e.name,batch_number:"",lot_number:"",available_quantity:e.quantity||0,uniqueKey:`${e.id}--`})}}),s}),Q=R(()=>y.value.filter(s=>s.stock_item.id!==0).length),te=R(()=>Q.value>0&&_.value.name!=="-- select destination --"&&b.value.name!=="-- select item --"&&h.value.trim()!==""&&y.value.every(s=>s.stock_item.id!==0&&s.quantity_requested>0&&s.quantity_requested<=(s.stock_item.quantity||0)));async function se(){oe(),le()}async function oe(){const s=new Z,{data:e,error:r}=await s.getStockItem(String(A.value),"metadata=true");e.value&&(T.value=e.value),r.value&&(console.error(r.value),N.error("Failed to load stock items"))}async function ae(){const s={route:Se.facility,method:"GET",token:A.value},{data:e,error:r}=await W(s);e.value&&(j.value=e.value.data),r.value&&console.error(r.value)}async function ne(){const s={route:"encounter_type_facility_section_mappings/facility_sections?encounter_type_id=2",method:"GET",token:A.value},{data:e,error:r}=await W(s);e.value&&(L.value=e.value),r.value&&console.error(r.value)}function le(){let s=["Facility","Ward","Department"];v.value=s.map(e=>({name:e}))}async function P(s){var C;V.value={id:s.id,value:!0};const e=new Z,r={stock_item_id:((C=T.value.find(E=>E.name==s.stock_item.name))==null?void 0:C.id)||0,quantity:s.quantity_requested,batch:s.batch_number,lot:s.lot_number},{data:p,error:o,pending:m}=await e.checkStockQuantity(A.value,r);V.value={id:s.id,value:m},p.value&&(p.value.deduction_allowed||(B().$toast.warning(p.value.message),s.quantity_requested=0),p.value.available_quantity!==null?s.stock_item.quantity=p.value.available_quantity:s.stock_item.quantity=0,V.value={id:s.id,value:!1}),o.value&&(console.error(o.value),V.value={id:s.id,value:!1},N.error("Could not verify stock quantity for given lot and batch, please try again"))}function re(){y.value.push({id:Date.now(),stock_item:{name:"select item",id:0,quantity:0},quantity_requested:1,batch_number:"",lot_number:"",expiry_date:"",searchQuery:"",showDropdown:!1})}function ie(s){s>=0&&s<y.value.length&&y.value.splice(s,1)}function G(s){const e=(s.searchQuery||"").toLowerCase(),r=y.value.filter(o=>o.id!==s.id&&o.stock_item.id!==0).map(o=>({id:o.stock_item.id,batch:o.batch_number,lot:o.lot_number}));let p=ee.value.filter(o=>!r.some(m=>m.id===o.id&&m.batch===o.batch_number&&m.lot===o.lot_number));return e&&(p=p.filter(o=>o.displayName.toLowerCase().includes(e)||o.batch_number&&o.batch_number.toLowerCase().includes(e)||o.lot_number&&o.lot_number.toLowerCase().includes(e))),p}function de(s,e){e&&e.id&&(s.stock_item={name:e.displayName,id:e.id,quantity:e.available_quantity,displayName:e.displayName},s.batch_number=e.batch_number||"",s.lot_number=e.lot_number||"",s.expiry_date=e.expiry_date||"",s.searchQuery=e.displayName,s.showDropdown=!1,s.stock_item.id&&P(s))}function ce(s){setTimeout(()=>{s.showDropdown=!1},200)}function ue(s){if(!s)return"N/A";try{return new Date(s).toLocaleDateString()}catch{return"N/A"}}function me(){_.value={name:"-- select destination --"},b.value={name:"-- select item --"},h.value="",y.value=[],y.value.forEach(s=>{s.showDropdown=!1,s.searchQuery=""})}return we(()=>{se()}),O(_,s=>{const r={Department:async()=>{F.value=f.departments},Facility:ae,Ward:ne}[s.name];r&&r()},{deep:!0}),O(y,(s,e)=>{const r=s.map(o=>o.stock_item.name),p=e.map(o=>o.stock_item.name);r!==p&&e.forEach(o=>{var m;o.stock_item.id=((m=T.value.find(C=>C.name===o.stock_item.name))==null?void 0:m.id)||0,o.stock_item.id&&P(o)})},{deep:!0}),(s,e)=>{const r=pe,p=_e,o=st,m=Ve,C=S("FormKit"),E=J;return i(),d("div",ot,[u(r,{pages:a(M)},null,8,["pages"]),t("div",at,[e[3]||(e[3]=t("h3",{class:"text-2xl font-semibold capitalize"},"Transfer Stock",-1)),t("div",nt,[a(y).length>0||a(h).trim()!==""?(i(),$e(p,{key:0,text:"Clear Form",click:me})):w("",!0),u(o,{"disable-checkout":!a(te),data:{reason:a(h),sendingTo:`${a(b).name.includes("select")?"":a(b).name} ${a(_).name.includes("select")?"":a(_).name}`,requisitions:a(y)}},null,8,["disable-checkout","data"])])]),t("div",null,[t("div",lt,[t("div",rt,[t("div",it,[t("div",dt,[t("h3",ct,[u(a(Fe),{class:"w-5 h-5 mr-2 text-sky-600"}),e[4]||(e[4]=I(" Transfer Details "))])]),t("div",ut,[t("div",mt,[e[5]||(e[5]=t("label",{class:"font-medium text-gray-700"},"Destination Type",-1)),u(m,{items:a(v),modelValue:a(_),"onUpdate:modelValue":e[0]||(e[0]=l=>H(_)?_.value=l:null)},null,8,["items","modelValue"])]),a(_)&&a(K).length>0?(i(),d("div",pt,[t("label",_t,[I(" Select "+c(a(_).name.toLowerCase())+" ",1),e[6]||(e[6]=t("span",{class:"text-red-600 font-medium"},"*",-1))]),u(m,{"is-searchable":!0,items:a(K),modelValue:a(b),"onUpdate:modelValue":e[1]||(e[1]=l=>H(b)?b.value=l:null)},null,8,["items","modelValue"])])):w("",!0),t("div",ft,[u(C,{label:"Reason for transfer",type:"textarea",modelValue:a(h),"onUpdate:modelValue":e[2]||(e[2]=l=>H(h)?h.value=l:null),validation:"required",placeholder:"Enter the reason for this stock transfer..."},null,8,["modelValue"])])])]),a(Q)>0?(i(),d("div",yt,[t("div",bt,[t("h4",ht,[u(a(Ee),{class:"w-5 h-5 mr-2"}),e[7]||(e[7]=I(" Transfer Summary "))])]),t("div",vt,[t("div",gt,[e[8]||(e[8]=t("span",{class:"font-medium"},"Items selected:",-1)),t("span",xt,c(a(Q)),1)]),a(_)&&!a(_).name.includes("select")?(i(),d("div",kt,[e[9]||(e[9]=t("span",{class:"font-medium"},"Destination:",-1)),t("span",wt,c(a(_).name),1)])):w("",!0),a(b)&&!a(b).name.includes("select")?(i(),d("div",$t,[e[10]||(e[10]=t("span",{class:"font-medium"},"To:",-1)),t("span",Ct,c(a(b).name),1)])):w("",!0),a(h)?(i(),d("div",Nt,[e[11]||(e[11]=t("span",{class:"font-medium line-clamp-1"},"Reason:",-1)),t("span",St,c(a(h).substring(0,50))+c(a(h).length>50?"...":""),1)])):w("",!0)])])):w("",!0)]),t("div",Dt,[t("div",Tt,[t("div",At,[t("h3",Mt,[u(a(X),{class:"w-5 h-5 mr-2"}),e[12]||(e[12]=I(" Items to Transfer "))]),u(E,{color:"primary",click:re,text:"Add Item",icon:a(n),size:"sm"},null,8,["icon"])]),t("div",Vt,[a(y).length>0?(i(),d("div",It,[(i(!0),d(U,null,z(a(y),(l,q)=>(i(),d("div",{key:q,class:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm"},[t("div",Bt,[t("h4",Ft,[t("span",jt," Item "+c(q+1),1)]),u(E,{icon:a($),text:"Remove",color:"error",click:()=>ie(q),size:"sm"},null,8,["icon","click"])]),t("div",Lt,[t("div",Et,[e[21]||(e[21]=t("label",{class:"font-medium text-gray-700"},"Stock Item",-1)),t("div",Rt,[Ce(t("input",{type:"text","onUpdate:modelValue":g=>l.searchQuery=g,onFocus:g=>l.showDropdown=!0,onBlur:g=>ce(l),placeholder:l.stock_item.id?l.stock_item.displayName||l.stock_item.name:"Search for stock items...",class:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-0"},null,40,Zt),[[Ne,l.searchQuery]]),e[13]||(e[13]=t("div",{class:"absolute inset-y-0 right-0 flex items-center pr-3"},[t("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))]),l.showDropdown?(i(),d("div",Qt,[t("div",qt,[G(l).length===0?(i(),d("div",Ht," No items found ")):(i(),d("div",Ut,[(i(!0),d(U,null,z(G(l),g=>(i(),d("div",{key:g.uniqueKey,onMousedown:_s=>de(l,g),class:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0"},[t("div",Kt,[t("div",Pt,c(g.displayName),1),t("div",Gt,[t("span",Ot,[e[14]||(e[14]=t("span",{class:"font-medium"},"Batch:",-1)),t("span",Wt,c(g.batch_number||"N/A"),1)]),t("span",Xt,[e[15]||(e[15]=t("span",{class:"font-medium"},"Lot:",-1)),t("span",Yt,c(g.lot_number||"N/A"),1)]),t("span",Jt,[e[16]||(e[16]=t("span",{class:"font-medium"},"Available:",-1)),t("span",es,c(g.available_quantity||0),1)])])])],40,zt))),128))]))])])):w("",!0),l.stock_item&&l.stock_item.id!==0?(i(),d("div",ts,[t("div",ss,[t("div",os,[e[17]||(e[17]=t("span",null,[t("strong",null,"Batch:")],-1)),t("span",as,c(l.batch_number||"N/A"),1)]),t("div",ns,[e[18]||(e[18]=t("span",null,[t("strong",null,"Lot:")],-1)),t("span",ls,c(l.lot_number||"N/A"),1)]),t("div",rs,[e[19]||(e[19]=t("span",null,[t("strong",null,"Available:")],-1)),t("span",is,c(l.stock_item.quantity||"N/A"),1)]),l.expiry_date?(i(),d("div",ds,[e[20]||(e[20]=t("span",null,[t("strong",null,"Expires:")],-1)),t("span",cs,c(ue(l.expiry_date)),1)])):w("",!0)])])):w("",!0)]),t("div",us,[u(C,{label:"Quantity to Transfer",type:"number",validation:"required|min:1",modelValue:l.quantity_requested,"onUpdate:modelValue":g=>l.quantity_requested=g,max:l.stock_item.quantity,placeholder:"Enter quantity"},null,8,["modelValue","onUpdate:modelValue","max"]),l.stock_item&&l.stock_item.quantity?(i(),d("div",ms," Max available: "+c(l.stock_item.quantity),1)):w("",!0)])])]))),128))])):(i(),d("div",ps,[u(a(X),{class:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e[22]||(e[22]=t("h3",{class:"text-xl font-semibold text-gray-900 mb-2"}," No items selected for transfer ",-1)),e[23]||(e[23]=t("p",{class:"text-gray-600 mb-6 max-w-md mx-auto"},' Start by adding stock items with their batch and lot information to create your transfer request. Use the "Add Item" button above to get started. ',-1))]))])])])])])])}}});export{Es as default};
