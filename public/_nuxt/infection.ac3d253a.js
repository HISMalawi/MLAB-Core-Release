import{_ as U}from"./Breadcrumb.vue.af519b7d.js";import{_ as j}from"./Dropdown.c3b078e3.js";import{m as q,u as G,C as u,a as I,g as Y,o as S,c as M,d as l,l as e,e as t,t as c,h as R,i as f,E as w,k as O,w as W,v as K,b as T,f as z}from"./entry.64b6b942.js";import{_ as J}from"./ExportButton.vue.ea9faa25.js";import{_ as Q}from"./Loader.52c40d31.js";import{e as X}from"./constants.31b85c3a.js";import{_ as Z}from"./report.35dfb70a.js";import{_ as ee}from"./page.2ba6cd71.js";import{h as p,e as k,f as E}from"./fetch.8fd817fe.js";import{k as te}from"./vue-doc-download.7c5e95f4.js";import{P as se}from"./package.70b788f3.js";import{u as oe}from"./facility.a7378ed6.js";import{r as re}from"./FunnelIcon.73d98fcb.js";import{r as ne}from"./ArrowPathIcon.b9b688c3.js";import"./nuxt-link.f9df4f37.js";import"./HomeIcon.4d524c11.js";import"./listbox.947b1eda.js";import"./hidden.a9fd55b4.js";import"./use-text-value.cb6830ee.js";import"./CheckIcon.b87f947f.js";import"./CheckCircleIcon.acd40d04.js";import"./MagnifyingGlassIcon.12344835.js";import"./transition.5b1867a1.js";import"./XMarkIcon.64f3f5c2.js";import"./PencilSquareIcon.f5030dad.js";import"./PrinterIcon.5a175993.js";const ae={class:"px-5 py-5"},le={class:"flex items-center py-5"},ie=t("img",{src:Z,alt:"report-icon",class:"w-8 h-8 mr-2"},null,-1),ce={class:"text-2xl font-semibold uppercase"},pe={class:"w-full flex items-center justify-between mb-5"},de={class:"w-full flex items-center space-x-3"},me={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},ue={class:"w-72 ml-2"},_e={class:"w-40"},fe={class:"w-48 flex items-end justify-end"},he={class:"text-lg font-semibold mb-2"},ge={class:"text-normal font-normal"},ve={class:"rounded border",id:"print-container"},ye={class:"hidden"},xe={class:"flex items-center justify-center"},be={class:"text-lg font-semibold mb-2"},Ye={class:"text-normal font-normal"},Se=["innerHTML"],Me={key:0,class:"w-full flex flex-col items-center justify-center space-y-2 py-10"},Re=t("img",{src:ee,alt:"page-icon",class:"object-cover w-20 h-20"},null,-1),we=t("p",{class:"text-base"},"Data not found, please generate report",-1),Te=[Re,we],ke={class:"mx-auto justify-center flex flex-col items-center space-y-3 py-20"},Ee=t("p",{class:"text-base"},[f("Generating report, please wait"),t("span",{class:"animate-ping"},"...")],-1),rt=q({__name:"infection",setup($e){G({title:`${se.name.toUpperCase()} - Infection Report`});const $=u("Infection Report"),D=u([{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"Aggregate Reports",link:"#"}]),g=u([]),_=u({id:0,name:"select department"}),x=I("token"),v=oe(),d=u(!1),h=u([]);h.value=[{test_type:"Syphilis Test",measure:"VDLR",result:"High",gender:"Male"},{test_type:"Syphilis Test",measure:"VDLR",result:"High",gender:"Female"},{test_type:"Syphilis Test",measure:"VDLR",result:"Medium",gender:"Male"}];const o=u(new Array("","")),C=()=>{o.value=new Array("","")},V=()=>'<thead class="w-full h-full border-b"><tr class="w-full h-full"><th rowspan="2" class="px-2 py-2 border-r">Test</th><th rowspan="2" class="border-r">Measure</th><th rowspan="2" class="px-2 py-2 border-r">Results</th><th rowspan="2" class="px-2 py-2 border-r">Sex</th><th colspan="3" scope="colgroup" class="border-r border-b px-2 py-2">Age Range</th><th rowspan="2" class="px-2 py-2 border-r">M/F Total</th><th rowspan="2" class="px-2 py-2">Total</th></tr><tr><th scope="col" class="border-l px-2 py-2 border-r">[0-5]</th><th scope="col" class="border-r px-2 py-2">[5-14]</th><th scope="col" class="border-r px-2 py-2">[14-120]</th></tr></thead>',B=a=>{let s="",n="",i="",m="";return a.forEach((r,b)=>{i==r.test_type?n!==r.test_type?(i=r.test_type,n=r.measure,s+="<tr>",s+='<td rowspan="">'+r.test_type+"</td>",s+='<td rowspan=""></td>',s+="</tr>"):m==r.result&&(s+="<td rowspan='NEW_RESULT'>[SomeResult]</td>"):(i=r.test_type,n=r.measure,m=r.result,s+="<tr class='tests'>",s+="<td class='test_type' rowspan='NEW_TEST'>"+r.test_type+"</td>",s+="<td rowspan='NEW_MEASURE'>"+r.measure+"</td>",s+="<td rowspan='NEW_RESULT'>"+r.result+"</td>"),s+="<td>"+r.gender+"</td>"}),s},N=a=>{const s=V(),n=a.length>0?B(a):"<tr></tr>";return`<table class="w-full rounded">${s}${n}</table>`};async function A(){const a={route:`${k.departments}`,method:"GET",token:`${x.value}`},{data:s,error:n}=await E(a);s.value&&(g.value=s.value,g.value.unshift({id:0,name:"All"})),n.value&&console.log(n.value)}async function L(){if(F())T().$toast.warning("Please select a department");else{d.value=!0;let a=o.value[0].toString()!=""?p(o.value[0].toString()).format("YYYY-MM-DD"):"",s=o.value[1].toString()!=""?p(o.value[1].toString()).format("YYYY-MM-DD"):"";const n={route:`${k.aggregateReports}infection?from=${a}&to=${s}&department=${_.value.id}`,method:"GET",token:`${x.value}`},{data:i,error:m,pending:r}=await E(n);d.value=r,i.value&&(d.value=!1,h.value=i.value.data),m.value&&(console.error(m.value),d.value=!1,T().$toast.error(X))}}function F(){return _.value.name=="select department"}return A(),(a,s)=>{const n=U,i=Y("datepicker"),m=j,r=z,b=Y("FormKit"),H=J,P=Q;return S(),M("div",ae,[l(n,{pages:e(D)},null,8,["pages"]),t("div",le,[ie,t("h3",ce,c(e($)),1)]),t("div",pe,[l(b,{type:"form","submit-label":"Update",onSubmit:L,actions:!1,id:"submitForm"},{default:R(({value:De})=>[t("div",de,[t("div",me,[l(e(re),{class:"w-5 h-5 mr-2"}),f(" Filter By Date Range "),t("div",ue,[l(i,{onCleared:C,required:"",position:"left",placeholder:"select start & end date",range:!0,"input-class-name":"datepicker",modelValue:e(o),"onUpdate:modelValue":s[0]||(s[0]=y=>w(o)?o.value=y:null)},null,8,["modelValue"])])]),t("div",_e,[l(m,{items:e(g),modelValue:e(_),"onUpdate:modelValue":s[1]||(s[1]=y=>w(_)?_.value=y:null)},null,8,["items","modelValue"])]),t("div",null,[l(r,{loading:e(d),color:"primary",type:"submit",text:"Generate Report",icon:e(ne),click:()=>{}},null,8,["loading","icon"])])])]),_:1}),t("div",fe,[l(e(te),{element:"print-container",filename:`infection_report_from_${e(p)(e(o)[0].toString()).format("DD_MM_YYYY")}_to_${e(p)(e(o)[1].toString()).format("DD_MM_YYYY")}`},{default:R(()=>[l(H,{text:"Export Excel"})]),_:1},8,["filename"])])]),t("div",null,[t("h3",he,[f("Tests Performed Period: "),t("span",ge,c(e(o)[0].toString()!=""?e(p)(e(o)[0].toString()).format("DD/MM/YYYY"):"")+" - "+c(e(o)[1].toString()!=""?e(p)(e(o)[1].toString()).format("DD/MM/YYYY"):""),1)]),t("div",ve,[t("div",ye,[t("h3",xe,[f("LABORATORY INFECTION REPORT "),t("p",null,c(e(v).details.name),1),t("p",null,c(e(v).details.address),1),t("p",null,c(e(v).details.phone),1)]),t("h3",be,[f("Tests Performed Period: "),t("span",Ye,c(e(o)[0].toString()!=""?e(p)(e(o)[0].toString()).format("DD/MM/YYYY"):"")+" - "+c(e(o)[1].toString()!=""?e(p)(e(o)[1].toString()).format("DD/MM/YYYY"):""),1)])]),t("div",{innerHTML:N(e(h))},null,8,Se)]),e(h).length==0&&!e(d)?(S(),M("div",Me,Te)):O("",!0),W(t("div",ke,[l(P),Ee],512),[[K,e(d)]])])])}}});export{rt as default};
