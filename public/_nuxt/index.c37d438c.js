import{_ as h}from"./Breadcrumb.vue.67061972.js";import{_}from"./SearchBar.f97a2703.js";import{u,a as f,_ as g,o as v,c as x,b as o,d as i,g as b,e as y}from"./entry.439009d7.js";import{_ as k}from"./Datatable.d04cc546.js";import{u as w}from"./vue.f36acd1f.fa639f1e.js";import{d as P,e as C}from"./constants.b3411291.js";import{h as I,e as V,f as B}from"./fetch.82daa61e.js";import{P as O}from"./package.47b8853b.js";import{r as R}from"./MagnifyingGlassIcon.dfe70d0e.js";import{r as U}from"./PencilSquareIcon.03aeeb33.js";import"./nuxt-link.a9a7724a.js";import"./HomeIcon.658f0e90.js";import"./XMarkIcon.7a9343f0.js";import"./Loader.fdcb8d74.js";import"./transition.f2756ed4.js";import"./hidden.3f41b6c9.js";import"./PrinterIcon.29534f2c.js";const $={setup(){w({title:`${O.name.toUpperCase()} - Patient Report`})},components:{MagnifyingGlassIcon:R},data(){return{headers:[{text:"patient id",value:"client_id",sortable:!0},{text:"name",value:"name",sortable:!0},{text:"sex",value:"sex",sortable:!0},{text:"date of birth",value:"date_of_birth",sortable:!0},{text:"actions",value:"actions"}],patients:new Array,pages:[{name:"Home",link:"/home"},{name:"Reports",link:"#"}],search:"",loading:!1,viewIcon:U,cookie:u("token"),serverItemsLength:0,serverOptions:{page:1,rowsPerPage:25,sortBy:"name"},searchField:"name",searchValue:""}},created(){this.init()},computed:{filteredPatients(){return this.patients.map(e=>({...e,name:`${e.first_name} ${e.middle_name} ${e.last_name}`.split(" ").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" "),date_of_birth:I(e.date_of_birth).format(P)}))}},methods:{updateSearch(e){this.searchValue=e,this.search=e,this.updatePatients(!0)},updatePatients(e){typeof e=="object"&&(this.serverOptions=e),this.init()},async init(){this.loading=!0;const{page:e,rowsPerPage:r}=this.serverOptions,n={route:`${V.clients}?page=${e}&per_page=${r}&search=${this.search}`,method:"GET",token:`${this.cookie}`,body:{}};let{data:a,error:t,pending:s}=await B(n);this.loading=s,a.value&&(this.patients=a.value.clients,this.serverItemsLength=a.value.meta.total_count),t.value&&(console.log(t.value.data),f().$toast.error(`${C}`))},async viewReport(e){this.$router.push(`/reports/daily/patient-report/${e.client_id}`)}}},F={class:"px-5 py-5"},L=i("div",{class:"flex items-center justify-between py-5"},[i("h3",{class:"text-2xl font-semibold"},"Patient reports")],-1),j={class:"flex justify-end w-full px-2 py-2 mb-2"},A={class:"py-2 flex items-center space-x-2"};function N(e,r,n,a,t,s){const c=h,p=_,l=y,m=k;return v(),x("div",F,[o(c,{pages:t.pages},null,8,["pages"]),L,i("div",j,[o(p,{search:t.search,onUpdate:s.updateSearch},null,8,["search","onUpdate"])]),o(m,{headers:t.headers,data:s.filteredPatients,loading:t.loading,searchField:t.searchField,searchValue:t.searchValue,serverItemsLength:t.serverItemsLength,serverOptions:t.serverOptions,onUpdate:s.updatePatients},{actions:b(({item:d})=>[i("div",A,[o(l,{click:()=>s.viewReport(d),color:"primary",text:"View Report",icon:t.viewIcon},null,8,["click","icon"])])]),_:1},8,["headers","data","loading","searchField","searchValue","serverItemsLength","serverOptions","onUpdate"])])}const te=g($,[["render",N]]);export{te as default};
