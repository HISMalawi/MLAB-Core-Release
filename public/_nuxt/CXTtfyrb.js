import{_ as Ue}from"./BdENdgJT.js";import{b as k,e as E,g as e,d as ge,r as i,a as se,u as ae,y as T,f as a,h as t,z as u,Y as ne,p as J,G as ie,V as re,j as Y,q as de,H as q,i as H,I as le,S as ce,s as we,l as j,m as B,J as Se,_ as ue,C as Ae,A as Te,B as ke,x as $e,v as oe,t as z,F as fe,k as _e,n as Ce,E as Ie,D as Pe,K as X,c as qe,w as he,o as Ee,L as ee}from"./D_S6f-1-.js";import{_ as Ve}from"./sPSmGTd2.js";import{_ as ye}from"./C_uWbslK.js";import{r as De}from"./DLYgY-h_.js";import{_ as Le}from"./DM9bqyyZ.js";import{r as Fe}from"./MTr1NVxU.js";import{r as Me}from"./Cp_vFhiS.js";import{_ as Re}from"./B-Mj1QMN.js";import{u as te}from"./BQSxqgc0.js";import{P as je}from"./D9oLXKDB.js";import{u as Be}from"./ms7f_jyB.js";import"./WAIr9m7E.js";import"./Cpt9Ovmf.js";import"./BkAIR3kE.js";import"./CW_35emG.js";function Ge(U,l){return k(),E("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z","clip-rule":"evenodd"})])}const xe="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6%2036C6%2031.0347%2017.9925%2028%2024%2028C30.0075%2028%2042%2031.0347%2042%2036V42H6V36Z'%20fill='%23333333'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M24%2024C28.4183%2024%2032%2020.4183%2032%2016C32%2011.5817%2028.4183%208%2024%208C19.5817%208%2016%2011.5817%2016%2016C16%2020.4183%2019.5817%2024%2024%2024ZM24%2026C29.5228%2026%2034%2021.5228%2034%2016C34%2010.4772%2029.5228%206%2024%206C18.4772%206%2014%2010.4772%2014%2016C14%2021.5228%2018.4772%2026%2024%2026Z'%20fill='%23333333'/%3e%3c/svg%3e",Ne={class:"fixed inset-0 overflow-y-auto"},ze={class:"flex min-h-full items-center justify-center p-4 text-center"},Oe={class:"border-b px-3 py-3 flex items-center justify-between"},Ze={class:"mt-2 space-y-3 px-5"},Ke={class:"grid grid-cols-2 gap-4"},He={class:"grid grid-cols-2 gap-4"},Xe={class:"grid grid-cols-2 gap-4"},Ye={class:"w-full flex items-center"},Je={class:"flex items-center"},Qe={class:"flex items-center ml-2"},We={class:"mt-10 justify-end flex items-center space-x-3 px-3 py-2 border-t"},et=ge({__name:"index",setup(U){const l=i(!1),m=we,D=De,r=i([]),h=i([]),_=i([]),$=se("token"),L=i([]),M=i([]),S=i([]),g=i([]),I=i([]),y=i([]),x=i(""),n=i(""),w=i(""),C=i(""),A=i(""),R=i(""),G=i(!1),c=i(!1),{$metadata:O}=ae(),Q=async()=>{G.value=!0;const b=r.value?r.value.map(N=>{var K;return(K=_.value.find(W=>N===W.name))==null?void 0:K.id}).filter(N=>N!==void 0):[],s=S.value?S.value.map(N=>{var K;return(K=M.value.find(W=>N===W.name))==null?void 0:K.id}).filter(N=>N!==void 0):[],v=y.value?y.value.map(N=>{var K;return(K=g.value.find(W=>N===W.name))==null?void 0:K.id}).filter(N=>N!==void 0).map(Number):[],f={route:j.users,method:"POST",token:`${$.value}`,body:{person:{first_name:x.value,middle_name:n.value,last_name:w.value,sex:A.value},user:{username:C.value,password:R.value},roles:s,departments:b,lab_locations:v}},{data:d,error:P,pending:p}=await B(f);G.value=p;const{$toast:be}=ae();d.value&&(V(),be.success("User created successfully!"),G.value=!1),P.value&&(V(),be.error(P.value),G.value=!1,console.error(P.value))},Z=async()=>{const b={route:j.roles,method:"GET",token:`${$.value}`},{data:s,error:v}=await B(b);s.value&&(M.value=s.value,L.value=s.value.map(f=>f.name)),v.value&&console.error(v.value)},me=async()=>{const b={route:j.locations,method:"GET",token:`${$.value}`},{data:s,error:v}=await B(b);s.value&&(g.value=s.value,I.value=s.value.map(f=>f.name)),v.value&&console.error(v.value)},pe=()=>{I.value=g.value.map(b=>b.name),_.value=O.departments,h.value=_.value.map(b=>b.name)},ve=async()=>{c.value=!0,await Z(),await me(),pe(),V(),c.value=!1},F=()=>{Se("submitForm"),r.value=[],S.value=[],y.value=[],A.value=""},o=()=>{l.value=!1,F()},V=()=>{l.value=!l.value};return(b,s)=>{const v=ue,f=T("FormKit"),d=Ve,P=ye;return k(),E("div",null,[e("div",null,[a(v,{text:"Add user",color:"primary",loading:t(c),icon:t(m),click:()=>{ve()}},null,8,["loading","icon","click"])]),a(t(ce),{appear:"",show:t(l),as:"template"},{default:u(()=>[a(t(ne),{as:"div",onClose:V,class:"relative z-10"},{default:u(()=>[a(t(J),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>s[10]||(s[10]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",Ne,[e("div",ze,[a(t(J),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[a(t(ie),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[e("div",Oe,[a(t(re),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:u(()=>s[11]||(s[11]=[e("img",{src:xe,alt:"user-icon",class:"w-8 h-8 mr-2"},null,-1),Y(" Add user ")])),_:1}),e("button",{onClick:o},[a(t(de),{class:"w-5 h-5"})])]),a(f,{type:"form",id:"submitForm","submit-label":"Update",onSubmit:Q,actions:!1},{default:u(()=>[e("div",Ze,[e("div",Ke,[a(f,{type:"text",label:"Username",validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"Username must contain only letters, no spaces or special characters"},modelValue:t(C),"onUpdate:modelValue":s[0]||(s[0]=p=>q(C)?C.value=p:null)},null,8,["modelValue"]),a(f,{type:"text",label:"First name",modelValue:t(x),"onUpdate:modelValue":s[1]||(s[1]=p=>q(x)?x.value=p:null),validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"First name must contain only letters, no spaces or special characters"}},null,8,["modelValue"])]),e("div",He,[a(f,{type:"text",label:"Middle name",modelValue:t(n),"onUpdate:modelValue":s[2]||(s[2]=p=>q(n)?n.value=p:null)},null,8,["modelValue"]),a(f,{type:"text",label:"Last name",modelValue:t(w),"onUpdate:modelValue":s[3]||(s[3]=p=>q(w)?w.value=p:null),validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"Last name must contain only letters, no spaces or special characters"}},null,8,["modelValue"])]),a(f,{type:"group"},{default:u(()=>[e("div",Xe,[a(f,{type:"password",label:"Password",name:"password",validation:"required",modelValue:t(R),"onUpdate:modelValue":s[4]||(s[4]=p=>q(R)?R.value=p:null),"validation-visibility":"live"},null,8,["modelValue"]),a(f,{type:"password",label:"Confirm password",name:"password_confirm",validation:"required|confirm","validation-label":"Password confirmation","validation-visibility":"live"})])]),_:1}),e("div",Ye,[s[14]||(s[14]=e("label",{class:"mr-5 font-medium text-lg"},"Sex",-1)),e("label",Je,[H(e("input",{required:"","onUpdate:modelValue":s[5]||(s[5]=p=>q(A)?A.value=p:null),type:"radio",value:"M",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[le,t(A)]]),s[12]||(s[12]=e("span",{class:"ml-2"},"Male",-1))]),e("label",Qe,[H(e("input",{required:"","onUpdate:modelValue":s[6]||(s[6]=p=>q(A)?A.value=p:null),type:"radio",value:"F",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[le,t(A)]]),s[13]||(s[13]=e("span",{class:"ml-2"},"Female",-1))])]),a(d,{label:"Select Role(s)","items-selected":t(S),"onUpdate:itemsSelected":s[7]||(s[7]=p=>q(S)?S.value=p:null),items:t(L),mode:"tags"},null,8,["items-selected","items"]),a(d,{label:"Select Laboratory Location(s)","items-selected":t(y),"onUpdate:itemsSelected":s[8]||(s[8]=p=>q(y)?y.value=p:null),items:t(I),mode:"tags"},null,8,["items-selected","items"]),a(d,{label:"Select Lab Section(s)","items-selected":t(r),"onUpdate:itemsSelected":s[9]||(s[9]=p=>q(r)?r.value=p:null),items:t(h),mode:"tags",direction:"top"},null,8,["items-selected","items"])]),e("div",We,[a(P,{type:"button",click:()=>{F()},text:"Clear form"},null,8,["click"]),a(v,{loading:t(G),type:"submit",click:()=>{},color:"success",icon:t(D),text:"Save Changes"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),tt={components:{TransitionRoot:ce,TransitionChild:J,Dialog:ne,DialogPanel:ie,DialogTitle:re,XMarkIcon:de,UserIcon:Fe},props:{data:{required:!0,type:Object}},data(){return{moment:Ae,open:!1,addIcon:we,viewIcon:Te,editIcon:ke,clearIcon:Me,details:{id:"",username:"",first_name:"",last_name:"",middle_name:"",sex:"",date_of_birth:"",lab_locations:new Array,roles:new Array,departments:new Array},loading:!1,cookie:se("token")}},methods:{async init(){this.loading=!0;const U={route:`${j.users}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:l,error:m,pending:D}=await B(U);this.loading=D,l.value&&(this.details=l.value,this.loading=!1,this.handleDialog()),m.value&&(console.error(m.value),this.loading=!1)},handleDialog(){this.open=!this.open}}},at={class:"fixed inset-0 overflow-y-auto"},st={class:"flex min-h-full items-center justify-center p-4 text-center"},lt={class:"border-b px-3 py-3 flex items-center justify-between"},ot={class:"flex items-center justify-center mx-auto my-20"},nt={class:"space-y-3 px-5 py-5"},it={class:"w-full flex flex-col space-y-1"},rt={class:"text-base text-gray-600"},dt={class:"w-full flex flex-col space-y-1"},ct={class:"text-base text-gray-600"},ut={class:"w-full flex flex-col space-y-1"},mt={class:"text-base text-gray-600"},pt={class:"w-full flex flex-col space-y-1"},vt={class:"w-full flex flex-col space-y-1"},ft={class:"w-full flex flex-col space-y-1"};function _t(U,l,m,D,r,h){const _=ue,$=T("TransitionChild"),L=T("DialogTitle"),M=T("XMarkIcon"),S=Ce,g=T("DialogPanel"),I=T("Dialog"),y=T("TransitionRoot");return k(),E("div",null,[e("div",null,[a(_,{text:"View",color:"primary",icon:r.viewIcon,click:h.init},null,8,["icon","click"])]),a(y,{appear:"",show:r.open,as:"template"},{default:u(()=>[a(I,{as:"div",onClose:h.handleDialog,class:"relative z-10"},{default:u(()=>[a($,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>l[1]||(l[1]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",at,[e("div",st,[a($,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[a(g,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[e("div",lt,[a(L,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:u(()=>l[2]||(l[2]=[e("img",{src:xe,class:"w-6 h-6 mr-2"},null,-1),Y(" View User Account ")])),_:1}),e("button",{onClick:l[0]||(l[0]=(...x)=>h.handleDialog&&h.handleDialog(...x))},[a(M,{class:"w-5 h-5"})])]),H(e("div",ot,[a(S,{loading:r.loading},null,8,["loading"])],512),[[oe,r.loading]]),H(e("div",nt,[e("div",it,[l[3]||(l[3]=e("label",{class:"font-semibold text-lg"},"Username",-1)),e("p",rt,z(r.details.username),1)]),e("div",dt,[l[4]||(l[4]=e("label",{class:"font-semibold text-lg"},"First name",-1)),e("p",ct,z(r.details.first_name),1)]),e("div",ut,[l[5]||(l[5]=e("label",{class:"font-semibold text-lg"},"Last name",-1)),e("p",mt,z(r.details.last_name),1)]),e("div",pt,[l[6]||(l[6]=e("label",{class:"font-semibold text-lg"},"Roles",-1)),(k(!0),E(fe,null,_e(r.details.roles,(x,n)=>(k(),E("p",{class:"text-base text-gray-600",key:n},z(x.role_name),1))),128))]),e("div",vt,[l[7]||(l[7]=e("label",{class:"font-semibold text-lg"},"Locations",-1)),(k(!0),E(fe,null,_e(r.details.lab_locations,(x,n)=>(k(),E("p",{class:"text-base text-gray-600",key:n},z(x.name),1))),128))]),e("div",ft,[l[8]||(l[8]=e("label",{class:"font-semibold text-lg"},"Departments",-1)),(k(!0),E(fe,null,_e(r.details.departments,(x,n)=>(k(),E("p",{class:"text-base text-gray-600",key:n},z(x.name),1))),128))])],512),[[oe,!r.loading]])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const gt=$e(tt,[["render",_t]]),yt={class:"mx-auto flex justify-center py-20 bg-white"},xt={class:"fixed inset-0 overflow-y-auto"},bt={class:"flex min-h-full items-center justify-center p-4 text-center"},ht={class:"border-b px-3 py-3 flex items-center justify-between"},wt={class:"mt-2 space-y-3 px-5 py-5"},kt={class:"grid grid-cols-2 gap-4"},$t={class:"grid grid-cols-2 gap-4"},Ct={class:"grid grid-cols-2 gap-4"},Vt={class:"w-full flex flex-col space-y-2"},Dt={class:"w-full flex flex-col space-y-2"},Ut={class:"flex items-center"},St={class:"flex items-center"},At={class:"flex items-center ml-2"},Tt={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},It=ge({__name:"index",props:{data:{}},emits:["update"],setup(U,{emit:l}){const m=U,D=i(!1),r=ke,h=De,_=i([]),$=i([]),L=i([]),M=i([]),S=i([]),g=i([]),I=se("token"),y=i([]),x=i([]),n=i([]),w=i(!1),C=i(!1),A=l,{$toast:R,$metadata:G}=ae(),c=i({id:"",username:"",first_name:"",last_name:"",middle_name:"",old_password:"",new_password:"",sex:"",date_of_birth:"",roles:[],lab_locations:[],departments:[]}),O=()=>{D.value=!D.value},Q=async()=>{const F={route:j.roles,method:"GET",token:`${I.value}`},{data:o,error:V}=await B(F);o.value&&(x.value=o.value,y.value=o.value.map(b=>b.name)),V.value&&console.error(V.value)},Z=async()=>{const F={route:j.locations,method:"GET",token:`${I.value}`},{data:o,error:V}=await B(F);o.value&&(M.value=o.value,S.value=o.value.map(b=>b.name)),V.value&&console.error(V.value)},me=()=>{L.value=G.departments,$.value=L.value.map(F=>F.name)},pe=async()=>{await Q(),await Z(),me(),O(),C.value=!0;const F={route:`${j.users}/${m.data.id}`,method:"GET",token:`${I.value}`},{data:o,error:V,pending:b}=await B(F);C.value=b,o.value&&(c.value=o.value,C.value=!1,n.value=o.value.roles.map(({role_name:s})=>{var v;return(v=x.value.find(f=>s===f.name))==null?void 0:v.name}).filter(s=>s!==void 0),_.value=o.value.departments.map(({name:s})=>{var v;return(v=L.value.find(f=>s===f.name))==null?void 0:v.name}).filter(s=>s!==void 0),g.value=o.value.lab_locations.map(({name:s})=>{var v;return(v=M.value.find(f=>s===f.name))==null?void 0:v.name}).filter(s=>s!==void 0)),V.value&&(console.error(V.value),C.value=!1)},ve=async()=>{w.value=!0;const F=_.value?_.value.map(d=>{var P;return(P=L.value.find(p=>d===p.name))==null?void 0:P.id}).filter(d=>d!==void 0).map(Number):[],o=n.value?n.value.map(d=>{var P;return(P=x.value.find(p=>d===p.name))==null?void 0:P.id}).filter(d=>d!==void 0):[],V=g.value?g.value.map(d=>{var P;return(P=M.value.find(p=>d===p.name))==null?void 0:P.id}).filter(d=>d!==void 0).map(Number):[],b={route:`${j.users}/${m.data.id}`,method:"PUT",token:`${I.value}`,body:{person:{first_name:c.value.first_name,middle_name:c.value.middle_name,last_name:c.value.last_name,sex:c.value.sex,date_of_birth:c.value.date_of_birth},user:{username:c.value.username,old_password:c.value.old_password,password:c.value.new_password},roles:o,departments:F,lab_locations:V}},{data:s,error:v,pending:f}=await B(b);w.value=f,s.value&&(O(),R.success("User updated successfully!"),w.value=!1,A("update",!0)),v.value&&(console.error(v.value),O(),R.error(Ie),w.value=!1)};return(F,o)=>{const V=ue,b=Ce,s=T("FormKit"),v=Ve,f=ye;return k(),E("div",null,[e("div",null,[a(V,{text:"Edit",color:"primary",icon:t(r),click:pe,loading:t(C)},null,8,["icon","loading"])]),a(t(ce),{appear:"",show:t(D),as:"template"},{default:u(()=>[a(t(ne),{as:"div",onClose:O,class:"relative z-10"},{default:u(()=>[a(t(J),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>o[10]||(o[10]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),H(e("div",yt,[a(b)],512),[[oe,t(C)]]),H(e("div",xt,[e("div",bt,[a(t(J),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[a(t(ie),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[e("div",ht,[a(t(re),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:u(()=>o[11]||(o[11]=[e("img",{src:xe,class:"w-8 h-8 mr-2",alt:"person-icon"},null,-1),Y(" Edit user ")])),_:1}),e("button",{onClick:O},[a(t(de),{class:"w-5 h-5"})])]),a(s,{type:"form","submit-label":"Update",onSubmit:ve,actions:!1},{default:u(()=>[e("div",wt,[e("div",kt,[a(s,{type:"text",label:"Username",modelValue:t(c).username,"onUpdate:modelValue":o[0]||(o[0]=d=>t(c).username=d),validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"Username must contain only letters and spaces"}},null,8,["modelValue"]),a(s,{type:"text",label:"First name",modelValue:t(c).first_name,"onUpdate:modelValue":o[1]||(o[1]=d=>t(c).first_name=d),validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"First name must contain only letters and spaces"}},null,8,["modelValue"])]),e("div",$t,[a(s,{type:"text",label:"Middle name",modelValue:t(c).middle_name,"onUpdate:modelValue":o[2]||(o[2]=d=>t(c).middle_name=d)},null,8,["modelValue"]),a(s,{type:"text",label:"Last name",modelValue:t(c).last_name,"onUpdate:modelValue":o[3]||(o[3]=d=>t(c).last_name=d),validation:"required|matches:/^[a-zA-Z']+$/","validation-messages":{matches:"Last name must contain only letters and spaces"}},null,8,["modelValue"])]),a(s,{type:"group"},{default:u(()=>[e("div",Ct,[e("div",Vt,[a(s,{type:"password",label:"New password",name:"password",modelValue:t(c).new_password,"onUpdate:modelValue":o[4]||(o[4]=d=>t(c).new_password=d),"validation-visibility":"live"},null,8,["modelValue"])]),e("div",Dt,[a(s,{type:"password",label:"Confirm new password",name:"password_confirm",validation:t(c).new_password&&"required|confirm","validation-label":"Password confirmation","validation-visibility":"live"},null,8,["validation"])])])]),_:1}),e("div",Ut,[o[14]||(o[14]=e("label",{class:"mr-5 font-medium text-lg"},"Sex",-1)),e("label",St,[H(e("input",{required:"","onUpdate:modelValue":o[5]||(o[5]=d=>t(c).sex=d),type:"radio",value:"M",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[le,t(c).sex]]),o[12]||(o[12]=e("span",{class:"ml-2"},"Male",-1))]),e("label",At,[H(e("input",{required:"","onUpdate:modelValue":o[6]||(o[6]=d=>t(c).sex=d),type:"radio",value:"F",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[le,t(c).sex]]),o[13]||(o[13]=e("span",{class:"ml-2"},"Female",-1))])]),a(v,{label:"Select Role(s)","items-selected":t(n),"onUpdate:itemsSelected":o[7]||(o[7]=d=>q(n)?n.value=d:null),items:t(y),mode:"tags"},null,8,["items-selected","items"]),a(v,{label:"Select Laboratory Location(s)","items-selected":t(g),"onUpdate:itemsSelected":o[8]||(o[8]=d=>q(g)?g.value=d:null),items:t(S),mode:"tags"},null,8,["items-selected","items"]),a(v,{label:"Select Lab Section(s)","items-selected":t(_),"onUpdate:itemsSelected":o[9]||(o[9]=d=>q(_)?_.value=d:null),items:t($),mode:"tags"},null,8,["items-selected","items"])]),e("div",Tt,[a(f,{type:"button",click:()=>{},text:"Clear form"}),a(V,{loading:t(w),type:"submit",click:()=>{},color:"success",icon:t(h),text:"Save Changes"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])],512),[[oe,!t(C)]])]),_:1})]),_:1},8,["show"])])}}}),Pt={components:{TransitionRoot:ce,TransitionChild:J,Dialog:ne,DialogPanel:ie,DialogTitle:re,XMarkIcon:de,ExclamationTriangleIcon:Pe},data(){return{show:!1,disableIcon:Ge,loading:!1,reason:"",cookie:se("token"),details:{id:"",username:"",first_name:"",last_name:"",middle_name:"",sex:"",date_of_birth:"",lab_locations:new Array,roles:new Array,departments:new Array}}},props:{data:{type:Object,required:!0}},methods:{async init(){this.loading=!0;const U={route:`${j.users}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:l,error:m,pending:D}=await B(U);this.loading=D,l.value&&(this.details=l.value,this.loading=!1,this.handleDialog()),m.value&&(console.error(m.value),this.loading=!1)},async deleteData(U){this.loading=!0;const l={route:`${j.users}/${U}`,method:"DELETE",token:`${this.cookie}`},{pending:m,error:D,data:r}=await B(l);this.loading=m,r.value&&(this.handleDialog(),ae().$toast.success(`${r.value.message}`),this.loading=!1,this.$emit("update",!0),this.reason=""),D.value&&(console.log(r.value),this.loading=!1)},async activate(U){this.loading=!0;const l={route:`${j.users}/activate/${U}`,method:"PUT",token:`${this.cookie}`,body:{retired_reason:this.reason}},{pending:m,error:D,data:r}=await B(l);this.loading=m,r.value&&(this.handleDialog(),ae().$toast.success(`${r.value.message}`),this.loading=!1,this.$emit("update",!0),this.reason=""),D.value&&(console.log(r.value),this.loading=!1)},handleDialog(){this.show=!this.show}}},qt={key:0},Et={key:1},Lt={class:"fixed inset-0 overflow-y-auto"},Ft={class:"flex min-h-full items-center justify-center p-4 text-center"},Mt={class:"border-b px-3 py-3 flex items-center justify-between"},Rt={class:"mt-2 space-y-3 px-5"},jt={class:"rounded px-2 py-2"},Bt={class:"font-semibold text-red-500"},Gt={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Nt(U,l,m,D,r,h){const _=ue,$=T("TransitionChild"),L=T("ExclamationTriangleIcon"),M=T("DialogTitle"),S=T("XMarkIcon"),g=T("FormKit"),I=ye,y=T("DialogPanel"),x=T("Dialog"),n=T("TransitionRoot");return k(),E("div",null,[e("div",null,[m.data.is_active?(k(),E("div",qt,[a(_,{click:h.init,color:"error",text:"Disable",icon:r.disableIcon},null,8,["click","icon"])])):X("",!0),m.data.is_active?X("",!0):(k(),E("div",Et,[a(_,{click:h.init,color:"success",text:"Enable",icon:r.disableIcon},null,8,["click","icon"])]))]),a(n,{appear:"",show:r.show,as:"template"},{default:u(()=>[a(x,{as:"div",class:"relative z-10"},{default:u(()=>[a($,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>l[3]||(l[3]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",Lt,[e("div",Ft,[a($,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[a(y,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[e("div",Mt,[a(M,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:u(()=>[a(L,{class:"h-5 w-5 mr-2"}),Y(" "+z(m.data.is_active?"Confirm disable":"Confirm activate"),1)]),_:1}),e("button",{onClick:l[0]||(l[0]=(...w)=>h.handleDialog&&h.handleDialog(...w))},[a(S,{class:"w-5 h-5"})])]),a(g,{type:"form","submit-label":"Update",onSubmit:l[2]||(l[2]=w=>m.data.is_active?h.deleteData(m.data.id):h.activate(m.data.id)),actions:!1},{default:u(({value:w})=>[e("div",Rt,[e("div",jt,[Y(" Do you want to "+z(m.data.is_active?"disable":"activate")+" ",1),e("span",Bt,z(m.data.username),1),l[4]||(l[4]=Y(" account? Note that once this action is completed, it can not be undone "))]),a(g,{type:"textarea",label:"Reason",validation:"required",modelValue:r.reason,"onUpdate:modelValue":l[1]||(l[1]=C=>r.reason=C)},null,8,["modelValue"])]),e("div",Gt,[a(I,{click:h.handleDialog,type:"button",text:"Cancel"},null,8,["click"]),a(_,{loading:r.loading,type:"submit",click:()=>{},color:"success",icon:r.disableIcon,text:"Continue"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const zt=$e(Pt,[["render",Nt]]),Ot=()=>{const U=i([{text:"id",value:"id",sortable:!0},{text:"username",value:"username",sortable:!0},{text:"full name",value:"fullname",sortable:!0},{text:"sex",value:"sex",sortable:!0},{text:"actions",value:"actions"}]),l=i([{name:"Home",link:"/home"},{name:"Access Controls",link:"#"}]);return{HEADERS:U,PAGES:l}},Zt={class:"py-5 px-5"},Kt={class:"flex items-center justify-between py-5"},Ht={class:"text-2xl font-semibold"},Xt={class:"flex justify-end w-full px-2 py-2 mb-2"},Yt={class:"py-2 flex items-center space-x-2"},pa=ge({__name:"user-accounts",setup(U){Be({title:`${je.name.toUpperCase()} - User Accounts`});const l=i("List of users"),m=Ot(),D=m.HEADERS.value,r=i([]),h=se("token"),_=i(!1),$=i(""),L=i(""),M=m.PAGES.value,S=i(0),g=i({page:1,rowsPerPage:25,sortBy:"name"}),I=qe(()=>r.value.map(n=>({id:n.id,is_active:n.is_active,username:n.username.charAt(0).toUpperCase()+n.username.slice(1),fullname:`${n.first_name} ${n.last_name}`,sex:n.sex})));async function y(){_.value=!0;const{page:n,rowsPerPage:w}=g.value,C={route:`${j.users}?page=${n}&per_page=${w}&search=${$.value}`,method:"GET",token:`${h.value}`},{data:A,error:R,pending:G}=await B(C);_.value=G,A.value&&(r.value=A.value.data,_.value=!1,S.value=A.value.meta.total_count),R.value&&(console.error(R.value),_.value=!1)}const x=n=>{typeof n=="object"&&(g.value=n)};return he($,()=>{y()}),he(g,()=>{y()}),Ee(()=>{y()}),(n,w)=>{const C=Ue,A=et,R=Le,G=gt,c=It,O=zt,Q=Re;return k(),E("div",Zt,[a(C,{pages:t(M)},null,8,["pages"]),e("div",Kt,[e("h3",Ht,z(t(l)),1),("usePermissions"in n?n.usePermissions:t(te))().can.manage("users")?(k(),ee(A,{key:0,onUpdate:y})):X("",!0)]),e("div",Xt,[a(R,{search:t($),"onUpdate:search":w[0]||(w[0]=Z=>q($)?$.value=Z:null)},null,8,["search"])]),("usePermissions"in n?n.usePermissions:t(te))().can.manage("users")?(k(),ee(Q,{key:0,headers:t(D),data:t(I),loading:t(_),searchField:"username",searchValue:t(L),serverItemsLength:t(S),serverOptions:t(g),onUpdate:x},{actions:u(({item:Z})=>[e("div",Yt,[("usePermissions"in n?n.usePermissions:t(te))().can.manage("users")?(k(),ee(G,{key:0,data:Z},null,8,["data"])):X("",!0),("usePermissions"in n?n.usePermissions:t(te))().can.manage("users")?(k(),ee(c,{key:1,data:Z,onUpdate:y},null,8,["data"])):X("",!0),("usePermissions"in n?n.usePermissions:t(te))().can.manage("users")?(k(),ee(O,{key:2,data:Z,onUpdate:y},null,8,["data"])):X("",!0)])]),_:1},8,["headers","data","loading","searchValue","serverItemsLength","serverOptions"])):X("",!0)])}}});export{pa as default};
