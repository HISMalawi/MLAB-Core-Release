import{_ as fe}from"./Breadcrumb.vue.c66aa30f.js";import{_ as ge}from"./Loader.17edb7c2.js";import{_ as he}from"./Dropdown.77434b8c.js";import{m as ye,V as xe,a as Ve,x as r,O as be,g as oe,o as f,c as g,d as s,e,w as k,v as j,l,h as we,z as _,S as se,F as B,r as E,t as ae,q as ke,k as U,i as Ue,b as ne,am as Ce,f as qe}from"./entry.7a85215a.js";import{_ as Te}from"./OutlinedButton.7579a73a.js";import{r as re,e as C,f as q,i as ie}from"./fetch.b3533157.js";import{s as Re,e as Se}from"./constants.8b327ee6.js";import{r as P}from"./XMarkIcon.3f6360b6.js";import{r as $e}from"./InformationCircleIcon.4922fd0b.js";import{r as Me}from"./ArrowDownTrayIcon.abb6941e.js";import"./nuxt-link.a46a2f01.js";import"./HomeIcon.d83c3686.js";import"./listbox.40261f8b.js";import"./hidden.38d3ab8c.js";import"./use-text-value.c03a06b7.js";import"./CheckIcon.5efdbc1a.js";import"./CheckCircleIcon.ca1d9483.js";import"./MagnifyingGlassIcon.cb45cf45.js";import"./transition.aeb06950.js";import"./PencilSquareIcon.c3173494.js";import"./PrinterIcon.be882207.js";const Ne={class:"px-5 py-5"},Ae=e("div",{class:"flex items-center justify-between"},[e("h3",{class:"text-2xl font-semibold mt-5"},"Create Test Type")],-1),Le={class:"flex items-center justify-center mx-auto my-20"},De={class:"mt-2 space-y-3"},Fe={class:"grid grid-cols-2 gap-4"},Oe={class:"w-full flex items-center"},je={class:"py-1 ml-2"},Be=e("p",{class:"font-medium text-base mb-2"},"Duration",-1),Ee={class:"w-full flex items-center space-x-2"},Pe=e("label",{for:"showCultureWorksheet"},"Show Culture Worksheet?",-1),Ie={class:"w-full flex flex-col space-y-2"},We=e("label",{class:"font-medium"},"Organisms",-1),Ge={class:"w-full flex flex-col space-y-2"},He=e("label",{class:"font-medium"},"Specimens",-1),Ke={class:"w-full flex items-center space-x-2"},ze=e("label",{for:"shouldPrintResults"},"Print Results On Small Label?",-1),Je={class:"w-full flex items-center"},Qe={class:"w-full flex flex-col space-y-2"},Xe=e("label",{class:"font-medium"},"Lab section",-1),Ye={class:"w-full flex"},Ze={class:"py-3 flex items-center justify-between"},et={class:"text-lg text-grameasuresy-700 font-semibold"},tt=["onClick"],lt={class:"grid grid-cols-4 gap-2 mb-3"},ot=e("p",{class:"font-medium mb-2"},"Type",-1),st={hidden:""},at={class:"flex items-center justify-center space-x-3"},nt={class:"grid grid-cols-2 gap-2"},rt={class:""},it=e("label",{class:"mb-2 text-lg font-semibold text-gray-600"},"Age Range",-1),ut={class:"grid grid-cols-2 gap-2"},dt={class:""},mt=e("label",{class:"mb-2 text-lg font-semibold text-gray-600"},"Measure Range",-1),ct={class:"grid grid-cols-2 gap-2"},pt=["onClick"],_t={class:"w-full flex items-center justify-center space-x-2"},vt={class:"w-full grid grid-cols-2 gap-4"},ft=["onClick"],gt={key:3,class:"flex items-center px-3 py-3 rounded bg-sky-50 mt-3 text-sky-500"},ht={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},Et=ye({__name:"index",setup(yt){const ue=xe(),b=Ve("token"),D=r(!1),v=r([]),T=r(""),R=r(""),S=r(""),I=r([]),p=r({name:"--select measure--"}),y=r(!1),$=r([]),W=r([]),G=r([]),M=r([]),N=r(!1),A=r(!1),de=r([{name:"Month"},{name:"Weeks"},{name:"Days"},{name:"Hours"},{name:"Minutes"}]),L=r({name:"-- select value --"}),H=r([]),K=r([]),z=r([]),w=r({name:"-- select value --"}),me=r(""),ce=[{name:"Home",link:"/home"},{name:"Test Catalog",link:"#"},{name:"Test Types",link:"/test-catalog/test-types"}];async function J(){const i={route:C.organisms,method:"GET",token:`${b.value}`},{error:t,data:n}=await q(i);n.value&&(W.value=n.value,n.value.map(m=>{G.value.push(m.name)})),t.value&&console.log(t.value)}async function Q(){D.value=!0;const i={route:C.specimens,method:"GET",token:`${b.value}`},{data:t,error:n}=await q(i);t.value&&(D.value=!1,H.value=t.value,t.value.map(m=>{K.value.push(String(m.name))})),n.value&&(D.value=!1,console.error(n.value))}async function X(){const i={route:C.departments,method:"GET",token:`${b.value}`},{data:t,error:n}=await q(i);t.value&&(z.value=t.value,w.value=t.value[0]),n.value&&console.error("error:",n.value)}async function Y(){var m;const i={route:`${C.testTypes}/test_indicator_types`,method:"GET",token:`${b.value}`},{data:t,error:n}=await q(i);t.value&&(I.value=t.value,p.value=t.value[0],me.value=String((m=p.value)==null?void 0:m.name)),n.value&&console.error(n.value)}function pe(i){try{const n=(v==null?void 0:v.value[i]).indicator_ranges;let m=0;if(n.length>0){const x=n.length-1;m=n[x].id}const c={id:m&&m+1,interpretation:""};p.value.name.toLowerCase().includes("numeric")?(c.age_max=0,c.age_min=0,c.upper_range=0,c.lower_range=0,c.gender={name:"-- select gender --"}):(p.value.name.toLowerCase()=="auto complete"||p.value.name.toLowerCase().includes("alpha"))&&(c.value=""),n.push(c)}catch(t){console.error("Error: ",t)}}const Z=(i,t)=>{v.value[i].indicator_ranges.splice(t,1)},_e=()=>{v.value.push({name:"",test_indicator_type:0,unit:"",description:"",indicator_ranges:[],value:"",id:""})},ee=i=>new Set(["free text","rich text"]).has(i);async function ve(){y.value=!0;const i=v.value.map(c=>{const x=c.indicator_ranges.map(h=>{if(h.hasOwnProperty("gender")){const{gender:F,...le}=h;return{...le,sex:F.name}}else return h});return{...c,indicator_ranges:x}}),t={route:C.testTypes,method:"POST",token:`${b.value}`,body:{name:T,short_name:R,expected_turn_around_time:{value:S,unit:L.value.name},print_device:N,department_id:w.value.id,specimens:ie(H.value,$.value),indicators:i,organisms:ie(W.value,M.value)}},{data:n,error:m,pending:u}=await q(t);y.value=u,n.value&&(ne().$toast.success("Test type created successfully!"),te(),ue.push("/test-catalog/test-types")),m.value&&(console.error("error creating test type: ",m.value),ne().$toast.error(Se))}const te=()=>{Ce("submitForm")};return be(()=>{Q(),X(),Y(),J()}),Q(),X(),Y(),J(),(i,t)=>{const n=fe,m=ge,u=oe("FormKit"),c=he,x=oe("multi-select"),h=qe,F=Te;return f(),g("div",Ne,[s(n,{pages:ce}),Ae,e("div",null,[k(e("div",Le,[s(m,{loading:l(y)},null,8,["loading"])],512),[[j,l(y)]]),k(e("div",null,[s(u,{id:"submitForm",type:"form","submit-label":"Update",onSubmit:ve,actions:!1},{default:we(({value:le})=>[e("div",De,[e("div",Fe,[s(u,{type:"text",label:"Name",validation:"required",modelValue:l(T),"onUpdate:modelValue":t[0]||(t[0]=o=>_(T)?T.value=o:null)},null,8,["modelValue"]),s(u,{type:"text",label:"Short name",validation:"required",modelValue:l(R),"onUpdate:modelValue":t[1]||(t[1]=o=>_(R)?R.value=o:null)},null,8,["modelValue"])]),e("div",Oe,[s(u,{type:"number",label:"Expected Turn Around Time",validation:"required|number",modelValue:l(S),"onUpdate:modelValue":t[2]||(t[2]=o=>_(S)?S.value=o:null)},null,8,["modelValue"]),e("div",je,[Be,s(c,{items:l(de),modelValue:l(L),"onUpdate:modelValue":t[3]||(t[3]=o=>_(L)?L.value=o:null)},null,8,["items","modelValue"])])]),e("div",Ee,[k(e("input",{id:"showCultureWorksheet",name:"showCultureWorksheet",type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=o=>_(A)?A.value=o:null)},null,512),[[se,l(A)]]),Pe]),k(e("div",Ie,[We,s(x,{style:{"--ms-max-height":"none !important"},modelValue:l(M),"onUpdate:modelValue":t[5]||(t[5]=o=>_(M)?M.value=o:null),options:l(G),mode:"tags",required:!1,clear:"",searchable:"",class:"focus:ring-none focus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])],512),[[j,l(A)]]),e("div",Ge,[He,s(x,{style:{"--ms-max-height":"none !important"},modelValue:l($),"onUpdate:modelValue":t[6]||(t[6]=o=>_($)?$.value=o:null),options:l(K),mode:"tags",required:"",searchable:"",clear:"",class:"focus:ring-none focus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])]),e("div",Ke,[k(e("input",{id:"shouldPrintResults",name:"shouldPrintResults",type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=o=>_(N)?N.value=o:null)},null,512),[[se,l(N)]]),ze]),e("div",Je,[e("div",Qe,[Xe,s(c,{"is-searchable":!0,modelValue:l(w),"onUpdate:modelValue":t[8]||(t[8]=o=>_(w)?w.value=o:null),items:l(z)},null,8,["modelValue","items"])])]),e("div",Ye,[s(h,{click:()=>{_e()},color:"primary",text:"Add Measure",icon:l(re)},null,8,["click","icon"])]),l(v).length!=0?(f(!0),g(B,{key:0},E(l(v),(o,V)=>(f(),g("div",{key:V,class:"border px-5 py-3 rounded"},[e("div",Ze,[e("h3",et," Measures ("+ae(V+1)+") ",1),e("button",{onClick:()=>{l(v).splice(V,1)}},[s(l(P),{class:"w-5 h-5"})],8,tt)]),e("div",lt,[s(u,{type:"text",label:"Name",validation:"required",modelValue:o.name,"onUpdate:modelValue":a=>o.name=a},null,8,["modelValue","onUpdate:modelValue"]),e("div",null,[ot,e("div",st,ae(o.test_indicator_type=Number(l(p).id)),1),s(c,{modelValue:l(p),"onUpdate:modelValue":t[9]||(t[9]=a=>_(p)?p.value=a:null),items:l(I)},null,8,["modelValue","items"])]),s(u,{type:"text",label:"Unit",modelValue:o.unit,"onUpdate:modelValue":a=>o.unit=a},null,8,["modelValue","onUpdate:modelValue"]),s(u,{type:"text",label:"Description",modelValue:o.description,"onUpdate:modelValue":a=>o.description=a},null,8,["modelValue","onUpdate:modelValue"])]),ee(l(p).name.toLowerCase())?U("",!0):(f(),ke(h,{key:0,type:"button",click:()=>{pe(V)},color:"primary",text:"Add New Range",icon:l(re)},null,8,["click","icon"])),o.indicator_ranges.length>0&&l(p).name==="Numeric"?(f(!0),g(B,{key:1},E(o.indicator_ranges,(a,O)=>(f(),g("div",{class:"px-3 py-3",key:a.id},[e("div",at,[e("div",nt,[e("div",rt,[it,e("div",ut,[s(u,{type:"number",label:"Minimum",validation:"required",modelValue:a.min_age,"onUpdate:modelValue":d=>a.min_age=d},null,8,["modelValue","onUpdate:modelValue"]),s(u,{type:"number",label:"Maximum",validation:"required",modelValue:a.max_age,"onUpdate:modelValue":d=>a.max_age=d},null,8,["modelValue","onUpdate:modelValue"]),s(c,{modelValue:a.gender,"onUpdate:modelValue":d=>a.gender=d,items:"sex"in i?i.sex:l(Re)},null,8,["modelValue","onUpdate:modelValue","items"])])]),e("div",dt,[mt,e("div",ct,[s(u,{type:"number",number:"",step:"any",label:"Minimum",validation:"required|required",modelValue:a.upper_range,"onUpdate:modelValue":d=>a.upper_range=d},null,8,["modelValue","onUpdate:modelValue"]),s(u,{type:"number",number:"",step:"any",label:"Maximum",validation:"required|required",modelValue:a.lower_range,"onUpdate:modelValue":d=>a.lower_range=d},null,8,["modelValue","onUpdate:modelValue"])])]),s(u,{type:"text",label:"Interpretation",validation:"required",modelValue:a.interpretation,"onUpdate:modelValue":d=>a.interpretation=d},null,8,["modelValue","onUpdate:modelValue"])]),e("button",{onClick:d=>Z(V,O)},[s(l(P),{class:"w-5 h-5"})],8,pt)])]))),128)):U("",!0),o.indicator_ranges.length>0&&l(p).name=="Auto Complete"||l(p).name==="Alpha Numeric"?(f(!0),g(B,{key:2},E(o.indicator_ranges,(a,O)=>(f(),g("div",{class:"px-3 py-3",key:a.id},[e("div",_t,[e("div",vt,[s(u,{type:"text",label:"Value",validation:"required",modelValue:a.value,"onUpdate:modelValue":d=>a.value=d},null,8,["modelValue","onUpdate:modelValue"]),s(u,{type:"text",label:"Interpretation",validation:"required",modelValue:a.interpretation,"onUpdate:modelValue":d=>a.interpretation=d},null,8,["modelValue","onUpdate:modelValue"])]),e("button",{onClick:d=>Z(V,O),class:"h-full bg-red-500 flex items-center justify-center rounded text-white px-4 py-2 mt-2"},[s(l(P),{class:"w-5 h-5"})],8,ft)])]))),128)):U("",!0),ee(l(p).name.toLowerCase())?(f(),g("div",gt,[s(l($e),{class:"w-5 h-5 mr-2"}),Ue(" A text box will appear for results entry ")])):U("",!0)]))),128)):U("",!0)]),e("div",ht,[s(F,{type:"button",click:()=>{te()},text:"Clear form"},null,8,["click"]),s(h,{type:"submit",click:()=>{},loading:l(y),color:"success",icon:l(Me),text:"Save Changes"},null,8,["loading","icon"])])]),_:1})],512),[[j,!l(y)]])])])}}});export{Et as default};
