import{_ as fe}from"./Breadcrumb.vue.48d266c2.js";import{_ as ge}from"./Loader.7a41138a.js";import{_ as he}from"./Dropdown.f8bbca59.js";import{l as ye,S as xe,u as Ve,s as r,M as be,f as oe,o as f,c as g,b as s,d as e,w as k,v as B,k as l,g as we,y as _,Q as se,F as E,r as O,t as ae,p as ke,j as U,h as Ue,a as ne,ao as Ce,e as Te}from"./entry.615ec979.js";import{_ as qe}from"./OutlinedButton.1ddb2698.js";import{r as re,e as C,f as T,i as ue}from"./fetch.25d6bbff.js";import{s as Re,e as Se}from"./constants.c9c8cf56.js";import{r as P}from"./XMarkIcon.4d88407f.js";import{r as $e}from"./InformationCircleIcon.8275a441.js";import{r as Me}from"./ArrowDownTrayIcon.3370be7b.js";import"./nuxt-link.aa9090bc.js";import"./HomeIcon.83ea769b.js";import"./listbox.96293176.js";import"./hidden.2bc01e3f.js";import"./use-text-value.70155605.js";import"./CheckIcon.52d590ad.js";import"./CheckCircleIcon.6ad075b0.js";import"./MagnifyingGlassIcon.3468acac.js";import"./transition.d4665360.js";import"./PencilSquareIcon.eaae9ab7.js";import"./PrinterIcon.9be93a85.js";const Ne={class:"px-5 py-5"},Ae=e("div",{class:"flex items-center justify-between"},[e("h3",{class:"text-2xl font-semibold mt-5"},"Create Test Type")],-1),Le={class:"flex items-center justify-center mx-auto my-20"},je={class:"mt-2 space-y-3"},De={class:"grid grid-cols-2 gap-4"},Fe={class:"w-full flex items-center"},Be={class:"py-1 ml-2"},Ee=e("p",{class:"font-medium text-base mb-2"},"Duration",-1),Oe={class:"w-full flex items-center space-x-2"},Pe=e("label",{for:"showCultureWorksheet"},"Show Culture Worksheet?",-1),Ie={class:"w-full flex flex-col space-y-2"},We=e("label",{class:"font-medium"},"Organisms",-1),Ge={class:"w-full flex flex-col space-y-2"},He=e("label",{class:"font-medium"},"Specimens",-1),Ke={class:"w-full flex items-center space-x-2"},Qe=e("label",{for:"shouldPrintResults"},"Print Results On Small Label?",-1),ze={class:"w-full flex items-center"},Je={class:"w-full flex flex-col space-y-2"},Xe=e("label",{class:"font-medium"},"Lab section",-1),Ye={class:"w-full flex"},Ze={class:"py-3 flex items-center justify-between"},et={class:"text-lg text-grameasuresy-700 font-semibold"},tt=["onClick"],lt={class:"grid grid-cols-4 gap-2 mb-3"},ot=e("p",{class:"font-medium mb-2"},"Type",-1),st={hidden:""},at={class:"flex items-center justify-center space-x-3"},nt={class:"grid grid-cols-2 gap-2"},rt={class:""},ut=e("label",{class:"mb-2 text-lg font-semibold text-gray-600"},"Age Range",-1),it={class:"grid grid-cols-2 gap-2"},dt={class:""},mt=e("label",{class:"mb-2 text-lg font-semibold text-gray-600"},"Measure Range",-1),ct={class:"grid grid-cols-2 gap-2"},pt=["onClick"],_t={class:"w-full flex items-center justify-center space-x-2"},vt={class:"w-full grid grid-cols-2 gap-4"},ft=["onClick"],gt={key:3,class:"flex items-center px-3 py-3 rounded bg-sky-50 mt-3 text-sky-500"},ht={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},Ot=ye({__name:"index",setup(yt){const ie=xe(),b=Ve("token"),j=r(!1),v=r([]),q=r(""),R=r(""),S=r(""),I=r([]),p=r({name:"--select measure--"}),y=r(!1),$=r([]),W=r([]),G=r([]),M=r([]),N=r(!1),A=r(!1),de=r([{name:"Month"},{name:"Weeks"},{name:"Days"},{name:"Hours"},{name:"Minutes"}]),L=r({name:"-- select value --"}),H=r([]),K=r([]),Q=r([]),w=r({name:"-- select value --"}),me=r(""),ce=[{name:"Home",link:"/home"},{name:"Test Catalog",link:"#"},{name:"Test Types",link:"/test-catalog/test-types"}];async function z(){const u={route:C.organisms,method:"GET",token:`${b.value}`},{error:t,data:n}=await T(u);n.value&&(W.value=n.value,n.value.map(m=>{G.value.push(m.name)})),t.value&&console.log(t.value)}async function J(){j.value=!0;const u={route:C.specimens,method:"GET",token:`${b.value}`},{data:t,error:n}=await T(u);t.value&&(j.value=!1,H.value=t.value,t.value.map(m=>{K.value.push(String(m.name))})),n.value&&(j.value=!1,console.error(n.value))}async function X(){const u={route:C.departments,method:"GET",token:`${b.value}`},{data:t,error:n}=await T(u);t.value&&(Q.value=t.value,w.value=t.value[0]),n.value&&console.error("error:",n.value)}async function Y(){var m;const u={route:`${C.testTypes}/test_indicator_types`,method:"GET",token:`${b.value}`},{data:t,error:n}=await T(u);t.value&&(I.value=t.value,p.value=t.value[0],me.value=String((m=p.value)==null?void 0:m.name)),n.value&&console.error(n.value)}function pe(u){try{const n=(v==null?void 0:v.value[u]).indicator_ranges;let m=0;if(n.length>0){const x=n.length-1;m=n[x].id}const c={id:m&&m+1,interpretation:""};p.value.name.toLowerCase().includes("numeric")?(c.age_max=0,c.age_min=0,c.upper_range=0,c.lower_range=0,c.gender={name:"-- select gender --"}):(p.value.name.toLowerCase()=="auto complete"||p.value.name.toLowerCase().includes("alpha"))&&(c.value=""),n.push(c)}catch(t){console.error("Error: ",t)}}const Z=(u,t)=>{v.value[u].indicator_ranges.splice(t,1)},_e=()=>{v.value.push({name:"",test_indicator_type:0,unit:"",description:"",indicator_ranges:[],value:"",id:""})},ee=u=>new Set(["free text","rich text"]).has(u);async function ve(){y.value=!0;const u=v.value.map(c=>{const x=c.indicator_ranges.map(h=>{if(h.hasOwnProperty("gender")){const{gender:D,...le}=h;return{...le,sex:D.name}}else return h});return{...c,indicator_ranges:x}}),t={route:C.testTypes,method:"POST",token:`${b.value}`,body:{name:q,short_name:R,expected_turn_around_time:{value:S,unit:L.value.name},print_device:N,department_id:w.value.id,specimens:ue(H.value,$.value),indicators:u,organisms:ue(W.value,M.value)}},{data:n,error:m,pending:i}=await T(t);y.value=i,n.value&&(ne().$toast.success("Test type created successfully!"),te(),ie.push("/test-catalog/test-types")),m.value&&(console.error("error creating test type: ",m.value),ne().$toast.error(Se))}const te=()=>{Ce("submitForm")};return be(()=>{J(),X(),Y(),z()}),J(),X(),Y(),z(),(u,t)=>{const n=fe,m=ge,i=oe("FormKit"),c=he,x=oe("multi-select"),h=Te,D=qe;return f(),g("div",Ne,[s(n,{pages:ce}),Ae,e("div",null,[k(e("div",Le,[s(m,{loading:l(y)},null,8,["loading"])],512),[[B,l(y)]]),k(e("div",null,[s(i,{id:"submitForm",type:"form","submit-label":"Update",onSubmit:ve,actions:!1},{default:we(({value:le})=>[e("div",je,[e("div",De,[s(i,{type:"text",label:"Name",validation:"required",modelValue:l(q),"onUpdate:modelValue":t[0]||(t[0]=o=>_(q)?q.value=o:null)},null,8,["modelValue"]),s(i,{type:"text",label:"Short name",validation:"required",modelValue:l(R),"onUpdate:modelValue":t[1]||(t[1]=o=>_(R)?R.value=o:null)},null,8,["modelValue"])]),e("div",Fe,[s(i,{type:"number",label:"Expected Turn Around Time",validation:"required|number",modelValue:l(S),"onUpdate:modelValue":t[2]||(t[2]=o=>_(S)?S.value=o:null)},null,8,["modelValue"]),e("div",Be,[Ee,s(c,{items:l(de),modelValue:l(L),"onUpdate:modelValue":t[3]||(t[3]=o=>_(L)?L.value=o:null)},null,8,["items","modelValue"])])]),e("div",Oe,[k(e("input",{id:"showCultureWorksheet",name:"showCultureWorksheet",type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=o=>_(A)?A.value=o:null)},null,512),[[se,l(A)]]),Pe]),k(e("div",Ie,[We,s(x,{style:{"--ms-max-height":"none !important"},modelValue:l(M),"onUpdate:modelValue":t[5]||(t[5]=o=>_(M)?M.value=o:null),options:l(G),mode:"tags",required:!1,clear:"",searchable:"",class:"focus:ring-none focus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])],512),[[B,l(A)]]),e("div",Ge,[He,s(x,{style:{"--ms-max-height":"none !important"},modelValue:l($),"onUpdate:modelValue":t[6]||(t[6]=o=>_($)?$.value=o:null),options:l(K),mode:"tags",required:"",searchable:"",clear:"",class:"focus:ring-none focus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])]),e("div",Ke,[k(e("input",{id:"shouldPrintResults",name:"shouldPrintResults",type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=o=>_(N)?N.value=o:null)},null,512),[[se,l(N)]]),Qe]),e("div",ze,[e("div",Je,[Xe,s(c,{"is-searchable":!0,modelValue:l(w),"onUpdate:modelValue":t[8]||(t[8]=o=>_(w)?w.value=o:null),items:l(Q)},null,8,["modelValue","items"])])]),e("div",Ye,[s(h,{click:()=>{_e()},color:"primary",text:"Add Measure",icon:l(re)},null,8,["click","icon"])]),l(v).length!=0?(f(!0),g(E,{key:0},O(l(v),(o,V)=>(f(),g("div",{key:V,class:"border px-5 py-3 rounded"},[e("div",Ze,[e("h3",et," Measures ("+ae(V+1)+") ",1),e("button",{onClick:()=>{l(v).splice(V,1)}},[s(l(P),{class:"w-5 h-5"})],8,tt)]),e("div",lt,[s(i,{type:"text",label:"Name",validation:"required",modelValue:o.name,"onUpdate:modelValue":a=>o.name=a},null,8,["modelValue","onUpdate:modelValue"]),e("div",null,[ot,e("div",st,ae(o.test_indicator_type=Number(l(p).id)),1),s(c,{modelValue:l(p),"onUpdate:modelValue":t[9]||(t[9]=a=>_(p)?p.value=a:null),items:l(I)},null,8,["modelValue","items"])]),s(i,{type:"text",label:"Unit",modelValue:o.unit,"onUpdate:modelValue":a=>o.unit=a},null,8,["modelValue","onUpdate:modelValue"]),s(i,{type:"text",label:"Description",modelValue:o.description,"onUpdate:modelValue":a=>o.description=a},null,8,["modelValue","onUpdate:modelValue"])]),ee(l(p).name.toLowerCase())?U("",!0):(f(),ke(h,{key:0,type:"button",click:()=>{pe(V)},color:"primary",text:"Add New Range",icon:l(re)},null,8,["click","icon"])),o.indicator_ranges.length>0&&l(p).name==="Numeric"?(f(!0),g(E,{key:1},O(o.indicator_ranges,(a,F)=>(f(),g("div",{class:"px-3 py-3",key:a.id},[e("div",at,[e("div",nt,[e("div",rt,[ut,e("div",it,[s(i,{type:"number",label:"Minimum",validation:"required",modelValue:a.min_age,"onUpdate:modelValue":d=>a.min_age=d},null,8,["modelValue","onUpdate:modelValue"]),s(i,{type:"number",label:"Maximum",validation:"required",modelValue:a.max_age,"onUpdate:modelValue":d=>a.max_age=d},null,8,["modelValue","onUpdate:modelValue"]),s(c,{modelValue:a.gender,"onUpdate:modelValue":d=>a.gender=d,items:"sex"in u?u.sex:l(Re)},null,8,["modelValue","onUpdate:modelValue","items"])])]),e("div",dt,[mt,e("div",ct,[s(i,{type:"number",number:"",step:"any",label:"Minimum",validation:"required|required",modelValue:a.upper_range,"onUpdate:modelValue":d=>a.upper_range=d},null,8,["modelValue","onUpdate:modelValue"]),s(i,{type:"number",number:"",step:"any",label:"Maximum",validation:"required|required",modelValue:a.lower_range,"onUpdate:modelValue":d=>a.lower_range=d},null,8,["modelValue","onUpdate:modelValue"])])]),s(i,{type:"text",label:"Interpretation",validation:"required",modelValue:a.interpretation,"onUpdate:modelValue":d=>a.interpretation=d},null,8,["modelValue","onUpdate:modelValue"])]),e("button",{onClick:d=>Z(V,F)},[s(l(P),{class:"w-5 h-5"})],8,pt)])]))),128)):U("",!0),o.indicator_ranges.length>0&&l(p).name=="Auto Complete"||l(p).name==="Alpha Numeric"?(f(!0),g(E,{key:2},O(o.indicator_ranges,(a,F)=>(f(),g("div",{class:"px-3 py-3",key:a.id},[e("div",_t,[e("div",vt,[s(i,{type:"text",label:"Value",validation:"required",modelValue:a.value,"onUpdate:modelValue":d=>a.value=d},null,8,["modelValue","onUpdate:modelValue"]),s(i,{type:"text",label:"Interpretation",validation:"required",modelValue:a.interpretation,"onUpdate:modelValue":d=>a.interpretation=d},null,8,["modelValue","onUpdate:modelValue"])]),e("button",{onClick:d=>Z(V,F),class:"h-full bg-red-500 flex items-center justify-center rounded text-white px-4 py-2 mt-2"},[s(l(P),{class:"w-5 h-5"})],8,ft)])]))),128)):U("",!0),ee(l(p).name.toLowerCase())?(f(),g("div",gt,[s(l($e),{class:"w-5 h-5 mr-2"}),Ue(" A text box will appear for results entry ")])):U("",!0)]))),128)):U("",!0)]),e("div",ht,[s(D,{type:"button",click:()=>{te()},text:"Clear form"},null,8,["click"]),s(h,{type:"submit",click:()=>{},loading:l(y),color:"success",icon:l(Me),text:"Save Changes"},null,8,["loading","icon"])])]),_:1})],512),[[B,!l(y)]])])])}}});export{Ot as default};
