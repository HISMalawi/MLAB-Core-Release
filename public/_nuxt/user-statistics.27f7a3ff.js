import{_ as ae}from"./Breadcrumb.vue.7469196c.js";import{_ as re}from"./Dropdown.57ff97da.js";import{o as v,c as f,e as s,m as oe,u as ne,C as r,a as le,L as w,H as ie,g as z,d as o,l as t,t as j,h as A,i as g,E as T,w as B,v as H,k as I,b as N,f as ce,A as ue,B as me,_ as pe}from"./entry.3ba6d4d3.js";import{_ as de}from"./Datatable.0a32cfee.js";import{_ as _e}from"./Loader.6f09c490.js";import{h as P,d as ve,e as q,f as E}from"./fetch.17eaab73.js";import{e as fe}from"./constants.1010fcbd.js";import{_ as ge}from"./report.901e14c7.js";import{_ as he}from"./page.5a4beaf3.js";import{P as xe}from"./package.babe1e72.js";import{w as ye}from"./vue-doc-download.966702c9.js";import{r as be}from"./FunnelIcon.66d24cfa.js";import{r as we}from"./ArrowPathIcon.36a7e1d6.js";import"./nuxt-link.24ac1730.js";import"./HomeIcon.e4f6e8f1.js";import"./listbox.752e36d3.js";import"./hidden.c42221ac.js";import"./use-text-value.1a122419.js";import"./CheckIcon.7ae673cc.js";import"./CheckCircleIcon.78484015.js";import"./MagnifyingGlassIcon.7fabd2c6.js";import"./transition.7e81bdc8.js";import"./XMarkIcon.7262efd1.js";import"./PencilSquareIcon.ded5f0ed.js";import"./PrinterIcon.93c5df84.js";function $e(u,n){return v(),f("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[s("path",{"fill-rule":"evenodd",d:"M3 6.75A.75.75 0 013.75 6h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 6.75zM3 12a.75.75 0 01.75-.75H12a.75.75 0 010 1.5H3.75A.75.75 0 013 12zm0 5.25a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z","clip-rule":"evenodd"})])}function Re(u,n){return v(),f("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[s("path",{d:"M6.25 6.375a4.125 4.125 0 118.25 0 4.125 4.125 0 01-8.25 0zM3.25 19.125a7.125 7.125 0 0114.25 0v.003l-.001.119a.75.75 0 01-.363.63 13.067 13.067 0 01-6.761 1.873c-2.472 0-4.786-.684-6.76-1.873a.75.75 0 01-.364-.63l-.001-.122zM19.75 7.5a.75.75 0 00-1.5 0v2.25H16a.75.75 0 000 1.5h2.25v2.25a.75.75 0 001.5 0v-2.25H22a.75.75 0 000-1.5h-2.25V7.5z"})])}const Se=""+new URL("word.873cd44d.png",import.meta.url).href,h=u=>(ue("data-v-b998859c"),u=u(),me(),u),De={class:"px-5 py-5"},ke={class:"flex items-center py-5"},Ce=h(()=>s("img",{src:ge,alt:"report-icon",class:"w-8 h-8 mr-2"},null,-1)),Ae={class:"text-2xl font-semibold uppercase"},Te={class:"w-full flex items-center justify-between mb-5"},Ne={class:"w-full flex items-center space-x-3"},Pe={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},Me={class:"w-72 ml-2"},Ue={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},Ve={class:"w-48 ml-2"},Le={class:"flex justify-end px-2 py-2"},Ye={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},ze={class:"w-48"},je={class:"flex justify-end px-2 py-2 mb-2"},Be=h(()=>s("button",{class:"flex text-sm bg-sky-500 px-4 py-2 rounded text-white"},[s("img",{src:Se,alt:"word-icon",class:"w-5 h-5 object-cover mr-2"}),g(" Export Word ")],-1)),He={key:0,id:"print-container"},Ie={key:1,class:"w-full flex flex-col items-center justify-center space-y-2 py-10"},qe=h(()=>s("img",{src:he,alt:"page-icon",class:"object-cover w-20 h-20"},null,-1)),Ee=h(()=>s("p",null,"Data not found, please generate report",-1)),Ge=[qe,Ee],Fe={class:"mx-auto justify-center flex flex-col items-center space-y-3"},Oe=h(()=>s("p",null,[g("Generating report, please wait"),s("span",{class:"animate-ping"},"...")],-1)),Ke=oe({__name:"user-statistics",setup(u){ne({title:`${xe.name.toUpperCase()} - User Statistics Report`});const n=r({name:"select report type"}),$=r(""),G=r(""),F=we,p=r(new Array),M=le("token"),R=r({page:1,rowsPerPage:100,sortBy:"name"}),U=r(0),l=r(!1),i=r([]),O=r("User Statistics Report"),V=r([]),S=r(!1),D=r({name:"Select and search for user..."}),K=r([{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"Aggregate Reports",link:"#"}]),W=r([{name:"Summary"},{name:"Specimen Registry"},{name:"Patients Registry"},{name:"Tests Registry"},{name:"Tests Performed"}]),J=w(()=>p.value.map(e=>({...e,created_date:P(e.created_date).format("DD/MMM/YYYY"),age:ve(e.date_of_birth)}))),Q=w(()=>V.value.map(e=>({id:e.id,name:`${e.first_name} ${e.last_name}`}))),X=w(()=>{const e={"tests performed":"test_type","patients registry":"actions","tests registry":"test_type_name","specimen registry":"specimen",summary:"user"},a=n.value.name.toLowerCase();return e[a]||""}),Z=w(()=>{const e={summary:new Array({text:"Name",value:"user",sortable:!0},{text:"Tests Received",value:"tests_received",sortable:!0},{text:"Specimen Collected",value:"specimen_collected",sortable:!0},{text:"Specimen Rejected",value:"specimen_rejected",sortable:!0},{text:"Tests Performed",value:"tests_completed",sortable:!0},{text:"Tests Authorized",value:"tests_authorized"}),"specimen registry":new Array({text:"Specimen Number",value:"id",sortable:!0},{text:"Name",value:"specimen",sortable:!0},{text:"Patient Number",value:"patient_no",sortable:!0},{text:"Name",value:"patient_no",sortable:!0},{text:"Date Registered",value:"created_date",sortable:!0}),"tests registry":new Array({text:"Test Type",value:"test_type_name",sortable:!0},{text:"Patient Number",value:"client.id",sortable:!0},{text:"Patient Name",value:"actions",sortable:!0},{text:"Specimen",value:"specimen_type",sortable:!0},{text:"Date Registered",value:"created_date"}),"patients registry":new Array({text:"Patient Number",value:"id",sortable:!0},{text:"Name",value:"actions",sortable:!0},{text:"Gender",value:"sex",sortable:!0},{text:"Age",value:"age",sortable:!0},{text:"Date Registered",value:"created_date",sortable:!0}),"tests performed":new Array({text:"Test Id",value:"test_id",sortable:!0},{text:"Test Type",value:"test_type",sortable:!0},{text:"Patient No",value:"patient_no",sortable:!0},{text:"Patient Name",value:"patient_name",sortable:!0},{text:"Accession Number",value:"accession_number",sortable:!0},{text:"Date Registered",value:"created_date"})},a=n.value.name.toLowerCase();return e[a]||new Array});async function L(){if(Y(n.value)=="")N().$toast.warning("Please select a report type!");else{l.value=!0;let e=i.value[0].toDateString()!=""?P(i.value[0].toDateString()).format("YYYY-MM-DD"):"",a=i.value[1].toDateString()!=""?P(i.value[1].toDateString()).format("YYYY-MM-DD"):"";const{page:m,rowsPerPage:x}=R.value;let y=`from=${e}&to=${a}&report_type=${Y(n.value).toLocaleLowerCase()}&page=${m}&limit=${x}&search=${$.value}`;const k={route:`${q.aggregateReports}user_statistics?${y}`,method:"GET",token:`${M.value}`},{data:d,error:b,pending:C}=await E(k);l.value=C,d.value&&(l.value=!1,p.value=d.value.data.tests,U.value=d.value.data.metadata.total_count,N().$toast.success("Report data generated successfully")),b.value&&(l.value=!1,console.error(b.value),N().$toast.success(fe))}}async function ee(){const e={route:`${q.users}?page=1&per_page=2000`,method:"GET",token:`${M.value}`},{data:a,error:m,pending:x}=await E(e);a.value&&(V.value=a.value.data),m.value&&console.error(m.value)}function Y(e){return e.name=="select report type"?"":e.name}function te(e){typeof e=="object"&&(R.value=e)}function se(e){$.value=e,G.value=e,L()}return ie(()=>n.value,(e,a)=>{e!==a&&(p.value=new Array),e.name.toLowerCase()=="summary"?(ee(),S.value=!0):S.value=!1}),(e,a)=>{const m=ae,x=z("datepicker"),y=re,k=ce,d=z("FormKit"),b=de,C=_e;return v(),f("div",De,[o(m,{pages:t(K)},null,8,["pages"]),s("div",ke,[Ce,s("h3",Ae,j(t(O)),1)]),s("div",Te,[o(d,{type:"form","submit-label":"Update",onSubmit:L,actions:!1,id:"submitForm"},{default:A(({value:c})=>[s("div",Ne,[s("div",Pe,[o(t(be),{class:"w-5 h-5 mr-2"}),g(" Filter By Date Range "),s("div",Me,[o(x,{required:"",position:"left",placeholder:"-- select start & end date --",range:!0,"input-class-name":"datepicker",modelValue:t(i),"onUpdate:modelValue":a[0]||(a[0]=_=>T(i)?i.value=_:null)},null,8,["modelValue"])])]),s("div",Ue,[o(t($e),{class:"w-5 h-5 mr-2 my-2.5"}),g(" Report Type "),s("div",Ve,[o(y,{class:"bg-white",items:t(W),modelValue:t(n),"onUpdate:modelValue":a[1]||(a[1]=_=>T(n)?n.value=_:null)},null,8,["items","modelValue"])])]),B(s("div",Le,[s("div",Ye,[o(t(Re),{class:"w-5 h-5 mr-2 my-2.5"}),g(" User "),o(y,{class:"ml-2 bg-white",isSearchable:!0,items:t(Q),modelValue:t(D),"onUpdate:modelValue":a[2]||(a[2]=_=>T(D)?D.value=_:null),onUpdate:se},null,8,["items","modelValue"])])],512),[[H,t(S)]]),s("div",ze,[o(k,{type:"submit",color:"success",text:"Generate Report",icon:t(F),click:()=>{},loading:t(l)},null,8,["icon","loading"])])])]),_:1}),s("div",je,[o(t(ye),{element:"print-container",filename:"document"},{default:A(()=>[Be]),_:1})])]),t(p).length>0?(v(),f("div",He,[o(b,{headers:t(Z),data:t(J),serverItemsLength:t(U),serverOptions:t(R),loading:t(l),"search-field":t(X),"search-value":t($),onUpdate:te},{actions:A(({item:c})=>[s("td",null,j(t(n).name.toLowerCase()=="patients registry"?`${c.first_name}
                                            ${c.middle_name} ${c.last_name}`:`${c.client.first_name} ${c.client.middle_name}
                                            ${c.client.last_name}`),1)]),_:1},8,["headers","data","serverItemsLength","serverOptions","loading","search-field","search-value"])])):I("",!0),t(p).length==0&&!t(l)?(v(),f("div",Ie,Ge)):I("",!0),B(s("div",Fe,[o(C),Oe],512),[[H,t(l)]])])}}});const yt=pe(Ke,[["__scopeId","data-v-b998859c"]]);export{yt as default};
