import{_ as I}from"./Breadcrumb.cfeb06ed.js";import{_ as B}from"./SearchBar.ef21d529.js";import{u as S,a as A,_ as j,o as n,c as a,b as d,d as e,w as g,v,F as u,r as m,t as y,e as q}from"./entry.6a3fbfc1.js";import{_ as E}from"./Loader.2c2cb550.js";import{u as L}from"./vue.f36acd1f.f8958c90.js";import{e as h,f as _}from"./fetch.444ade97.js";import{P as R}from"./package.d411c004.js";import{r as U}from"./AdjustmentsVerticalIcon.81e4d963.js";import{r as G}from"./ArrowDownTrayIcon.fa0f85a0.js";import{r as N}from"./MagnifyingGlassIcon.ba982fe1.js";import{r as T}from"./InformationCircleIcon.3f2e808a.js";import{r as V}from"./EllipsisVerticalIcon.8049ed97.js";import"./nuxt-link.bebad584.js";import"./HomeIcon.54ceb79b.js";import"./XMarkIcon.fd9a39e2.js";import"./constants.cf42f90d.js";import"./transition.9bb58b2a.js";import"./hidden.e85239c2.js";import"./PencilSquareIcon.79aa7948.js";import"./PrinterIcon.b8623d34.js";const $={setup(){L({title:`${R.name.toUpperCase()} - Permissions`})},data(){return{filterIcon:U,saveIcon:G,pages:[{name:"Home",link:"/home"},{name:"Access Controls",link:"#"}],search:"",privileges:new Array,roles:new Array,cookie:S("token"),loading:!1}},components:{MagnifyingGlassIcon:N,InformationCircleIcon:T,EllipsisVerticalIcon:V},created(){this.init(),this.loadRoles()},computed:{filteredPrivileges(){if(!this.search)return this.privileges;const t=this.search.toLowerCase();return this.privileges.filter(s=>s.display_name.toLowerCase().includes(t))}},methods:{async init(){this.loading=!0;const t={route:h.privileges,method:"GET",token:`${this.cookie}`},{data:s,pending:r,error:i}=await _(t);s.value&&(this.privileges=s.value,this.loading=!1),i.value&&(console.error(i.value),this.loading=!1)},async loadRoles(){const t={route:h.roles,method:"GET",token:`${this.cookie}`},{data:s,error:r}=await _(t);s.value&&(this.roles=s.value),r.value&&console.error(r.value)},async update(){this.loading=!0;const t={route:`${h.roles}/update_permissions`,method:"PUT",token:`${this.cookie}`,body:{role_privileges:this.roles}},{data:s,pending:r,error:i}=await _(t);s.value&&(this.loading=!1,A().$toast.success("Permissions updated successfully!"),this.init(),this.loadRoles()),i.value&&(this.loading=!1,console.error(i.value))},updatePermissions(t,s,r){t.target.checked?s.privileges.push(r):s.privileges.map((i,o)=>{i.id===r.id&&s.privileges.splice(o,1)})},updateSearch(t){this.search=t}}},D={class:"px-5 py-5"},F=e("div",{class:"flex items-center justify-between py-5"},[e("h3",{class:"text-2xl font-semibold"},"Permissions")],-1),H={class:"flex items-center space-x-3 justify-between"},M={class:"w-full mt-5 rounded"},z={class:"flex items-center mx-auto justify-center py-20"},J={class:"overflow-x-auto mb-20 rounded"},K={class:"table-auto w-full border-collapse border rounded"},O={class:"border-b"},Q=e("th",{class:"px-20 py-2 text-left uppercase font-semibold border sticky left-0 bg-white"},"Permissions",-1),W={class:"border-r sticky left-0 bg-white"},X={class:"space-y-2 border-l border-r"},Y={class:"flex items-center justify-between border-b py-2 px-4 hover:bg-gray-100 transition duration-150 hover:font-medium"},Z=["checked","onChange"];function ee(t,s,r,i,o,c){const b=I,x=B,k=q,w=E;return n(),a("div",D,[d(b,{pages:o.pages},null,8,["pages"]),F,e("div",H,[d(x,{search:o.search,onUpdate:c.updateSearch},null,8,["search","onUpdate"]),d(k,{loading:o.loading,click:()=>{c.update()},text:"Save changes",color:"success",icon:o.saveIcon},null,8,["loading","click","icon"])]),e("div",M,[g(e("div",z,[d(w,{loading:o.loading},null,8,["loading"])],512),[[v,o.loading]]),g(e("div",J,[e("table",K,[e("thead",O,[e("tr",null,[Q,(n(!0),a(u,null,m(o.roles,l=>(n(),a("th",{class:"px-4 py-2 text-left uppercase font-semibold",key:l.id},y(l.name),1))),128))])]),e("tbody",null,[(n(!0),a(u,null,m(c.filteredPrivileges,(l,C)=>(n(),a("tr",{key:C},[e("td",W,[e("div",X,[e("div",Y,[e("p",null,y(l.display_name),1)])])]),(n(!0),a(u,null,m(o.roles,(f,P)=>(n(),a("td",{class:"border px-4 py-2",key:P},[e("input",{type:"checkbox",checked:f.privileges.filter(p=>p.name==l.name).length>0,class:"mr-2 leading-tight",onChange:p=>{c.updatePermissions(p,f,l)}},null,40,Z)]))),128))]))),128))])])],512),[[v,!o.loading]])])])}const xe=j($,[["render",ee]]);export{xe as default};
