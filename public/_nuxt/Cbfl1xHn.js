import{_ as Q}from"./DeHqjJH7.js";import{S as R,p as P,Y as j,G as A,V as F,q as B,a as $,u as O,s as N,x as m,b as x,e as D,g as e,f as o,y as l,j as H,_ as T,d as Y,r as V,h as _,A as J,m as U,l as X,z as k,L as C,H as q,D as E,t as i,F as K,k as Z,i as W,v as ee}from"./BLMYYBub.js";import{_ as te}from"./Dz4s_-UK.js";import{S}from"./DPmaYSTO.js";import{r as se}from"./CnGMDaSy.js";import{r as oe}from"./DnJ5gH3O.js";import{r as re}from"./B77w2j_x.js";import{r as ie}from"./ClTnEHmM.js";import{_ as ne}from"./BOt9Lm4e.js";import{_ as ae}from"./B6_2qwyC.js";import{r as L}from"./9NBlOp5g.js";import{u as le}from"./B4BIo1yJ.js";import{r as de}from"./Bp_YRZwq.js";import{r as ce}from"./CFxj9TAl.js";import{r as M}from"./Cy4dTOpp.js";import{_ as ue}from"./Gj1XiySU.js";import{_ as pe}from"./IQzdcCmk.js";import{_ as me}from"./CJcSPQ8s.js";import{P as fe}from"./CM4UxiDe.js";import{u as _e}from"./CfmpkH2n.js";import{r as he}from"./BvmvZzqk.js";import{r as ge}from"./BZ4S9scB.js";import{r as be}from"./6ry9hSgf.js";import"./sNlKP72R.js";import"./DliR-cc7.js";import"./BlFheT0q.js";import"./IJCDyQty.js";import"./cHOIL3XF.js";import"./CkgugtXF.js";import"./BpACQbkq.js";import"./OnYuLN16.js";import"./DDt9YMgi.js";const ve={components:{TransitionRoot:R,TransitionChild:P,Dialog:j,DialogPanel:A,DialogTitle:F,XMarkIcon:B,UserIcon:se},data(){return{open:!1,addIcon:oe,saveIcon:re,clearIcon:ie,loading:!1,voucherId:"",description:"",cookie:$("token")}},methods:{async checkVoucherValidity(){this.loading=!0;const r=new S,{data:t,error:d,pending:p}=await r.checkStockOrder(`${this.cookie}`,{voucher_number:Number(this.voucherId)});this.loading=p,t.value&&(t.value.used?O().$toast.warn("Order already exists"):this.$router.push(`/stock-management/orders/${this.voucherId}`),this.loading=!1),d.value&&(console.error(d.value),this.loading=!1)},handleClick(){this.open=!this.open},clearForm(){this.$formkit.reset("submitForm")}}},xe={class:"fixed inset-0 overflow-y-auto"},ye={class:"flex min-h-full items-center justify-center p-4 text-center"},we={class:"border-b px-3 py-3 flex items-center justify-between"},ke={class:"mt-2 space-y-3"},Ce={class:"w-full flex items-center px-5"},De={class:"w-full flex flex-col space-y-2"},Se={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Ie(r,t,d,p,s,n){const h=T,f=m("TransitionChild"),g=m("DialogTitle"),y=m("XMarkIcon"),w=m("FormKit"),v=te,b=m("DialogPanel"),a=m("Dialog"),c=m("TransitionRoot");return x(),D("div",null,[e("div",null,[o(h,{text:"Create order",color:"primary",icon:s.addIcon,click:n.handleClick},null,8,["icon","click"])]),o(c,{appear:"",show:s.open,as:"template"},{default:l(()=>[o(a,{as:"div",onClose:n.handleClick,class:"relative z-10"},{default:l(()=>[o(f,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>t[2]||(t[2]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",xe,[e("div",ye,[o(f,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[o(b,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[e("div",we,[o(g,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:l(()=>t[3]||(t[3]=[H(" Create stock order ")])),_:1}),e("button",{onClick:t[0]||(t[0]=(...u)=>n.handleClick&&n.handleClick(...u))},[o(y,{class:"w-5 h-5"})])]),o(w,{type:"form","submit-label":"Update",actions:!1,onSubmit:n.checkVoucherValidity,id:"submitForm"},{default:l(({value:u})=>[e("div",ke,[e("div",Ce,[e("div",De,[o(w,{type:"text",label:"Voucher ID",validation:"required",modelValue:s.voucherId,"onUpdate:modelValue":t[1]||(t[1]=I=>s.voucherId=I)},null,8,["modelValue"])])])]),e("div",Se,[o(v,{type:"button",click:()=>{n.clearForm()},text:"Clear form"},null,8,["click"]),o(h,{loading:s.loading,type:"submit",click:()=>{},color:"success",icon:s.saveIcon,text:"Continue"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const Ve=N(ve,[["render",Ie]]),Oe={class:"fixed inset-0 overflow-y-auto"},Le={class:"flex top-0 items-center justify-center p-4 text-center"},Pe={class:"border-b px-3 py-3 flex items-center justify-between"},Be={class:"py-5 px-5"},$e={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},Te=Y({__name:"index",props:{orderId:{}},emits:["update"],setup(r,{emit:t}){const d=r,p=t,s=V(!1),n=$("token"),h=V([]),f=V(""),g=V(!1),y=async()=>{v();const{data:b,error:a}=await U({route:X.printers,method:"GET",token:`${n.value}`});b.value&&(h.value=[],b.value.map(c=>{h.value.push(c.name)})),a.value&&console.error(a.value)},w=async()=>{g.value=!0;const b=new FormData;b.append("printer_name",f.value);const a={route:`${X.stockOrderPrint}${d.orderId}`,method:"POST",token:`${n.value}`,body:b},{data:c,error:u}=await U(a);g.value=!1,c.value&&(c.value.printed?O().$toast.success("Order report printed successfully!"):O().$toast.warning("Could not print report!"),p("update",!0),v()),u.value&&(console.error(u.value),O().$toast.error("An error occurred while printing report"),v())},v=()=>{s.value=!s.value};return(b,a)=>{const c=T,u=m("FormKit");return x(),D("div",null,[o(c,{click:y,color:"primary",text:"Print",icon:_(L)},null,8,["icon"]),o(_(R),{appear:"",show:_(s),as:"template"},{default:l(()=>[o(_(j),{as:"div",class:"relative z-10"},{default:l(()=>[o(_(P),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>a[1]||(a[1]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",Oe,[e("div",Le,[o(_(P),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[o(_(A),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[e("div",Pe,[o(_(F),{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>[o(_(L),{class:"h-5 w-5 mr-2"}),a[2]||(a[2]=H(" Print "))]),_:1}),e("button",{onClick:v},[o(_(B),{class:"w-5 h-5"})])]),o(u,{type:"form","submit-label":"Print",onSubmit:w,actions:!1},{default:l(({value:I})=>[e("div",Be,[o(u,{validation:"required",label:"Select a printer",type:"radio",modelValue:_(f),"onUpdate:modelValue":a[0]||(a[0]=G=>J(f)?f.value=G:null),options:_(h)},null,8,["modelValue","options"])]),e("div",$e,[o(c,{click:()=>{},loading:_(g),type:"submit",icon:_(L),text:"Print",color:"success"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),qe={components:{TransitionRoot:R,TransitionChild:P,Dialog:j,DialogPanel:A,DialogTitle:F,XMarkIcon:B,TicketIcon:de},data(){return{viewIcon:ce,show:!1,editIcon:M,facility:le(),cookie:$("token"),loading:!1,requisitions:new Array,voidReason:"",issuerName:"",issuerDesignation:"",issuerPhone:"",issuerSignature:"",approverName:"",approverDesignation:"",approverPhone:"",approverSignature:"",issuedDate:"",approvedDate:"",preparedBy:"",preparedDesignation:"",preparedSignature:"",preparedDate:"",certifiedBy:"",certifiedDesignation:"",certifiedSignature:"",certifiedDate:"",collectedBy:"",collectedDesignation:"",collectedSignature:"",collectedDate:"",verifiedBy:"",verifiedDesignation:"",verifiedSignature:"",verifiedDate:""}},props:{data:{type:Object,required:!0}},methods:{async openDialog(){await this.init(),this.handleClick()},async init(){this.loading=!0;const r=new S,{data:t,error:d,pending:p}=await r.getStockOrder(`${this.cookie}`,`${this.data.id}`);this.loading=p,t.value&&(this.requisitions=t.value.stock_requisitions,this.loading=!1,t.value.stock_pharmacy_approver_and_issuers.map(s=>{s.record_type=="issuer"?(this.issuerName=s.name,this.issuerPhone=s.phone_number,this.issuerDesignation=s.designation,this.issuerSignature=s.signature,this.issuedDate=k(s.created_date).format(C)):(this.approverName=s.name,this.approverPhone=s.phone_number,this.approverDesignation=s.designation,this.approverSignature=s.signature,this.approvedDate=k(s.created_date).format(C))}),t.value.stock_order_status_trail.map(s=>{s.stock_status.name.toLowerCase()=="draft"?(this.preparedBy=`${s.initiator.first_name} ${s.initiator.last_name}`,this.preparedDesignation="Laboratory",this.preparedSignature=s.initiator.username,this.preparedDate=k(s.created_date).format(C)):s.stock_status.name.toLowerCase()=="requested"?(this.certifiedBy=`${s.initiator.first_name} ${s.initiator.last_name}`,this.certifiedDesignation="Laboratory",this.certifiedSignature=s.initiator.username,this.certifiedDate=k(s.created_date).format(C)):s.stock_status.name.toLowerCase()=="received"?(this.collectedBy=`${s.initiator.first_name} ${s.initiator.last_name}`,this.collectedDesignation="Laboratory",this.collectedSignature=s.initiator.username,this.collectedDate=k(s.created_date).format(C)):s.stock_status.name.toLowerCase()=="approved"&&(this.verifiedBy=`${s.initiator.first_name} ${s.initiator.last_name}`,this.verifiedDesignation="Laboratory",this.verifiedSignature=s.initiator.username,this.verifiedDate=k(s.created_date).format(C))})),d.value&&(console.error(d.value),this.loading=!1)},handleClick(){this.show=!this.show}}},z="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M9%206C7.34315%206%206%207.34315%206%209V39C6%2040.6569%207.34315%2042%209%2042H39C40.6569%2042%2042%2040.6569%2042%2039V9C42%207.34315%2040.6569%206%2039%206H9ZM20.8%2016L28.2%2016.0002V17.0001C28.2%2017.2855%2028.4226%2017.7213%2028.8491%2018.2037C29.0393%2018.4187%2029.2325%2018.6011%2029.3792%2018.7302C29.4519%2018.7941%2029.5114%2018.8434%2029.5511%2018.8755C29.5708%2018.8915%2029.5856%2018.9031%2029.5944%2018.9099L29.6024%2018.9161L30%2019.2159V21H28V20.1802C27.8169%2020.016%2027.5851%2019.7935%2027.3509%2019.5285C27.033%2019.1691%2026.6234%2018.6359%2026.3884%2018L22.5447%2018.0001C22.493%2018.1099%2022.4389%2018.2107%2022.3881%2018.3C22.1834%2018.6601%2021.9233%2019.0165%2021.6825%2019.3192C21.4385%2019.6258%2021.197%2019.8987%2021.0178%2020.0938L21%2020.1132V31.5C21%2033.433%2022.567%2035%2024.5%2035C25.8962%2035%2027.1015%2034.1825%2027.6632%2033H29.793C29.14%2035.3085%2027.0176%2037%2024.5%2037C21.4624%2037%2019%2034.5376%2019%2031.5V19.3017L19.2907%2019.0095L19.2934%2019.0067L19.3054%2018.9944C19.3166%2018.983%2019.3338%2018.9654%2019.3561%2018.9421C19.4009%2018.8955%2019.466%2018.8268%2019.5447%2018.7411C19.703%2018.5687%2019.9115%2018.3327%2020.1175%2018.0738C20.3266%2017.811%2020.5166%2017.5453%2020.6494%2017.3117C20.7524%2017.1304%2020.785%2017.0302%2020.7953%2016.9986C20.7977%2016.991%2020.7989%2016.9874%2020.7995%2016.9875C20.7994%2016.9872%2020.7996%2016.9875%2020.7995%2016.9875C20.7995%2016.9877%2020.7999%2016.9886%2020.7999%2016.989L20.8%2016.9932V16ZM32%2028.0909C32%2029.6976%2030.6569%2031%2029%2031C27.3431%2031%2026%2029.6976%2026%2028.0909C26%2025.5455%2029%2023%2029%2023C29%2023%2032%2025.5455%2032%2028.0909ZM29%2010H20V14H29V10Z'%20fill='currentColor'/%3e%3c/svg%3e",Me={class:"fixed inset-0 overflow-y-auto"},Re={class:"flex min-h-full items-center justify-center p-4 text-center"},je={class:"border-b px-3 py-3 flex items-center justify-between"},Ae={class:"py-5 px-5 space-y-3 print-container",id:"print-container"},Fe={class:"flex bg-gray-50 border-l-4 border-l-100 rounded-r px-2 py-2 items-center space-x-2"},Ne={class:"mt-3"},He={class:"w-full"},Ue={class:"px-2 py-2 border-r"},Xe={class:"px-2 py-2 border-r"},ze={class:"px-2 py-2 border-r"},Ee={class:"px-2 py-2 border-r"},Ke={class:"rounded border mt-5"},Ze={class:"w-full grid grid-cols-2 gap-5 py-5 px-5"},Ge={class:"col-span-1 flex flex-col space-y-2"},Qe={class:"w-full flex items-center space-x-2"},Ye={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Je={class:"w-full flex items-center space-x-2"},We={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},et={class:"w-full flex items-center space-x-2"},tt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},st={class:"w-full flex items-center space-x-2"},ot={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},rt={class:"col-span-1 flex flex-col space-y-2"},it={class:"w-full flex items-center space-x-2"},nt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},at={class:"w-full flex items-center space-x-2"},lt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},dt={class:"w-full flex items-center space-x-2"},ct={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ut={class:"w-full flex items-center space-x-2"},pt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},mt={class:"rounded border mt-5"},ft={class:"w-full grid grid-cols-2 gap-5 py-5 px-5"},_t={class:"col-span-1 flex flex-col space-y-2"},ht={class:"w-full flex items-center space-x-2"},gt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},bt={class:"w-full flex items-center space-x-2"},vt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},xt={class:"w-full flex items-center space-x-2"},yt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},wt={class:"w-full flex items-center space-x-2"},kt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Ct={class:"col-span-1 flex flex-col space-y-2"},Dt={class:"w-full flex items-center space-x-2"},St={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},It={class:"w-full flex items-center space-x-2"},Vt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Ot={class:"w-full flex items-center space-x-2"},Lt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Pt={class:"w-full flex items-center space-x-2"},Bt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},$t={class:"rounded border mt-5"},Tt={class:"w-full grid grid-cols-2 gap-5 py-5 px-5"},qt={class:"col-span-1 flex flex-col space-y-2"},Mt={class:"w-full flex items-center space-x-2"},Rt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},jt={class:"w-full flex items-center space-x-2"},At={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Ft={class:"w-full flex items-center space-x-2"},Nt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Ht={class:"w-full flex items-center space-x-2"},Ut={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Xt={class:"col-span-1 flex flex-col space-y-2"},zt={class:"w-full flex items-center space-x-2"},Et={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Kt={class:"w-full flex items-center space-x-2"},Zt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Gt={class:"w-full flex items-center space-x-2"},Qt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Yt={class:"w-full flex items-center space-x-2"},Jt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"};function Wt(r,t,d,p,s,n){const h=T,f=m("TransitionChild"),g=Te,y=m("DialogTitle"),w=m("XMarkIcon"),v=m("TicketIcon"),b=m("DialogPanel"),a=m("Dialog"),c=m("TransitionRoot");return x(),D("div",null,[o(h,{click:()=>{n.openDialog()},color:"primary",text:"View",icon:s.viewIcon},null,8,["click","icon"]),o(c,{appear:"",show:s.show,as:"template"},{default:l(()=>[o(a,{as:"div",class:"relative z-10"},{default:l(()=>[o(f,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>t[1]||(t[1]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",Me,[e("div",Re,[o(f,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[o(b,{class:"w-full max-w-4xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[e("div",je,[o(y,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>[d.data.stock_order_status.toLowerCase()==="approved"?(x(),q(g,{key:0,orderId:d.data.id,id:"print-container","print-small-label":!1},null,8,["orderId"])):E("",!0)]),_:1}),e("button",{onClick:t[0]||(t[0]=(...u)=>n.handleClick&&n.handleClick(...u))},[o(w,{class:"w-5 h-5"})])]),e("div",Ae,[t[32]||(t[32]=e("div",{class:"rounded-tr rounded-tl px-5 py-5 flex flex-col items-center"},[e("img",{src:ue,alt:"app-logo",class:"w-24 h-24 object-cover"}),e("h3",{class:"mt-2 text-xl font-medium uppercase"},"Republic of Malawi"),e("h3",{class:"mt-2 text-xl font-medium"},"Ministry of Health"),e("h3",{class:"mt-2 text-2xl font-semibold"},"Requisition and Issue Voucher")],-1)),e("div",Fe,[o(v,{class:"h-5 w-5"}),e("p",null,[t[2]||(t[2]=H("Voucher Number: ")),t[3]||(t[3]=e("span",{class:"text-lg text-sky-500 font-medium"},"B",-1)),e("strong",null,i(d.data.voucher_number),1)])]),e("div",Ne,[e("table",He,[t[4]||(t[4]=e("thead",{clas:"w-full border-t border-l border-r"},[e("tr",{class:"border-b border-t border-r border-l rounded"},[e("th",{colspan:2,class:"text-left p-2"}," Requisitions ")]),e("tr",{class:"border-b border-t border-r border-l rounded"},[e("th",{class:"px-2 py-2 text-left border-r"}," Stock Item "),e("th",{class:"px-2 py-2 text-left"}," Quantity Being Requested "),e("th",{class:"px-2 py-2 text-left"}," Quantity Isssued "),e("th",{class:"px-2 py-2 text-left"}," Quantity Collected ")])],-1)),e("tbody",null,[(x(!0),D(K,null,Z(s.requisitions,(u,I)=>(x(),D("tr",{key:I,class:"border-b border-t border-r border-l rounded"},[e("td",Ue,i(u.item.name),1),e("td",Xe,i(u.quantity_requested),1),e("td",ze,i(u.quantity_issued),1),e("td",Ee,i(u.quantity_collected),1)]))),128))])]),e("div",Ke,[t[13]||(t[13]=e("div",{class:"flex items-center space-x-3 bg-gray-50 py-2 rounded-t px-2 border-b"},[e("img",{src:z,class:"w-6 h-6"}),e("h3",{class:"text-lg font-semibold"},"Preparation of RIV")],-1)),e("div",Ze,[e("div",Ge,[e("div",Qe,[t[5]||(t[5]=e("p",{class:"w-72 font-medium"},"Prepared by: ",-1)),e("span",Ye,i(s.preparedBy),1)]),e("div",Je,[t[6]||(t[6]=e("p",{class:"w-72 font-medium"},"Designation: ",-1)),e("span",We,i(s.preparedDesignation),1)]),e("div",et,[t[7]||(t[7]=e("p",{class:"w-72 font-medium"},"Signature: ",-1)),e("span",tt,i(s.preparedSignature),1)]),e("div",st,[t[8]||(t[8]=e("p",{class:"w-72 font-medium"},"Date:",-1)),e("span",ot,i(s.preparedDate),1)])]),e("div",rt,[e("div",it,[t[9]||(t[9]=e("p",{class:"w-72 font-medium"},"Certified by: ",-1)),e("span",nt,i(s.certifiedBy),1)]),e("div",at,[t[10]||(t[10]=e("p",{class:"w-72 font-medium"},"Designation: ",-1)),e("span",lt,i(s.certifiedDesignation),1)]),e("div",dt,[t[11]||(t[11]=e("p",{class:"w-72 font-medium"},"Signature: ",-1)),e("span",ct,i(s.certifiedSignature),1)]),e("div",ut,[t[12]||(t[12]=e("p",{class:"w-72 font-medium"},"Date:",-1)),e("span",pt,i(s.certifiedDate),1)])])])]),e("div",mt,[t[22]||(t[22]=e("div",{class:"flex items-center space-x-3 bg-gray-50 py-2 rounded-t px-2 border-b"},[e("img",{src:pe,class:"w-6 h-6"}),e("h3",{class:"text-lg font-semibold"},"Pharmacy")],-1)),e("div",ft,[e("div",_t,[e("div",ht,[t[14]||(t[14]=e("p",{class:"w-72 font-medium"},"Issued by: ",-1)),e("span",gt,i(s.issuerName),1)]),e("div",bt,[t[15]||(t[15]=e("p",{class:"w-72 font-medium"},"Designation: ",-1)),e("span",vt,i(s.issuerDesignation),1)]),e("div",xt,[t[16]||(t[16]=e("p",{class:"w-72 font-medium"},"Signature: ",-1)),e("span",yt,i(s.issuerSignature),1)]),e("div",wt,[t[17]||(t[17]=e("p",{class:"w-72 font-medium"},"Date:",-1)),e("span",kt,i(s.issuedDate),1)])]),e("div",Ct,[e("div",Dt,[t[18]||(t[18]=e("p",{class:"w-72 font-medium"},"Approved by: ",-1)),e("span",St,i(s.approverName),1)]),e("div",It,[t[19]||(t[19]=e("p",{class:"w-72 font-medium"},"Designation: ",-1)),e("span",Vt,i(s.approverDesignation),1)]),e("div",Ot,[t[20]||(t[20]=e("p",{class:"w-72 font-medium"},"Signature: ",-1)),e("span",Lt,i(s.issuerSignature),1)]),e("div",Pt,[t[21]||(t[21]=e("p",{class:"w-72 font-medium"},"Date:",-1)),e("span",Bt,i(s.approvedDate),1)])])])]),e("div",$t,[t[31]||(t[31]=e("div",{class:"flex items-center space-x-3 bg-gray-50 py-2 rounded-t px-2 border-b"},[e("img",{src:z,class:"w-6 h-6"}),e("h3",{class:"text-lg font-semibold"},"Finalisation of Order")],-1)),e("div",Tt,[e("div",qt,[e("div",Mt,[t[23]||(t[23]=e("p",{class:"w-72 font-medium"},"Collected by: ",-1)),e("span",Rt,i(s.collectedBy),1)]),e("div",jt,[t[24]||(t[24]=e("p",{class:"w-72 font-medium"},"Designation: ",-1)),e("span",At,i(s.collectedDesignation),1)]),e("div",Ft,[t[25]||(t[25]=e("p",{class:"w-72 font-medium"},"Signature: ",-1)),e("span",Nt,i(s.collectedSignature),1)]),e("div",Ht,[t[26]||(t[26]=e("p",{class:"w-72 font-medium"},"Date:",-1)),e("span",Ut,i(s.collectedDate),1)])]),e("div",Xt,[e("div",zt,[t[27]||(t[27]=e("p",{class:"w-72 font-medium"},"Verified by: ",-1)),e("span",Et,i(s.verifiedBy),1)]),e("div",Kt,[t[28]||(t[28]=e("p",{class:"w-72 font-medium"},"Designation: ",-1)),e("span",Zt,i(s.verifiedDesignation),1)]),e("div",Gt,[t[29]||(t[29]=e("p",{class:"w-72 font-medium"},"Signature: ",-1)),e("span",Qt,i(s.verifiedSignature),1)]),e("div",Yt,[t[30]||(t[30]=e("p",{class:"w-72 font-medium"},"Date:",-1)),e("span",Jt,i(s.verifiedDate),1)])])])])])])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const es=N(qe,[["render",Wt]]),ts={setup(){_e({title:`${fe.name.toUpperCase()} - Stock Orders`})},data(){return{header:"Stock Orders",pages:[{name:"Home",link:"/home"},{name:"Stock Management",link:"#"}],search:"",headers:[{text:"Voucher Number",value:"voucher_number",sortable:!0},{text:"Requisitions",value:"requisitions"},{text:"Status",value:"stock_order_status"},{text:"Date Created",value:"created_date"},{text:"actions",value:"actions"}],statuses:new Array,statusSelected:{name:"-- select status -- ",id:0},orders:new Array,printIcon:L,editIcon:M,clearIcon:B,loading:!1,statusLoading:!1,cookie:$("token"),serverItemsLength:0,serverOptions:{page:1,rowsPerPage:25,sortBy:"voucher_number"}}},created(){this.init(),this.getOrderStatuses()},computed:{orderStatuses(){return[{name:"Edit",show:"pending",icon:M},{name:"Verify",show:"draft",icon:he},{name:"Receive",show:"requested",icon:ge},{name:"Approve",show:"received",icon:be}]}},methods:{async getOrderStatuses(){const r=new S,{data:t,error:d}=await r.getStockOrderStatus(`${this.cookie}`);t.value&&t.value.map(p=>{this.statuses.push({name:p.name,id:p.id})}),d.value&&console.error(d.value)},async init(){this.loading=!0;const r=new S;let t=this.statusSelected.id==0?"":this.statusSelected.id;const{page:d,rowsPerPage:p}=this.serverOptions;let s=`page=${d}&per_page=${p}`;const{data:n,error:h,pending:f}=await r.getStockOrder(`${this.cookie}`,"",this.search,`${t}`,s);this.loading=f,n.value&&(this.orders=n.value.data.map(g=>({...g,requisitions:g.stock_requisitions.length,created_date:k(g.created_date).format(C)})),this.loading=!1),h.value&&(console.error(h.value),this.loading=!1)},clearFilter(){this.statuses.push({name:"-- select status -- ",id:0}),this.statusSelected=this.statuses[this.statuses.length-1],this.init()},checkStatus(r,t){return r.show.toLowerCase()==t.stock_order_status.toLowerCase()},verifyStockOrder(r,t){this.$router.push(`/stock-management/orders/request/${t}?order_id=${r}`)},receiveStockOrder(r,t){this.$router.push(`/stock-management/orders/receive/${t}?order_id=${r}`)},approveStockOrder(r,t){this.$router.push(`/stock-management/orders/approve/${t}?order_id=${r}`)},rejectStockOrder(r,t){this.$router.push(`/stock-management/orders/reject/${t}?order_id=${r}`)},async changeStatus(r){this.statusLoading=!0;const t=new S,d={route:"",status:r},{data:p,error:s,pending:n}=await t.updateStockOrderStatus(`${this.cookie}`,d);this.statusLoading=n,p.value&&(this.init(),this.statusLoading=!1),s.value&&(console.error(s.value),this.statusLoading=!1)},processStockOrder(r,t){r==="Verify"?this.verifyStockOrder(t.id,t.voucher_number):r==="Receive"?this.receiveStockOrder(t.id,t.voucher_number):r==="Approve"?this.approveStockOrder(t.id,t.voucher_number):r==="Reject"&&this.rejectStockOrder(t.id,t.voucher_number)}},watch:{search(){this.init()},statusSelected:{handler(){this.init()},deep:!0}}},ss={class:"px-5 py-5"},os={class:"flex items-center justify-between py-5"},rs={class:"text-2xl font-semibold"},is={class:"flex items-center space-x-3"},ns={class:"flex items-center justify-between"},as={class:"flex items-center space-x-2"},ls={class:"mt-10"},ds={class:"py-2 flex items-center space-x-2"};function cs(r,t,d,p,s,n){const h=Q,f=Ve,g=ne,y=T,w=ae,v=es,b=me;return x(),D("div",ss,[o(h,{pages:s.pages},null,8,["pages"]),e("div",os,[e("h3",rs,i(s.header),1),e("div",is,[o(f)])]),e("div",ns,[e("div",as,[o(g,{items:s.statuses,modelValue:s.statusSelected,"onUpdate:modelValue":t[0]||(t[0]=a=>s.statusSelected=a)},null,8,["items","modelValue"]),s.statusSelected.id!=0?(x(),q(y,{key:0,text:"Clear filter",color:"warning",icon:s.clearIcon,click:()=>{n.clearFilter()},loading:s.loading},null,8,["icon","click","loading"])):E("",!0)]),o(w,{search:s.search,"onUpdate:search":t[1]||(t[1]=a=>s.search=a)},null,8,["search"])]),e("div",ls,[o(b,{data:s.orders,headers:s.headers,loading:s.loading,"search-field":"voucher_number","search-value":s.search,serverItemsLength:s.serverItemsLength,serverOptions:s.serverOptions,onUpdate:n.init},{actions:l(({item:a})=>[e("div",ds,[o(v,{data:a},null,8,["data"]),(x(!0),D(K,null,Z(n.orderStatuses,(c,u)=>W((x(),q(y,{key:u,text:c.name,color:c.name=="Reject"?"error":"success",icon:c.icon,click:()=>{n.processStockOrder(c.name,a)}},null,8,["text","color","icon","click"])),[[ee,n.checkStatus(c,a)]])),128))])]),_:1},8,["data","headers","loading","search-value","serverItemsLength","serverOptions","onUpdate"])])])}const Us=N(ts,[["render",cs]]);export{Us as default};
