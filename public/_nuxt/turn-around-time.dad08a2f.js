import{_ as V}from"./Breadcrumb.fceb39b7.js";import{_ as A}from"./Dropdown.2b951ceb.js";import{_ as k,f as x,o as p,p as Y,u as C,a as g,c as _,b as a,d as t,t as n,g as M,E as B,h as E,k as f,F as R,r as S,j as N,e as q}from"./entry.8d1887e0.js";import{B as U,C as P,b as j,c as I,g as L,f as G,p as H,a as O}from"./index.cb63c941.js";import{e as W,d as h}from"./constants.6559c015.js";import{u as z}from"./vue.f36acd1f.90da7972.js";import{h as y,e as T,f as v}from"./fetch.1b1fb40d.js";import{k as J}from"./vue-doc-download.cc2187a7.js";import{u as K}from"./facility.984f70b4.js";import{P as Q}from"./package.d411c004.js";import{r as X}from"./ArrowPathIcon.8c2f2968.js";import{r as Z}from"./DocumentTextIcon.a6bda4f5.js";import{_ as $}from"./logo.adb9f7cd.js";import"./nuxt-link.8f68ed8a.js";import"./HomeIcon.a70aee08.js";import"./CheckIcon.296969e7.js";import"./CheckCircleIcon.e76b01e3.js";import"./MagnifyingGlassIcon.659a43f2.js";import"./listbox.20f1ca74.js";import"./hidden.4fcf3718.js";import"./use-text-value.60301a55.js";import"./transition.166bd9ac.js";import"./XMarkIcon.dad50e8c.js";import"./PencilSquareIcon.21ca2aeb.js";import"./PrinterIcon.1c7de3dc.js";P.register(j,I,L,G,H,O);const ee={components:{Bar:U},props:{chartData:{required:!0,type:Object}},data(){return{data:this.chartData,options:{responsive:!0,maintainAspectRatio:!1}}},watch:{chartData:{handler(s){this.data=s},deep:!0}}};function te(s,o,i,d,e,m){const c=x("Bar");return p(),Y(c,{data:e.data,options:e.options},null,8,["data","options"])}const oe=k(ee,[["render",te]]),se={setup(){z({title:`${Q.name.toUpperCase()} - Turn Around Time Reports`})},components:{ExportToExcel:J},data(){return{moment:y,refreshIcon:X,exportIcon:Z,title:"Turn Around Time Report",pages:[{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"Aggregate Reports",link:"#"}],departments:new Array,selectedDepartment:{name:"-- select department --",id:0},dateFrom:"",dateTo:"",timeUnits:[{name:"Minutes"},{name:"Hours"},{name:"Days"},{name:"Weeks"}],unitSelected:{name:"-- select unit --"},loading:!1,statistics:new Array,facility:K(),cookie:C("token"),chartData:{}}},created(){this.loadDepartments()},methods:{async loadDepartments(){const s={route:`${T.departments}`,method:"GET",token:`${this.cookie}`},{data:o,error:i}=await v(s);o.value&&(this.departments=o.value),i.value&&console.error(i.value)},async generateReport(){this.loading=!0,this.chartData={};let s=this.dateFrom!=""?y(this.dateFrom).format("YYYY-MM-DD"):"",o=this.dateTo!=""?y(this.dateTo).format("YYYY-MM-DD"):"",i=`from=${s}&to=${o}&department=${this.selectedDepartment.id}&unit=${this.unitSelected.name.toLowerCase()}`;const d={route:`${T.aggregateReports}turn_around_time?${i}`,method:"GET",token:`${this.cookie}`},{data:e,error:m,pending:c}=await v(d);if(this.loading=c,e.value){this.loading=!1,this.statistics=e.value.data;let u={labels:e.value.data.map(l=>l.test_type),datasets:[{label:"Turn Around Time",backgroundColor:"#0284c7",data:e.value.data.map(l=>l.average)},{label:"Average Turn Around Time",backgroundColor:"#030712",data:e.value.data.map(l=>this.extractNumber(l.turn_around_time))}]};this.chartData=u,g().$toast.success("Report data generated successfully")}m.value&&(this.loading=!1,console.error(m.value),g().$toast.error(W))},checkDropdownValues(){return this.selectedDepartment.name=="-- select department --"||this.unitSelected.name=="-- select unit --"?(g().$toast.warning("Please select a department and unit"),!1):!0},extractNumber(s){let o=0;const i=/\d+/,d=s.match(i);return d?o=parseInt(d[0]):o=0,o}}},re={class:"px-5 py-5"},ne={class:"flex items-center justify-between py-5"},ae={class:"text-2xl font-semibold"},ie={class:"w-44"},le={class:"w-44"},de={class:"w-48"},me={class:"w-48"},ce={class:"w-48"},pe={class:"border rounded mt-10",id:"print-container"},ue={class:"w-full bg-gray-50 rounded-tr rounded-tl px-10 py-5"},_e={class:"flex items-center justify-between px-5"},fe=t("td",null,[t("img",{src:$,alt:"app-logo",class:"w-24 h-24 object-cover"})],-1),he={class:"py-5"},ge={class:"uppercase font-medium"},ye={class:"uppercase font-medium"},xe={class:"uppercase font-medium"},be=t("p",{class:"uppercase font-medium underline"},"Laboratory Report",-1),Te={class:"m-3"},ve={class:"font-semibold mb-2"},ke={class:"text-normal font-normal"},De={class:"px-2 py-2"},we={class:"w-full rounded"},Fe=t("thead",null,[t("tr",{class:"border"},[t("th",{class:"text-left px-2 py-2 border-r"},"Test Type"),t("th",{class:"text-left px-2 py-2 border-r"},"Turn Around Time"),t("th",{class:"text-left px-2 py-2"},"Average Turn Around Time")])],-1),Ve={class:"text-left px-2 py-2 border-l border-b"},Ae={class:"text-left px-2 py-2 border-l border-b"},Ye={class:"text-left px-2 py-2 border-l border-r border-b"},Ce={class:"px-5 py-5 flex flex-col items-center"},Me=t("h3",{class:"text-lg font-medium"},"Average Turn Around Time",-1),Be={class:"mt-1"},Ee={key:0,style:{height:"400px"}};function Re(s,o,i,d,e,m){const c=V,u=x("datepicker"),l=A,b=q,D=x("ExportToExcel"),w=oe;return p(),_("div",re,[a(c,{pages:e.pages},null,8,["pages"]),t("div",ne,[t("h3",ae,n(e.title),1)]),t("form",{onSubmit:o[4]||(o[4]=B(r=>m.checkDropdownValues()&&m.generateReport(),["prevent"])),class:"w-full flex items-center space-x-3"},[t("div",ie,[a(u,{required:"",position:"left",range:!1,placeholder:"-- start date --","input-classes":"border rounded px-2 py-1.5 block focus:outline-none focus:ring-2 focus:ring-sky-500 transition duration-150 focus:border-none",modelValue:e.dateFrom,"onUpdate:modelValue":o[0]||(o[0]=r=>e.dateFrom=r),format:"dd/MM/yyyy"},null,8,["modelValue"])]),t("div",le,[a(u,{required:"",range:!1,placeholder:"-- end date --","input-classes":"border rounded px-2 py-1.5 block focus:outline-none focus:ring-2 focus:ring-sky-500 transition duration-150 focus:border-none",modelValue:e.dateTo,"onUpdate:modelValue":o[1]||(o[1]=r=>e.dateTo=r),format:"dd/MM/yyyy"},null,8,["modelValue"])]),t("div",de,[a(l,{items:e.departments,modelValue:e.selectedDepartment,"onUpdate:modelValue":o[2]||(o[2]=r=>e.selectedDepartment=r)},null,8,["items","modelValue"])]),t("div",me,[a(l,{items:e.timeUnits,modelValue:e.unitSelected,"onUpdate:modelValue":o[3]||(o[3]=r=>e.unitSelected=r)},null,8,["items","modelValue"])]),t("div",ce,[a(b,{type:"submit",color:"success",text:"Generate Report",icon:e.refreshIcon,click:()=>{},loading:e.loading},null,8,["icon","loading"])]),t("div",null,[a(D,{element:"print-container",filename:`turn_around_time_${e.moment(e.dateFrom).format("DD_MM_YYYY")}_to_${e.moment(e.dateTo).format("DD_MM_YYYY")}_report`},{default:M(()=>[a(b,{click:()=>{},text:"Export",color:"success",icon:e.exportIcon},null,8,["icon"])]),_:1},8,["filename"])])],32),t("div",pe,[t("table",ue,[t("tr",_e,[fe,t("td",he,[t("p",ge,n(e.facility.details.name),1),t("p",ye,n(e.facility.details.address),1),t("p",xe,n(e.facility.details.phone),1),be])])]),t("div",Te,[t("h3",ve,[E("Tests Performed Period: "),t("span",ke,n(e.dateFrom!=""?e.moment(e.dateFrom).format("dateFormat"in s?s.dateFormat:f(h)):"")+" -:- "+n(e.dateTo!=""?e.moment(e.dateTo).format("dateFormat"in s?s.dateFormat:f(h)):""),1)])]),t("div",De,[t("table",we,[Fe,t("tbody",null,[(p(!0),_(R,null,S(e.statistics,(r,F)=>(p(),_("tr",{key:F},[t("td",Ve,n(r.test_type),1),t("td",Ae,n(r.turn_around_time),1),t("td",Ye,n(r.average),1)]))),128))])])])]),t("div",Ce,[Me,t("p",Be,"From: "+n(e.dateFrom!=""?e.moment(e.dateFrom).format("dateFormat"in s?s.dateFormat:f(h)):"")+" -:- To: "+n(e.dateTo!=""?e.moment(e.dateTo).format("dateFormat"in s?s.dateFormat:f(h)):""),1)]),e.statistics.length>0?(p(),_("div",Ee,[a(w,{"chart-data":e.chartData},null,8,["chart-data"])])):N("",!0)])}const at=k(se,[["render",Re]]);export{at as default};
