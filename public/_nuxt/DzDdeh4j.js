import{_ as Q}from"./BSOqz5j4.js";import{S as j,p as I,Y as E,G as M,V as O,q,s as W,a as U,l as D,m as C,u as S,E as B,x as F,y as c,b,e as $,g as t,f as o,z as l,j as T,_ as P,D as H,A as Z,B as Y,C as ee,i as G,v as X,t as V,n as te,d as oe,r as A,h as g,L as K,K as z}from"./27gxMGx-.js";import{_ as se}from"./brxpDQUf.js";import{_ as R}from"./JiKuP2bS.js";import{r as ne}from"./UndSPvyO.js";import{r as J}from"./B5GTxTiU.js";import{r as ae}from"./DfvgcqjQ.js";import{_ as ie}from"./C4ELRxbT.js";import{_ as N}from"./BaJf9vfg.js";import{r as le}from"./TKtKq94X.js";import{_ as re}from"./R_7gmH9H.js";import{u as L}from"./DYy0OeSK.js";import{P as ce}from"./Dj9465vM.js";import{u as de}from"./BXtJ-a5P.js";import{r as ue}from"./BgDFElE0.js";import"./DPOyO2jd.js";import"./eODTOUMG.js";import"./DHThhBvD.js";import"./CQnnh4jB.js";import"./qJJcjVyA.js";const me={components:{TransitionRoot:j,TransitionChild:I,Dialog:E,DialogPanel:M,DialogTitle:O,XMarkIcon:q,UserIcon:ne},data(){return{open:!1,addIcon:W,saveIcon:J,clearIcon:ae,name:"",description:"",drugSelected:null,loading:!1,drugs:new Array,rawDrugs:new Array,cookie:U("token")}},methods:{async init(){this.handleModal();const n={route:D.drugs,method:"GET",token:`${this.cookie}`},{pending:e,error:i,data:r}=await C(n);this.loading=e,r.value&&(this.rawDrugs=r.value,r.value.map(s=>{this.drugs.push(s.name)})),i.value&&console.error(i.value)},async submitForm(){this.loading=!0;const n=this.drugSelected.map(a=>{const u=this.rawDrugs.find(f=>f.name===a);return u?u.id:null}).filter(a=>a!==null),e={route:D.organisms,method:"POST",token:`${this.cookie}`,body:{name:this.name,description:this.description,drugs:n}},{data:i,error:r,pending:s}=await C(e);this.loading=s,i.value&&(this.handleModal(),S().$toast.success(`${this.name} organism created sucessfully!`),this.name="",this.description="",this.drugSelected=null,this.loading=!1,this.$emit("update",!0)),r.value&&(this.handleModal(),console.error(r.value),S().$toast.error(B),this.loading=!1)},handleModal(){this.open=!this.open},clearForm(){this.$formkit.reset("submitForm"),this.drugSelected=null}}},pe={class:"fixed inset-0 overflow-y-auto"},fe={class:"flex min-h-full items-center justify-center p-4 text-center"},_e={class:"border-b px-3 py-3 flex items-center justify-between"},ge={class:"mt-2 space-y-3"},he={class:"w-full flex items-center px-5"},ve={class:"w-full flex flex-col space-y-2"},xe={class:"w-full flex items-center px-5 space-x-3"},ye={class:"w-full flex flex-col space-y-2"},we={class:"w-full pb-20 px-5"},be={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function ke(n,e,i,r,s,a){const u=P,f=c("TransitionChild"),h=c("DialogTitle"),w=c("XMarkIcon"),p=c("FormKit"),v=se,d=R,_=c("DialogPanel"),x=c("Dialog"),k=c("TransitionRoot");return b(),$("div",null,[t("div",null,[o(u,{text:"Create organism",color:"primary",icon:s.addIcon,click:a.init},null,8,["icon","click"])]),o(k,{appear:"",show:s.open,as:"template"},{default:l(()=>[o(x,{as:"div",onClose:a.handleModal,class:"relative z-10"},{default:l(()=>[o(f,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>e[4]||(e[4]=[t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),t("div",pe,[t("div",fe,[o(f,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[o(_,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[t("div",_e,[o(h,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:l(()=>e[5]||(e[5]=[T(" Create organism ")])),_:1}),t("button",{onClick:e[0]||(e[0]=(...y)=>a.handleModal&&a.handleModal(...y))},[o(w,{class:"w-5 h-5"})])]),o(p,{type:"form","submit-label":"Update",onSubmit:a.submitForm,actions:!1,id:"submitForm"},{default:l(({value:y})=>[t("div",ge,[t("div",he,[t("div",ve,[o(p,{type:"text",label:"Name",validation:"required",modelValue:s.name,"onUpdate:modelValue":e[1]||(e[1]=m=>s.name=m)},null,8,["modelValue"])])]),t("div",xe,[t("div",ye,[o(p,{type:"textarea",label:"Description",validation:"required",modelValue:s.description,"onUpdate:modelValue":e[2]||(e[2]=m=>s.description=m)},null,8,["modelValue"])])]),t("div",we,[o(v,{label:"Drugs","items-selected":s.drugSelected,"onUpdate:itemsSelected":e[3]||(e[3]=m=>s.drugSelected=m),items:s.drugs,mode:"tags"},null,8,["items-selected","items"])])]),t("div",be,[o(d,{type:"button",click:()=>{a.clearForm()},text:"Clear form"},null,8,["click"]),o(u,{loading:s.loading,type:"submit",click:()=>{},color:"success",icon:s.saveIcon,text:"Save changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const De=F(me,[["render",ke]]),Ce={components:{TransitionRoot:j,TransitionChild:I,Dialog:E,DialogPanel:M,DialogTitle:O,XMarkIcon:q,ExclamationTriangleIcon:H},data(){return{viewIcon:Z,show:!1,loading:!1,editIcon:Y,moment:ee,cookie:U("token"),organism:{}}},props:{data:{type:Object,required:!0}},methods:{handleClick(){this.show=!this.show},async init(){this.handleClick(),this.loading=!0;const n={route:`${D.organisms}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:e,error:i,pending:r}=await C(n);this.loading=r,e.value&&(this.organism=e.value,this.loading=!1),i.value&&(console.error("error loading organism data: ",i.value),this.loading=!1)}}},$e={class:"fixed inset-0 overflow-y-auto"},Te={class:"flex min-h-full items-center justify-center p-4 text-center"},Se={class:"border-b px-3 py-3 flex items-center justify-between"},Ve={class:"flex items-center justify-center mx-auto my-20"},Ie={class:"space-y-3 px-5 py-5"},Ue={class:"w-full flex flex-col space-y-1"},je={class:"underline text-black"},Ee={class:"w-full flex flex-col space-y-1"},Me={key:0,class:"underline text-black"},Oe={key:1,class:"bg-red-50 py-2 px-2 flex items-center space-x-2"},qe={class:"w-full flex flex-col space-y-1"},Fe={class:"underline text-black"};function Pe(n,e,i,r,s,a){const u=P,f=c("TransitionChild"),h=c("DialogTitle"),w=c("XMarkIcon"),p=te,v=c("ExclamationTriangleIcon"),d=c("DialogPanel"),_=c("Dialog"),x=c("TransitionRoot");return b(),$("div",null,[o(u,{click:a.init,color:"primary",text:"View",icon:s.viewIcon},null,8,["click","icon"]),o(x,{appear:"",show:s.show,as:"template"},{default:l(()=>[o(_,{as:"div",class:"relative z-10"},{default:l(()=>[o(f,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>e[1]||(e[1]=[t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),t("div",$e,[t("div",Te,[o(f,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[o(d,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>{var k,y;return[t("div",Se,[o(h,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>e[2]||(e[2]=[t("img",{src:N,class:"w-8 h-8 mr-2"},null,-1),T(" View organism ")])),_:1}),t("button",{onClick:e[0]||(e[0]=(...m)=>a.handleClick&&a.handleClick(...m))},[o(w,{class:"w-5 h-5"})])]),G(t("div",Ve,[o(p,{loading:s.loading},null,8,["loading"])],512),[[X,s.loading]]),G(t("div",Ie,[t("div",Ue,[e[3]||(e[3]=t("label",{class:"font-semibold text-lg"},"Name",-1)),t("p",je,V(s.organism.name),1)]),t("div",Ee,[e[5]||(e[5]=t("label",{class:"font-semibold text-lg"},"Description",-1)),s.organism.description?(b(),$("p",Me,V(s.organism.description),1)):(b(),$("div",Oe,[o(v,{class:"w-5 h-5 text-red-500 rounded-md"}),e[4]||(e[4]=t("p",{class:"text-red-500 font-medium"}," Description not found ",-1))]))]),t("div",qe,[e[6]||(e[6]=t("label",{class:"font-semibold text-lg"},"Drugs",-1)),t("p",Fe,V((y=(k=s.organism.drugs)==null?void 0:k.map(m=>m.name))==null?void 0:y.join(", ")),1)])],512),[[X,!s.loading]])]}),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const Ae=F(Ce,[["render",Pe]]),Be={components:{TransitionRoot:j,TransitionChild:I,Dialog:E,DialogPanel:M,DialogTitle:O,XMarkIcon:q},data(){return{editIcon:Y,show:!1,saveIcon:J,drugSelected:new Array,cookie:U("token"),drugs:new Array,rawDrugs:new Array,loading:!1}},props:{data:{type:Object,required:!0}},methods:{async loadDrugs(){const n={route:D.drugs,method:"GET",token:`${this.cookie}`},{error:e,data:i}=await C(n);i.value&&(this.rawDrugs=i.value,i.value.map(r=>{this.drugs.push(r.name)})),e.value&&console.error(e.value)},async init(){await this.loadDrugs(),this.handleClick(),this.drugSelected=new Array;const n={route:`${D.organisms}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{error:e,data:i}=await C(n);i.value&&i.value.drugs.map(r=>{this.drugSelected.push(r.name)}),e.value&&console.error(e.value)},async submitForm(){this.loading=!0;let n=new Array;this.drugSelected.map(a=>{this.rawDrugs.filter(u=>{a==u.name&&n.push(Number(u.id))})}),this.data.drugs=n;const e={route:`${D.organisms}/${this.data.id}`,method:"PUT",token:`${this.cookie}`,body:this.data},{pending:i,error:r,data:s}=await C(e);this.loading=i,s.value&&(this.show=!1,S().$toast.success("Organism updated successfully!"),this.loading=!1,this.$emit("update",!0)),r.value&&(this.show=!1,console.error(r.value),this.loading=!1,S().$toast.error(B))},updateDrugs(n){this.drugSelected=n},handleClick(){this.show=!this.show},clearForm(){this.$formkit.reset("submitForm")}}},Re={class:"fixed inset-0 overflow-y-auto"},Ne={class:"flex min-h-full items-center justify-center p-4 text-center"},Ge={class:"border-b px-3 py-3 flex items-center justify-between"},Xe={class:"mt-2 space-y-3"},Ke={class:"w-full flex items-center px-5"},ze={class:"w-full flex flex-col space-y-2"},Le={class:"w-full flex items-center px-5 space-x-3"},He={class:"w-full flex flex-col space-y-2"},Ye={class:"w-full pb-20 px-5"},Je={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Qe(n,e,i,r,s,a){const u=P,f=c("TransitionChild"),h=c("DialogTitle"),w=c("XMarkIcon"),p=c("FormKit"),v=c("multi-select"),d=R,_=c("DialogPanel"),x=c("Dialog"),k=c("TransitionRoot");return b(),$("div",null,[o(u,{click:a.init,text:"Edit",color:"success",icon:s.editIcon},null,8,["click","icon"]),o(k,{appear:"",show:s.show,as:"template"},{default:l(()=>[o(x,{as:"div",class:"relative z-10"},{default:l(()=>[o(f,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>e[4]||(e[4]=[t("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-25"},null,-1)])),_:1}),t("div",Re,[t("div",Ne,[o(f,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[o(_,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[t("div",Ge,[o(h,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>e[5]||(e[5]=[t("img",{src:N,class:"w-8 h-8 mr-2"},null,-1),T(" Edit organism ")])),_:1}),t("button",{onClick:e[0]||(e[0]=(...y)=>a.handleClick&&a.handleClick(...y))},[o(w,{class:"w-5 h-5"})])]),o(p,{type:"form","submit-label":"Update",onSubmit:a.submitForm,actions:!1,id:"submitForm"},{default:l(({value:y})=>[t("div",Xe,[t("div",Ke,[t("div",ze,[o(p,{type:"text",label:"Name",validation:"required",modelValue:i.data.name,"onUpdate:modelValue":e[1]||(e[1]=m=>i.data.name=m)},null,8,["modelValue"])])]),t("div",Le,[t("div",He,[o(p,{type:"textarea",label:"Description",validation:"required",modelValue:i.data.description,"onUpdate:modelValue":e[2]||(e[2]=m=>i.data.description=m)},null,8,["modelValue"])])]),t("div",Ye,[o(v,{label:"Drugs",modelValue:s.drugSelected,"onUpdate:modelValue":e[3]||(e[3]=m=>s.drugSelected=m),options:s.drugs,mode:"tags",clear:"",searchable:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),t("div",Je,[o(d,{text:"Clear form",type:"button",click:()=>{a.clearForm()}},null,8,["click"]),o(u,{loading:s.loading,type:"submit",click:()=>{},color:"success",icon:s.saveIcon,text:"Save changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const We=F(Be,[["render",Qe]]),Ze={class:"fixed inset-0 overflow-y-auto"},et={class:"flex min-h-full items-center justify-center p-4 text-center"},tt={class:"border-b px-3 py-3 flex items-center justify-between"},ot={class:"mt-2 space-y-3 px-5"},st={class:"rounded px-2 py-2"},nt={class:"font-semibold text-red-500"},at={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},it=oe({__name:"index",props:{data:{type:Object,required:!0}},emits:["update"],setup(n,{emit:e}){const i=n,r=e,s=A(!1),a=le,u=A(!1),f=U("token"),h=A("");async function w(v){u.value=!0;const d={route:`${D.organisms}/${v}`,method:"DELETE",token:`${f.value}`,body:{retired_reason:h.value}},{error:_,data:x}=await C(d);x.value&&(p(),S().$toast.success("Drug deleted successfully!"),u.value=!1,r("update",!0)),_.value&&(S().$toast.error(B),u.value=!1)}function p(){s.value=!s.value}return(v,d)=>{const _=P,x=c("FormKit"),k=R;return b(),$("div",null,[o(_,{click:p,color:"error",text:"Delete",icon:g(a)},null,8,["icon"]),o(g(j),{appear:"",show:s.value,as:"template"},{default:l(()=>[o(g(E),{as:"div",class:"relative z-10"},{default:l(()=>[o(g(I),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>d[2]||(d[2]=[t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),t("div",Ze,[t("div",et,[o(g(I),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[o(g(M),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[t("div",tt,[o(g(O),{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>[o(g(H),{class:"h-5 w-5 mr-2"}),d[3]||(d[3]=T(" Confirm delete "))]),_:1}),t("button",{onClick:p},[o(g(q),{class:"w-5 h-5"})])]),o(x,{type:"form","submit-label":"Update",onSubmit:d[1]||(d[1]=y=>w(n.data.id)),actions:!1},{default:l(({value:y})=>[t("div",ot,[t("div",st,[d[4]||(d[4]=T(" Do you really want to delete ")),t("span",nt,V(i.data.name),1),d[5]||(d[5]=T("? Note that once this action is completed, it can not be undone "))]),o(x,{type:"textarea",label:"Reason",validation:"required",modelValue:h.value,"onUpdate:modelValue":d[0]||(d[0]=m=>h.value=m)},null,8,["modelValue"])]),t("div",at,[o(k,{click:()=>{p()},type:"button",text:"Cancel"},null,8,["click"]),o(_,{loading:u.value,type:"submit",click:()=>{},color:"error",icon:g(a),text:"Delete"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),lt={setup(){de({title:`${ce.name.toUpperCase()} - Organisms`})},data(){return{header:"Organisms",loading:!1,search:"",searchValue:"",headers:[{text:"id",value:"id",sortable:!0},{text:"name",value:"name",sortable:!0},{text:"description",value:"description"},{text:"actions",value:"actions"}],organisms:[],pages:[{name:"Home",link:"/home"},{name:"Test Catalog",link:"#"}],cookie:U("token")}},components:{MagnifyingGlassIcon:ue},created(){this.init()},methods:{updateSearch(n){this.searchValue=n,this.search=n},async init(){this.loading=!0;const n={route:D.organisms,method:"GET",token:`${this.cookie}`},{data:e,error:i,pending:r}=await C(n);this.loading=r,e.value&&(this.organisms=e.value,this.loading=!1),i.value&&(console.error(i.value),this.loading=!1)},updateOrganisms(n){n&&this.init()}}},rt={class:"py-5 px-5"},ct={class:"flex items-center justify-between py-5"},dt={class:"text-2xl font-semibold flex items-center uppercase"},ut={class:"flex items-center space-x-3"},mt={class:"flex justify-end w-full px-2 py-2 mb-2"},pt={class:"py-2 flex items-center space-x-2"};function ft(n,e,i,r,s,a){const u=Q,f=De,h=ie,w=Ae,p=We,v=it,d=re;return b(),$("div",rt,[o(u,{pages:s.pages},null,8,["pages"]),t("div",ct,[t("div",dt,[e[0]||(e[0]=t("img",{src:N,alt:"report-icon",class:"w-8 h-8 mr-2"},null,-1)),T(" "+V(s.header),1)]),t("div",ut,[("usePermissions"in n?n.usePermissions:g(L))().can.manage("test_catalog")?(b(),K(f,{key:0,onUpdate:a.updateOrganisms},null,8,["onUpdate"])):z("",!0)])]),t("div",mt,[o(h,{search:s.search,onUpdate:a.updateSearch},null,8,["search","onUpdate"])]),("usePermissions"in n?n.usePermissions:g(L))().can.manage("test_catalog")?(b(),K(d,{key:0,headers:s.headers,data:s.organisms,loading:s.loading,"search-value":s.searchValue,"search-field":"name"},{actions:l(({item:_})=>[t("div",pt,[o(w,{data:_},null,8,["data"]),o(p,{data:_,onUpdate:a.updateOrganisms},null,8,["data","onUpdate"]),o(v,{data:_,onUpdate:a.updateOrganisms},null,8,["data","onUpdate"])])]),_:1},8,["headers","data","loading","search-value"])):z("",!0)])}const Ot=F(lt,[["render",ft]]);export{Ot as default};
