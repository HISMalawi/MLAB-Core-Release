import{_ as I}from"./Breadcrumb.vue.7a457d8b.js";import{_ as K}from"./Dropdown.e58140fb.js";import{m as Q,u as W,C as u,a as X,L as D,g as C,o as a,c as n,d as l,l as e,e as t,t as i,i as M,E as T,h as Z,F as x,r as y,b as k,f as ee}from"./entry.18364f1c.js";import{_ as te}from"./index.9dd83819.js";import{_ as oe}from"./ExportButton.vue.24739b4a.js";import{_ as re}from"./Address.vue.bce78d5c.js";import{d as F,e as se}from"./constants.86829aaf.js";import{_ as ae}from"./report.b706b044.js";import{_ as ne}from"./logo.4d702f1b.js";import{h as _,e as P,f as S}from"./fetch.5f03fbcc.js";import{u as le}from"./facility.f011c060.js";import{P as de}from"./package.b965e1b0.js";import{r as ce}from"./FunnelIcon.238c88c3.js";import{r as ie}from"./ArrowPathIcon.cb4e24ae.js";import"./nuxt-link.eb4fc10e.js";import"./HomeIcon.8d531f3f.js";import"./listbox.e7ac43d3.js";import"./hidden.d8a7e9c3.js";import"./use-text-value.d8341020.js";import"./CheckIcon.9b9f88b3.js";import"./CheckCircleIcon.b928c17b.js";import"./MagnifyingGlassIcon.570b6e64.js";import"./jspdf.es.min.7c0fa74a.js";import"./XMarkIcon.13f92378.js";import"./PrinterIcon.46fc5b73.js";import"./transition.bca0aae9.js";import"./PencilSquareIcon.5a78d442.js";const me={class:"px-5 py-5"},pe=t("img",{src:ae,alt:"report-icon",class:"w-8 h-8 mr-2"},null,-1),ue={class:"w-full flex items-center justify-between"},_e={class:"flex items-center space-x-3"},fe={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},ve={class:"w-72 ml-2"},be={class:"w-44"},he={class:"flex items-center space-x-3"},xe={class:"mt-3"},ye={class:"text-lg font-semibold mb-2"},ge={class:"text-normal font-normal"},Re={class:"border rounded print-container",id:"print-container"},De={class:"flex items-center justify-between px-5 py-5 border-b"},ke=t("div",{class:"flex flex-col space-y-2"},[t("img",{src:ne,alt:"app-logo",class:"w-24 h-24 object-cover"}),t("h3",{class:"text-xl font-semibold"}," REJECTED SAMPLES REPORT ")],-1),we={class:"mt-10"},Ee={class:"w-full border border-dotted rounded overflow-x-auto"},$e={class:"bg-gray-50 border-b border-dotted rounded-t"},Ce=t("th",{class:"border-r"},null,-1),Me=["colspan"],Te=t("th",null,"TOTAL",-1),Fe=t("td",{class:"border-r border-b border-dotted px-2 py-2"},null,-1),Pe={class:"border-r border-b border-dotted px-2 py-2"},Se={class:"border-r border-t border-b border-dotted px-2 py-2"},Ve="Rejected Samples Report",ct=Q({__name:"rejected-samples",setup(je){W({title:`${de.name.toUpperCase()} - Rejected Samples Report`});const V=u([{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"Aggregate Reports",link:"#"}]),w=u([]),f=u({name:"select department"}),E=X("token"),g=le(),d=u(["",""]),j=()=>{d.value=new Array("","")},m=u({result:[],value:void 0,wards:void 0}),A=D(()=>[]),v=u(!1),Y=()=>{const o={};return m.value.result.forEach(r=>{r.test_types.forEach(s=>{o[s.name]?o[s.name]+=s.count:o[s.name]=s.count})}),o};async function B(){const o={route:P.departments,method:"GET",token:`${E.value}`},{data:r,error:s}=await S(o);r.value&&(w.value=r.value),s.value&&console.error(s.value)}const b=D(()=>d.value[0]?_(d.value[0]).format("YYYY-MM-DD"):""),h=D(()=>d.value[1]?_(d.value[1]).format("YYYY-MM-DD"):"");async function L(){if(O())k().$toast.warning("Please select a department");else{v.value=!0;const o={route:`${P.aggregateReports}rejected?from=${b.value}&to=${h.value}&department=${f.value.id}`,method:"GET",token:`${E.value}`},{data:r,error:s,pending:R}=await S(o);v.value=R,r.value&&(v.value=!1,m.value=r.value.data,console.log(r.value.data),k().$toast.success("Report generated successfully!")),s.value&&(console.log(s.value),v.value=!1,k().$toast.error(se))}}function O(){return f.value.name=="select department"}return B(),(o,r)=>{const s=I,R=C("datepicker"),q=K,N=ee,G=te,U=oe,H=C("excel"),J=re;return a(),n("div",me,[l(s,{pages:e(V)},null,8,["pages"]),t("div",{class:"flex items-center py-5"},[pe,t("h3",{class:"text-2xl font-semibold uppercase"},i(Ve))]),t("div",ue,[t("div",_e,[t("div",fe,[l(e(ce),{class:"w-5 h-5 mr-2"}),M(" Filter By Date Range "),t("div",ve,[l(R,{onCleared:j,required:"",position:"left",placeholder:"select start & end date",range:!0,"input-class-name":"datepicker",modelValue:e(d),"onUpdate:modelValue":r[0]||(r[0]=p=>T(d)?d.value=p:null)},null,8,["modelValue"])])]),t("div",be,[l(q,{items:e(w),modelValue:e(f),"onUpdate:modelValue":r[1]||(r[1]=p=>T(f)?f.value=p:null)},null,8,["items","modelValue"])]),l(N,{color:"primary",text:"Generate Report",icon:e(ie),click:()=>L(),loading:e(v)},null,8,["icon","click","loading"])]),t("div",he,[l(G,{printSmallLabel:!1}),l(H,{class:"btn btn-default",header:["REJECTED SAMPLES REPORT ",`PERIOD FROM ${e(_)(e(b)).format("DD-MM-yyyy")} TO ${e(h)}).format('DD-MM-yyyy')}`,e(g).details.name,e(g).details.address,e(g).details.phone],data:e(A),worksheet:"report-work-sheet",name:`rejected_samples_report_${e(_)(e(b)).format("DD_MM_yyyy")}_to_${e(h)}).format('DD_MM_yyyy')}.xls`},{default:Z(()=>[l(U,{text:"Export Excel"})]),_:1},8,["header","data","name"])])]),t("div",xe,[t("h3",ye,[M("Tests Performed Period: "),t("span",ge,i(e(b)!=""?e(_)(e(b)).format("dateFormat"in o?o.dateFormat:e(F)):"")+" - "+i(e(h)!=""?e(_)(e(h)).format("dateFormat"in o?o.dateFormat:e(F)):""),1)])]),t("div",Re,[t("div",De,[ke,l(J)]),t("div",we,[t("table",Ee,[(a(!0),n(x,null,y(e(m).result,(p,z)=>(a(),n(x,{key:z},[t("thead",$e,[t("tr",null,[Ce,t("th",{colspan:e(m).wards.length,class:"px-5 py-2 border-r"},i(p.name),9,Me),Te])]),t("tbody",null,[t("tr",null,[Fe,(a(!0),n(x,null,y(e(m).wards,c=>(a(),n("td",{key:c,class:"border-r border-b border-dotted px-2 py-2"},i(c),1))),128))]),(a(!0),n(x,null,y(p.test_types,c=>(a(),n("tr",{key:c.name},[t("td",Pe,i(c.name),1),(a(!0),n(x,null,y(e(m).wards,$=>(a(),n("td",{key:$,class:"border-r border-b border-dotted px-2 py-2"},i(c.ward===$?c.count:0),1))),128)),t("td",Se,i(Y()[c.name]),1)]))),128))])],64))),128))])])])])}}});export{ct as default};
