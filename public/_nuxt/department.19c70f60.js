import{_ as W}from"./Breadcrumb.vue.172b08a1.js";import{_ as I}from"./Dropdown.17f845b1.js";import{l as K,z as y,u as Q,f as X,o as r,c as o,b as m,k as t,d as e,t as d,h as S,A as B,g as Z,F as c,r as u,j as P,a as F,e as ee}from"./entry.29d75565.js";import{_ as te}from"./index.c045fc20.js";import{_ as re}from"./ExportButton.vue.c393e026.js";import{_ as oe}from"./Address.vue.e3a11591.js";import{u as se}from"./vue.f36acd1f.f2e079ec.js";import{d as V}from"./constants.8021834b.js";import{_ as ae}from"./report.5acd8875.js";import{_ as ne}from"./logo.069ff05a.js";import{_ as le}from"./stock_out.4180fb86.js";import{h as k,e as j,f as O}from"./fetch.c4499ad2.js";import{u as de}from"./facility.8101314b.js";import{P as ce}from"./package.5e2caa05.js";import{k as ie}from"./vue-doc-download.ab674543.js";import{r as pe}from"./FunnelIcon.357b5521.js";import{r as _e}from"./ArrowPathIcon.166ad1cb.js";import"./nuxt-link.03f295fe.js";import"./HomeIcon.ea2dab51.js";import"./listbox.c6ea7184.js";import"./hidden.f73e56d1.js";import"./use-text-value.f574ba92.js";import"./CheckIcon.65f37a5a.js";import"./CheckCircleIcon.ebff275b.js";import"./MagnifyingGlassIcon.476707c0.js";import"./jspdf.es.min.907c7e71.js";import"./XMarkIcon.87dc4c8a.js";import"./PrinterIcon.1a5037aa.js";import"./transition.b64af0ad.js";import"./PencilSquareIcon.7e2db42f.js";const ue={class:"px-5 py-5"},me=e("img",{src:ae,alt:"report-icon",class:"w-8 h-8 mr-2"},null,-1),be={class:"w-full flex items-center justify-between"},ye={class:"flex items-center space-x-3"},fe={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},he={class:"w-72 ml-2"},xe={class:"w-44"},ge={class:"flex items-center space-x-3"},ve={class:"border rounded print-container mt-5",id:"print-container"},ke={class:"w-full rounded-tr rounded-tl border-b px-5 py-5 flex items-center justify-between"},we=e("div",{class:"flex flex-col space-y-2"},[e("img",{src:ne,alt:"app-logo",class:"w-24 h-24 object-cover"}),e("h3",{class:"text-xl font-semibold"}," LABORATORY DEPARTMENT REPORT ")],-1),De={class:"mt-3 px-5 border-b"},Re={class:"font-medium mb-2"},$e={class:"font-normal"},Ce={key:0,class:"overflow-x-auto"},Se={class:"w-full border border-dotted rounded overflow-x-auto"},Pe={class:"w-full"},Ae=e("th",{class:"px-2 py-2 text-center border-r"},"Tests",-1),Me=["colspan"],Te=e("th",{class:"px-2 py-2 text-center"},"Total",-1),Be={class:"border-b"},Fe=e("th",{class:"border-r"},null,-1),Ve={class:"capitalize px-2 py-2 text-center bg-gray-50 border-b border-t"},je=e("th",{class:"capitalize px-2 py-2 text-center bg-gray-50 border-b border-t"},null,-1),Oe={class:"capitalize px-2 py-2 text-center border-r"},Ee={class:"px-2 py-2 text-center"},Ye={key:0,class:"w-full border border-dotted rounded overflow-x-auto mt-10"},Ne=e("th",{class:"border-b px-2 py-2",rowspan:4},"Blood Product",-1),ze=e("th",{class:"border-b px-2 py-2"},null,-1),qe=["colspan"],Le={class:"border-t"},Ge={class:"capitalize px-2 py-2 text-center bg-gray-50 border-r"},Ue=e("td",{class:"px-2 py-2 border-r border-b"},null,-1),He=e("td",{class:"px-2 py-2 bg-gray-50 border-r"}," ",-1),Je=e("td",{class:"px-2 py-2 border-b border-r"},"Age-Ranges",-1),We=e("td",{class:"px-2 py-2 border-b border-r"},"0-5",-1),Ie=e("td",{class:"px-2 py-2 border-b border-r"},"6-14",-1),Ke=e("td",{class:"border-r px-2 py-2 border-b"},"15-120",-1),Qe=e("td",{class:"px-2 py-2 bg-gray-50 border-r"}," ",-1),Xe=e("td",{class:"px-2 py-2 border-b border-r"},"Female",-1),Ze={class:"px-2 py-2 border-b border-r"},et={class:"px-2 py-2 border-b border-r"},tt={class:"border-r px-2 py-2 border-b"},rt=e("td",{class:"px-2 py-2 bg-gray-50 border-r"}," ",-1),ot=e("td",{class:"px-2 py-2 border-b border-r"},"Male",-1),st={class:"px-2 py-2 border-b border-r"},at={class:"px-2 py-2 border-b border-r"},nt={class:"border-r px-2 py-2 border-b"},lt={key:1,class:"flex flex-col space-y-3 items-center justify-center py-10"},dt=e("img",{src:le,class:"w-20 h-20"},null,-1),ct={class:"font-medium"},it="Department Report",qt=K({__name:"department",setup(pt){se({title:`${ce.name.toUpperCase()} - Department Report`}),de();const A=y(new Array),i=y(new Array("","")),E=()=>{i.value=new Array("","")},x=y({name:"select department"}),Y=y(""),N=y(""),M=Q("token"),a=y({wards:[],data:[]}),w=y(!1),z=y([{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"Aggregate Reports",link:"#"}]);async function q(){const s={route:j.departments,method:"GET",token:`${M.value}`},{data:p,error:_}=await O(s);p.value&&(A.value=p.value),_.value&&console.error(_.value)}async function L(){if(U())F().$toast.warning("Please select a department!");else{w.value=!0;let s=i.value[0].toString()!=""?k(i.value[0].toString()).format("YYYY-MM-DD"):"",p=i.value[1].toString()!=""?k(i.value[1].toString()).format("YYYY-MM-DD"):"",_=`from=${s}&to=${p}&department=${G(x.value.name)}`;const b={route:`${j.aggregateReports}/department?${_}`,method:"GET",token:`${M.value}`},{data:D,error:f,pending:v}=await O(b);w.value=v,D.value&&(w.value=!1,a.value=D.value,F().$toast.success("Report generated successfully!")),f.value&&(w.value=!1,console.error(f.value))}}function G(s){return s==="select department"||s==="-- select test type --"||s==="-- select test status --"?"":s}function U(){return x.value.name=="select department"}function H(s){return a.value.wards.reduce((_,b)=>_+(s.ward[b]?s.ward[b]:0),0)}function g(s,p,_,b){const f=JSON.parse(JSON.stringify(s[Object.keys(s)[0]])).find(R=>R.gender===p);if(!f)return 0;const v=f.ward.find(R=>Object.keys(R)[0]===_.toLowerCase());if(!v)return 0;const C=v[_.toLowerCase()][b];return C===void 0?0:C}return q(),(s,p)=>{const _=W,b=X("datepicker"),D=I,f=ee,v=te,C=re,R=oe;return r(),o("div",ue,[m(_,{pages:t(z)},null,8,["pages"]),e("div",{class:"flex items-center py-5"},[me,e("h3",{class:"text-2xl font-semibold uppercase"},d(it))]),e("div",be,[e("div",ye,[e("div",fe,[m(t(pe),{class:"w-5 h-5 mr-2"}),S(" Filter By Date Range "),e("div",he,[m(b,{onCleared:E,required:"",position:"left",placeholder:"select start & end date",range:!0,"input-class-name":"datepicker",format:"dd/MM/yyyy",modelValue:t(i),"onUpdate:modelValue":p[0]||(p[0]=l=>B(i)?i.value=l:null)},null,8,["modelValue"])])]),e("div",xe,[m(D,{items:t(A),modelValue:t(x),"onUpdate:modelValue":p[1]||(p[1]=l=>B(x)?x.value=l:null)},null,8,["items","modelValue"])]),e("div",null,[m(f,{color:"primary",text:"Generate Report",icon:t(_e),click:()=>L(),loading:t(w)},null,8,["icon","click","loading"])])]),e("div",ge,[m(v,{printSmallLabel:!1}),m(t(ie),{element:"print-container",filename:`department_report_from_${t(k)(t(Y)).format("DD_MM_yyyy")}_to_${t(k)(t(N)).format("DD_MM_yyyy")}`},{default:Z(()=>[m(C,{text:"Export Excel"})]),_:1},8,["filename"])])]),e("div",ve,[e("div",ke,[we,m(R)]),e("div",De,[e("h3",Re,[S("Tests Performed Period: "),e("span",$e,d(t(i)[0].toString()!=""?t(k)(t(i)[0].toString()).format("dateFormat"in s?s.dateFormat:t(V)):"")+" - "+d(t(i)[1].toString()!=""?t(k)(t(i)[1].toString()).format("dateFormat"in s?s.dateFormat:t(V)):""),1)])]),t(a).wards.length>0&&t(a).data.length>0?(r(),o("div",Ce,[e("table",Se,[e("thead",Pe,[e("tr",null,[Ae,e("th",{class:"px-2 py-2 text-center border-r border-b",colspan:t(a).wards.length},"Wards ",8,Me),Te]),e("tr",Be,[Fe,(r(!0),o(c,null,u(t(a).wards,(l,$)=>(r(),o("th",{class:"px-2 py-2 text-center border-r",key:$},d(l),1))),128))])]),e("tbody",null,[(r(!0),o(c,null,u(t(a).data,(l,$)=>(r(),o(c,{key:$},[e("th",Ve,d(Object.keys(l)[0]),1),(r(!0),o(c,null,u(t(a).wards,(n,h)=>(r(),o("th",{class:"capitalize px-2 py-2 text-center bg-gray-50 border-b border-t",key:h}))),128)),je,(r(!0),o(c,null,u(l[Object.keys(l)[0]],(n,h)=>(r(),o("tr",{class:"border-t border-b",key:h},[e("td",Oe,d(n.test_type),1),(r(!0),o(c,null,u(t(a).wards,(T,J)=>(r(),o("td",{key:J,class:"border-r px-2 py-2 text-center"},d(n.ward[T]?n.ward[T]:0),1))),128)),e("td",Ee,d(H(n)),1)]))),128))],64))),128))])]),t(a).blood_bank_products.length>0?(r(),o("table",Ye,[e("thead",null,[e("tr",null,[Ne,ze,e("th",{class:"border-b px-2 py-2",colspan:t(a).wards.length},"Wards",8,qe)])]),e("tbody",null,[(r(!0),o(c,null,u(t(a).blood_bank_products,(l,$)=>(r(),o(c,{key:$},[e("tr",Le,[e("td",Ge,d(Object.keys(l)[0]),1),Ue,(r(!0),o(c,null,u(t(a).wards,(n,h)=>(r(),o("th",{colspan:3,class:"px-2 py-2 text-center border-r border-b",key:h},d(n),1))),128))]),e("tr",null,[He,Je,(r(!0),o(c,null,u(t(a).wards,(n,h)=>(r(),o(c,{key:h},[We,Ie,Ke],64))),128))]),e("tr",null,[Qe,Xe,(r(!0),o(c,null,u(t(a).wards,n=>(r(),o(c,{key:n},[e("td",Ze,d(g(l,"female",n,"0-5")),1),e("td",et,d(g(l,"female",n,"6-14")),1),e("td",tt,d(g(l,"female",n,"15-120")),1)],64))),128))]),e("tr",null,[rt,ot,(r(!0),o(c,null,u(t(a).wards,n=>(r(),o(c,{key:n},[e("td",st,d(g(l,"male",n,"0-5")),1),e("td",at,d(g(l,"male",n,"6-14")),1),e("td",nt,d(g(l,"male",n,"15-120")),1)],64))),128))])],64))),128))])])):P("",!0)])):P("",!0),t(a).wards.length==0&&t(a).data.length==0?(r(),o("div",lt,[dt,e("p",null,[S("Please generate report data to preview the "),e("span",ct,d(t(x).name),1),S(" report. ")])])):P("",!0)])])}}});export{qt as default};
