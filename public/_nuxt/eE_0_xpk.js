import{_ as U}from"./u_i5tT18.js";import{a as L,u as X,l as O,m as c,b as g,e as w,g as e,f as i,n as l,p as P,_ as B,x as I,s as M,t as o,F as $,j as q,i as Z,v as Q}from"./CgCt1uig.js";import{_ as z}from"./CfpL-cj9.js";import{S as D}from"./CDxCIj4O.js";import{r as T}from"./CosnS5_S.js";import{r as E}from"./Dy4fK2sP.js";import{r as G,h as b}from"./DDP8Pd40.js";import{r as K}from"./BiLmvBTn.js";import{r as Y}from"./DJfJbGbA.js";import{S as R,h as j,Y as N,G as F,V as A}from"./BBi4X6kY.js";import{_ as J}from"./DFDCZMcv.js";import{_ as W}from"./D5NS-hCo.js";import{_ as ee}from"./B04vpJj4.js";import{d as x}from"./C7nrlxI_.js";import{u as te}from"./DOBy1ww1.js";import{r as se}from"./DYMQhaww.js";import{r as oe,a as V}from"./9jRWjONT.js";import{_ as re}from"./BWdvd0jv.js";import{_ as ie}from"./IQzdcCmk.js";import{_ as ae}from"./DQ0UyYB3.js";import{u as ne}from"./Kt-y9hP3.js";import{P as ce}from"./Bf5grz7u.js";import{r as le}from"./DDaZZI9g.js";import{r as de}from"./BFVncPZ8.js";import{r as pe}from"./DaMsgard.js";import{r as ue}from"./Dbv5hOu-.js";import"./DAatDIeb.js";import"./CDGutsna.js";import"./CEii_6Qs.js";import"./22U_Ornm.js";import"./D8JfA7oG.js";import"./q9WmgNLv.js";import"./BvrD8SKf.js";import"./DESlB7Mi.js";import"./Ck2xr5Cu.js";import"./B0S8Cwtp.js";import"./CarKmmQ_.js";const _e={components:{TransitionRoot:R,TransitionChild:j,Dialog:N,DialogPanel:F,DialogTitle:A,XMarkIcon:T,UserIcon:E},data(){return{open:!1,addIcon:G,saveIcon:K,clearIcon:Y,loading:!1,voucherId:"",description:"",cookie:L("token")}},methods:{async checkVoucherValidity(){this.loading=!0;const r=new D,{data:s,error:n,pending:d}=await r.checkStockOrder(`${this.cookie}`,{voucher_number:Number(this.voucherId)});this.loading=d,s.value&&(s.value.used?X().$toast.warn("Order already exists"):this.$router.push(`/stock-management/orders/${this.voucherId}`),this.loading=!1),n.value&&(console.error(n.value),this.loading=!1)},handleClick(){this.open=!this.open},clearForm(){this.$formkit.reset("submitForm")}}},me=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),fe={class:"fixed inset-0 overflow-y-auto"},he={class:"flex min-h-full items-center justify-center p-4 text-center"},ge={class:"border-b px-3 py-3 flex items-center justify-between"},be={class:"mt-2 space-y-3"},xe={class:"w-full flex items-center px-5"},ve={class:"w-full flex flex-col space-y-2"},ye={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function we(r,s,n,d,t,a){const _=B,m=c("TransitionChild"),f=c("DialogTitle"),v=c("XMarkIcon"),y=c("FormKit"),k=z,C=c("DialogPanel"),p=c("Dialog"),h=c("TransitionRoot");return g(),w("div",null,[e("div",null,[i(_,{text:"Create order",color:"primary",icon:t.addIcon,click:a.handleClick},null,8,["icon","click"])]),i(h,{appear:"",show:t.open,as:"template"},{default:l(()=>[i(p,{as:"div",onClose:a.handleClick,class:"relative z-10"},{default:l(()=>[i(m,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>[me]),_:1}),e("div",fe,[e("div",he,[i(m,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[i(C,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[e("div",ge,[i(f,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:l(()=>[P(" Create stock order ")]),_:1}),e("button",{onClick:s[0]||(s[0]=(...u)=>a.handleClick&&a.handleClick(...u))},[i(v,{class:"w-5 h-5"})])]),i(y,{type:"form","submit-label":"Update",actions:!1,onSubmit:a.checkVoucherValidity,id:"submitForm"},{default:l(({value:u})=>[e("div",be,[e("div",xe,[e("div",ve,[i(y,{type:"text",label:"Voucher ID",validation:"required",modelValue:t.voucherId,"onUpdate:modelValue":s[1]||(s[1]=S=>t.voucherId=S)},null,8,["modelValue"])])])]),e("div",ye,[i(k,{type:"button",click:()=>{a.clearForm()},text:"Clear form"},null,8,["click"]),i(_,{loading:t.loading,type:"submit",click:()=>{},color:"success",icon:t.saveIcon,text:"Continue"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const ke=O(_e,[["render",we]]),Ce={components:{TransitionRoot:R,TransitionChild:j,Dialog:N,DialogPanel:F,DialogTitle:A,XMarkIcon:T,TicketIcon:se},data(){return{viewIcon:oe,show:!1,editIcon:V,facility:te(),cookie:L("token"),loading:!1,requisitions:new Array,voidReason:"",issuerName:"",issuerDesignation:"",issuerPhone:"",issuerSignature:"",approverName:"",approverDesignation:"",approverPhone:"",approverSignature:"",issuedDate:"",approvedDate:"",preparedBy:"",preparedDesignation:"",preparedSignature:"",preparedDate:"",certifiedBy:"",certifiedDesignation:"",certifiedSignature:"",certifiedDate:"",collectedBy:"",collectedDesignation:"",collectedSignature:"",collectedDate:"",verifiedBy:"",verifiedDesignation:"",verifiedSignature:"",verifiedDate:""}},props:{data:{type:Object,required:!0}},methods:{async openDialog(){await this.init(),this.handleClick()},async init(){this.loading=!0;const r=new D,{data:s,error:n,pending:d}=await r.getStockOrder(`${this.cookie}`,`${this.data.id}`);this.loading=d,s.value&&(this.requisitions=s.value.stock_requisitions,this.loading=!1,s.value.stock_pharmacy_approver_and_issuers.map(t=>{t.record_type=="issuer"?(this.issuerName=t.name,this.issuerPhone=t.phone_number,this.issuerDesignation=t.designation,this.issuerSignature=t.signature,this.issuedDate=b(t.created_date).format(x)):(this.approverName=t.name,this.approverPhone=t.phone_number,this.approverDesignation=t.designation,this.approverSignature=t.signature,this.approvedDate=b(t.created_date).format(x))}),s.value.stock_order_status_trail.map(t=>{t.stock_status.name.toLowerCase()=="draft"?(this.preparedBy=`${t.initiator.first_name} ${t.initiator.last_name}`,this.preparedDesignation="Laboratory",this.preparedSignature=t.initiator.username,this.preparedDate=b(t.created_date).format(x)):t.stock_status.name.toLowerCase()=="requested"?(this.certifiedBy=`${t.initiator.first_name} ${t.initiator.last_name}`,this.certifiedDesignation="Laboratory",this.certifiedSignature=t.initiator.username,this.certifiedDate=b(t.created_date).format(x)):t.stock_status.name.toLowerCase()=="received"?(this.collectedBy=`${t.initiator.first_name} ${t.initiator.last_name}`,this.collectedDesignation="Laboratory",this.collectedSignature=t.initiator.username,this.collectedDate=b(t.created_date).format(x)):t.stock_status.name.toLowerCase()=="approved"&&(this.verifiedBy=`${t.initiator.first_name} ${t.initiator.last_name}`,this.verifiedDesignation="Laboratory",this.verifiedSignature=t.initiator.username,this.verifiedDate=b(t.created_date).format(x))})),n.value&&(console.error(n.value),this.loading=!1)},handleClick(){this.show=!this.show}}},H="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M9%206C7.34315%206%206%207.34315%206%209V39C6%2040.6569%207.34315%2042%209%2042H39C40.6569%2042%2042%2040.6569%2042%2039V9C42%207.34315%2040.6569%206%2039%206H9ZM20.8%2016L28.2%2016.0002V17.0001C28.2%2017.2855%2028.4226%2017.7213%2028.8491%2018.2037C29.0393%2018.4187%2029.2325%2018.6011%2029.3792%2018.7302C29.4519%2018.7941%2029.5114%2018.8434%2029.5511%2018.8755C29.5708%2018.8915%2029.5856%2018.9031%2029.5944%2018.9099L29.6024%2018.9161L30%2019.2159V21H28V20.1802C27.8169%2020.016%2027.5851%2019.7935%2027.3509%2019.5285C27.033%2019.1691%2026.6234%2018.6359%2026.3884%2018L22.5447%2018.0001C22.493%2018.1099%2022.4389%2018.2107%2022.3881%2018.3C22.1834%2018.6601%2021.9233%2019.0165%2021.6825%2019.3192C21.4385%2019.6258%2021.197%2019.8987%2021.0178%2020.0938L21%2020.1132V31.5C21%2033.433%2022.567%2035%2024.5%2035C25.8962%2035%2027.1015%2034.1825%2027.6632%2033H29.793C29.14%2035.3085%2027.0176%2037%2024.5%2037C21.4624%2037%2019%2034.5376%2019%2031.5V19.3017L19.2907%2019.0095L19.2934%2019.0067L19.3054%2018.9944C19.3166%2018.983%2019.3338%2018.9654%2019.3561%2018.9421C19.4009%2018.8955%2019.466%2018.8268%2019.5447%2018.7411C19.703%2018.5687%2019.9115%2018.3327%2020.1175%2018.0738C20.3266%2017.811%2020.5166%2017.5453%2020.6494%2017.3117C20.7524%2017.1304%2020.785%2017.0302%2020.7953%2016.9986C20.7977%2016.991%2020.7989%2016.9874%2020.7995%2016.9875C20.7994%2016.9872%2020.7996%2016.9875%2020.7995%2016.9875C20.7995%2016.9877%2020.7999%2016.9886%2020.7999%2016.989L20.8%2016.9932V16ZM32%2028.0909C32%2029.6976%2030.6569%2031%2029%2031C27.3431%2031%2026%2029.6976%2026%2028.0909C26%2025.5455%2029%2023%2029%2023C29%2023%2032%2025.5455%2032%2028.0909ZM29%2010H20V14H29V10Z'%20fill='currentColor'/%3e%3c/svg%3e",De=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Se={class:"fixed inset-0 overflow-y-auto"},Ie={class:"flex min-h-full items-center justify-center p-4 text-center"},Ve={class:"border-b px-3 py-3 flex items-center justify-between"},Le={class:"py-5 px-5 space-y-3 print-container",id:"print-container"},Oe=e("div",{class:"rounded-tr rounded-tl px-5 py-5 flex flex-col items-center"},[e("img",{src:re,alt:"app-logo",class:"w-24 h-24 object-cover"}),e("h3",{class:"mt-2 text-xl font-medium uppercase"},"Republic of Malawi"),e("h3",{class:"mt-2 text-xl font-medium"},"Ministry of Health"),e("h3",{class:"mt-2 text-2xl font-semibold"},"Requisition and Issue Voucher")],-1),Be={class:"flex bg-gray-50 border-l-4 border-l-100 rounded-r px-2 py-2 items-center space-x-2"},Te=e("span",{class:"text-lg text-sky-500 font-medium"},"B",-1),Pe={class:"mt-3"},Me={class:"w-full"},$e=e("thead",{clas:"w-full border-t border-l border-r"},[e("tr",{class:"border-b border-t border-r border-l rounded"},[e("th",{colspan:2,class:"text-left p-2"}," Requisitions ")]),e("tr",{class:"border-b border-t border-r border-l rounded"},[e("th",{class:"px-2 py-2 text-left border-r"}," Stock Item "),e("th",{class:"px-2 py-2 text-left"}," Quantity Being Requested "),e("th",{class:"px-2 py-2 text-left"}," Quantity Isssued "),e("th",{class:"px-2 py-2 text-left"}," Quantity Collected ")])],-1),qe={class:"px-2 py-2 border-r"},Re={class:"px-2 py-2 border-r"},je={class:"px-2 py-2 border-r"},Ne={class:"px-2 py-2 border-r"},Fe={class:"rounded border mt-5"},Ae=e("div",{class:"flex items-center space-x-3 bg-gray-50 py-2 rounded-t px-2 border-b"},[e("img",{src:H,class:"w-6 h-6"}),e("h3",{class:"text-lg font-semibold"},"Preparation of RIV")],-1),He={class:"w-full grid grid-cols-2 gap-5 py-5 px-5"},Ue={class:"col-span-1 flex flex-col space-y-2"},Xe={class:"w-full flex items-center space-x-2"},Ze=e("p",{class:"w-72 font-medium"},"Prepared by: ",-1),Qe={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ze={class:"w-full flex items-center space-x-2"},Ee=e("p",{class:"w-72 font-medium"},"Designation: ",-1),Ge={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Ke={class:"w-full flex items-center space-x-2"},Ye=e("p",{class:"w-72 font-medium"},"Signature: ",-1),Je={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},We={class:"w-full flex items-center space-x-2"},et=e("p",{class:"w-72 font-medium"},"Date:",-1),tt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},st={class:"col-span-1 flex flex-col space-y-2"},ot={class:"w-full flex items-center space-x-2"},rt=e("p",{class:"w-72 font-medium"},"Certified by: ",-1),it={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},at={class:"w-full flex items-center space-x-2"},nt=e("p",{class:"w-72 font-medium"},"Designation: ",-1),ct={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},lt={class:"w-full flex items-center space-x-2"},dt=e("p",{class:"w-72 font-medium"},"Signature: ",-1),pt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ut={class:"w-full flex items-center space-x-2"},_t=e("p",{class:"w-72 font-medium"},"Date:",-1),mt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ft={class:"rounded border mt-5"},ht=e("div",{class:"flex items-center space-x-3 bg-gray-50 py-2 rounded-t px-2 border-b"},[e("img",{src:ie,class:"w-6 h-6"}),e("h3",{class:"text-lg font-semibold"},"Pharmacy")],-1),gt={class:"w-full grid grid-cols-2 gap-5 py-5 px-5"},bt={class:"col-span-1 flex flex-col space-y-2"},xt={class:"w-full flex items-center space-x-2"},vt=e("p",{class:"w-72 font-medium"},"Issued by: ",-1),yt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},wt={class:"w-full flex items-center space-x-2"},kt=e("p",{class:"w-72 font-medium"},"Designation: ",-1),Ct={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Dt={class:"w-full flex items-center space-x-2"},St=e("p",{class:"w-72 font-medium"},"Signature: ",-1),It={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Vt={class:"w-full flex items-center space-x-2"},Lt=e("p",{class:"w-72 font-medium"},"Date:",-1),Ot={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Bt={class:"col-span-1 flex flex-col space-y-2"},Tt={class:"w-full flex items-center space-x-2"},Pt=e("p",{class:"w-72 font-medium"},"Approved by: ",-1),Mt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},$t={class:"w-full flex items-center space-x-2"},qt=e("p",{class:"w-72 font-medium"},"Designation: ",-1),Rt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},jt={class:"w-full flex items-center space-x-2"},Nt=e("p",{class:"w-72 font-medium"},"Signature: ",-1),Ft={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},At={class:"w-full flex items-center space-x-2"},Ht=e("p",{class:"w-72 font-medium"},"Date:",-1),Ut={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Xt={class:"rounded border mt-5"},Zt=e("div",{class:"flex items-center space-x-3 bg-gray-50 py-2 rounded-t px-2 border-b"},[e("img",{src:H,class:"w-6 h-6"}),e("h3",{class:"text-lg font-semibold"},"Finalisation of Order")],-1),Qt={class:"w-full grid grid-cols-2 gap-5 py-5 px-5"},zt={class:"col-span-1 flex flex-col space-y-2"},Et={class:"w-full flex items-center space-x-2"},Gt=e("p",{class:"w-72 font-medium"},"Collected by: ",-1),Kt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Yt={class:"w-full flex items-center space-x-2"},Jt=e("p",{class:"w-72 font-medium"},"Designation: ",-1),Wt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},es={class:"w-full flex items-center space-x-2"},ts=e("p",{class:"w-72 font-medium"},"Signature: ",-1),ss={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},os={class:"w-full flex items-center space-x-2"},rs=e("p",{class:"w-72 font-medium"},"Date:",-1),is={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},as={class:"col-span-1 flex flex-col space-y-2"},ns={class:"w-full flex items-center space-x-2"},cs=e("p",{class:"w-72 font-medium"},"Verified by: ",-1),ls={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ds={class:"w-full flex items-center space-x-2"},ps=e("p",{class:"w-72 font-medium"},"Designation: ",-1),us={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},_s={class:"w-full flex items-center space-x-2"},ms=e("p",{class:"w-72 font-medium"},"Signature: ",-1),fs={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},hs={class:"w-full flex items-center space-x-2"},gs=e("p",{class:"w-72 font-medium"},"Date:",-1),bs={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"};function xs(r,s,n,d,t,a){const _=B,m=c("TransitionChild"),f=ee,v=c("DialogTitle"),y=c("XMarkIcon"),k=c("TicketIcon"),C=c("DialogPanel"),p=c("Dialog"),h=c("TransitionRoot");return g(),w("div",null,[i(_,{click:()=>{a.openDialog()},color:"primary",text:"View",icon:t.viewIcon},null,8,["click","icon"]),i(h,{appear:"",show:t.show,as:"template"},{default:l(()=>[i(p,{as:"div",class:"relative z-10"},{default:l(()=>[i(m,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>[De]),_:1}),e("div",Se,[e("div",Ie,[i(m,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[i(C,{class:"w-full max-w-4xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[e("div",Ve,[i(v,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>[n.data.stock_order_status.toLowerCase()==="approved"?(g(),I(f,{key:0,id:"print-container","print-small-label":!1})):M("",!0)]),_:1}),e("button",{onClick:s[0]||(s[0]=(...u)=>a.handleClick&&a.handleClick(...u))},[i(y,{class:"w-5 h-5"})])]),e("div",Le,[Oe,e("div",Be,[i(k,{class:"h-5 w-5"}),e("p",null,[P("Voucher Number: "),Te,e("strong",null,o(n.data.voucher_number),1)])]),e("div",Pe,[e("table",Me,[$e,e("tbody",null,[(g(!0),w($,null,q(t.requisitions,(u,S)=>(g(),w("tr",{key:S,class:"border-b border-t border-r border-l rounded"},[e("td",qe,o(u.item.name),1),e("td",Re,o(u.quantity_requested),1),e("td",je,o(u.quantity_issued),1),e("td",Ne,o(u.quantity_collected),1)]))),128))])]),e("div",Fe,[Ae,e("div",He,[e("div",Ue,[e("div",Xe,[Ze,e("span",Qe,o(t.preparedBy),1)]),e("div",ze,[Ee,e("span",Ge,o(t.preparedDesignation),1)]),e("div",Ke,[Ye,e("span",Je,o(t.preparedSignature),1)]),e("div",We,[et,e("span",tt,o(t.preparedDate),1)])]),e("div",st,[e("div",ot,[rt,e("span",it,o(t.certifiedBy),1)]),e("div",at,[nt,e("span",ct,o(t.certifiedDesignation),1)]),e("div",lt,[dt,e("span",pt,o(t.certifiedSignature),1)]),e("div",ut,[_t,e("span",mt,o(t.certifiedDate),1)])])])]),e("div",ft,[ht,e("div",gt,[e("div",bt,[e("div",xt,[vt,e("span",yt,o(t.issuerName),1)]),e("div",wt,[kt,e("span",Ct,o(t.issuerDesignation),1)]),e("div",Dt,[St,e("span",It,o(t.issuerSignature),1)]),e("div",Vt,[Lt,e("span",Ot,o(t.issuedDate),1)])]),e("div",Bt,[e("div",Tt,[Pt,e("span",Mt,o(t.approverName),1)]),e("div",$t,[qt,e("span",Rt,o(t.approverDesignation),1)]),e("div",jt,[Nt,e("span",Ft,o(t.issuerSignature),1)]),e("div",At,[Ht,e("span",Ut,o(t.approvedDate),1)])])])]),e("div",Xt,[Zt,e("div",Qt,[e("div",zt,[e("div",Et,[Gt,e("span",Kt,o(t.collectedBy),1)]),e("div",Yt,[Jt,e("span",Wt,o(t.collectedDesignation),1)]),e("div",es,[ts,e("span",ss,o(t.collectedSignature),1)]),e("div",os,[rs,e("span",is,o(t.collectedDate),1)])]),e("div",as,[e("div",ns,[cs,e("span",ls,o(t.verifiedBy),1)]),e("div",ds,[ps,e("span",us,o(t.verifiedDesignation),1)]),e("div",_s,[ms,e("span",fs,o(t.verifiedSignature),1)]),e("div",hs,[gs,e("span",bs,o(t.verifiedDate),1)])])])])])])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const vs=O(Ce,[["render",xs]]),ys={setup(){ne({title:`${ce.name.toUpperCase()} - Stock Orders`})},data(){return{header:"Stock Orders",pages:[{name:"Home",link:"/home"},{name:"Stock Management",link:"#"}],search:"",headers:[{text:"Voucher Number",value:"voucher_number",sortable:!0},{text:"Requisitions",value:"requisitions"},{text:"Status",value:"stock_order_status"},{text:"Date Created",value:"created_date"},{text:"actions",value:"actions"}],statuses:new Array,statusSelected:{name:"-- select status -- ",id:0},orders:new Array,printIcon:le,editIcon:V,clearIcon:T,loading:!1,statusLoading:!1,cookie:L("token"),serverItemsLength:0,serverOptions:{page:1,rowsPerPage:25,sortBy:"voucher_number"}}},created(){this.init(),this.getOrderStatuses()},computed:{orderStatuses(){return[{name:"Edit",show:"pending",icon:V},{name:"Verify",show:"draft",icon:de},{name:"Receive",show:"requested",icon:pe},{name:"Approve",show:"received",icon:ue}]}},methods:{async getOrderStatuses(){const r=new D,{data:s,error:n}=await r.getStockOrderStatus(`${this.cookie}`);s.value&&s.value.map(d=>{this.statuses.push({name:d.name,id:d.id})}),n.value&&console.error(n.value)},async init(){this.loading=!0;const r=new D;let s=this.statusSelected.id==0?"":this.statusSelected.id;const{page:n,rowsPerPage:d}=this.serverOptions;let t=`page=${n}&per_page=${d}`;const{data:a,error:_,pending:m}=await r.getStockOrder(`${this.cookie}`,"",this.search,`${s}`,t);this.loading=m,a.value&&(this.orders=a.value.data.map(f=>({...f,requisitions:f.stock_requisitions.length,created_date:b(f.created_date).format(x)})),this.loading=!1),_.value&&(console.error(_.value),this.loading=!1)},clearFilter(){this.statuses.push({name:"-- select status -- ",id:0}),this.statusSelected=this.statuses[this.statuses.length-1],this.init()},checkStatus(r,s){return r.show.toLowerCase()==s.stock_order_status.toLowerCase()},verifyStockOrder(r,s){this.$router.push(`/stock-management/orders/request/${s}?order_id=${r}`)},receiveStockOrder(r,s){this.$router.push(`/stock-management/orders/receive/${s}?order_id=${r}`)},approveStockOrder(r,s){this.$router.push(`/stock-management/orders/approve/${s}?order_id=${r}`)},rejectStockOrder(r,s){this.$router.push(`/stock-management/orders/reject/${s}?order_id=${r}`)},async changeStatus(r){this.statusLoading=!0;const s=new D,n={route:"",status:r},{data:d,error:t,pending:a}=await s.updateStockOrderStatus(`${this.cookie}`,n);this.statusLoading=a,d.value&&(this.init(),this.statusLoading=!1),t.value&&(console.error(t.value),this.statusLoading=!1)},processStockOrder(r,s){r==="Verify"?this.verifyStockOrder(s.id,s.voucher_number):r==="Receive"?this.receiveStockOrder(s.id,s.voucher_number):r==="Approve"?this.approveStockOrder(s.id,s.voucher_number):r==="Reject"&&this.rejectStockOrder(s.id,s.voucher_number)}},watch:{search(){this.init()},statusSelected:{handler(){this.init()},deep:!0}}},ws={class:"px-5 py-5"},ks={class:"flex items-center justify-between py-5"},Cs={class:"text-2xl font-semibold"},Ds={class:"flex items-center space-x-3"},Ss={class:"flex items-center justify-between"},Is={class:"flex items-center space-x-2"},Vs={class:"mt-10"},Ls={class:"py-2 flex items-center space-x-2"};function Os(r,s,n,d,t,a){const _=U,m=ke,f=J,v=B,y=W,k=vs,C=ae;return g(),w("div",ws,[i(_,{pages:t.pages},null,8,["pages"]),e("div",ks,[e("h3",Cs,o(t.header),1),e("div",Ds,[i(m)])]),e("div",Ss,[e("div",Is,[i(f,{items:t.statuses,modelValue:t.statusSelected,"onUpdate:modelValue":s[0]||(s[0]=p=>t.statusSelected=p)},null,8,["items","modelValue"]),t.statusSelected.id!=0?(g(),I(v,{key:0,text:"Clear filter",color:"warning",icon:t.clearIcon,click:()=>{a.clearFilter()},loading:t.loading},null,8,["icon","click","loading"])):M("",!0)]),i(y,{search:t.search,"onUpdate:search":s[1]||(s[1]=p=>t.search=p)},null,8,["search"])]),e("div",Vs,[i(C,{data:t.orders,headers:t.headers,loading:t.loading,"search-field":"voucher_number","search-value":t.search,serverItemsLength:t.serverItemsLength,serverOptions:t.serverOptions,onUpdate:a.init},{actions:l(({item:p})=>[e("div",Ls,[i(k,{data:p},null,8,["data"]),(g(!0),w($,null,q(a.orderStatuses,(h,u)=>Z((g(),I(v,{key:u,text:h.name,color:h.name=="Reject"?"error":"success",icon:h.icon,click:()=>{a.processStockOrder(h.name,p)}},null,8,["text","color","icon","click"])),[[Q,a.checkStatus(h,p)]])),128))])]),_:1},8,["data","headers","loading","search-value","serverItemsLength","serverOptions","onUpdate"])])])}const fo=O(ys,[["render",Os]]);export{fo as default};
