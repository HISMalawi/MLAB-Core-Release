import{_ as R}from"./Breadcrumb.6b2e0aaf.js";import{u as E,a as k,_ as V,f as v,o,c as s,b as i,d as t,t as r,E as j,g as C,h as B,k as w,F as d,r as p,j as D,e as P}from"./entry.07439091.js";import{_ as q}from"./index.5202e669.js";import{e as A,d as T}from"./constants.06d305c2.js";import{u as N}from"./vue.f36acd1f.70ff2b88.js";import{h,e as I,f as S}from"./fetch.b0dbeb5a.js";import{u as L}from"./facility.9663b28a.js";import{k as U}from"./vue-doc-download.2c8f7211.js";import{P as G}from"./package.d411c004.js";import{r as H}from"./ArrowPathIcon.e0098bbf.js";import{r as O}from"./DocumentTextIcon.f4b85975.js";import{_ as z}from"./logo.b25abaa2.js";import{_ as J}from"./stock_out.23ad164c.js";import"./nuxt-link.93f30edb.js";import"./HomeIcon.42729c2c.js";import"./jspdf.es.min.3d7af806.js";import"./XMarkIcon.03d2e3cf.js";import"./PrinterIcon.0139b369.js";import"./transition.d75289e9.js";import"./hidden.0c3ab281.js";import"./PencilSquareIcon.ac5eab04.js";const K={setup(){N({title:`${G.name.toUpperCase()} - TB Tests Reports`})},components:{ExportToExcel:U},data(){return{moment:h,title:"TB Tests Report",refreshIcon:H,exportIcon:O,pages:[{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"Aggregate Reports",link:"#"}],dateFrom:"",dateTo:"",loading:!1,reportData:{months:new Array,data:new Array},facility:L(),cookie:E("token")}},methods:{async generateReport(){this.loading=!0;let l=this.dateFrom!=""?h(this.dateFrom).format("YYYY-MM-DD"):"",n=this.dateTo!=""?h(this.dateTo).format("YYYY-MM-DD"):"",y=`from=${l}&to=${n}`;const g={route:`${I.aggregateReports}tb_tests?${y}`,method:"GET",token:`${this.cookie}`},{data:e,error:m,pending:u}=await S(g);this.loading=u,e.value&&(this.loading=!1,console.log(e.value),this.reportData=e.value,k().$toast.success("Report data generated successfully")),m.value&&(this.loading=!1,console.error(m.value),k().$toast.success(A))}}},Q={class:"px-5 py-5"},W={class:"flex items-center justify-between py-5"},X={class:"text-2xl font-semibold"},Z={class:"flex justify-between items-center"},$={class:"w-40"},ee={class:"w-40"},te={class:"w-48"},oe={class:"flex items-center space-x-3"},se={key:0,class:"border rounded mt-10",id:"print-container"},re={class:"w-full bg-gray-50 rounded-tr rounded-tl px-10 py-5"},ne={class:"flex items-center justify-between px-5"},ae=t("td",null,[t("img",{src:z,alt:"app-logo",class:"w-24 h-24 object-cover"})],-1),ie={class:"py-5"},le={class:"uppercase font-medium"},ce={class:"uppercase font-medium"},de={class:"uppercase font-medium"},me=t("p",{class:"uppercase font-medium underline"},"Laboratory Report",-1),pe={class:"m-3"},ue={class:"text-lg font-semibold mb-2"},_e={class:"text-normal font-normal"},fe={class:"w-full rounded overflow-x-auto border-t"},he={class:"w-full border-b"},ye={class:"border-b"},ge=["colspan"],xe={class:"bg-gray-50"},be=t("th",{class:"px-2 py-2 border-r"},"Result",-1),ke={class:"px-2 py-2 text-center border-r capitalize"},ve={key:1,class:"flex flex-col space-y-3 items-center justify-center"},we=t("img",{src:J,class:"w-20 h-20"},null,-1),De=t("p",{class:"font-medium"},"Please generate report data to preview the report",-1),Te=[we,De];function Fe(l,n,y,g,e,m){const u=R,x=v("datepicker"),b=P,F=q,Y=v("ExportToExcel");return o(),s("div",Q,[i(u,{pages:e.pages},null,8,["pages"]),t("div",W,[t("h3",X,r(e.title),1)]),t("div",Z,[t("form",{onSubmit:n[2]||(n[2]=j(a=>m.generateReport(),["prevent"])),class:"w-full flex items-center space-x-3"},[t("div",$,[i(x,{position:"left",required:"",range:!1,placeholder:"-- start date --","input-classes":"border rounded px-2 py-1.5 block focus:outline-none focus:ring-2 focus:ring-sky-500 transition duration-150 focus:border-none",modelValue:e.dateFrom,"onUpdate:modelValue":n[0]||(n[0]=a=>e.dateFrom=a),format:"dd/MM/yyyy"},null,8,["modelValue"])]),t("div",ee,[i(x,{range:!1,required:"",placeholder:"-- end date --","input-classes":"border rounded px-2 py-1.5 block focus:outline-none focus:ring-2 focus:ring-sky-500 transition duration-150 focus:border-none",modelValue:e.dateTo,"onUpdate:modelValue":n[1]||(n[1]=a=>e.dateTo=a),format:"dd/MM/yyyy"},null,8,["modelValue"])]),t("div",te,[i(b,{type:"submit",color:"success",text:"Generate Report",icon:e.refreshIcon,click:()=>{},loading:e.loading},null,8,["icon","loading"])])],32),t("div",oe,[i(F,{printSmallLabel:!1}),i(Y,{element:"print-container",filename:`tb_tests_report_from_${e.moment(e.dateFrom).format("DD_MM_YYYY")}_to_${e.moment(e.dateTo).format("DD_MM_YYYY")}`},{default:C(()=>[i(b,{click:()=>{},text:"Export",color:"success",icon:e.exportIcon},null,8,["icon"])]),_:1},8,["filename"])])]),e.reportData.data.length>0?(o(),s("div",se,[t("table",re,[t("tr",ne,[ae,t("td",ie,[t("p",le,r(e.facility.details.name),1),t("p",ce,r(e.facility.details.address),1),t("p",de,r(e.facility.details.phone),1),me])])]),t("div",pe,[t("h3",ue,[B("Tests Performed Period: "),t("span",_e,r(e.dateFrom!=""?e.moment(e.dateFrom).format("dateFormat"in l?l.dateFormat:w(T)):"")+" - "+r(e.dateTo!=""?e.moment(e.dateTo).format("dateFormat"in l?l.dateFormat:w(T)):""),1)])]),t("div",null,[t("table",fe,[(o(!0),s(d,null,p(e.reportData.data,(a,M)=>(o(),s(d,{key:M},[t("thead",he,[t("tr",ye,[t("th",{class:"px-2 py-2 text-center uppercase",colspan:e.reportData.months.length},r(Object.keys(a)[0]),9,ge)]),t("tr",xe,[be,(o(!0),s(d,null,p(e.reportData.months,(c,_)=>(o(),s("th",{class:"px-2 py-2 border-r",key:_},r(c),1))),128))])]),t("tbody",null,[(o(!0),s(d,null,p(a[Object.keys(a)[0]],(c,_)=>(o(),s("tr",{class:"border-b",key:_},[t("td",ke,r(c.result),1),(o(!0),s(d,null,p(e.reportData.months,f=>(o(),s("td",{key:f,class:"px-2 py-2 text-center border-r"},r(c.month[f]>0?c.month[f]:0),1))),128))]))),128))])],64))),128))])])])):D("",!0),e.reportData.data.length==0?(o(),s("div",ve,Te)):D("",!0)])}const Ke=V(K,[["render",Fe]]);export{Ke as default};
