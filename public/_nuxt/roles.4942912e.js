import{_ as z}from"./Breadcrumb.vue.437e47f9.js";import{u as I,a as $,_ as R,f as a,o as C,c as D,b as e,g as l,d as t,h as T,e as V,w as X,v as B,t as P,F as L,r as H}from"./entry.b00002c8.js";import{_ as G}from"./OutlinedButton.4c65cb2c.js";import{e as E}from"./constants.54f6c1a7.js";import{r as J,e as y,f as w,h as Q,a as W}from"./fetch.4258df66.js";import{r as S}from"./XMarkIcon.f0b7420f.js";import{r as N}from"./ArrowDownTrayIcon.3a091c3d.js";import{S as U,h as j,U as q,G as A,V as F}from"./transition.47e96d34.js";import{_ as Y}from"./SearchBar.ac818ae5.js";import{_ as Z}from"./Loader.a779029f.js";import{r as ee,a as M}from"./PencilSquareIcon.18ace5e1.js";import{r as K}from"./TrashIcon.b56b3152.js";import{_ as te}from"./Datatable.ca1ba85f.js";import{u as oe}from"./vue.f36acd1f.d9242aca.js";import{P as se}from"./package.3108aa59.js";import{r as ne}from"./UserGroupIcon.e0488904.js";import"./nuxt-link.eaba292c.js";import"./HomeIcon.4a429618.js";import"./PrinterIcon.3bac4692.js";import"./hidden.78b0d74d.js";const ae={components:{TransitionRoot:U,TransitionChild:j,Dialog:q,DialogPanel:A,DialogTitle:F,XMarkIcon:S},data(){return{addIcon:J,show:!1,saveIcon:N,name:"",loading:!1,cookie:I("token"),rawPrivileges:new Array,privileges:new Array,previlegesSelected:new Array}},methods:{async init(){this.handleClick();const r={route:y.privileges,method:"GET",token:`${this.cookie}`},{data:o,error:i}=await w(r);o.value&&(this.rawPrivileges=o.value,o.value.map(c=>{this.privileges.push(c.display_name)})),i.value&&console.error(i.value)},async submitForm(){this.loading=!0;let r=new Array;this.previlegesSelected.map(s=>{this.rawPrivileges.map(n=>{s.name===n.name&&this.privileges.push(n.id)})});const o={route:y.roles,method:"POST",token:`${this.cookie}`,body:{name:this.name,privileges:r}},{data:i,error:c}=await w(o);i.value&&(this.handleClick(),$().$toast.success("Role created successfully!"),this.loading=!1,this.$emit("update",!0)),c.value&&(this.handleClick(),$().$toast.error(E),this.loading=!1,console.error(c.value))},clearForm(){this.$formkit.reset("submitForm")},handleClick(){this.show=!this.show}}},ie=t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),le={class:"fixed inset-0 overflow-y-auto"},re={class:"flex min-h-full items-center justify-center p-4 text-center"},ce={class:"border-b px-3 py-3 flex items-center justify-between"},de={class:"mt-2 space-y-3"},ue={class:"w-full flex items-center px-5"},me={class:"w-full flex flex-col space-y-2"},pe={class:"w-full flex flex-col space-y-2 px-5 pb-36"},_e=t("label",{class:"font-medium"},"Permissions",-1),he={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function fe(r,o,i,c,s,n){const u=V,d=a("TransitionChild"),h=a("DialogTitle"),f=a("XMarkIcon"),m=a("FormKit"),_=a("multi-select"),v=G,p=a("DialogPanel"),g=a("Dialog"),x=a("TransitionRoot");return C(),D("div",null,[e(u,{click:n.init,text:"Create role",color:"success",icon:s.addIcon},null,8,["click","icon"]),e(x,{appear:"",show:s.show,as:"template"},{default:l(()=>[e(g,{as:"div",class:"relative z-10"},{default:l(()=>[e(d,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>[ie]),_:1}),t("div",le,[t("div",re,[e(d,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[e(p,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[t("div",ce,[e(h,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>[T(" Create role ")]),_:1}),t("button",{onClick:o[0]||(o[0]=(...k)=>n.handleClick&&n.handleClick(...k))},[e(f,{class:"w-5 h-5"})])]),e(m,{type:"form",id:"submitForm","submit-label":"Update",onSubmit:n.submitForm,actions:!1},{default:l(({value:k})=>[t("div",de,[t("div",ue,[t("div",me,[e(m,{type:"text",label:"Name",validation:"required",modelValue:s.name,"onUpdate:modelValue":o[1]||(o[1]=b=>s.name=b)},null,8,["modelValue"])])]),t("div",pe,[_e,e(_,{style:{"--ms-max-height":"none !important"},modelValue:s.previlegesSelected,"onUpdate:modelValue":o[2]||(o[2]=b=>s.previlegesSelected=b),options:s.privileges,mode:"tags",required:"",clear:"",searchable:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),t("div",he,[e(v,{type:"button",click:()=>n.clearForm(),text:"Clear form"},null,8,["click"]),e(u,{loading:s.loading,type:"submit",click:()=>{},color:"success",icon:s.saveIcon,text:"Save changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const ve=R(ae,[["render",fe]]),ge={components:{TransitionRoot:U,TransitionChild:j,Dialog:q,DialogPanel:A,DialogTitle:F,XMarkIcon:S},data(){return{viewIcon:ee,show:!1,editIcon:M,moment:Q,cookie:I("token"),details:{name:"",privileges:[{id:0,display_name:""}]},loading:!1}},props:{data:{type:Object,required:!0}},methods:{async init(){this.handleClick(),this.loading=!0;const r={route:`${y.roles}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:o,error:i,pending:c}=await w(r);this.loading=c,o.value&&(this.details=o.value,this.loading=!1),i.value&&(console.error(i.value),this.loading=!1)},handleClick(){this.show=!this.show}}},O=""+new URL("group.3c310866.svg",import.meta.url).href,xe=t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),ye={class:"fixed inset-0 overflow-y-auto"},we={class:"flex min-h-full items-center justify-center p-4 text-center"},ke={class:"border-b px-3 py-3 flex items-center justify-between"},be=t("img",{src:O,class:"w-8 h-8 mr-2"},null,-1),Ce={class:"flex items-center justify-center mx-auto my-20"},De={class:"space-y-3 px-5 py-5"},Te={class:"w-full flex flex-col space-y-1"},$e=t("label",{class:"font-semibold text-lg"},"Name",-1),Ie={class:"underline"},Re={class:"w-full flex flex-col space-y-1"},Pe=t("label",{class:"font-semibold text-lg"},"Permissions",-1);function Ve(r,o,i,c,s,n){const u=V,d=a("TransitionChild"),h=a("DialogTitle"),f=a("XMarkIcon"),m=Z,_=a("DialogPanel"),v=a("Dialog"),p=a("TransitionRoot");return C(),D("div",null,[e(u,{click:n.init,color:"primary",text:"View",icon:s.viewIcon},null,8,["click","icon"]),e(p,{appear:"",show:s.show,as:"template"},{default:l(()=>[e(v,{as:"div",class:"relative z-10"},{default:l(()=>[e(d,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>[xe]),_:1}),t("div",ye,[t("div",we,[e(d,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[e(_,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[t("div",ke,[e(h,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>[be,T(" View role ")]),_:1}),t("button",{onClick:o[0]||(o[0]=(...g)=>n.handleClick&&n.handleClick(...g))},[e(f,{class:"w-5 h-5"})])]),X(t("div",Ce,[e(m,{loading:s.loading},null,8,["loading"])],512),[[B,s.loading]]),X(t("div",De,[t("div",Te,[$e,t("p",Ie,P(s.details.name),1)]),t("div",Re,[Pe,(C(!0),D(L,null,H(s.details.privileges,(g,x)=>(C(),D("p",{key:x,class:"underline"},P(g.display_name),1))),128))])],512),[[B,!s.loading]])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const Se=R(ge,[["render",Ve]]),Ue={components:{TransitionRoot:U,TransitionChild:j,Dialog:q,DialogPanel:A,DialogTitle:F,XMarkIcon:S},data(){return{editIcon:M,show:!1,saveIcon:N,name:this.data.name,loading:!1,cookie:I("token"),rawPrivileges:new Array,privileges:new Array,previlegesSelected:new Array}},props:{data:{type:Object,required:!0}},created(){this.loadPrivileges()},methods:{async loadPrivileges(){const r={route:y.privileges,method:"GET",token:`${this.cookie}`},{data:o,error:i}=await w(r);o.value&&(this.rawPrivileges=o.value,o.value.map(c=>{this.privileges.push(c.display_name)})),i.value&&console.error(i.value)},async init(){this.handleClick();const r={route:`${y.roles}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:o,error:i}=await w(r);o.value&&o.value.privileges.map(c=>{this.previlegesSelected.push(c.display_name)}),i.value&&console.error(i.value)},async submitForm(){this.loading=!0;const r=this.rawPrivileges.filter(n=>this.previlegesSelected.includes(n.display_name)).map(n=>n.id),o={route:`${y.roles}/${this.data.id}`,method:"PUT",token:`${this.cookie}`,body:{name:this.name,privileges:r}},{data:i,error:c,pending:s}=await w(o);this.loading=s,i.value&&(this.handleClick(),this.previlegesSelected=new Array,$().$toast.success("Role updated successfully!"),this.loading=!1,this.$emit("update",!0)),c.value&&(this.handleClick(),console.error(c.value),$().$toast.success(E),this.loading=!1)},handleClick(){this.show=!this.show}}},je=t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),qe={class:"fixed inset-0 overflow-y-auto"},Ae={class:"flex min-h-full items-center justify-center p-4 text-center"},Fe={class:"border-b px-3 py-3 flex items-center justify-between"},Ee=t("img",{src:O,class:"w-8 h-8 mr-2"},null,-1),Me={class:"mt-2 space-y-3"},Xe={class:"w-full flex items-center px-5"},Be={class:"w-full flex flex-col space-y-2"},Ge={class:"w-full flex flex-col space-y-2 px-5 pb-36 mt-3"},Ne=t("label",{class:"font-medium"},"Permissions",-1),Ke={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Oe(r,o,i,c,s,n){const u=V,d=a("TransitionChild"),h=a("DialogTitle"),f=a("XMarkIcon"),m=a("FormKit"),_=a("multi-select"),v=G,p=a("DialogPanel"),g=a("Dialog"),x=a("TransitionRoot");return C(),D("div",null,[e(u,{click:n.init,text:"Edit",color:"success",icon:s.editIcon},null,8,["click","icon"]),e(x,{appear:"",show:s.show,as:"template"},{default:l(()=>[e(g,{as:"div",class:"relative z-10"},{default:l(()=>[e(d,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>[je]),_:1}),t("div",qe,[t("div",Ae,[e(d,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[e(p,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[t("div",Fe,[e(h,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>[Ee,T(" Edit role ")]),_:1}),t("button",{onClick:o[0]||(o[0]=(...k)=>n.handleClick&&n.handleClick(...k))},[e(f,{class:"w-5 h-5"})])]),e(m,{type:"form","submit-label":"Update",onSubmit:n.submitForm,actions:!1},{default:l(({value:k})=>[t("div",Me,[t("div",Xe,[t("div",Be,[e(m,{type:"text",label:"Name",validation:"required",modelValue:s.name,"onUpdate:modelValue":o[1]||(o[1]=b=>s.name=b)},null,8,["modelValue"])])])]),t("div",Ge,[Ne,e(_,{style:{"--ms-max-height":"none !important"},modelValue:s.previlegesSelected,"onUpdate:modelValue":o[2]||(o[2]=b=>s.previlegesSelected=b),options:s.privileges,mode:"tags",required:"",clear:"",searchable:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])]),t("div",Ke,[e(v,{text:"Clear form"}),e(u,{loading:s.loading,type:"submit",click:()=>{},color:"success",icon:s.saveIcon,text:"Save changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const ze=R(Ue,[["render",Oe]]),Le={components:{TransitionRoot:U,TransitionChild:j,Dialog:q,DialogPanel:A,DialogTitle:F,XMarkIcon:S,ExclamationTriangleIcon:W},data(){return{show:!1,deleteIcon:K,loading:!1,reason:"",cookie:I("token")}},props:{data:{type:Object,required:!0}},methods:{async deleteData(r){this.loading=!0;const o={route:`${y.roles}/${r}`,method:"DELETE",token:`${this.cookie}`,body:{retired_reason:this.reason}},{data:i,error:c,pending:s}=await w(o);this.loading=s,i.value&&(this.handleClick(),$().$toast.success(`${i.value.message}`),this.loading=!1,this.$emit("update",!0)),c.value&&(console.error(i.value),this.loading=!1,$().$toast.error(E))},handleClick(){this.show=!this.show}}},He=t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Je={class:"fixed inset-0 overflow-y-auto"},Qe={class:"flex min-h-full items-center justify-center p-4 text-center"},We={class:"border-b px-3 py-3 flex items-center justify-between"},Ye={class:"mt-2 space-y-3 px-5"},Ze={class:"rounded px-2 py-2"},et={class:"font-semibold text-red-500"},tt={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function ot(r,o,i,c,s,n){const u=V,d=a("TransitionChild"),h=a("ExclamationTriangleIcon"),f=a("DialogTitle"),m=a("XMarkIcon"),_=a("FormKit"),v=a("DialogPanel"),p=a("Dialog"),g=a("TransitionRoot");return C(),D("div",null,[e(u,{click:n.handleClick,color:"error",text:"Delete",icon:s.deleteIcon},null,8,["click","icon"]),e(g,{appear:"",show:s.show,as:"template"},{default:l(()=>[e(p,{as:"div",class:"relative z-10"},{default:l(()=>[e(d,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>[He]),_:1}),t("div",Je,[t("div",Qe,[e(d,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[e(v,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[t("div",We,[e(f,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>[e(h,{class:"h-5 w-5 mr-2"}),T(" Confirm delete ")]),_:1}),t("button",{onClick:o[0]||(o[0]=(...x)=>n.handleClick&&n.handleClick(...x))},[e(m,{class:"w-5 h-5"})])]),e(_,{type:"form","submit-label":"Update",onSubmit:o[2]||(o[2]=x=>n.deleteData(i.data.id)),actions:!1},{default:l(({value:x})=>[t("div",Ye,[t("div",Ze,[T(" Do you really want to delete "),t("span",et,P(i.data.name),1),T("? Note that once this action is completed, it can not be undone ")]),e(_,{type:"textarea",label:"Reason",validation:"required",modelValue:s.reason,"onUpdate:modelValue":o[1]||(o[1]=k=>s.reason=k)},null,8,["modelValue"])]),t("div",tt,[e(u,{loading:s.loading,type:"submit",click:()=>{},color:"error",icon:s.deleteIcon,text:"Delete"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const st=R(Le,[["render",ot]]),nt={setup(){oe({title:`${se.name.toUpperCase()} - Roles`})},components:{UserGroupIcon:ne},data(){return{header:"Roles",editIcon:M,deleteIcon:K,pages:[{name:"Home",link:"/home"},{name:"Access Controls",link:"#"}],roles:new Array,cookie:I("token"),headers:new Array({text:"id",value:"id",sortable:!0},{text:"name",value:"name",sortable:!0},{text:"actions",value:"actions"}),searchValue:"",search:"",loading:!1}},created(){this.init()},methods:{updateSearch(r){this.searchValue=r,this.search=r},async init(){this.loading=!0;const r={route:y.roles,method:"GET",token:`${this.cookie}`},{data:o,error:i,pending:c}=await w(r);this.loading=c,o.value&&(this.roles=o.value,this.loading=!1),i.value&&(console.error(i.value),this.loading=!1)},updateRoles(r){r&&this.init()}},computed:{filteredRoles(){const{roles:r}=this;return r.map(o=>({id:o.id,name:o.name}))}}},at={class:"px-5 py-5"},it={class:"flex items-center justify-between py-5"},lt={class:"text-2xl font-semibold"},rt={class:"flex items-center justify-between py-5"},ct=t("div",null,null,-1),dt={class:"flex items-center space-x-3"},ut={class:"py-2 flex items-center space-x-2"};function mt(r,o,i,c,s,n){const u=z,d=ve,h=Y,f=Se,m=ze,_=st,v=te;return C(),D("div",at,[e(u,{pages:s.pages},null,8,["pages"]),t("div",it,[t("h3",lt,P(s.header),1),e(d)]),t("div",rt,[ct,t("div",dt,[e(h,{search:s.search,onUpdate:n.updateSearch},null,8,["search","onUpdate"])])]),e(v,{headers:s.headers,data:n.filteredRoles,loading:s.loading,"search-value":s.searchValue,"search-field":"name"},{actions:l(({item:p})=>[t("div",ut,[e(f,{data:p,onUpdate:n.updateRoles},null,8,["data","onUpdate"]),e(m,{data:p,onUpdate:n.updateRoles},null,8,["data","onUpdate"]),e(_,{data:p,onUpdate:n.updateRoles},null,8,["data","onUpdate"])])]),_:1},8,["headers","data","loading","search-value"])])}const Ut=R(nt,[["render",mt]]);export{Ut as default};
