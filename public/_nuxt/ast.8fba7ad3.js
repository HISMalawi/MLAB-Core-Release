import{l as U,s as v,u as V,H as M,f as I,o as n,c as l,d as e,b as a,g,k as t,h as T,y as F,t as c,F as R,r as w,j as E,w as O,v as P,a as k,e as j}from"./entry.c551b705.js";import{_ as L}from"./ExportButton.vue.b137a760.js";import{_ as G}from"./Address.vue.bfe7b3f8.js";import{_ as Y}from"./Loader.11946374.js";import{e as q}from"./constants.c32bb852.js";import{_ as K}from"./logo.a42aceaa.js";import{_ as z}from"./page.6f801adf.js";import{h as p,e as H,f as J}from"./fetch.7df80c03.js";import{u as Q}from"./facility.01164380.js";import{r as W}from"./FunnelIcon.c896a477.js";import{r as X}from"./ArrowPathIcon.4d5c879a.js";import"./transition.fe0cdd04.js";import"./hidden.1f7f321e.js";import"./XMarkIcon.455acd8f.js";import"./PencilSquareIcon.c201b425.js";import"./PrinterIcon.de9e1628.js";const Z={class:"w-full flex items-center justify-between mb-10"},ee={class:"flex items-center space-x-5"},te={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},se={class:"w-56 ml-2"},oe={class:"w-48"},re={class:"rounded border",id:"print-container"},ae={class:"rounded-tr rounded-tl border-b px-5 py-5 flex items-center justify-between"},ne=e("div",{class:"flex flex-col space-y-2"},[e("img",{src:K,alt:"app-logo",class:"w-24 h-24 object-cover"}),e("h3",{class:"text-xl font-semibold"},"CULTURE & SENSITIVITY ANTIBIOTIC SUSCEPTIBILITY REPORT ")],-1),le={class:"px-4 mt-2 font-medium"},ce={class:"font-normal"},ie={key:0},de={class:"w-full border-b border-t bg-gray-50 rounded-t"},pe={colspan:4,class:"text-left px-2 py-2"},_e=e("tr",{class:"border-r border-t"},[e("th",{class:"border-r px-2 py-2 text-left"}," Drug Name "),e("th",{class:"border-r px-2 py-2 text-center"}," I "),e("th",{class:"border-r px-2 py-2 text-center"}," R "),e("th",{class:"px-2 py-2 text-center"}," S ")],-1),me={class:"border-r px-2 py-2 text-left"},ue={class:"border-r px-2 py-2 text-center"},fe={class:"border-r px-2 py-2 text-center"},ye={class:"px-2 py-2 text-center"},he={class:"w-full items-center flex flex-col space-y-2 my-10"},xe=e("p",null,[T("Generating report, please wait"),e("span",{class:"animate-pulse"},"...")],-1),be={key:1,class:"w-full flex flex-col items-center justify-center space-y-2 py-10"},ve=e("img",{src:z,alt:"page-icon",class:"object-cover w-20 h-20"},null,-1),Ie=e("p",null,"Data not found, please generate report",-1),Te=[ve,Ie],Pe=U({__name:"ast",setup(ge){const s=v(""),N=V("token"),r=v(!1),i=v([]),f=Q(),C=M(()=>i.value.flatMap(_=>_.drugs.map(o=>({"DRUG NAME":o.drug_name,"INTERPRETATION I":o.interpretations.I,"INTERPRETATION R":o.interpretations.R,"INTERPRETATION S":o.interpretations.S})))),S=()=>{s.value=""};async function $(){r.value=!0;let _=p(s.value).format("M"),o=p(s.value).format("yyyy");const y={route:`${H.aggregateReports}culture/ast?year=${o}&month=${_}`,method:"GET",token:`${N.value}`},{data:m,error:u,pending:h}=await J(y);r.value=h,m.value&&(i.value=m.value.data,r.value=!1,k().$toast.success("Report data generated successfully")),u.value&&(console.error(u.value),r.value=!1,k().$toast.error(q))}return(_,o)=>{const y=I("datepicker"),m=j,u=I("FormKit"),h=L,B=I("excel"),A=G,D=Y;return n(),l("div",null,[e("div",Z,[a(u,{type:"form","submit-label":"Update",onSubmit:$,actions:!1},{default:g(({value:x})=>[e("div",ee,[e("div",te,[a(t(W),{class:"w-5 h-5 mr-2"}),T(" Filter By Date Range "),e("div",se,[a(y,{onCleared:S,required:"",position:"left",placeholder:"select month & year",range:!1,"input-class-name":"datepicker",modelValue:t(s),"onUpdate:modelValue":o[0]||(o[0]=b=>F(s)?s.value=b:null),format:"M/yyyy"},null,8,["modelValue"])])]),e("div",oe,[a(m,{type:"submit",color:"primary",text:"Generate Report",icon:t(X),click:()=>{},loading:t(r)},null,8,["icon","loading"])])])]),_:1}),e("div",null,[a(B,{class:"btn btn-default",header:[`CULTURE & SENSITIVITY ANTIBIOTIC SUSCEPTIBILITY REPORT ${t(p)(t(s)).format("M/yyyy")}`,t(f).details.name,t(f).details.address,t(f).details.phone],data:t(C),worksheet:"report-work-sheet",name:`culture_sensitivity_antibiotic_susceptibility_report_${t(p)(t(s)).format("M_yyyy")}.xls`},{default:g(()=>[a(h,{text:"Export Excel"})]),_:1},8,["header","data","name"])])]),e("div",re,[e("div",ae,[ne,a(A)]),e("div",null,[e("h3",le,[T("Data for period: "),e("span",ce,c(t(s)==""?"":t(p)(t(s)).format("M/yyyy")),1)])]),t(i).length>0&&!t(r)?(n(),l("div",ie,[(n(!0),l(R,null,w(t(i),(x,b)=>(n(),l("table",{key:b,class:"w-full mt-3",ref_for:!0,ref:"table"},[e("thead",de,[e("tr",null,[e("th",pe,c(x.name),1)]),_e]),e("tbody",null,[(n(!0),l(R,null,w(x.drugs,d=>(n(),l("tr",{key:d,class:"border-b border-r border-l"},[e("td",me,c(d.drug_name),1),e("td",ue,c(d.interpretations.I),1),e("td",fe,c(d.interpretations.R),1),e("td",ye,c(d.interpretations.S),1)]))),128))])],512))),128))])):E("",!0),O(e("div",he,[a(D),xe],512),[[P,t(r)]]),t(i).length==0&&!t(r)?(n(),l("div",be,Te)):E("",!0)])])}}});export{Pe as default};
