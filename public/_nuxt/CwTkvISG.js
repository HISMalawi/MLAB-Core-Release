import{_ as U}from"./DnsJT0Ia.js";import{S as P,p as q,Y as R,G as $,V as j,q as L,s as X,a as O,u as Z,x as B,y as l,b as h,e as w,g as e,f as i,z as d,j as A,_ as T,A as z,B as I,C as b,P as x,L as V,K as N,t as o,F,k as H,M as E,i as K,v as Q}from"./DV-4n8jq.js";import{_ as G}from"./CkwR-rve.js";import{S as D}from"./D_0HA-0V.js";import{r as Y}from"./CmNFGJ7g.js";import{r as J}from"./Cye_jclW.js";import{r as W}from"./CSNGlDTv.js";import{_ as ee}from"./BfivlAzr.js";import{_ as te}from"./BJL1Ko1G.js";import{_ as se}from"./BoiOdAED.js";import{u as oe}from"./-_8NMcbT.js";import{r as re}from"./OlGufQnV.js";import{_ as ie}from"./Btww53J3.js";import{_ as ne}from"./IQzdcCmk.js";import{_ as ae}from"./GLfqwz9U.js";import{P as le}from"./C10gm716.js";import{u as de}from"./CokWNKn_.js";import{r as ce}from"./DRMcN7RZ.js";import{r as ue}from"./DOq_0B2I.js";import{r as pe}from"./CkpNujGJ.js";import"./8wCHL_pn.js";import"./BXROeG0Z.js";import"./PUvLgkXr.js";import"./D9Y-jCjP.js";import"./BughWnsJ.js";import"./JsFzH7BX.js";import"./FoxSJF9V.js";import"./Bl4Zu80E.js";import"./Cao4ruaM.js";import"./D6vWl-Mh.js";const me={components:{TransitionRoot:P,TransitionChild:q,Dialog:R,DialogPanel:$,DialogTitle:j,XMarkIcon:L,UserIcon:Y},data(){return{open:!1,addIcon:X,saveIcon:J,clearIcon:W,loading:!1,voucherId:"",description:"",cookie:O("token")}},methods:{async checkVoucherValidity(){this.loading=!0;const r=new D,{data:t,error:a,pending:c}=await r.checkStockOrder(`${this.cookie}`,{voucher_number:Number(this.voucherId)});this.loading=c,t.value&&(t.value.used?Z().$toast.warn("Order already exists"):this.$router.push(`/stock-management/orders/${this.voucherId}`),this.loading=!1),a.value&&(console.error(a.value),this.loading=!1)},handleClick(){this.open=!this.open},clearForm(){this.$formkit.reset("submitForm")}}},fe={class:"fixed inset-0 overflow-y-auto"},_e={class:"flex min-h-full items-center justify-center p-4 text-center"},ge={class:"border-b px-3 py-3 flex items-center justify-between"},he={class:"mt-2 space-y-3"},be={class:"w-full flex items-center px-5"},xe={class:"w-full flex flex-col space-y-2"},ve={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function ye(r,t,a,c,s,n){const m=T,f=l("TransitionChild"),_=l("DialogTitle"),v=l("XMarkIcon"),y=l("FormKit"),k=G,C=l("DialogPanel"),u=l("Dialog"),g=l("TransitionRoot");return h(),w("div",null,[e("div",null,[i(m,{text:"Create order",color:"primary",icon:s.addIcon,click:n.handleClick},null,8,["icon","click"])]),i(g,{appear:"",show:s.open,as:"template"},{default:d(()=>[i(u,{as:"div",onClose:n.handleClick,class:"relative z-10"},{default:d(()=>[i(f,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:d(()=>t[2]||(t[2]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",fe,[e("div",_e,[i(f,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:d(()=>[i(C,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:d(()=>[e("div",ge,[i(_,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:d(()=>t[3]||(t[3]=[A(" Create stock order ")])),_:1}),e("button",{onClick:t[0]||(t[0]=(...p)=>n.handleClick&&n.handleClick(...p))},[i(v,{class:"w-5 h-5"})])]),i(y,{type:"form","submit-label":"Update",actions:!1,onSubmit:n.checkVoucherValidity,id:"submitForm"},{default:d(({value:p})=>[e("div",he,[e("div",be,[e("div",xe,[i(y,{type:"text",label:"Voucher ID",validation:"required",modelValue:s.voucherId,"onUpdate:modelValue":t[1]||(t[1]=S=>s.voucherId=S)},null,8,["modelValue"])])])]),e("div",ve,[i(k,{type:"button",click:()=>{n.clearForm()},text:"Clear form"},null,8,["click"]),i(m,{loading:s.loading,type:"submit",click:()=>{},color:"success",icon:s.saveIcon,text:"Continue"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const we=B(me,[["render",ye]]),ke={components:{TransitionRoot:P,TransitionChild:q,Dialog:R,DialogPanel:$,DialogTitle:j,XMarkIcon:L,TicketIcon:re},data(){return{viewIcon:z,show:!1,editIcon:I,facility:oe(),cookie:O("token"),loading:!1,requisitions:new Array,voidReason:"",issuerName:"",issuerDesignation:"",issuerPhone:"",issuerSignature:"",approverName:"",approverDesignation:"",approverPhone:"",approverSignature:"",issuedDate:"",approvedDate:"",preparedBy:"",preparedDesignation:"",preparedSignature:"",preparedDate:"",certifiedBy:"",certifiedDesignation:"",certifiedSignature:"",certifiedDate:"",collectedBy:"",collectedDesignation:"",collectedSignature:"",collectedDate:"",verifiedBy:"",verifiedDesignation:"",verifiedSignature:"",verifiedDate:""}},props:{data:{type:Object,required:!0}},methods:{async openDialog(){await this.init(),this.handleClick()},async init(){this.loading=!0;const r=new D,{data:t,error:a,pending:c}=await r.getStockOrder(`${this.cookie}`,`${this.data.id}`);this.loading=c,t.value&&(this.requisitions=t.value.stock_requisitions,this.loading=!1,t.value.stock_pharmacy_approver_and_issuers.map(s=>{s.record_type=="issuer"?(this.issuerName=s.name,this.issuerPhone=s.phone_number,this.issuerDesignation=s.designation,this.issuerSignature=s.signature,this.issuedDate=b(s.created_date).format(x)):(this.approverName=s.name,this.approverPhone=s.phone_number,this.approverDesignation=s.designation,this.approverSignature=s.signature,this.approvedDate=b(s.created_date).format(x))}),t.value.stock_order_status_trail.map(s=>{s.stock_status.name.toLowerCase()=="draft"?(this.preparedBy=`${s.initiator.first_name} ${s.initiator.last_name}`,this.preparedDesignation="Laboratory",this.preparedSignature=s.initiator.username,this.preparedDate=b(s.created_date).format(x)):s.stock_status.name.toLowerCase()=="requested"?(this.certifiedBy=`${s.initiator.first_name} ${s.initiator.last_name}`,this.certifiedDesignation="Laboratory",this.certifiedSignature=s.initiator.username,this.certifiedDate=b(s.created_date).format(x)):s.stock_status.name.toLowerCase()=="received"?(this.collectedBy=`${s.initiator.first_name} ${s.initiator.last_name}`,this.collectedDesignation="Laboratory",this.collectedSignature=s.initiator.username,this.collectedDate=b(s.created_date).format(x)):s.stock_status.name.toLowerCase()=="approved"&&(this.verifiedBy=`${s.initiator.first_name} ${s.initiator.last_name}`,this.verifiedDesignation="Laboratory",this.verifiedSignature=s.initiator.username,this.verifiedDate=b(s.created_date).format(x))})),a.value&&(console.error(a.value),this.loading=!1)},handleClick(){this.show=!this.show}}},M="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M9%206C7.34315%206%206%207.34315%206%209V39C6%2040.6569%207.34315%2042%209%2042H39C40.6569%2042%2042%2040.6569%2042%2039V9C42%207.34315%2040.6569%206%2039%206H9ZM20.8%2016L28.2%2016.0002V17.0001C28.2%2017.2855%2028.4226%2017.7213%2028.8491%2018.2037C29.0393%2018.4187%2029.2325%2018.6011%2029.3792%2018.7302C29.4519%2018.7941%2029.5114%2018.8434%2029.5511%2018.8755C29.5708%2018.8915%2029.5856%2018.9031%2029.5944%2018.9099L29.6024%2018.9161L30%2019.2159V21H28V20.1802C27.8169%2020.016%2027.5851%2019.7935%2027.3509%2019.5285C27.033%2019.1691%2026.6234%2018.6359%2026.3884%2018L22.5447%2018.0001C22.493%2018.1099%2022.4389%2018.2107%2022.3881%2018.3C22.1834%2018.6601%2021.9233%2019.0165%2021.6825%2019.3192C21.4385%2019.6258%2021.197%2019.8987%2021.0178%2020.0938L21%2020.1132V31.5C21%2033.433%2022.567%2035%2024.5%2035C25.8962%2035%2027.1015%2034.1825%2027.6632%2033H29.793C29.14%2035.3085%2027.0176%2037%2024.5%2037C21.4624%2037%2019%2034.5376%2019%2031.5V19.3017L19.2907%2019.0095L19.2934%2019.0067L19.3054%2018.9944C19.3166%2018.983%2019.3338%2018.9654%2019.3561%2018.9421C19.4009%2018.8955%2019.466%2018.8268%2019.5447%2018.7411C19.703%2018.5687%2019.9115%2018.3327%2020.1175%2018.0738C20.3266%2017.811%2020.5166%2017.5453%2020.6494%2017.3117C20.7524%2017.1304%2020.785%2017.0302%2020.7953%2016.9986C20.7977%2016.991%2020.7989%2016.9874%2020.7995%2016.9875C20.7994%2016.9872%2020.7996%2016.9875%2020.7995%2016.9875C20.7995%2016.9877%2020.7999%2016.9886%2020.7999%2016.989L20.8%2016.9932V16ZM32%2028.0909C32%2029.6976%2030.6569%2031%2029%2031C27.3431%2031%2026%2029.6976%2026%2028.0909C26%2025.5455%2029%2023%2029%2023C29%2023%2032%2025.5455%2032%2028.0909ZM29%2010H20V14H29V10Z'%20fill='currentColor'/%3e%3c/svg%3e",Ce={class:"fixed inset-0 overflow-y-auto"},De={class:"flex min-h-full items-center justify-center p-4 text-center"},Se={class:"border-b px-3 py-3 flex items-center justify-between"},Ie={class:"py-5 px-5 space-y-3 print-container",id:"print-container"},Ve={class:"flex bg-gray-50 border-l-4 border-l-100 rounded-r px-2 py-2 items-center space-x-2"},Le={class:"mt-3"},Oe={class:"w-full"},Be={class:"px-2 py-2 border-r"},Te={class:"px-2 py-2 border-r"},Me={class:"px-2 py-2 border-r"},Pe={class:"px-2 py-2 border-r"},qe={class:"rounded border mt-5"},Re={class:"w-full grid grid-cols-2 gap-5 py-5 px-5"},$e={class:"col-span-1 flex flex-col space-y-2"},je={class:"w-full flex items-center space-x-2"},Ae={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Ne={class:"w-full flex items-center space-x-2"},Fe={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},He={class:"w-full flex items-center space-x-2"},Ue={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Xe={class:"w-full flex items-center space-x-2"},Ze={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ze={class:"col-span-1 flex flex-col space-y-2"},Ee={class:"w-full flex items-center space-x-2"},Ke={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Qe={class:"w-full flex items-center space-x-2"},Ge={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Ye={class:"w-full flex items-center space-x-2"},Je={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},We={class:"w-full flex items-center space-x-2"},et={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},tt={class:"rounded border mt-5"},st={class:"w-full grid grid-cols-2 gap-5 py-5 px-5"},ot={class:"col-span-1 flex flex-col space-y-2"},rt={class:"w-full flex items-center space-x-2"},it={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},nt={class:"w-full flex items-center space-x-2"},at={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},lt={class:"w-full flex items-center space-x-2"},dt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ct={class:"w-full flex items-center space-x-2"},ut={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},pt={class:"col-span-1 flex flex-col space-y-2"},mt={class:"w-full flex items-center space-x-2"},ft={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},_t={class:"w-full flex items-center space-x-2"},gt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ht={class:"w-full flex items-center space-x-2"},bt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},xt={class:"w-full flex items-center space-x-2"},vt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},yt={class:"rounded border mt-5"},wt={class:"w-full grid grid-cols-2 gap-5 py-5 px-5"},kt={class:"col-span-1 flex flex-col space-y-2"},Ct={class:"w-full flex items-center space-x-2"},Dt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},St={class:"w-full flex items-center space-x-2"},It={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Vt={class:"w-full flex items-center space-x-2"},Lt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Ot={class:"w-full flex items-center space-x-2"},Bt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},Tt={class:"col-span-1 flex flex-col space-y-2"},Mt={class:"w-full flex items-center space-x-2"},Pt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},qt={class:"w-full flex items-center space-x-2"},Rt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},$t={class:"w-full flex items-center space-x-2"},jt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},At={class:"w-full flex items-center space-x-2"},Nt={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"};function Ft(r,t,a,c,s,n){const m=T,f=l("TransitionChild"),_=se,v=l("DialogTitle"),y=l("XMarkIcon"),k=l("TicketIcon"),C=l("DialogPanel"),u=l("Dialog"),g=l("TransitionRoot");return h(),w("div",null,[i(m,{click:()=>{n.openDialog()},color:"primary",text:"View",icon:s.viewIcon},null,8,["click","icon"]),i(g,{appear:"",show:s.show,as:"template"},{default:d(()=>[i(u,{as:"div",class:"relative z-10"},{default:d(()=>[i(f,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:d(()=>t[1]||(t[1]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",Ce,[e("div",De,[i(f,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:d(()=>[i(C,{class:"w-full max-w-4xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:d(()=>[e("div",Se,[i(v,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:d(()=>[a.data.stock_order_status.toLowerCase()==="approved"?(h(),V(_,{key:0,id:"print-container","print-small-label":!1})):N("",!0)]),_:1}),e("button",{onClick:t[0]||(t[0]=(...p)=>n.handleClick&&n.handleClick(...p))},[i(y,{class:"w-5 h-5"})])]),e("div",Ie,[t[32]||(t[32]=e("div",{class:"rounded-tr rounded-tl px-5 py-5 flex flex-col items-center"},[e("img",{src:ie,alt:"app-logo",class:"w-24 h-24 object-cover"}),e("h3",{class:"mt-2 text-xl font-medium uppercase"},"Republic of Malawi"),e("h3",{class:"mt-2 text-xl font-medium"},"Ministry of Health"),e("h3",{class:"mt-2 text-2xl font-semibold"},"Requisition and Issue Voucher")],-1)),e("div",Ve,[i(k,{class:"h-5 w-5"}),e("p",null,[t[2]||(t[2]=A("Voucher Number: ")),t[3]||(t[3]=e("span",{class:"text-lg text-sky-500 font-medium"},"B",-1)),e("strong",null,o(a.data.voucher_number),1)])]),e("div",Le,[e("table",Oe,[t[4]||(t[4]=e("thead",{clas:"w-full border-t border-l border-r"},[e("tr",{class:"border-b border-t border-r border-l rounded"},[e("th",{colspan:2,class:"text-left p-2"}," Requisitions ")]),e("tr",{class:"border-b border-t border-r border-l rounded"},[e("th",{class:"px-2 py-2 text-left border-r"}," Stock Item "),e("th",{class:"px-2 py-2 text-left"}," Quantity Being Requested "),e("th",{class:"px-2 py-2 text-left"}," Quantity Isssued "),e("th",{class:"px-2 py-2 text-left"}," Quantity Collected ")])],-1)),e("tbody",null,[(h(!0),w(F,null,H(s.requisitions,(p,S)=>(h(),w("tr",{key:S,class:"border-b border-t border-r border-l rounded"},[e("td",Be,o(p.item.name),1),e("td",Te,o(p.quantity_requested),1),e("td",Me,o(p.quantity_issued),1),e("td",Pe,o(p.quantity_collected),1)]))),128))])]),e("div",qe,[t[13]||(t[13]=e("div",{class:"flex items-center space-x-3 bg-gray-50 py-2 rounded-t px-2 border-b"},[e("img",{src:M,class:"w-6 h-6"}),e("h3",{class:"text-lg font-semibold"},"Preparation of RIV")],-1)),e("div",Re,[e("div",$e,[e("div",je,[t[5]||(t[5]=e("p",{class:"w-72 font-medium"},"Prepared by: ",-1)),e("span",Ae,o(s.preparedBy),1)]),e("div",Ne,[t[6]||(t[6]=e("p",{class:"w-72 font-medium"},"Designation: ",-1)),e("span",Fe,o(s.preparedDesignation),1)]),e("div",He,[t[7]||(t[7]=e("p",{class:"w-72 font-medium"},"Signature: ",-1)),e("span",Ue,o(s.preparedSignature),1)]),e("div",Xe,[t[8]||(t[8]=e("p",{class:"w-72 font-medium"},"Date:",-1)),e("span",Ze,o(s.preparedDate),1)])]),e("div",ze,[e("div",Ee,[t[9]||(t[9]=e("p",{class:"w-72 font-medium"},"Certified by: ",-1)),e("span",Ke,o(s.certifiedBy),1)]),e("div",Qe,[t[10]||(t[10]=e("p",{class:"w-72 font-medium"},"Designation: ",-1)),e("span",Ge,o(s.certifiedDesignation),1)]),e("div",Ye,[t[11]||(t[11]=e("p",{class:"w-72 font-medium"},"Signature: ",-1)),e("span",Je,o(s.certifiedSignature),1)]),e("div",We,[t[12]||(t[12]=e("p",{class:"w-72 font-medium"},"Date:",-1)),e("span",et,o(s.certifiedDate),1)])])])]),e("div",tt,[t[22]||(t[22]=e("div",{class:"flex items-center space-x-3 bg-gray-50 py-2 rounded-t px-2 border-b"},[e("img",{src:ne,class:"w-6 h-6"}),e("h3",{class:"text-lg font-semibold"},"Pharmacy")],-1)),e("div",st,[e("div",ot,[e("div",rt,[t[14]||(t[14]=e("p",{class:"w-72 font-medium"},"Issued by: ",-1)),e("span",it,o(s.issuerName),1)]),e("div",nt,[t[15]||(t[15]=e("p",{class:"w-72 font-medium"},"Designation: ",-1)),e("span",at,o(s.issuerDesignation),1)]),e("div",lt,[t[16]||(t[16]=e("p",{class:"w-72 font-medium"},"Signature: ",-1)),e("span",dt,o(s.issuerSignature),1)]),e("div",ct,[t[17]||(t[17]=e("p",{class:"w-72 font-medium"},"Date:",-1)),e("span",ut,o(s.issuedDate),1)])]),e("div",pt,[e("div",mt,[t[18]||(t[18]=e("p",{class:"w-72 font-medium"},"Approved by: ",-1)),e("span",ft,o(s.approverName),1)]),e("div",_t,[t[19]||(t[19]=e("p",{class:"w-72 font-medium"},"Designation: ",-1)),e("span",gt,o(s.approverDesignation),1)]),e("div",ht,[t[20]||(t[20]=e("p",{class:"w-72 font-medium"},"Signature: ",-1)),e("span",bt,o(s.issuerSignature),1)]),e("div",xt,[t[21]||(t[21]=e("p",{class:"w-72 font-medium"},"Date:",-1)),e("span",vt,o(s.approvedDate),1)])])])]),e("div",yt,[t[31]||(t[31]=e("div",{class:"flex items-center space-x-3 bg-gray-50 py-2 rounded-t px-2 border-b"},[e("img",{src:M,class:"w-6 h-6"}),e("h3",{class:"text-lg font-semibold"},"Finalisation of Order")],-1)),e("div",wt,[e("div",kt,[e("div",Ct,[t[23]||(t[23]=e("p",{class:"w-72 font-medium"},"Collected by: ",-1)),e("span",Dt,o(s.collectedBy),1)]),e("div",St,[t[24]||(t[24]=e("p",{class:"w-72 font-medium"},"Designation: ",-1)),e("span",It,o(s.collectedDesignation),1)]),e("div",Vt,[t[25]||(t[25]=e("p",{class:"w-72 font-medium"},"Signature: ",-1)),e("span",Lt,o(s.collectedSignature),1)]),e("div",Ot,[t[26]||(t[26]=e("p",{class:"w-72 font-medium"},"Date:",-1)),e("span",Bt,o(s.collectedDate),1)])]),e("div",Tt,[e("div",Mt,[t[27]||(t[27]=e("p",{class:"w-72 font-medium"},"Verified by: ",-1)),e("span",Pt,o(s.verifiedBy),1)]),e("div",qt,[t[28]||(t[28]=e("p",{class:"w-72 font-medium"},"Designation: ",-1)),e("span",Rt,o(s.verifiedDesignation),1)]),e("div",$t,[t[29]||(t[29]=e("p",{class:"w-72 font-medium"},"Signature: ",-1)),e("span",jt,o(s.verifiedSignature),1)]),e("div",At,[t[30]||(t[30]=e("p",{class:"w-72 font-medium"},"Date:",-1)),e("span",Nt,o(s.verifiedDate),1)])])])])])])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const Ht=B(ke,[["render",Ft]]),Ut={setup(){de({title:`${le.name.toUpperCase()} - Stock Orders`})},data(){return{header:"Stock Orders",pages:[{name:"Home",link:"/home"},{name:"Stock Management",link:"#"}],search:"",headers:[{text:"Voucher Number",value:"voucher_number",sortable:!0},{text:"Requisitions",value:"requisitions"},{text:"Status",value:"stock_order_status"},{text:"Date Created",value:"created_date"},{text:"actions",value:"actions"}],statuses:new Array,statusSelected:{name:"-- select status -- ",id:0},orders:new Array,printIcon:E,editIcon:I,clearIcon:L,loading:!1,statusLoading:!1,cookie:O("token"),serverItemsLength:0,serverOptions:{page:1,rowsPerPage:25,sortBy:"voucher_number"}}},created(){this.init(),this.getOrderStatuses()},computed:{orderStatuses(){return[{name:"Edit",show:"pending",icon:I},{name:"Verify",show:"draft",icon:ce},{name:"Receive",show:"requested",icon:ue},{name:"Approve",show:"received",icon:pe}]}},methods:{async getOrderStatuses(){const r=new D,{data:t,error:a}=await r.getStockOrderStatus(`${this.cookie}`);t.value&&t.value.map(c=>{this.statuses.push({name:c.name,id:c.id})}),a.value&&console.error(a.value)},async init(){this.loading=!0;const r=new D;let t=this.statusSelected.id==0?"":this.statusSelected.id;const{page:a,rowsPerPage:c}=this.serverOptions;let s=`page=${a}&per_page=${c}`;const{data:n,error:m,pending:f}=await r.getStockOrder(`${this.cookie}`,"",this.search,`${t}`,s);this.loading=f,n.value&&(this.orders=n.value.data.map(_=>({..._,requisitions:_.stock_requisitions.length,created_date:b(_.created_date).format(x)})),this.loading=!1),m.value&&(console.error(m.value),this.loading=!1)},clearFilter(){this.statuses.push({name:"-- select status -- ",id:0}),this.statusSelected=this.statuses[this.statuses.length-1],this.init()},checkStatus(r,t){return r.show.toLowerCase()==t.stock_order_status.toLowerCase()},verifyStockOrder(r,t){this.$router.push(`/stock-management/orders/request/${t}?order_id=${r}`)},receiveStockOrder(r,t){this.$router.push(`/stock-management/orders/receive/${t}?order_id=${r}`)},approveStockOrder(r,t){this.$router.push(`/stock-management/orders/approve/${t}?order_id=${r}`)},rejectStockOrder(r,t){this.$router.push(`/stock-management/orders/reject/${t}?order_id=${r}`)},async changeStatus(r){this.statusLoading=!0;const t=new D,a={route:"",status:r},{data:c,error:s,pending:n}=await t.updateStockOrderStatus(`${this.cookie}`,a);this.statusLoading=n,c.value&&(this.init(),this.statusLoading=!1),s.value&&(console.error(s.value),this.statusLoading=!1)},processStockOrder(r,t){r==="Verify"?this.verifyStockOrder(t.id,t.voucher_number):r==="Receive"?this.receiveStockOrder(t.id,t.voucher_number):r==="Approve"?this.approveStockOrder(t.id,t.voucher_number):r==="Reject"&&this.rejectStockOrder(t.id,t.voucher_number)}},watch:{search(){this.init()},statusSelected:{handler(){this.init()},deep:!0}}},Xt={class:"px-5 py-5"},Zt={class:"flex items-center justify-between py-5"},zt={class:"text-2xl font-semibold"},Et={class:"flex items-center space-x-3"},Kt={class:"flex items-center justify-between"},Qt={class:"flex items-center space-x-2"},Gt={class:"mt-10"},Yt={class:"py-2 flex items-center space-x-2"};function Jt(r,t,a,c,s,n){const m=U,f=we,_=ee,v=T,y=te,k=Ht,C=ae;return h(),w("div",Xt,[i(m,{pages:s.pages},null,8,["pages"]),e("div",Zt,[e("h3",zt,o(s.header),1),e("div",Et,[i(f)])]),e("div",Kt,[e("div",Qt,[i(_,{items:s.statuses,modelValue:s.statusSelected,"onUpdate:modelValue":t[0]||(t[0]=u=>s.statusSelected=u)},null,8,["items","modelValue"]),s.statusSelected.id!=0?(h(),V(v,{key:0,text:"Clear filter",color:"warning",icon:s.clearIcon,click:()=>{n.clearFilter()},loading:s.loading},null,8,["icon","click","loading"])):N("",!0)]),i(y,{search:s.search,"onUpdate:search":t[1]||(t[1]=u=>s.search=u)},null,8,["search"])]),e("div",Gt,[i(C,{data:s.orders,headers:s.headers,loading:s.loading,"search-field":"voucher_number","search-value":s.search,serverItemsLength:s.serverItemsLength,serverOptions:s.serverOptions,onUpdate:n.init},{actions:d(({item:u})=>[e("div",Yt,[i(k,{data:u},null,8,["data"]),(h(!0),w(F,null,H(n.orderStatuses,(g,p)=>K((h(),V(v,{key:p,text:g.name,color:g.name=="Reject"?"error":"success",icon:g.icon,click:()=>{n.processStockOrder(g.name,u)}},null,8,["text","color","icon","click"])),[[Q,n.checkStatus(g,u)]])),128))])]),_:1},8,["data","headers","loading","search-value","serverItemsLength","serverOptions","onUpdate"])])])}const Ls=B(Ut,[["render",Jt]]);export{Ls as default};
