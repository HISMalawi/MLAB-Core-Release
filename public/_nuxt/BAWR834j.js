import{_ as X}from"./BJooVA_-.js";import{_ as Z}from"./_pI-mxTi.js";import{x as ee,y as k,b as v,L as te,d as ae,r as _,u as oe,a as se,c as F,C as f,w as O,o as ne,e as T,f as n,h as e,g as a,t as i,z as V,j as S,H as B,O as A,F as re,k as le,N as ie,K as E,l as de,E as ue,_ as me}from"./CYcp6nS7.js";import{_ as ce}from"./Cuu1z6fr.js";import{_ as pe,a as _e}from"./QQvDYip1.js";import{u as fe,_ as ve}from"./CeOEQoQz.js";import{C as ge,b as he,L as be,B as ye,c as Te,p as xe,a as Ae,d as Re}from"./B_AcabRt.js";import{_ as De}from"./DtCINWsh.js";import{_ as Ee}from"./C7TiL_M-.js";import{u as ke}from"./Bb40XinX.js";import{P as we}from"./lDJ8LIwH.js";import{u as $e}from"./CySQNWaz.js";import{r as Ce}from"./DD1XQcSB.js";import{r as Me}from"./B576kTo_.js";import"./CiPuaXMZ.js";import"./BD7R0M9r.js";import"./BbStvG_C.js";import"./BbalwqwO.js";import"./CaXKGook.js";import"./CIoZ7vxW.js";import"./wA_l6D9q.js";import"./K4HDHDkc.js";import"./CclvD-oN.js";ge.register(he,be,ye,Te,xe,Ae);const Fe={components:{Bar:Re},props:{chartData:{required:!0,type:Object}},data(){return{data:this.chartData,options:{responsive:!0,maintainAspectRatio:!1}}},watch:{chartData:{handler(w){this.data=w},deep:!0}}};function Oe(w,N,x,g,s,U){const $=k("Bar");return v(),te($,{data:s.data,options:s.options},null,8,["data","options"])}const Be=ee(Fe,[["render",Oe]]),Ne={class:"px-5 py-5"},Ue={class:"flex justify-between items-center"},Ve={class:"w-full flex items-center space-x-3"},Se={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},Pe={class:"w-72 ml-2"},Ye={class:"w-48"},je={class:"w-48"},qe={class:"w-48"},Ge={class:"border rounded mt-10",id:"print-container"},Le={class:"flex items-center justify-between px-5 py-5 border-b"},Ie={class:"m-3"},He={class:"font-semibold mb-2"},ze={class:"text-normal font-normal"},Ke={key:0},We={class:"w-full rounded"},Je={class:"border-t bg-gray-100 border-b"},Qe={class:"text-left px-2 py-2 border-r uppercase"},Xe={class:"text-left px-2 py-2 uppercase"},Ze={class:"text-left px-2 py-2 border-r border-b"},et={class:"text-left px-2 py-2 border-r border-b"},tt={class:"text-left px-2 py-2 border-b"},at={key:1,class:"w-full flex flex-col items-center justify-center space-y-2 py-10"},ot={key:0,class:"bg-gray-50 rounded mt-5 border"},st={class:"px-5 py-5 flex flex-col items-center"},nt={class:"mt-1"},rt={key:0,style:{height:"400px"}},lt="Turn Around Time Report",Mt=ae({__name:"turn-around-time",setup(w){$e({title:`${we.name.toUpperCase()} - Turn Around Time Reports`});const N=_([{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"Aggregate Reports",link:"#"}]),x=_([]),g=_({name:"select department",id:0}),{loading:s,executeCancellableRequest:U,cancelRequest:$}=fe(),P=_([{name:"Minutes"},{name:"Hours"},{name:"Days"},{name:"Weeks"}]),d=_({name:"select unit"}),r=_([]),C=ke(),{$toast:D,$metadata:Y}=oe(),j=se("token"),M=_({}),u=_(new Array("","")),q=()=>{u.value=new Array("","")},c=F(()=>u.value[0]?f(u.value[0]).format("YYYY-MM-DD"):""),p=F(()=>u.value[1]?f(u.value[1]).format("YYYY-MM-DD"):""),G=F(()=>r.value.length>0?r.value.map(o=>({"TEST TYPE":o.test_type,UNITS:d.value.name,"TURN AROUND TIME":o.turn_around_time,AVERAGE:o.average})):[]);async function L(){s.value=!0,M.value={};let o=`from=${c.value}&to=${p.value}&department=${g.value.id}&unit=${d.value.name.toLowerCase()}`;const t={route:`${de.aggregateReports}turn_around_time?${o}`,method:"GET",token:`${j.value}`},{data:l,error:h,pending:b}=await U(t);s.value=b,l.value&&(s.value=!1,r.value=l.value.data,M.value={labels:l.value.data.map(y=>y.test_type),datasets:[{label:"Turn Around Time",backgroundColor:"#030712",data:l.value.data.map(y=>y.turn_around_time)},{label:"Average Turn Around Time",backgroundColor:"#0284c7",data:l.value.data.map(y=>Number(y.average))}]},l.value.data.length>0?D.success("Report data generated successfully"):D.warning(`No data found in period ${f(c.value).format(A)} - ${f(p.value).format(A)}`)),h.value&&(s.value=!1,console.error(h.value),D.error(ue))}function I(){const o=g.value.name==="select department"||d.value.name==="select unit";return o&&D.warning("Please select a department and unit"),!o}return O(d,(o,t)=>{o!==t&&(r.value=[])}),O(g,(o,t)=>{o!==t&&(r.value=[])}),O(u,(o,t)=>{o!==t&&(r.value=[])}),ne(()=>{s.value=!1,x.value=Y.departments,x.value.some(t=>t.name=="All")||x.value.push({id:0,name:"All"}),x.value.sort((t,l)=>{const h=t.name.toUpperCase(),b=l.name.toUpperCase();return h<b?-1:h>b?1:0})}),(o,t)=>{const l=X,h=k("datepicker"),b=Z,y=me,H=k("FormKit"),z=ce,K=k("excel"),W=_e,J=ve,Q=Be;return v(),T("div",Ne,[n(l,{pages:e(N)},null,8,["pages"]),a("div",{class:"flex items-center py-5"},[t[4]||(t[4]=a("img",{src:De,alt:"report-icon",class:"w-8 h-8 mr-2"},null,-1)),a("h3",{class:"text-2xl font-semibold uppercase"},i(lt))]),a("div",Ue,[n(H,{type:"form","submit-label":"Update",onSubmit:t[3]||(t[3]=R=>I()&&L()),actions:!1,id:"submitForm"},{default:V(({value:R})=>[a("div",Ve,[a("div",Se,[n(e(Ce),{class:"w-5 h-5 mr-2"}),t[5]||(t[5]=S(" Filter By Date Range ")),a("div",Pe,[n(h,{onCleared:q,required:"",position:"left",placeholder:"select start & end date",range:!0,"input-class-name":"datepicker",modelValue:e(u),"onUpdate:modelValue":t[0]||(t[0]=m=>B(u)?u.value=m:null),format:"dd/MM/yyyy"},null,8,["modelValue"])])]),a("div",Ye,[n(b,{items:e(x),modelValue:e(g),"onUpdate:modelValue":t[1]||(t[1]=m=>B(g)?g.value=m:null)},null,8,["items","modelValue"])]),a("div",je,[n(b,{items:e(P),modelValue:e(d),"onUpdate:modelValue":t[2]||(t[2]=m=>B(d)?d.value=m:null)},null,8,["items","modelValue"])]),a("div",qe,[n(y,{type:"submit",color:"primary",text:"Generate Report",icon:e(Me),click:()=>{},loading:e(s)},null,8,["icon","loading"])])])]),_:1}),n(K,{class:"btn btn-default",header:[`TURN AROUND TIME REPORT ${e(c)} - ${e(p)}`,e(C).details.name,e(C).details.address,e(C).details.phone],data:e(G),worksheet:"report-work-sheet",name:`turn_around_time_${e(c)}_to_${e(p)}.xls`},{default:V(()=>[n(z,{text:"Export Excel"})]),_:1},8,["header","data","name"])]),a("div",Ge,[a("div",Le,[t[6]||(t[6]=a("div",{class:"flex flex-col space-y-2"},[a("img",{src:Ee,alt:"app-logo",class:"w-24 h-24 object-cover"}),a("h3",{class:"text-xl font-semibold"}," TURN AROUND TIME REPORT ")],-1)),n(W)]),a("div",Ie,[a("h3",He,[t[7]||(t[7]=S("Tests Performed Period: ")),a("span",ze,i(e(c)!==""?e(f)(e(c)).format("DATE_FORMAT"in o?o.DATE_FORMAT:e(A)):"")+" - "+i(e(p)!==""?e(f)(e(p)).format("DATE_FORMAT"in o?o.DATE_FORMAT:e(A)):""),1)])]),e(r).length>0&&!e(s)?(v(),T("div",Ke,[a("table",We,[a("thead",null,[a("tr",Je,[t[8]||(t[8]=a("th",{class:"text-left px-2 py-2 border-r uppercase"},"Test Type",-1)),a("th",Qe,"Turn Around Time ("+i(e(d).name)+")",1),a("th",Xe,"Average Turn Around Time ("+i(e(d).name)+")",1)])]),a("tbody",null,[(v(!0),T(re,null,le(e(r),(R,m)=>(v(),T("tr",{key:m,class:ie({"bg-white":m%2===0,"bg-gray-100":m%2!==0})},[a("td",Ze,i(R.test_type),1),a("td",et,i(R.turn_around_time),1),a("td",tt,i(R.average),1)],2))),128))])])])):E("",!0),e(r).length==0&&!e(s)?(v(),T("div",at,t[9]||(t[9]=[a("img",{src:pe,alt:"page-icon",class:"object-cover w-20 h-20"},null,-1),a("p",null,"Data not found, please generate report",-1)]))):E("",!0),n(J,{condition:e(s),cancelReportGeneration:()=>e($)()},null,8,["condition","cancelReportGeneration"])]),e(r).length>0&&!e(s)?(v(),T("div",ot,[a("div",st,[t[10]||(t[10]=a("h3",{class:"text-lg font-medium"},"Average Turn Around Time",-1)),a("p",nt,"From: "+i(e(c)!==""?e(f)(e(c)).format("DATE_FORMAT"in o?o.DATE_FORMAT:e(A)):"")+" - To: "+i(e(p)!==""?e(f)(e(p)).format("DATE_FORMAT"in o?o.DATE_FORMAT:e(A)):""),1)]),e(r).length>0?(v(),T("div",rt,[n(Q,{"chart-data":e(M)},null,8,["chart-data"])])):E("",!0)])):E("",!0)])}}});export{Mt as default};
