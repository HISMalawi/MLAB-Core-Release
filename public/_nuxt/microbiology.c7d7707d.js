import{_ as T}from"./Breadcrumb.cfeb06ed.js";import{_ as M}from"./Dropdown.28b1fd1d.js";import{u as I,a as C,_ as L,f as O,o as Q,c as j,b,d as e,g as B,t as o,h as S,F,r as J,e as N}from"./entry.6a3fbfc1.js";import{u as V}from"./vue.f36acd1f.f8958c90.js";import{e as R,f as A,_ as E}from"./fetch.444ade97.js";import{u as H}from"./facility.df7118e4.js";import{P as Y}from"./package.d411c004.js";import{r as G}from"./ArrowPathIcon.8bf7277c.js";import{r as P}from"./ArrowUpTrayIcon.7312485f.js";import{_ as q}from"./logo.18f1af6f.js";import"./nuxt-link.bebad584.js";import"./HomeIcon.54ceb79b.js";import"./listbox.064b6dcd.js";import"./hidden.e85239c2.js";import"./use-text-value.75cce7ff.js";import"./CheckIcon.9343e206.js";import"./CheckCircleIcon.6ff04472.js";import"./MagnifyingGlassIcon.ba982fe1.js";import"./constants.cf42f90d.js";import"./transition.9bb58b2a.js";import"./XMarkIcon.fd9a39e2.js";import"./PencilSquareIcon.79aa7948.js";import"./PrinterIcon.b8623d34.js";const U={setup(){V({title:`${Y.name.toUpperCase()} - Microbiology Report`})},data(){return{viewIcon:G,exportIcon:P,date:"",pages:[{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"MoH Diagnistic Reports",link:"#"}],indicators:new Array,items:new Array,data:new Array,yearSelected:{name:"-- select year --"},years:new Array,cookie:I("token"),viewing:!1,facility:H(),json_fields:{fieldLabel:"indicator",anotherFieldLabel:{field:["indicator"],callback:c=>`formatted value ${c}`}},reportData:new Array}},created(){this.getYears(),this.getReportIndicators()},methods:{async getReportIndicators(){const c={route:`${R.reportIndicators}?department=Microbiology`,method:"GET",token:`${this.cookie}`},{data:s,error:n,pending:x}=await A(c);s.value&&s.value.map(r=>{this.items.push({indicator:r,jan:"!",feb:"!",mar:"!",totalQ1:"!",apr:"!",may:"!",june:"!",totalQ2:"!",jul:"!",aug:"!",sept:"!",totalQ3:"!",oct:"!",nov:"!",dec:"!",totalQ4:"!",total:"!"})}),n.value&&console.error(n.value)},async getReportData(){if(this.yearSelected.name=="-- select year --")C().$toast.warning("Please select a year");else{this.viewing=!0;const c={route:`${R.mohReport}microbiology?year=${this.yearSelected.name}`,method:"GET",token:`${this.cookie}`},{data:s,error:n,pending:x}=await A(c);if(this.viewing=x,s.value){let r=new Array;this.items.map(a=>{let l=s.value.january[a.indicator],d=s.value.february[a.indicator],i=s.value.march[a.indicator],p=s.value.april[a.indicator],t=s.value.may[a.indicator],y=s.value.june[a.indicator],f=s.value.july[a.indicator],g=s.value.august[a.indicator],k=s.value.september[a.indicator],v=s.value.october[a.indicator],w=s.value.november[a.indicator],D=s.value.december[a.indicator],m=l+d+i,_=p+t+y,u=f+g+k,h=v+w+D;r.push({indicator:a.indicator,jan:l,feb:d,mar:i,totalQ1:m,apr:p,may:t,june:y,totalQ2:_,jul:f,aug:g,sept:k,totalQ3:u,oct:v,nov:w,dec:D,totalQ4:h,total:m+_+u+h}),this.reportData.push({"Laboratory Service":a.indicator,January:l,February:d,March:i,"Total Q1":m,April:p,May:t,June:y,"Total Q2":_,July:f,August:g,September:k,"Total Q3":u,October:v,November:w,December:D,"Total Q4":h,Total:m+_+u+h})}),this.items=new Array,this.items.push(...r),this.viewing=!1}n.value&&(this.viewing=!1,console.error(n.value))}},getYears(){for(let c=new Date().getFullYear();c>=2e3;c--)this.years.push({name:c.toString(),id:c})}}},z={class:"px-5 py-5"},K=e("div",{class:"py-5"},[e("h3",{class:"text-xl font-semibold flex items-center"},[e("img",{src:E,class:"w-8 h-8 mr-2"}),S(" MoH Diagonistic Reports (Microbiology) ")])],-1),W={class:"w-full flex justify-between py-5"},X={class:"flex items-center space-x-3"},Z={class:"border rounded"},$={class:"rounded-tr rounded-tl border-b px-5 py-5 flex items-center justify-between"},ee=e("img",{src:q,alt:"app-logo",class:"w-24 h-24 object-cover"},null,-1),te={class:"space-y-2"},re={class:"font-medium"},oe={class:"font-medium"},se={class:"font-medium"},ae=e("p",{class:"uppercase underline"},"Laboratory Report",-1),ce={class:"px-4 py-2.5"},ne={class:"font-semibold"},ie={class:"w-full rounded border-t"},le={class:"w-full"},de=e("thead",{class:"w-full border-b"},[e("tr",{class:"w-full bg-gray-50"},[e("th",{class:"px-4 py-2 border-r"},"Laboratory Service"),e("th",{class:"px-4 py-2 border-r"},"Jan"),e("th",{class:"px-4 py-2 border-r"},"Feb"),e("th",{class:"px-4 py-2"},"March"),e("th",{class:"px-4 py-2 bg-sky-50 text-sky-500 border border-sky-100"},"Total Q1"),e("th",{class:"px-4 py-2 border-r"},"Apr"),e("th",{class:"px-4 py-2 border-r"},"May"),e("th",{class:"px-4 py-2"},"Jun"),e("th",{class:"px-4 py-2 bg-sky-50 text-sky-500 border border-sky-100"},"Total Q2"),e("th",{class:"px-4 py-2 border-r"},"Jul"),e("th",{class:"px-4 py-2 border-r"},"Aug"),e("th",{class:"px-4 py-2"},"Sep"),e("th",{class:"px-4 py-2 bg-sky-50 text-sky-500 border border-sky-100"},"Total Q3"),e("th",{class:"px-4 py-2 border-r"},"Oct"),e("th",{class:"px-4 py-2 border-r"},"Nov"),e("th",{class:"px-4 py-2"},"Dev"),e("th",{class:"px-4 py-2 bg-sky-50 text-sky-500 border-t border-l border-b border-sky-100"},"Total Q4 "),e("th",{class:"px-4 py-2 bg-green-50 text-green-500 border border-green-100"},"Total")])],-1),pe={class:"px-4 py-2 text-left border-r border-b"},ye={class:"px-4 py-2 text-center border-r border-b"},be={class:"px-4 py-2 text-center border-r border-b"},me={class:"px-4 py-2 text-center border-b"},_e={class:"px-4 py-2 text-center bg-sky-50 text-sky-500 border border-sky-100"},ue={class:"px-4 py-2 text-center border-r border-b"},he={class:"px-4 py-2 text-center border-r border-b"},xe={class:"px-4 py-2 text-center border-b"},fe={class:"px-4 py-2 text-center bg-sky-50 text-sky-500 border border-sky-100"},ge={class:"px-4 py-2 text-center border-r border-b"},ke={class:"px-4 py-2 text-center border-r border-b"},ve={class:"px-4 py-2 text-center border-b"},we={class:"px-4 py-2 text-center bg-sky-50 text-sky-500 border border-sky-100"},De={class:"px-4 py-2 text-center border-r border-b"},Qe={class:"px-4 py-2 text-center border-r border-b"},je={class:"px-4 py-2 text-center border-b"},Re={class:"px-4 py-2 text-center bg-sky-50 text-sky-500 border-t border-l border-b border-sky-100"},Ae={class:"px-4 py-2 text-center bg-green-50 border text-green-500 border-green-100"};function Se(c,s,n,x,r,a){const l=T,d=M,i=N,p=O("excel");return Q(),j("div",z,[b(l,{pages:r.pages},null,8,["pages"]),K,e("div",W,[e("div",X,[b(d,{items:r.years,modelValue:r.yearSelected,"onUpdate:modelValue":s[0]||(s[0]=t=>r.yearSelected=t)},null,8,["items","modelValue"]),b(i,{loading:r.viewing,click:()=>{a.getReportData()},color:"primary",icon:r.viewIcon,text:"Generate report"},null,8,["loading","click","icon"])]),e("div",null,[b(p,{class:"btn btn-default",header:[`MICROBIOLOGY MoH LABORATORY REPORT ${r.yearSelected.name}`,r.facility.details.name,r.facility.details.address,r.facility.details.phone],data:r.reportData,worksheet:"report-work-sheet",name:`moh_microbiology_report_${r.yearSelected.name}.xls`},{default:B(()=>[b(i,{color:"success",click:()=>{},icon:r.exportIcon,text:"Export"},null,8,["icon"])]),_:1},8,["header","data","name"])])]),e("div",Z,[e("div",$,[ee,e("div",te,[e("p",re,o(r.facility.details.name),1),e("p",oe,o(r.facility.details.address),1),e("p",se,o(r.facility.details.phone),1),ae])]),e("div",null,[e("p",ce,[S("Data for the year: "),e("span",ne,o(r.yearSelected.name),1)])]),e("div",ie,[e("table",le,[de,e("tbody",null,[(Q(!0),j(F,null,J(r.items,(t,y)=>(Q(),j("tr",{class:"px-2",key:y},[e("td",pe,o(t.indicator),1),e("td",ye,o(t.jan),1),e("td",be,o(t.feb),1),e("td",me,o(t.mar),1),e("td",_e,o(t.totalQ1),1),e("td",ue,o(t.apr),1),e("td",he,o(t.may),1),e("td",xe,o(t.june),1),e("td",fe,o(t.totalQ2),1),e("td",ge,o(t.jul),1),e("td",ke,o(t.aug),1),e("td",ve,o(t.sept),1),e("td",we,o(t.totalQ3),1),e("td",De,o(t.oct),1),e("td",Qe,o(t.nov),1),e("td",je,o(t.dec),1),e("td",Re,o(t.totalQ4),1),e("td",Ae,o(t.total),1)]))),128))])])])])])}const $e=L(U,[["render",Se]]);export{$e as default};
