import{_ as Rt}from"./9st0-0tz.js";import{d as me,r as d,c as de,aZ as st,a6 as q,bq as ot,b3 as Te,b1 as bt,b2 as Et,b4 as Ie,br as Bt,bs as Ut,aF as lt,bt as It,a_ as zt,a$ as Nt,b0 as Zt,a7 as he,ab as at,F as ge,a4 as Ae,o as nt,as as ht,bu as gt,a8 as Xe,aa as Qe,bv as $e,b8 as ye,b5 as Gt,b6 as _t,a5 as rt,ad as we,bw as be,bx as Je,b as A,e as U,g as e,f as l,y as T,h as t,j as re,T as Yt,A as le,_ as xe,q as ke,s as xt,x as Q,t as N,i as Ne,v as it,K as ze,J as Ve,a as qe,w as Ce,Y as Me,p as ue,G as Pe,V as Le,S as De,l as W,m as K,u as pe,E as ie,aY as Kt,D as te,by as Wt,a3 as Ue,a2 as wt,z as _e,L as yt,U as Xt,H as ce,k as je,az as $t,aT as Qt,n as Jt,ay as es,bz as ts,af as ss,M as os,bA as ls,bB as as}from"./DFRCgfJ7.js";import{_ as Ct}from"./CzHc6CvN.js";import{_ as ns}from"./CwpPpque.js";import{s as rs}from"./Ddj-PgKU.js";import{_ as is}from"./BZkefcnP.js";import{_ as us}from"./C2qXY2MP.js";import{_ as Oe}from"./DKZ0QoWC.js";import{r as ut}from"./CNSNb7H9.js";import{r as Fe}from"./BIfcYUmN.js";import{u as He}from"./RjamUEmk.js";import{P as et,u as cs}from"./DkUPYZlH.js";import{r as kt}from"./C-CyX-lv.js";import{r as tt}from"./C591Aj4h.js";import{r as ds}from"./CaMGlw8b.js";import{r as ps}from"./DvUwAmtA.js";import{r as ms}from"./Z66635vA.js";import{r as vs}from"./DDOI77tZ.js";import{_ as fs}from"./DJS9VRo6.js";import{u as _s}from"./DX-fG2iE.js";import{P as ys}from"./BJWqiItS.js";import{r as bs}from"./CX5UrGBo.js";import{r as hs}from"./BS_3Esgb.js";import{r as gs}from"./CJomWIoV.js";import{r as xs}from"./Pijfe7ag.js";import{r as ws,a as $s}from"./Cm1MwiFL.js";import"./_gKYxzJq.js";import"./ETY0v-Ty.js";import"./DPgPQj3l.js";import"./DgQpkSfa.js";import"./BYyprm3K.js";import"./w-YgZM2H.js";import"./BCeJtOqG.js";import"./D8DjzwVZ.js";import"./DMnRMKKE.js";var Cs=(L=>(L[L.Open=0]="Open",L[L.Closed=1]="Closed",L))(Cs||{});let St=Symbol("PopoverContext");function ct(L){let v=rt(St,null);if(v===null){let f=new Error(`<${L} /> is missing a parent <${Mt.name} /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(f,ct),f}return v}let ks=Symbol("PopoverGroupContext");function Tt(){return rt(ks,null)}let Vt=Symbol("PopoverPanelContext");function Ss(){return rt(Vt,null)}let Mt=me({name:"Popover",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(L,{slots:v,attrs:f,expose:O}){var $;let V=d(null);O({el:V,$el:V});let s=d(1),r=d(null),C=d(null),k=d(null),D=d(null),H=de(()=>st(V)),E=de(()=>{var c,p;if(!q(r)||!q(D))return!1;for(let m of document.querySelectorAll("body > *"))if(Number(m==null?void 0:m.contains(q(r)))^Number(m==null?void 0:m.contains(q(D))))return!0;let n=ot(),a=n.indexOf(q(r)),_=(a+n.length-1)%n.length,g=(a+1)%n.length,x=n[_],y=n[g];return!((c=q(D))!=null&&c.contains(x))&&!((p=q(D))!=null&&p.contains(y))}),S={popoverState:s,buttonId:d(null),panelId:d(null),panel:D,button:r,isPortalled:E,beforePanelSentinel:C,afterPanelSentinel:k,togglePopover(){s.value=Te(s.value,{0:1,1:0})},closePopover(){s.value!==1&&(s.value=1)},close(c){S.closePopover();let p=c?c instanceof HTMLElement?c:c.value instanceof HTMLElement?q(c):q(S.button):q(S.button);p==null||p.focus()}};bt(St,S),Et(de(()=>Te(s.value,{0:Ie.Open,1:Ie.Closed})));let F={buttonId:S.buttonId,panelId:S.panelId,close(){S.closePopover()}},j=Tt(),I=j==null?void 0:j.registerPopover,[Z,M]=Bt(),R=Ut({mainTreeNodeRef:j==null?void 0:j.mainTreeNodeRef,portals:Z,defaultContainers:[r,D]});function h(){var c,p,n,a;return(a=j==null?void 0:j.isFocusWithinPopoverGroup())!=null?a:((c=H.value)==null?void 0:c.activeElement)&&(((p=q(r))==null?void 0:p.contains(H.value.activeElement))||((n=q(D))==null?void 0:n.contains(H.value.activeElement)))}return lt(()=>I==null?void 0:I(F)),It(($=H.value)==null?void 0:$.defaultView,"focus",c=>{var p,n;c.target!==window&&c.target instanceof HTMLElement&&s.value===0&&(h()||r&&D&&(R.contains(c.target)||(p=q(S.beforePanelSentinel))!=null&&p.contains(c.target)||(n=q(S.afterPanelSentinel))!=null&&n.contains(c.target)||S.closePopover()))},!0),zt(R.resolveContainers,(c,p)=>{var n;S.closePopover(),Nt(p,Zt.Loose)||(c.preventDefault(),(n=q(r))==null||n.focus())},de(()=>s.value===0)),()=>{let c={open:s.value===0,close:S.close};return he(ge,[he(M,{},()=>at({theirProps:{...L,...f},ourProps:{ref:V},slot:c,slots:v,attrs:f,name:"Popover"})),he(R.MainTreeNode)])}}}),Ts=me({name:"PopoverButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(L,{attrs:v,slots:f,expose:O}){var $;let V=($=L.id)!=null?$:`headlessui-popover-button-${Ae()}`,s=ct("PopoverButton"),r=de(()=>st(s.button));O({el:s.button,$el:s.button}),nt(()=>{s.buttonId.value=V}),ht(()=>{s.buttonId.value=null});let C=Tt(),k=C==null?void 0:C.closeOthers,D=Ss(),H=de(()=>D===null?!1:D.value===s.panelId.value),E=d(null),S=`headlessui-focus-sentinel-${Ae()}`;H.value||lt(()=>{s.button.value=q(E)});let F=rs(de(()=>({as:L.as,type:v.type})),E);function j(c){var p,n,a,_,g;if(H.value){if(s.popoverState.value===1)return;switch(c.key){case we.Space:case we.Enter:c.preventDefault(),(n=(p=c.target).click)==null||n.call(p),s.closePopover(),(a=q(s.button))==null||a.focus();break}}else switch(c.key){case we.Space:case we.Enter:c.preventDefault(),c.stopPropagation(),s.popoverState.value===1&&(k==null||k(s.buttonId.value)),s.togglePopover();break;case we.Escape:if(s.popoverState.value!==0)return k==null?void 0:k(s.buttonId.value);if(!q(s.button)||(_=r.value)!=null&&_.activeElement&&!((g=q(s.button))!=null&&g.contains(r.value.activeElement)))return;c.preventDefault(),c.stopPropagation(),s.closePopover();break}}function I(c){H.value||c.key===we.Space&&c.preventDefault()}function Z(c){var p,n;L.disabled||(H.value?(s.closePopover(),(p=q(s.button))==null||p.focus()):(c.preventDefault(),c.stopPropagation(),s.popoverState.value===1&&(k==null||k(s.buttonId.value)),s.togglePopover(),(n=q(s.button))==null||n.focus()))}function M(c){c.preventDefault(),c.stopPropagation()}let R=gt();function h(){let c=q(s.panel);if(!c)return;function p(){Te(R.value,{[be.Forwards]:()=>$e(c,ye.First),[be.Backwards]:()=>$e(c,ye.Last)})===Je.Error&&$e(ot().filter(n=>n.dataset.headlessuiFocusGuard!=="true"),Te(R.value,{[be.Forwards]:ye.Next,[be.Backwards]:ye.Previous}),{relativeTo:q(s.button)})}p()}return()=>{let c=s.popoverState.value===0,p={open:c},{...n}=L,a=H.value?{ref:E,type:F.value,onKeydown:j,onClick:Z}:{ref:E,id:V,type:F.value,"aria-expanded":s.popoverState.value===0,"aria-controls":q(s.panel)?s.panelId.value:void 0,disabled:L.disabled?!0:void 0,onKeydown:j,onKeyup:I,onClick:Z,onMousedown:M};return he(ge,[at({ourProps:a,theirProps:{...v,...n},slot:p,attrs:v,slots:f,name:"PopoverButton"}),c&&!H.value&&s.isPortalled.value&&he(Xe,{id:S,features:Qe.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:h})])}}}),Vs=me({name:"PopoverPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},focus:{type:Boolean,default:!1},id:{type:String,default:null}},inheritAttrs:!1,setup(L,{attrs:v,slots:f,expose:O}){var $;let V=($=L.id)!=null?$:`headlessui-popover-panel-${Ae()}`,{focus:s}=L,r=ct("PopoverPanel"),C=de(()=>st(r.panel)),k=`headlessui-focus-sentinel-before-${Ae()}`,D=`headlessui-focus-sentinel-after-${Ae()}`;O({el:r.panel,$el:r.panel}),nt(()=>{r.panelId.value=V}),ht(()=>{r.panelId.value=null}),bt(Vt,r.panelId),lt(()=>{var M,R;if(!s||r.popoverState.value!==0||!r.panel)return;let h=(M=C.value)==null?void 0:M.activeElement;(R=q(r.panel))!=null&&R.contains(h)||$e(q(r.panel),ye.First)});let H=Gt(),E=de(()=>H!==null?(H.value&Ie.Open)===Ie.Open:r.popoverState.value===0);function S(M){var R,h;switch(M.key){case we.Escape:if(r.popoverState.value!==0||!q(r.panel)||C.value&&!((R=q(r.panel))!=null&&R.contains(C.value.activeElement)))return;M.preventDefault(),M.stopPropagation(),r.closePopover(),(h=q(r.button))==null||h.focus();break}}function F(M){var R,h,c,p,n;let a=M.relatedTarget;a&&q(r.panel)&&((R=q(r.panel))!=null&&R.contains(a)||(r.closePopover(),((c=(h=q(r.beforePanelSentinel))==null?void 0:h.contains)!=null&&c.call(h,a)||(n=(p=q(r.afterPanelSentinel))==null?void 0:p.contains)!=null&&n.call(p,a))&&a.focus({preventScroll:!0})))}let j=gt();function I(){let M=q(r.panel);if(!M)return;function R(){Te(j.value,{[be.Forwards]:()=>{var h;$e(M,ye.First)===Je.Error&&((h=q(r.afterPanelSentinel))==null||h.focus())},[be.Backwards]:()=>{var h;(h=q(r.button))==null||h.focus({preventScroll:!0})}})}R()}function Z(){let M=q(r.panel);if(!M)return;function R(){Te(j.value,{[be.Forwards]:()=>{let h=q(r.button),c=q(r.panel);if(!h)return;let p=ot(),n=p.indexOf(h),a=p.slice(0,n+1),_=[...p.slice(n+1),...a];for(let g of _.slice())if(g.dataset.headlessuiFocusGuard==="true"||c!=null&&c.contains(g)){let x=_.indexOf(g);x!==-1&&_.splice(x,1)}$e(_,ye.First,{sorted:!1})},[be.Backwards]:()=>{var h;$e(M,ye.Previous)===Je.Error&&((h=q(r.button))==null||h.focus())}})}R()}return()=>{let M={open:r.popoverState.value===0,close:r.close},{focus:R,...h}=L,c={ref:r.panel,id:V,onKeydown:S,onFocusout:s&&r.popoverState.value===0?F:void 0,tabIndex:-1};return at({ourProps:c,theirProps:{...v,...h},attrs:v,slot:M,slots:{...f,default:(...p)=>{var n;return[he(ge,[E.value&&r.isPortalled.value&&he(Xe,{id:k,ref:r.beforePanelSentinel,features:Qe.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:I}),(n=f.default)==null?void 0:n.call(f,...p),E.value&&r.isPortalled.value&&he(Xe,{id:D,ref:r.afterPanelSentinel,features:Qe.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:Z})])]}},features:_t.RenderStrategy|_t.Static,visible:E.value,name:"PopoverPanel"})}}});function Ms(L,v){return A(),U("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M14.47 2.47a.75.75 0 0 1 1.06 0l6 6a.75.75 0 0 1 0 1.06l-6 6a.75.75 0 1 1-1.06-1.06l4.72-4.72H9a5.25 5.25 0 1 0 0 10.5h3a.75.75 0 0 1 0 1.5H9a6.75 6.75 0 0 1 0-13.5h10.19l-4.72-4.72a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})])}function Pt(L,v){return A(),U("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v6c0 .414.336.75.75.75h4.5a.75.75 0 0 0 0-1.5h-3.75V6Z","clip-rule":"evenodd"})])}function We(L,v){return A(),U("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M15.73 5.5h1.035A7.465 7.465 0 0 1 18 9.625a7.465 7.465 0 0 1-1.235 4.125h-.148c-.806 0-1.534.446-2.031 1.08a9.04 9.04 0 0 1-2.861 2.4c-.723.384-1.35.956-1.653 1.715a4.499 4.499 0 0 0-.322 1.672v.633A.75.75 0 0 1 9 22a2.25 2.25 0 0 1-2.25-2.25c0-1.152.26-2.243.723-3.218.266-.558-.107-1.282-.725-1.282H3.622c-1.026 0-1.945-.694-2.054-1.715A12.137 12.137 0 0 1 1.5 12.25c0-2.848.992-5.464 2.649-7.521C4.537 4.247 5.136 4 5.754 4H9.77a4.5 4.5 0 0 1 1.423.23l3.114 1.04a4.5 4.5 0 0 0 1.423.23ZM21.669 14.023c.536-1.362.831-2.845.831-4.398 0-1.22-.182-2.398-.52-3.507-.26-.85-1.084-1.368-1.973-1.368H19.1c-.445 0-.72.498-.523.898.591 1.2.924 2.55.924 3.977a8.958 8.958 0 0 1-1.302 4.666c-.245.403.028.959.5.959h1.053c.832 0 1.612-.453 1.918-1.227Z"})])}function Ps(L,v){return A(),U("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z","clip-rule":"evenodd"})])}function Ls(L,v){return A(),U("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.625 9.75a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375m-13.5 3.01c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.184-4.183a1.14 1.14 0 0 1 .778-.332 48.294 48.294 0 0 0 5.83-.498c1.585-.233 2.708-1.626 2.708-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"})])}function Ds(L,v){return A(),U("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 10.5v6m3-3H9m4.06-7.19-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})])}const As={class:"px-5 py-3"},js={class:"flex items-end justify-end space-x-2 border-t px-4 py-2"},Hs=me({__name:"FilterWards",props:{wards:{type:Array,required:!0}},emits:["update:items-selected"],setup(L,{emit:v}){const f=v,O=L,$=de(()=>O.wards.map(r=>r.name)),V=d([]),s=r=>{f("update:items-selected",V.value),r()};return(r,C)=>{const k=ns,D=xe;return A(),U("div",null,[l(t(Mt),{class:"relative"},{default:T(({close:H})=>[l(t(Ts),{class:"bg-gray-50 text-zinc-500 flex items-center space-x-2 rounded border px-2 py-1.5"},{default:T(()=>C[1]||(C[1]=[e("svg",{class:"mr-2",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 48 48"},[e("path",{fill:"currentColor","fill-rule":"evenodd",d:"M29 6v2c0 1.306.835 2.418 2 2.83V12h-1a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-6a1 1 0 0 0-1-1h-1v-1h5v12.066H20.11a.3.3 0 0 1-.218-.09l-.366-.37l.369-.367a3.77 3.77 0 0 0 .001-5.333l-1.8-1.8a3.77 3.77 0 0 0-5.333-.003l-.704.704a3.95 3.95 0 0 0-3.892 1.021a4.034 4.034 0 0 0 0 5.676l.833.839V34H6v2h3.05a3.5 3.5 0 1 0 4.899 0h20.102a3.5 3.5 0 1 0 4.899 0H42v-2h-4v-3h.066C40.24 31 42 29.224 42 27.033a3.97 3.97 0 0 0-2-3.455V11a2 2 0 0 0-2-2h-6a1 1 0 0 1-1-1V6zM13.826 16.868l4.29 4.32l.365-.364a1.77 1.77 0 0 0 0-2.504l-1.8-1.8a1.77 1.77 0 0 0-2.504-.002zM36 34H11v-8.644l5.275 5.311c.212.213.498.333.797.333H36z","clip-rule":"evenodd"})],-1),re(" Filter By Wards ")])),_:1}),l(Yt,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"translate-y-1 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-1 opacity-0"},{default:T(()=>[l(t(Vs),{class:"absolute z-10 mt-0 w-screen bg-white border shadow-2xl rounded max-w-2xl transform px-4 sm:px-0 lg:max-w-3xl"},{default:T(()=>[e("div",As,[l(k,{placeholder:"click to select wards",label:"Select ward(s)",mode:"tags",items:t($),"items-selected":t(V),"onUpdate:itemsSelected":C[0]||(C[0]=E=>le(V)?V.value=E:null)},null,8,["items","items-selected"])]),e("div",js,[l(D,{text:"Apply",icon:t(Ms),color:"primary",click:()=>{s(H)}},null,8,["icon","click"])])]),_:2},1024)]),_:2},1024)]),_:1})])}}}),qs={props:{value:{type:Object,required:!0},close:{type:Boolean,required:!0},color:{required:!1,type:String,default:"green"},icon:{required:!1,type:Object}},methods:{removeLabel(){this.$emit("update",this.value)}},components:{XMarkIcon:ke}},Os={class:"text-sm"};function Fs(L,v,f,O,$,V){const s=Q("XMarkIcon");return A(),U("div",{class:ze(["flex items-center space-x-2 px-2 py-1 text-white rounded",`bg-${f.color}-500`])},[e("p",Os,N(f.value.value),1),Ne(e("button",{onClick:v[0]||(v[0]=(...r)=>V.removeLabel&&V.removeLabel(...r)),class:"ml-2"},[l(s,{class:"w-4 h-4"})],512),[[it,f.close]])],2)}const Rs=xt(qs,[["render",Fs]]),Es={class:"fixed inset-0 overflow-y-auto"},Bs={class:"flex min-h-full items-center justify-center p-4 text-center"},Us={class:"border-b px-3 py-3 flex items-center justify-between"},Is={class:"mt-2 space-y-3 pb-40"},zs={class:"w-full flex flex-col space-y-2 px-5"},Ns={class:"w-full flex flex-col space-y-2 px-5"},Zs={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},Gs=me({__name:"index",props:{item:{}},emits:["update"],setup(L,{emit:v}){const f=v,O=L,$=d(!1),V=ut,s=Fe,r=d([]),C=d(!1),k=d([]),D=d([]),H=d([]),E=Ve(),S=d("-- select department"),F=qe("token"),j=Ve(),I=d(0);async function Z(){h();const p=j.department,n=j.user.departments.find(a=>a.name===p);n&&(I.value=Number(n.id)),S.value=p,H.value=j.user.departments,await M(I.value)}async function M(p){var x;const n=(x=O.item.client)!=null&&x.sex.match(/f/i)?"Female":"Male",a={route:`${W.specimenTestTypes}?department_id=${p}&specimen_id=${O.item.specimen_id}&sex=${n}`,method:"GET",token:`${F.value}`},{error:_,data:g}=await K(a);g.value&&(D.value=g.value,k.value=g.value),_.value&&console.error("error: ",_.value)}async function R(){C.value=!0;let p=r.value.map(x=>({specimen:O.item.specimen_id,test_type:x}));const n=E.locations.find(x=>x.name===E.selectedLocation);if(!n){pe().$toast.error("Location not found"),C.value=!1;return}const a={route:`${W.addTestOrder}`,method:"POST",token:`${F.value}`,body:{order_id:O.item.order_id,lab_location:(n==null?void 0:n.id)||0,tests:p}},{data:_,error:g}=await K(a);_.value&&(pe().$toast.success("Tests added to current order successfully!"),C.value=!1,f("update",!0),h()),g.value&&(h(),console.error("error: ",g.value),pe().$toast.error(ie),C.value=!1)}function h(){$.value=!$.value}function c(){r.value=[]}return Ce(S,(p,n)=>{if(p!==n){const a=j.user.departments.find(_=>_.name===p);a&&(I.value=Number(a.id),M(I.value))}}),(p,n)=>{const a=xe,_=Q("multi-select"),g=Oe,x=Q("FormKit");return A(),U("div",null,[e("div",null,[l(a,{text:"Add test to current order",color:"warning",icon:t(V),click:()=>{Z()}},null,8,["icon","click"])]),l(t(De),{appear:"",show:$.value,as:"template"},{default:T(()=>[l(t(Me),{as:"div",onClose:h,class:"relative z-10"},{default:T(()=>[l(t(ue),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:T(()=>n[2]||(n[2]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",Es,[e("div",Bs,[l(t(ue),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:T(()=>[l(t(Pe),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:T(()=>[e("div",Us,[l(t(Le),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:T(()=>n[3]||(n[3]=[e("svg",{class:"w-6 h-6 mr-2",xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64"},[e("path",{fill:"currentColor",d:"M43.191 40.403h5.498a.775.775 0 1 0 0-1.55h-5.498a.775.775 0 0 0 0 1.55m12.544-23.651H36.222V32.08h19.513zM54.319 30.78H37.622V18.059h16.697zM22.771 17.262H19.6v3.171h-3.171v3.171H19.6v3.171h3.171v-3.171h3.17v-3.171h-3.17z"}),e("path",{fill:"currentColor",d:"M43.191 22.323h5.498a.775.775 0 0 0 0-1.55h-5.498a.775.775 0 0 0 0 1.55"}),e("path",{fill:"currentColor",d:"M55.612.547H9.042C4.479.547.766 4.26.766 8.825v46.568c0 4.565 3.713 8.278 8.276 8.278h46.57c4.564 0 8.277-3.712 8.277-8.278V8.825c0-4.564-3.714-8.278-8.277-8.278M9.252 11.361v10.416H7.693a.533.533 0 0 1-.534-.534V7.802c0-.455.339-.825.805-.825h6.887c.464 0 .805.369.805.824v.789h10.648c.296 0 .534.239.534.532v3.023h-9.089v-.791c0-.454-.339-.823-.807-.823h-6.883c-.467 0-.806.375-.806.831zM30.49 28.617H11.881a.53.53 0 0 1-.534-.532V14.644c0-.455.339-.825.804-.825h6.885c.466 0 .807.369.807.823v.789H30.49c.296 0 .534.239.534.532v12.121a.53.53 0 0 1-.535.532zm26.644 27.286H34.828V15.316h22.306z"}),e("path",{fill:"currentColor",d:"M55.735 34.831H36.222v15.33h19.513zm-1.406 14.022H37.634V36.135h16.695z"})],-1),re(" Add Test To Current Order ")])),_:1}),e("button",{onClick:h},[l(t(ke),{class:"w-5 h-5"})])]),l(x,{type:"form","submit-label":"Update",onSubmit:R,actions:!1,id:"submitForm"},{default:T(()=>[e("div",Is,[e("div",zs,[n[4]||(n[4]=e("label",{class:"font-medium"},"Department",-1)),l(_,{style:{"--ms-max-height":"none !important"},modelValue:S.value,"onUpdate:modelValue":n[0]||(n[0]=y=>S.value=y),options:H.value.map(y=>y.name),searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])]),e("div",Ns,[n[5]||(n[5]=e("label",{class:"font-medium"},"Tests",-1)),l(_,{style:{"--ms-max-height":"none !important"},modelValue:r.value,"onUpdate:modelValue":n[1]||(n[1]=y=>r.value=y),options:k.value,mode:"tags",searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),e("div",Zs,[l(g,{type:"button",click:()=>c(),text:"Clear form"},null,8,["click"]),l(a,{loading:C.value,type:"submit",click:()=>{},color:"success",icon:t(s),text:"Save changes"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),Ys={class:"fixed inset-0 overflow-y-auto"},Ks={class:"flex min-h-full items-center justify-center p-4 text-center"},Ws={class:"border-b px-3 py-3 flex items-center justify-between"},Xs={class:"mt-2 space-y-3 pb-40"},Qs={class:"w-full flex flex-col space-y-2 px-5"},Js={class:"w-full flex flex-col space-y-2 px-5"},eo={class:"w-full flex flex-col space-y-2 px-5"},to={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},so=me({__name:"index",props:{color:{},item:{}},emits:["update"],setup(L,{emit:v}){const f=v,O=L,$=d(!1),V=ut,s=Fe,r=d(!1),C=d([]),k=d([]),D=d([]),H=d([]),E=Ve(),S=d("-- select department"),F=d(""),j=d([]),I=d([]),Z=qe("token"),M=Ve(),R=d(0),{$toast:h}=pe();async function c(){_();const x=M.department,y=M.user.departments.find(m=>m.name===x);y&&(R.value=Number(y.id)),S.value=x,H.value=M.user.departments,await p(R.value)}async function p(x){var G;const y=(G=O.item.client)!=null&&G.sex.match(/f/i)?"Female":"Male",m={route:`${W.specimens}?department_id=${x}&specimen_id=${O.item.specimen_id}&sex=${y}`,method:"GET",token:`${Z.value}`},{error:o,data:b}=await K(m);b.value&&(k.value=b.value,C.value=b.value.map(w=>w.name)),o.value&&console.error("error: ",o.value)}async function n(){var G;if(!F.value){I.value=[];return}const x=k.value.find(w=>w.name===F.value);if(!x){I.value=[];return}const y=(G=O.item.client)!=null&&G.sex.match(/f/i)?"Female":"Male",m={route:`specimen/test_types?specimen_id=${x.id}&department_id=${R.value}&sex=${y}`,method:"GET",token:`${Z.value}`},{error:o,data:b}=await K(m);b.value&&(D.value=b.value,I.value=b.value,j.value=[]),o.value&&(console.error("error: ",o.value),I.value=[])}async function a(){r.value=!0;const x=k.value.find(w=>w.name===F.value);if(!x){h.error("Please select a valid specimen"),r.value=!1;return}let y=j.value.map(w=>({specimen:x.id.toString(),test_type:w}));const m=E.locations.find(w=>w.name===E.selectedLocation);if(!m){h.error("Location not found"),r.value=!1;return}const o={route:`${W.addOrderToEncounter}`,method:"POST",token:`${Z.value}`,body:{encounter_id:O.item.encounter_id,lab_location:(m==null?void 0:m.id)||0,tests:y}},{data:b,error:G}=await K(o);b.value&&(r.value=!1,f("update",b.value),_()),G.value&&(_(),console.error("error: ",G.value),h.error(ie),r.value=!1)}function _(){$.value=!$.value}function g(){F.value="",j.value=[],I.value=[]}return Ce(S,(x,y)=>{if(x!==y){const m=M.user.departments.find(o=>o.name===x);m&&(R.value=Number(m.id),p(R.value),F.value="",j.value=[],I.value=[])}}),Ce(F,()=>{n()}),(x,y)=>{const m=xe,o=Q("multi-select"),b=Oe,G=Q("FormKit");return A(),U("div",null,[e("div",null,[l(m,{text:"Add order to encounter",color:O.color,icon:t(V),click:()=>{c()}},null,8,["color","icon","click"])]),l(t(De),{appear:"",show:t($),as:"template"},{default:T(()=>[l(t(Me),{as:"div",onClose:_,class:"relative z-10"},{default:T(()=>[l(t(ue),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:T(()=>y[3]||(y[3]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",Ys,[e("div",Ks,[l(t(ue),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:T(()=>[l(t(Pe),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:T(()=>[e("div",Ws,[l(t(Le),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:T(()=>y[4]||(y[4]=[e("svg",{class:"w-6 h-6 mr-2",xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64"},[e("path",{fill:"currentColor",d:"M43.191 40.403h5.498a.775.775 0 1 0 0-1.55h-5.498a.775.775 0 0 0 0 1.55m12.544-23.651H36.222V32.08h19.513zM54.319 30.78H37.622V18.059h16.697zM22.771 17.262H19.6v3.171h-3.171v3.171H19.6v3.171h3.171v-3.171h3.17v-3.171h-3.17z"}),e("path",{fill:"currentColor",d:"M43.191 22.323h5.498a.775.775 0 0 0 0-1.55h-5.498a.775.775 0 0 0 0 1.55"}),e("path",{fill:"currentColor",d:"M55.612.547H9.042C4.479.547.766 4.26.766 8.825v46.568c0 4.565 3.713 8.278 8.276 8.278h46.57c4.564 0 8.277-3.712 8.277-8.278V8.825c0-4.564-3.714-8.278-8.277-8.278M9.252 11.361v10.416H7.693a.533.533 0 0 1-.534-.534V7.802c0-.455.339-.825.805-.825h6.887c.464 0 .805.369.805.824v.789h10.648c.296 0 .534.239.534.532v3.023h-9.089v-.791c0-.454-.339-.823-.807-.823h-6.883c-.467 0-.806.375-.806.831zM30.49 28.617H11.881a.53.53 0 0 1-.534-.532V14.644c0-.455.339-.825.804-.825h6.885c.466 0 .807.369.807.823v.789H30.49c.296 0 .534.239.534.532v12.121a.53.53 0 0 1-.535.532zm26.644 27.286H34.828V15.316h22.306z"}),e("path",{fill:"currentColor",d:"M55.735 34.831H36.222v15.33h19.513zm-1.406 14.022H37.634V36.135h16.695z"})],-1),re(" Add Order To Encounter ")])),_:1}),e("button",{onClick:_},[l(t(ke),{class:"w-5 h-5"})])]),l(G,{type:"form","submit-label":"Update",onSubmit:a,actions:!1,id:"submitForm"},{default:T(()=>[e("div",Xs,[e("div",Qs,[y[5]||(y[5]=e("label",{class:"font-medium"},"Department",-1)),l(o,{style:{"--ms-max-height":"none !important"},modelValue:t(S),"onUpdate:modelValue":y[0]||(y[0]=w=>le(S)?S.value=w:null),options:t(H).map(w=>w.name),searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])]),e("div",Js,[y[6]||(y[6]=e("label",{class:"font-medium"},"Specimen",-1)),l(o,{style:{"--ms-max-height":"none !important"},modelValue:t(F),"onUpdate:modelValue":y[1]||(y[1]=w=>le(F)?F.value=w:null),options:t(C),searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])]),e("div",eo,[y[7]||(y[7]=e("label",{class:"font-medium"},"Test Types",-1)),l(o,{style:{"--ms-max-height":"none !important"},modelValue:t(j),"onUpdate:modelValue":y[2]||(y[2]=w=>le(j)?j.value=w:null),options:t(I),mode:"tags",searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),e("div",to,[l(b,{type:"button",click:()=>g(),text:"Clear form"},null,8,["click"]),l(m,{loading:t(r),type:"submit",click:()=>{},color:"success",icon:t(s),text:"Save changes"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),oo="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M27%2015V4H10C9.44772%204%209%204.44772%209%205V43C9%2043.5523%209.44772%2044%2010%2044H38C38.5523%2044%2039%2043.5523%2039%2043V16H28C27.4477%2016%2027%2015.5523%2027%2015ZM29%2014V4.58579L38.4142%2014H29ZM17%2019C17%2018.4477%2017.4477%2018%2018%2018H23C25.2091%2018%2027%2019.7909%2027%2022C27%2024.0759%2025.4186%2025.7825%2023.3948%2025.9808L27%2029.5859L30.2929%2026.293L31.7072%2027.7072L28.4142%2031.0001L31.7071%2034.293L30.2928%2035.7072L27%2032.4143L23.7072%2035.7072L22.2929%2034.293L25.5858%2031.0001L20.5857%2026H19V33H17V25V19ZM23%2024H19V20H23C24.1046%2020%2025%2020.8954%2025%2022C25%2023.1046%2024.1046%2024%2023%2024Z'%20fill='currentColor'/%3e%3c/svg%3e",lo="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M19%204C18.4477%204%2018%204.44772%2018%205V8C18%208.55228%2018.4477%209%2019%209H20V11.2729C19.4174%2011.4788%2019%2012.0344%2019%2012.6875V39C19%2041.7614%2021.2386%2044%2024%2044C26.7614%2044%2029%2041.7614%2029%2039V12.6875C29%2012.0344%2028.5826%2011.4788%2028%2011.2729V9H29C29.5523%209%2030%208.55228%2030%208V5C30%204.44772%2029.5523%204%2029%204H19ZM22%2011.6875V9H26V11.6875C26%2012.3406%2026.4174%2012.8962%2027%2013.1021V18H21V13.1021C21.5826%2012.8962%2022%2012.3406%2022%2011.6875Z'%20fill='currentColor'/%3e%3c/svg%3e",ao="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M28.7526%206.3415C28.4782%206.02797%2028.0383%205.91736%2027.6483%206.0639C27.2583%206.21043%2027%206.58339%2027%207V14C27%2015.1046%2027.8954%2016%2029%2016H35C35.3924%2016%2035.7485%2015.7705%2035.9106%2015.4132C36.0728%2015.0559%2036.011%2014.6368%2035.7526%2014.3415L28.7526%206.3415ZM20.75%2023H19.25L20%2021.2L20.75%2023ZM27.5576%205L37%2015.3866V40C37%2041.6569%2035.6569%2043%2034%2043H14C12.3431%2043%2011%2041.6569%2011%2040V8C11%206.34315%2012.3431%205%2014%205H27.5576ZM21.8462%2015.2308C21.5356%2014.4855%2020.8074%2014%2020%2014C19.1926%2014%2018.4644%2014.4855%2018.1538%2015.2308L13.1538%2027.2308C12.729%2028.2504%2013.2112%2029.4213%2014.2308%2029.8462C15.2504%2030.271%2016.4213%2029.7888%2016.8462%2028.7692L17.5833%2027H22.4167L23.1538%2028.7692C23.5787%2029.7888%2024.7496%2030.271%2025.7692%2029.8462C26.7888%2029.4213%2027.271%2028.2504%2026.8462%2027.2308L26.7432%2026.9837C26.8273%2026.9944%2026.913%2027%2027%2027H28V28C28%2029.1046%2028.8954%2030%2030%2030C31.1046%2030%2032%2029.1046%2032%2028V27H33C34.1046%2027%2035%2026.1046%2035%2025C35%2023.8954%2034.1046%2023%2033%2023H32V22C32%2020.8954%2031.1046%2020%2030%2020C28.8954%2020%2028%2020.8954%2028%2022V23H27C26.3521%2023%2025.7762%2023.3081%2025.4107%2023.7857L21.8462%2015.2308ZM15%2031C13.8954%2031%2013%2031.8954%2013%2033C13%2034.1046%2013.8954%2035%2015%2035C13.8954%2035%2013%2035.8954%2013%2037C13%2038.1046%2013.8954%2039%2015%2039H27C28.1046%2039%2029%2038.1046%2029%2037C29%2035.8962%2028.1058%2035.0012%2027.0023%2035H33C34.1046%2035%2035%2034.1046%2035%2033C35%2031.8954%2034.1046%2031%2033%2031L15%2031Z'%20fill='currentColor'%20stroke='%23333333'%20stroke-width='2'%20stroke-linejoin='round'/%3e%3c/svg%3e",Lt="data:image/svg+xml,%3csvg%20width='48'%20height='48'%20viewBox='0%200%2048%2048'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M40%2024.0005C40%2027.3142%2037.3137%2030.0005%2034%2030.0005H32.566L27.7629%2024.9453C27.9142%2024.6638%2028%2024.3419%2028%2024C28%2022.8954%2027.1046%2022%2026%2022H24.9645L21.1644%2018.0005H34C37.3137%2018.0005%2040%2020.6868%2040%2024.0005ZM36%2023.9995C36%2023.1711%2035.3284%2022.4995%2034.5%2022.4995C33.6716%2022.4995%2033%2023.1711%2033%2023.9995C33%2024.8279%2033.6716%2025.4995%2034.5%2025.4995C35.3284%2025.4995%2036%2024.8279%2036%2023.9995ZM30.752%2023.25C31.1673%2023.25%2031.504%2023.5858%2031.504%2024C31.504%2024.4142%2031.1673%2024.75%2030.752%2024.75C30.3367%2024.75%2030%2024.4142%2030%2024C30%2023.5858%2030.3367%2023.25%2030.752%2023.25Z'%20fill='%23333333'/%3e%3cpath%20d='M12%2024C12%2022.8954%2012.8954%2022%2014%2022H16.6881L12.9715%2018.0883C10.1478%2018.5761%208%2021.0375%208%2024.0005C8%2027.3142%2010.6863%2030.0005%2014%2030.0005H24.2896L20.4886%2026H14C12.8954%2026%2012%2025.1046%2012%2024Z'%20fill='%23333333'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M44%2024C44%2035.0457%2035.0457%2044%2024%2044C12.9543%2044%204%2035.0457%204%2024C4%2012.9543%2012.9543%204%2024%204C35.0457%204%2044%2012.9543%2044%2024ZM42%2024C42%2029.1085%2039.8719%2033.7199%2036.4539%2036.9962L11.6573%2010.8981C14.8798%207.86121%2019.2226%206%2024%206C33.9411%206%2042%2014.0589%2042%2024ZM24%2042C28.1125%2042%2031.9028%2040.6209%2034.9338%2038.2999L10.2781%2012.35C7.60984%2015.4897%206%2019.5569%206%2024C6%2033.9411%2014.0589%2042%2024%2042Z'%20fill='%23333333'/%3e%3c/svg%3e",no={key:0},ro={class:"fixed inset-0 overflow-y-auto"},io={class:"flex min-h-full items-center justify-center text-center"},uo={class:"border-b px-3 py-3 flex items-center justify-between"},co={class:"flex items-center justify-center mx-auto my-20"},po={class:"grid grid-cols-3 gap-4 px-5 py-5"},mo={class:"rounded border"},vo={class:"w-full space-y-2 py-2"},fo={class:"w-full flex justify-between px-4 py-1"},_o={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},yo={class:"w-full flex justify-between px-4 py-1"},bo={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},ho={class:"rounded border"},go={class:"w-full space-y-2 py-2"},xo={class:"w-full flex justify-between px-4 py-1"},wo={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},$o={class:"w-full flex justify-between px-4 py-1"},Co={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},ko={class:"w-full flex justify-between px-4 py-1"},So={class:"rounded border max-h-72 overflow-y-auto"},To={class:"w-full space-y-2 py-2"},Vo={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Mo={class:"w-full flex justify-between px-4 py-1"},Po={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Lo={class:"w-full flex justify-between px-4 py-1"},Do={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},Ao={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},jo={class:"w-full flex justify-between px-4 py-1"},Ho={class:"w-full flex justify-between px-4 py-2 bg-gray-50 border-b border-t border-dotted"},qo={class:"mx-5 rounded border mb-5"},Oo={class:"flex items-center justify-between bg-gray-50 px-4 py-2 border-b rounded-t"},Fo={class:"justify-end flex items-center space-x-3"},Ro={key:0},Eo={class:"font-medium"},Bo={class:"flex items-center space-x-1"},Uo=["innerHTML"],Io={key:1,class:"text-xs"},zo={key:1,class:"px-4 py-2 flex items-center"},No={class:"text-lg font-semibold"},Zo={class:"text-base text-gray-600 font-normal"},Go={key:2,class:"px-2.5 py-2.5 border-t"},Yo={class:"w-full px-5 py-2 border-b border-dotted flex justify-between items-center"},Ko={class:"w-full px-5 py-2 border-b border-dotted flex justify-between items-center"},Wo={class:"w-full px-5 py-2 border-b border-dotted flex justify-between items-center"},Xo={class:"w-full px-5 py-2 border-b border-dotted flex justify-between items-center"},Qo=me({__name:"index",props:{open:{type:Boolean,required:!1}},emits:["update","order"],setup(L,{expose:v,emit:f}){const O=L,$=f,V=d(O.open),s=d({}),r=d(!1),C=d(!1),k=d(!1),D=kt,H=tt,E=ds,S=qe("token"),F=Ve(),j=pe();async function I(m){r.value=!0;const o={route:`${W.tests}/${m.id}`,method:"GET",token:`${S.value}`},{data:b,error:G,pending:w}=await K(o);r.value=w.value,b.value&&(s.value=b.value,typeof s.value=="object"&&c()),G.value&&(r.value=!1,console.error(G.value),j.$toast.error(ie))}async function Z(){const m={route:W.printOutZebra,method:"POST",token:`${S.value}`,body:{order_id:s.value.order_id,tests:[s.value.id],is_cross_match:!0}},{data:o,error:b,pending:G}=await K(m);if(k.value=G.value,o.value){k.value=!1;const w=new FileReader;w.onload=()=>{const J=URL.createObjectURL(o.value),ae=document.createElement("a");ae.href=J,ae.setAttribute("download",`${Date.now()}.lbl`),ae.click(),URL.revokeObjectURL(J)},w.readAsText(o.value),j.$toast.success("Results printed successfully!")}b.value&&(k.value=!1,j.$toast.error(ie),console.error(b.value))}async function M(m,o){C.value=!0;const b={route:`${W.testStatus}/${o}/${m}`,method:"PUT",token:`${S.value}`},{data:G,error:w,pending:J}=await K(b);C.value=J.value,G.value&&(C.value=!1,j.$toast.success(`${s.value.test_type_name} test for ${s.value.client.first_name} ${s.value.client.middle_name!==null?s.value.client.middle_name:""} ${s.value.client.last_name} verified successfully!`),a(!0)),w.value&&(console.error(w.value),C.value=!1)}function R(){$("update",!0)}function h(m){$("order",m),c()}function c(){V.value=!V.value}function p(){return et.printSpecimenLabel(s.value.accession_number)}function n(){return et.printTrackingNumber(s.value.tracking_number)}function a(m=!1){return Qt(`/reports/daily/patient-report/${s.value.client.id}?order_id=${s.value.order_id}&printer=${m}`)}function _(m){let o="";return m.forEach(b=>{b.status.name==="pending"&&(o=`${b.initiator.first_name} ${b.initiator.last_name}`)}),Ue(o)}function g(m){return new Set(["voided","test-rejected","rejected","not-done"]).has(m.toLowerCase())}function x(m){const o=F.user,b=m.completed_by;if(b){if(b.id!==o.id)return!0;if(b.is_super_admin===!0)return!0}return!1}function y(m){const o=new Date(m.created_date),b=m.status_trail.find(Ze=>Ze.status.name.toLowerCase()==="verified");if(!b)return"In progress...";const w=new Date(b.created_date).getTime()-o.getTime(),J=Math.floor(w/1e3),ae=Math.floor(J/(3600*24)),X=Math.floor(J%(3600*24)/3600),ve=Math.floor(J%3600/60),ne=J%60,fe=[];return ae>0&&fe.push(`${ae} day${ae>1?"s":""}`),X>0&&fe.push(`${X} hour${X>1?"s":""}`),ve>0&&fe.push(`${ve} minute${ve>1?"s":""}`),ne>0&&fe.push(`${ne} second${ne>1?"s":""}`),fe.length>0?fe.join(", "):"0 seconds"}return v({init:I,printBBResults:Z,changeStatus:M,updateChanges:R,updateNewOrder:h,handleClick:c,printAccessionNumber:p,printTrackingNumber:n,viewReport:a,getRequestedBy:_,isRejectedOrVoided:g,isCompletedByCurrentUserOrSuperAdmin:x,getTurnAroundTime:y}),(m,o)=>{const b=us,G=Jt,w=xe,J=Gs,ae=so;return A(),U("div",null,[Kt(m.$slots,"default",{onClick:I}),s.value!==null&&s.value.client!==void 0?(A(),U("div",no,[l(b,{class:"hidden",ref:"corePrinter",orderId:`${s.value.order_id}`,id:`${s.value.client.id}`},null,8,["orderId","id"])])):te("",!0),l(t(De),{appear:"",show:V.value,as:"template"},{default:T(()=>[l(t(Me),{as:"div",class:"relative z-10"},{default:T(()=>[l(t(ue),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:T(()=>o[0]||(o[0]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",ro,[e("div",io,[l(t(ue),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:T(()=>[l(t(Pe),{class:"w-full max-w-7xl m-20 transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:T(()=>[e("div",uo,[l(t(Le),{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:T(()=>o[1]||(o[1]=[e("img",{src:oo,class:"w-8 h-8 mr-2"},null,-1),re(" View Test ")])),_:1}),e("button",{onClick:c},[l(t(ke),{class:"w-5 h-5"})])]),Ne(e("div",co,[l(G,{loading:r.value},null,8,["loading"])],512),[[it,r.value]]),e("div",po,[e("div",mo,[o[6]||(o[6]=e("div",{class:"px-2 py-2 bg-gray-50 border-b rounded-t"},[e("h3",{class:"text-lg font-semibold text-black flex items-center"},[e("img",{src:Wt,class:"w-7 h-7 mr-1"}),re(" Patient ")])],-1)),e("div",vo,[e("div",fo,[o[2]||(o[2]=e("h3",{class:"font-semibold"},"Patient Number",-1)),e("p",null,N(s.value.client.id),1)]),e("div",_o,[o[3]||(o[3]=e("h3",{class:"font-semibold"},"Name",-1)),e("p",null,N(("capitalize"in m?m.capitalize:t(Ue))(`${s.value.client.first_name} ${s.value.client.middle_name!==null?s.value.client.middle_name:""} ${s.value.client.last_name}`)),1)]),e("div",yo,[o[4]||(o[4]=e("h3",{class:"font-semibold"},"Sex",-1)),e("p",null,N(s.value.client.sex),1)]),e("div",bo,[o[5]||(o[5]=e("h3",{class:"font-semibold"},"Age",-1)),e("p",null,N(("calculateAge"in m?m.calculateAge:t(wt))(s.value.client.date_of_birth)),1)])])]),e("div",ho,[o[12]||(o[12]=e("div",{class:"px-2 py-2 bg-gray-50 border-b rounded-t"},[e("h3",{class:"text-lg font-semibold text-black flex items-center"},[e("img",{src:lo,class:"w-7 h-7 mr-1"}),re(" Specimen ")])],-1)),e("div",go,[e("div",xo,[o[7]||(o[7]=e("h3",{class:"font-semibold"},"Specimen Type",-1)),e("p",null,N(s.value.specimen_type),1)]),e("div",wo,[o[8]||(o[8]=e("h3",{class:"font-semibold"},"Tracking Number",-1)),e("p",null,N(s.value.tracking_number),1)]),e("div",$o,[o[9]||(o[9]=e("h3",{class:"font-semibold"},"Accession Number",-1)),e("p",null,N(s.value.accession_number),1)]),e("div",Co,[o[10]||(o[10]=e("h3",{class:"font-semibold"},"Status",-1)),e("p",null,N(("capitalize"in m?m.capitalize:t(Ue))(s.value.order_status.split("-").join(" "))),1)]),e("div",ko,[o[11]||(o[11]=e("h3",{class:"font-semibold"},"Turn Around Time",-1)),e("p",null,N(y(s.value)),1)])])]),e("div",So,[o[21]||(o[21]=e("div",{class:"px-2 py-2 bg-gray-50 border-b rounded-t flex items-center"},[e("img",{src:ao,class:"w-7 h-7 mr-1"}),e("h3",{class:"text-lg font-semibold text-black"},"Test")],-1)),e("div",To,[e("div",Vo,[o[13]||(o[13]=e("h3",{class:"font-semibold"},"Name",-1)),e("p",null,N(s.value.test_type_name),1)]),e("div",Mo,[o[14]||(o[14]=e("h3",{class:"font-semibold"},"Date Registered",-1)),e("p",null,N(t(_e)(s.value.created_date).format("DATE_FORMAT"in m?m.DATE_FORMAT:t(yt))),1)]),e("div",Po,[o[15]||(o[15]=e("h3",{class:"font-semibold"},"Receipt Date",-1)),e("p",null,N(t(_e)(s.value.created_date).format("DATE_FORMAT"in m?m.DATE_FORMAT:t(yt))),1)]),e("div",Lo,[o[16]||(o[16]=e("h3",{class:"font-semibold"},"Test Status",-1)),e("p",null,N(("capitalizeStr"in m?m.capitalizeStr:t(Xt))(s.value.status.split("-").join(" "))),1)]),e("div",Do,[o[17]||(o[17]=e("h3",{class:"font-semibold"},"Ward/Location",-1)),e("p",null,N(s.value.requesting_ward),1)]),e("div",Ao,[o[18]||(o[18]=e("h3",{class:"font-semibold"},"Request Origin",-1)),e("p",null,N(s.value.request_origin),1)]),e("div",jo,[o[19]||(o[19]=e("h3",{class:"font-semibold"},"Registered By",-1)),e("p",null,N(_(s.value.status_trail)),1)]),e("div",Ho,[o[20]||(o[20]=e("h3",{class:"font-semibold"},"Requested By",-1)),e("p",null,N(s.value.requested_by),1)])])])]),e("div",qo,[e("div",Oo,[o[22]||(o[22]=e("h3",{class:"text-lg font-semibold text-black"},"Results",-1)),e("div",Fo,[s.value.status.toLowerCase()==="completed"&&("usePermissions"in m?m.usePermissions:t(He))().can.verify("test_results")&&x(s.value)?(A(),ce(w,{key:0,icon:t(H),text:"Authorize",click:()=>{M("verified",s.value.id)},color:"success",loading:C.value},null,8,["icon","click","loading"])):te("",!0),(s.value.status.toLowerCase()==="completed"||s.value.status.toLowerCase()==="verified"||s.value.status.toLowerCase()==="test-rejected")&&("usePermissions"in m?m.usePermissions:t(He))().can.view("reports")?(A(),ce(w,{key:1,icon:t(D),text:"View Report",click:a,color:"primary"},null,8,["icon"])):te("",!0),l(J,{item:s.value,onUpdate:R,color:"primary"},null,8,["item"]),l(ae,{item:s.value,onUpdate:h,color:"primary"},null,8,["item"]),l(w,{icon:t(E),text:"Print Accession Number",click:p,color:"primary"},null,8,["icon"]),l(w,{icon:t(E),color:"success",text:"Print Tracking Number",click:n},null,8,["icon"])])]),g(s.value.status)?(A(),U("div",zo,[o[24]||(o[24]=e("img",{src:Lt,class:"w-6 h-6 mr-2",alt:"no-result-svg"},null,-1)),e("h3",No,[o[23]||(o[23]=re(" Test Rejected: ")),e("span",Zo,N(s.value.rejection_reason),1)])])):(A(),U("div",Ro,[(A(!0),U(ge,null,je(s.value.indicators,(X,ve)=>{var ne;return A(),U("div",{class:ze(s.value.indicators.length!==ve+1?"w-full px-5 py-2 border-b border-dotted flex justify-between items-center":"w-full px-5 py-2 flex justify-between items-center"),key:ve},[e("h3",Eo,N(X.name),1),e("div",Bo,[X.result?(A(),U("p",{key:0,innerHTML:X.result.value?X.result.value:"Not done"},null,8,Uo)):te("",!0),(ne=X.result)!=null&&ne.value?(A(),U("span",Io,N(X==null?void 0:X.unit),1)):te("",!0)])],2)}),128))])),s.value.test_type_name=="Cross-match"&&s.value.status.toLowerCase()=="verified"?(A(),U("div",Go,[l(w,{loading:k.value,click:()=>{Z()},text:"Print results",color:"primary",icon:t(E)},null,8,["loading","click","icon"])])):te("",!0),e("div",null,[o[29]||(o[29]=e("div",{class:"flex items-center justify-between px-4 py-2 bg-gray-50 border-b border-t"},[e("h3",{class:"text-lg font-semibold text-black"}," Post Cross-match processes ")],-1)),e("div",null,[e("div",Yo,[o[25]||(o[25]=e("h3",{class:"font-medium"},"Collected by",-1)),e("p",null,N(s.value.post_crossmatch_process?s.value.post_crossmatch_process.collected_by:"Not collected"),1)]),e("div",Ko,[o[26]||(o[26]=e("h3",{class:"font-medium"},"Collected date",-1)),e("p",null,N(s.value.post_crossmatch_process?t(_e)(s.value.post_crossmatch_process.collection_date).format("DATE_FORMAT_TIME"in m?m.DATE_FORMAT_TIME:t($t)):"Not collected"),1)]),e("div",Wo,[o[27]||(o[27]=e("h3",{class:"font-medium"},"Transfusion outcome",-1)),e("p",null,N(s.value.post_crossmatch_process?s.value.post_crossmatch_process.transfusion_outcome:"Not done"),1)]),e("div",Xo,[o[28]||(o[28]=e("h3",{class:"font-medium"},"Returned reason",-1)),e("p",null,N(s.value.post_crossmatch_process?s.value.post_crossmatch_process.returned_reason:"Not returned"),1)])])])])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),Jo={class:"fixed inset-0 overflow-y-auto"},el={class:"flex min-h-full items-center justify-center p-4 text-center"},tl={class:"border-b px-3 py-3 flex items-center justify-between"},sl={class:"mt-2 space-y-3 px-5 py-5"},ol={class:"w-full border border-dotted rounded"},ll={class:"flex items-center space-x-1"},al=["innerHTML"],nl={key:1,class:"text-xs"},rl={class:"w-full flex items-center"},il={class:"w-full flex flex-col space-y-2"},ul={class:"w-full flex flex-col space-y-2"},cl={class:"w-full flex flex-col space-y-2"},dl={class:"flex items-center space-x-2"},pl={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},ml=me({__name:"index",props:{item:{}},emits:["update"],setup(L,{emit:v}){const f=L,O=v,$=d(),V=d(!1),s=Fe,r=d(""),C=d(""),k=d(!1),D=d(!1),H=d(!1),E=d([]),{$toast:S}=pe(),F=d({name:"select ward",id:0}),j=async()=>{const{data:n,error:a}=await K({route:W.sections,method:"GET"});n.value&&(E.value=n.value.data),a.value&&console.error(a.value)},I=async()=>{k.value=!0,await j();const n={route:`${W.tests}/${f.item.id}`,method:"GET"},{data:a,error:_,pending:g}=await K(n);k.value=g,a.value&&(k.value=!1,$.value=a.value,F.value=E.value.find(x=>x.name==a.value.requesting_ward)||{name:"select ward",id:0},h()),_.value&&(k.value=!1,console.error(_.value),S.error(ie))},Z=()=>{C.value=""},M=()=>{const n=new Date,a=n.getFullYear(),_=String(n.getMonth()+1).padStart(2,"0"),g=String(n.getDate()).padStart(2,"0"),x=String(n.getHours()).padStart(2,"0"),y=String(n.getMinutes()).padStart(2,"0");C.value=`${a}-${_}-${g}T${x}:${y}`},R=async()=>{D.value=!0;const n={route:`${W.processCrossMatch}`,method:"POST",body:{post_crossmatch_process:{facility_section_id:F.value.id,test_id:f.item.id,collected_by:r.value,collection_date:C.value}}},{data:a,error:_,pending:g}=await K(n);D.value=g,a.value&&(S.success("Collection details saved successfully!"),h(),D.value=!1,c(),O("update",!0)),_.value&&(console.error(_.value),S.error(ie),D.value=!1)},h=()=>{V.value=!V.value};async function c(){var x,y;const n={route:W.printOutZebra,method:"POST",body:{order_id:(x=$.value)==null?void 0:x.order_id,tests:[(y=$.value)==null?void 0:y.id],is_cross_match:!0}},{data:a,error:_,pending:g}=await K(n);if(H.value=g,a.value){H.value=!1;const m=new FileReader;m.onload=()=>{const o=URL.createObjectURL(a.value),b=document.createElement("a");b.href=o,b.setAttribute("download",`${Date.now()}.lbl`),b.click(),URL.revokeObjectURL(o)},m.readAsText(a.value),S.success("Results printed successfully!")}_.value&&(H.value=!1,S.error(ie),console.error(_.value))}const p=()=>{r.value="",C.value="",F.value={name:"select ward",id:0}};return(n,a)=>{const _=xe,g=Q("FormKit"),x=Ct,y=Q("datepicker"),m=Oe;return A(),U("div",null,[e("div",null,[l(_,{text:"Collect",color:"primary",icon:t(Ds),click:()=>{I()},loading:t(k)},null,8,["icon","click","loading"])]),l(t(De),{appear:"",show:t(V),as:"template"},{default:T(()=>[l(t(Me),{as:"div",onClose:h,class:"relative z-10"},{default:T(()=>[l(t(ue),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:T(()=>a[3]||(a[3]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",Jo,[e("div",el,[l(t(ue),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:T(()=>[l(t(Pe),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:T(()=>[e("div",tl,[l(t(Le),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:T(()=>a[4]||(a[4]=[e("svg",{class:"w-8 h-8 mr-2",xmlns:"http://www.w3.org/2000/svg",width:"512",height:"512",viewBox:"0 0 512 512"},[e("path",{fill:"currentColor",d:"m118.2 55l-2.5 5.02C108.9 73.86 99.93 79 91.97 79s-16.99-5.17-23.92-19.03l-16.1 8.06C61.02 86.17 75.99 97 91.97 97c14.43 0 27.93-8.91 37.03-24h82v419h18V73h81.8c7.3 11.92 17.2 19.95 28.2 22.82V119h18V95.84c12.5-3.24 23.7-13.13 31.1-27.81l-16.2-8.06C365 73.83 356 79 348 79s-17-5.17-23.9-19.03L321.6 55zm171.1 82c-1.3 3-3.9 9.6-5.4 19.8c-1.9 12.9-2.9 29.5-2.9 47.2c0 33.5 3.8 70.9 10.5 93.5c14 6 35.3 9.5 56.5 9.5s42.5-3.5 56.5-9.5c6.7-22.6 10.5-60 10.5-93.5c0-17.7-1-34.3-2.9-47.2c-1.5-10.2-4.1-16.8-5.4-19.8zm5.3 77c35.3 7.2 70.6 10.5 105.9 0c-.5 24-2.4 45-10.2 69.6c-28.9 3-56.5 11.4-89.9-3.9zm91.1 107.7c-5.8 1.1-11.8 1.9-17.9 2.4c.7 3.1 1.5 6.6 2.3 10.6c2.4 11.4 4.4 25.3 3.9 32.7v.1c-.4 6.3-3 13.3-6.2 21.1s-6.9 16.5-7.7 26.7c-1.2 14.7 1.4 34.1 4.1 50.4s5.6 29.4 5.6 29.4l17.6-4s-2.9-12.6-5.5-28.3c-2.5-15.8-4.7-35-3.8-46.1c.5-6.4 3.2-13.4 6.4-21.3s6.9-16.6 7.5-26.8c.7-11.5-1.8-25.6-4.2-37.5c-.7-3.4-1.5-6.6-2.1-9.4m-74.7.1v24.5h18v-22.1c-6.1-.5-12.2-1.3-18-2.4"})],-1),re(" Blood collection ")])),_:1}),e("button",{type:"button",onClick:h},[l(t(ke),{class:"w-5 h-5"})])]),l(g,{type:"form","submit-label":"Update",onSubmit:R,actions:!1,id:"collectionForm"},{default:T(({value:o})=>{var b,G;return[e("div",sl,[e("div",null,[a[5]||(a[5]=e("h3",{class:"text-lg font-semibold text-black"},"Results",-1)),e("div",ol,[(A(!0),U(ge,null,je((b=t($))==null?void 0:b.indicators,(w,J)=>{var ae,X;return A(),U("div",{class:ze(((ae=t($))==null?void 0:ae.indicators.length)!==J+1?"w-full px-5 py-2 border-b border-dotted flex justify-between items-center":"w-full px-5 py-2 flex justify-between items-center"),key:J},[e("h3",null,N(w.name),1),e("div",ll,[w.result?(A(),U("p",{key:0,innerHTML:w.result.value?w.result.value:"Not done"},null,8,al)):te("",!0),(X=w.result)!=null&&X.value?(A(),U("span",nl,N(w==null?void 0:w.unit),1)):te("",!0)])],2)}),128))])]),e("div",rl,[e("div",il,[l(g,{type:"text",label:"Person's Name",validation:"required",modelValue:t(r),"onUpdate:modelValue":a[0]||(a[0]=w=>le(r)?r.value=w:null)},null,8,["modelValue"])])]),e("div",ul,[a[6]||(a[6]=e("label",{class:"font-medium"},"Designated ward",-1)),l(x,{isSearchable:"",items:t(E),modelValue:t(F),"onUpdate:modelValue":a[1]||(a[1]=w=>le(F)?F.value=w:null),class:ze(t(F).name=="select ward"&&"text-gray-600")},null,8,["items","modelValue","class"])]),e("div",cl,[a[7]||(a[7]=e("label",{class:"font-medium"},"Collection Time",-1)),e("div",dl,[l(y,{required:"",position:"left",onCleared:Z,placeholder:"select collection date and time",range:!1,format:"dd/MM/yyyy HH:mm:ss","input-class-name":"datepicker",modelValue:t(C),"onUpdate:modelValue":a[2]||(a[2]=w=>le(C)?C.value=w:null),minDate:(G=t($))==null?void 0:G.created_date,maxDate:new Date},null,8,["modelValue","minDate","maxDate"]),l(_,{text:"Now",color:"primary",click:()=>{M()},icon:t(Pt)},null,8,["click","icon"])])])]),e("div",pl,[l(m,{type:"button",text:"Clear form",click:p}),l(_,{loading:t(D),type:"submit",color:"success",icon:t(s),click:()=>{},text:"Save details"},null,8,["loading","icon"])])]}),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),vl={class:"fixed inset-0 overflow-y-auto"},fl={class:"flex min-h-full items-center justify-center p-4 text-center"},_l={class:"border-b px-3 py-3 flex items-center justify-between"},yl={class:"mt-2 space-y-3 px-5 py-5"},bl={class:"mt-2"},hl={key:0,class:"space-y-3"},gl={class:"w-full flex flex-col space-y-2"},xl={class:"flex items-center space-x-2"},wl={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},$l=me({__name:"index",props:{item:{}},emits:["update"],setup(L,{emit:v}){const f=L,O=v,$=d(),V=d(!1),s=Fe,r=d(""),C=d(!1),k=d(""),D=d(""),H=d(""),E=d(!1),S=d(!1),F=d(!1),{$toast:j}=pe(),I=async()=>{E.value=!0;const n={route:`${W.tests}/${f.item.id}`,method:"GET"},{data:a,error:_,pending:g}=await K(n);E.value=g,a.value&&(E.value=!1,$.value=a.value,h()),_.value&&(E.value=!1,console.error(_.value),j.error(ie))},Z=()=>{H.value=""},M=()=>{const n=new Date,a=n.getFullYear(),_=String(n.getMonth()+1).padStart(2,"0"),g=String(n.getDate()).padStart(2,"0"),x=String(n.getHours()).padStart(2,"0"),y=String(n.getMinutes()).padStart(2,"0");H.value=`${a}-${_}-${g}T${x}:${y}`},R=async()=>{S.value=!0;const n={route:`${W.processCrossMatch}`,method:"POST",body:{post_crossmatch_process:{facility_section_id:f.item.post_crossmatch_process.facility_section_id,test_id:f.item.id,transfusion_outcome:r.value,returned:C.value,returned_by:D.value,returned_date:H.value,returned_reason:k.value}}},{data:a,error:_,pending:g}=await K(n);S.value=g,a.value&&(j.success("Transfusion outcome saved successfully!"),h(),S.value=!1,c(),O("update",!0)),_.value&&(console.error(_.value),j.error(ie),S.value=!1)},h=()=>{V.value=!V.value};async function c(){var x,y;const n={route:W.printOutZebra,method:"POST",body:{order_id:(x=$.value)==null?void 0:x.order_id,tests:[(y=$.value)==null?void 0:y.id],is_cross_match:!0}},{data:a,error:_,pending:g}=await K(n);if(F.value=g,a.value){F.value=!1;const m=new FileReader;m.onload=()=>{const o=URL.createObjectURL(a.value),b=document.createElement("a");b.href=o,b.setAttribute("download",`${Date.now()}.lbl`),b.click(),URL.revokeObjectURL(o)},m.readAsText(a.value),j.success("Results printed successfully!")}_.value&&(F.value=!1,j.error(ie),console.error(_.value))}const p=()=>{r.value="",C.value=!0,D.value="",H.value="",k.value=""};return(n,a)=>{const _=xe,g=Q("FormKit"),x=Q("datepicker"),y=Oe;return A(),U("div",null,[e("div",null,[l(_,{text:"Outcome",color:"success",icon:t(Ls),click:()=>{I()},loading:t(E)},null,8,["icon","click","loading"])]),l(t(De),{appear:"",show:t(V),as:"template"},{default:T(()=>[l(t(Me),{as:"div",onClose:h,class:"relative z-10"},{default:T(()=>[l(t(ue),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:T(()=>a[5]||(a[5]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",vl,[e("div",fl,[l(t(ue),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:T(()=>[l(t(Pe),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:T(()=>[e("div",_l,[l(t(Le),{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:T(()=>a[6]||(a[6]=[e("svg",{class:"w-8 h-8 mr-2",xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 64 64"},[e("path",{fill:"currentColor",d:"M55.407.547H8.833C4.271.547.559 4.26.559 8.824v46.568c0 4.565 3.713 8.279 8.274 8.279h46.574c4.564 0 8.276-3.713 8.276-8.279V8.824c0-4.564-3.712-8.277-8.276-8.277M35.358 16.592a6.583 6.583 0 0 1 6.584 6.584c0 3.634-2.949 6.586-6.584 6.586s-6.584-2.952-6.584-6.586a6.583 6.583 0 0 1 6.584-6.584M8.191 18.675v-5.269h5.269V8.137h5.269v5.269h5.269v5.269h-5.269v5.268H13.46v-5.268zM52.64 53.058c-.488 0-.957-.095-1.385-.267l-5.862-1.631v5.843H25.044V51.16l-5.86 1.631a3.7 3.7 0 0 1-1.385.267a3.755 3.755 0 0 1-3.112-5.853l9.4-12.889c1.02-1.398 2.445-2.955 5.45-2.955H40.9c3.004 0 4.43 1.558 5.449 2.955l9.399 12.889a3.74 3.74 0 0 1 .642 2.099a3.757 3.757 0 0 1-3.752 3.754z"}),e("path",{fill:"currentColor",d:"M25.043 35.868v7.816l.712-.24c5.242-1.545 7.281 5.376 2.04 6.918l-.168.047l7.592 2.513l7.593-2.513l-.171-.047c-5.238-1.542-3.199-8.463 2.039-6.918l.716.24v-7.816l-10.177 3.325z"})],-1),re(" Transfusion outcome ")])),_:1}),e("button",{type:"button",onClick:h},[l(t(ke),{class:"w-5 h-5"})])]),l(g,{type:"form","submit-label":"Update",onSubmit:R,actions:!1,id:"collectionForm"},{default:T(({value:m})=>[e("div",yl,[l(g,{type:"text",label:"Transfusion Outcome",modelValue:t(r),"onUpdate:modelValue":a[0]||(a[0]=o=>le(r)?r.value=o:null),validation:"required"},null,8,["modelValue"]),e("div",bl,[e("label",null,[Ne(e("input",{type:"checkbox","onUpdate:modelValue":a[1]||(a[1]=o=>le(C)?C.value=o:null)},null,512),[[es,t(C)]]),a[7]||(a[7]=re(" Is it returned? "))])]),t(C)?(A(),U("div",hl,[l(g,{type:"text",label:"Returned By",modelValue:t(D),"onUpdate:modelValue":a[2]||(a[2]=o=>le(D)?D.value=o:null),validation:"required"},null,8,["modelValue"]),e("div",gl,[a[8]||(a[8]=e("label",{class:"font-medium"},"Returned Date",-1)),e("div",xl,[l(x,{required:"",position:"left",onCleared:Z,placeholder:"select collection date and time",range:!1,format:"dd/MM/yyyy HH:mm:ss","input-class-name":"datepicker",modelValue:t(H),"onUpdate:modelValue":a[3]||(a[3]=o=>le(H)?H.value=o:null)},null,8,["modelValue"]),l(_,{text:"Now",color:"primary",click:()=>{M()},icon:t(Pt)},null,8,["click","icon"])])]),l(g,{type:"textarea",label:"Returned Reason",modelValue:t(k),"onUpdate:modelValue":a[4]||(a[4]=o=>le(k)?k.value=o:null),validation:"required"},null,8,["modelValue"])])):te("",!0)]),e("div",wl,[l(y,{type:"button",text:"Clear form",click:()=>{p()}},null,8,["click"]),l(_,{loading:t(S),type:"submit",color:"success",icon:t(s),click:()=>{},text:"Save details"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),Cl={components:{TransitionRoot:De,TransitionChild:ue,Dialog:Me,DialogPanel:Pe,DialogTitle:Le,XMarkIcon:ke,UserIcon:ps},data(){return{open:!1,addIcon:ms,saveIcon:Fe,clearIcon:vs,name:"",description:"",loading:!1,cookie:qe("token"),reasons:new Array,reasonsSelected:"",rawReasons:new Array}},props:{item:{required:!0,type:Object},text:{type:String,required:!0},action:{type:String,required:!0},icon:{type:[Object,Function],required:!0}},methods:{async init(){this.handleClick();const L={route:W.rejectionReasons,method:"GET",token:`${this.cookie}`},{error:v,data:f}=await K(L);f.value&&(this.rawReasons=f.value,f.value.map(O=>{this.reasons.push(O.description)})),v.value&&console.error(v.value)},async submitForm(){this.loading=!0;let L=null;this.rawReasons.map(V=>{V.description===this.reasonsSelected&&(L=V.id)});const v={route:`${W.testStatus}/${this.item.id}/${this.action}?status_reason_id=${L}&person_talked_to=${this.name}`,method:"PUT",token:`${this.cookie}`,body:{}},{data:f,error:O,pending:$}=await K(v);this.loading=$,f.value&&(pe().$toast.success(`Test action "${this.text}" done successfully!`),this.handleClick(),this.loading=!1,this.$emit("update",!0)),O.value&&(console.error(O.value),pe().$toast.error(ie),this.loading=!1)},handleClick(){this.open=!this.open},resetForm(){this.reasonsSelected="",this.$formkit.reset("rejectionForm")}}},kl={class:"fixed inset-0 overflow-y-auto"},Sl={class:"flex min-h-full items-center justify-center p-4 text-center"},Tl={class:"border-b px-3 py-3 flex items-center justify-between"},Vl={class:"mt-2 space-y-3 px-5 py-5"},Ml={class:"space-y-2"},Pl={class:"border-b border-dotted text-gray-600"},Ll={class:"space-y-2"},Dl={class:"border-b border-dotted text-gray-600"},Al={class:"space-y-2"},jl={class:"border-b border-dotted text-gray-600"},Hl={class:"w-full flex items-center"},ql={class:"w-full flex flex-col space-y-2"},Ol={class:"w-full flex flex-col space-y-2 pb-40"},Fl={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Rl(L,v,f,O,$,V){const s=xe,r=Q("TransitionChild"),C=Q("DialogTitle"),k=Q("XMarkIcon"),D=Q("FormKit"),H=Q("multi-select"),E=Oe,S=Q("DialogPanel"),F=Q("Dialog"),j=Q("TransitionRoot");return A(),U("div",null,[e("div",null,[l(s,{text:f.text,color:"error",icon:f.icon,click:V.init},null,8,["text","icon","click"])]),l(j,{appear:"",show:$.open,as:"template"},{default:T(()=>[l(F,{as:"div",onClose:V.handleClick,class:"relative z-10"},{default:T(()=>[l(r,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:T(()=>v[3]||(v[3]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",kl,[e("div",Sl,[l(r,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:T(()=>[l(S,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:T(()=>[e("div",Tl,[l(C,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:T(()=>[v[4]||(v[4]=e("img",{src:Lt,class:"w-8 h-8 mr-2"},null,-1)),re(" "+N(f.text.charAt(0).toUpperCase()+f.text.slice(1))+" Reason ",1)]),_:1}),e("button",{onClick:v[0]||(v[0]=(...I)=>V.handleClick&&V.handleClick(...I))},[l(k,{class:"w-5 h-5"})])]),l(D,{type:"form","submit-label":"Update",onSubmit:V.submitForm,actions:!1,id:"rejectionForm"},{default:T(({value:I})=>[e("div",Vl,[e("div",Ml,[v[5]||(v[5]=e("h3",{class:"font-medium"},"Test Type",-1)),e("p",Pl,N(f.item.test_type_name),1)]),e("div",Ll,[v[6]||(v[6]=e("h3",{class:"font-medium"},"Specimen",-1)),e("p",Dl,N(f.item.specimen_type),1)]),e("div",Al,[v[7]||(v[7]=e("h3",{class:"font-medium"},"Accession Number",-1)),e("p",jl,N(f.item.accession_number),1)]),e("div",Hl,[e("div",ql,[l(D,{type:"text",label:"Person Talked To",validation:f.text.toLowerCase()!=="void"?"required":"",modelValue:$.name,"onUpdate:modelValue":v[1]||(v[1]=Z=>$.name=Z)},null,8,["validation","modelValue"])])]),e("div",Ol,[v[8]||(v[8]=e("label",{class:"font-medium"},"Select Reason(s)",-1)),l(H,{style:{"--ms-max-height":"none !important"},modelValue:$.reasonsSelected,"onUpdate:modelValue":v[2]||(v[2]=Z=>$.reasonsSelected=Z),options:$.reasons,searchable:!0,required:!0,clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),e("div",Fl,[l(E,{type:"button",text:"Clear form",click:V.resetForm},null,8,["click"]),l(s,{loading:$.loading,type:"submit",click:()=>{},color:"success",icon:$.saveIcon,text:"Save changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const El=xt(Cl,[["render",Rl]]),Bl={class:"py-5 px-5"},Ul={class:"flex items-center space-x-2 py-5"},Il={class:"text-2xl font-semibold uppercase"},zl={class:"flex justify-between items-center w-full py-2 mb-2"},Nl={class:"flex items-center space-x-2"},Zl={class:"relative z-10 w-40"},Gl={class:"w-44"},Yl={class:"pt-1"},Kl={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},Wl={class:"w-72 ml-2"},Xl={class:"py-3 flex items-center space-x-3"},Ql={class:"py-2 flex items-center"},Jl={class:"w-full flex items-center justify-between space-x-2"},ea={key:0,class:"flex items-center space-x-2"},ta={key:0,class:"flex items-center space-x-2"},Oa=me({__name:"index",setup(L){const v=Ve(),f=ts(),O=ss(),{$toast:$,$metadata:V}=pe();_s({title:`${ys.name.toUpperCase()} - ${v.department} Tests`});const s=d(!1),r=d(0),C=d(),k=d(["",""]),D=d(""),H=d("Tests Lists"),E=d([{name:"Home",link:"/home"}]),S=d([{text:"PATIENT NO",value:"client.id",sortable:!0},{text:"PATIENT NAME",value:"name",sortable:!0},{text:"ACCESSION NO",value:"accession_number",sortable:!0},{text:"TEST",value:"test_type_name",sortable:!0},{text:"LOCATION",value:"requesting_ward",sortable:!0},{text:"ORDER STATUS",value:"order_status",sortable:!0},{text:"STATUS",value:"status",sortable:!0},{text:"DATE REGISTERED",value:"created_date",sortable:!0},{text:"ACTIONS",value:"actions",sortable:!1}]),F=d([{text:"Results",color:"primary",icon:bs,status:"completed",show:"started",permission:"enter_test_results"},{text:"Accept",color:"success",icon:tt,status:"pending",show:"not-collected",permission:"accept_test_specimen"},{text:"Start",color:"warning",icon:Ps,status:"started",show:"pending",permission:"start_test"},{text:"Authorize",color:"success",status:"verified",icon:tt,show:"completed",permission:"verify_test_results"}]),j=i=>{const u=[{name:"Reject",icon:We,action:"rejected",permission:"void_test"},{name:"Void",icon:We,action:"voided",permission:"void_test"},{name:"Notdone",icon:We,action:"not_done",permission:"void_test"}];return i.toLowerCase()==="verified"?u.filter(P=>P.name.toLowerCase()==="void"):u},I=d([]),Z=cs(),M=d({name:"select status"}),R=d("accession_number"),h=d(""),c=qe("token"),p=d(!1),n=d(!0),a=d(0),_=d([]),g=d({page:1,rowsPerPage:20,sortBy:"name"}),x=d([]),y=d([]),m=i=>{r.value==i?r.value=0:r.value=i},o=async i=>{p.value=!0;const u={route:`${W.nlimsTestSearch}?tracking_number=${i.replace(/\$$/,"")}`,method:"GET",token:`${c.value}`},{data:P,error:z}=await K(u);P.value&&(as(P.value).then(Y=>{const se={...f.query,search:Y};O.replace({query:se}),D.value=Y,h.value=Y,b()}).catch(Y=>{console.error("error routing to merged test: ",Y)}),p.value=!1),z.value&&(console.error(z.value),$.error(`${z.value.data.error}`),p.value=!1)},b=async()=>{G(),p.value=!0;const{page:i,rowsPerPage:u}=g.value;let P=ve(v.user.departments,v.department),z=ve(v.locations,v.selectedLocation),Y=M.value.name==="select status"?"":M.value.name!==void 0&&M.value.name;const se=k.value[0].toString()!==""?_e(k.value[0].toString()).format("YYYY-MM-DD"):"",Ge=k.value[1].toString()!==""?_e(k.value[1].toString()).format("YYYY-MM-DD"):"",Ye={route:`${W.tests}?minimal=true&page=${i}&per_page=${u}&status=${Y.toString().toLowerCase()}&search=${D.value}&department_id=${P}&lab_location=${z}&start_date=${se}&end_date=${Ge}&facility_sections=${_.value}`,method:"GET",token:`${c.value}`},{data:Se,error:Re,pending:Ke}=await K(Ye);p.value=Ke,Se.value&&(Se.value.data.length==0&&$.warning("No tests found within the specified period"),I.value=Se.value.data.map(ee=>{var Ee,Be,B,oe;return{...ee,name:`${Ue(`${(Ee=ee.client)==null?void 0:Ee.first_name} ${((Be=ee.client)==null?void 0:Be.middle_name)!==null?ee.client.middle_name:""} ${(B=ee.client)==null?void 0:B.last_name}`)} (${ee.client.sex}, ${wt((oe=ee.client)==null?void 0:oe.date_of_birth)} yrs)`,order_status:`${ee.order_status!==null?(ee.order_status.charAt(0).toUpperCase()+ee.order_status.slice(1)).split("-").join(" "):""}`,status:`${ee.status!==null?ee.status.charAt(0).toUpperCase()+ee.status.slice(1):""}`,created_date:_e(ee.created_date).utcOffset(2).format($t)}}),a.value=Se.value.meta.total_count,p.value=!1),Re.value&&(console.error(Re.value.data),$.error(ie),p.value=!1)},G=async()=>{const i={route:`${W.testStatus}/all`,method:"GET",token:`${c.value}`},{data:u,error:P}=await K(i);u.value&&(x.value=u.value.map(z=>({id:z.id,name:z.name.charAt(0).toUpperCase()+z.name.slice(1)}))),P.value&&console.error(P.value)},w=async(i,u)=>{p.value=!0;const P={route:`${W.testStatus}/${u}/${i}`,method:"PUT",token:`${c.value}`,body:{}},{data:z,error:Y,pending:se}=await K(P);p.value=se,z.value&&(b(),p.value=!1),Y.value&&(console.error(Y.value),p.value=!1)},J=async i=>{ls(i)||($.success(`Order with accession number ${i.accession_number} has been created successfully!`),await Z.alertConfirmation({message:"Do you want to print specimen label?"})&&await et.printSpecimenLabel(i.accession_number)),b()},ae=async(i,u)=>{p.value=!0;const P={route:`${W.orderStatus}/${i}`,method:"PUT",token:`${c.value}`,body:{order_id:u}},{data:z,error:Y,pending:se}=await K(P);p.value=se,z.value&&(b(),p.value=!1),Y.value&&(console.error(Y.value),p.value=!1)},X=(i,u)=>{i.status==="completed"?u.test_type_name.toLowerCase().includes("culture")?dt(u,`/tests/result/culture-sensitivity?accession_number=${u.accession_number}&test_id=${u.id}`):dt(u,`/tests/result?accession_number=${u.accession_number}&test_id=${u.id}`):i.status==="verified"?vt(u):i.status!==""&&w(i.status,u.id)},ve=(i,u)=>{const P=i.find(z=>z.name===u);return P?P.id:null},ne=i=>{if(r.value=0,typeof i=="object"){g.value=i;const u={...f.query,page:i.page,rowsPerPage:i.rowsPerPage};O.replace({query:u})}b(),s.value=!1},fe=()=>{h.value="",D.value="",b()},Ze=i=>{D.value=i,h.value=i;const u={...f.query,search:i};O.replace({query:u}),i!==""?At(i)?o(i):ne(i):b()},Dt=i=>{if(i){_.value=i;for(let u=y.value.length-1;u>=0;u--){const P=y.value[u];P.origin==="wards"&&!i.includes(P.value)&&y.value.splice(u,1)}i.forEach(u=>{y.value.some(P=>P.origin==="wards"&&P.value===u)||y.value.push({origin:"wards",value:u})}),b()}},dt=(i,u)=>{O.push(u)},At=i=>/^(x|l).*\d/.test(i.toLowerCase()),pt=i=>{if(i.name!=="select status"){const P=y.value.find(z=>z.origin==="statuses");P?P.value=i.name:y.value.push({origin:"statuses",value:i.name})}M.value=i;const u={...f.query,status:i.name.toLowerCase()=="select status"?"":i.name.toLowerCase()};O.replace({query:u}),u.status!==""&&b()},jt=i=>{if(i.origin==="statuses"&&M.value.name!=="select status"&&pt({name:"select status"}),i.origin==="wards"){const P=_.value.indexOf(i.value);P!==-1&&_.value.splice(P,1)}const u=y.value.findIndex(P=>P.origin===i.origin);u!==-1&&y.value.splice(u,1),b()},Ht=i=>{const u=v.user,P=i.completed_by;if(P){if(P.id!==u.id)return!0;if(P.is_super_admin===!0)return!0}return!1},qt=(i,u)=>{const{hasPermission:P}=He(),z=i.status.toLowerCase(),Y=u.show.toLowerCase();if(z===Y){const se=Ht(i);return z==="pending"&&i.order_status.toLowerCase()==="specimen not collected"?!1:u.permission?se&&P.value(String(u.permission)):se}return!1},Ot=i=>{const u=new Set(["rejected","not-done","voided"]),P=new Set(["specimen not collected"]);return!u.has(i.status.toLowerCase())&&P.has(i.order_status.toLowerCase())},mt=i=>{const{can:u}=He();return!new Set(["voided","test-rejected","rejected","not-done"]).has(i.status.toLowerCase())&&u.void("test")},Ft=()=>{k.value=["",""]},vt=i=>{C!==null&&C.value.init(i)};return Ce(()=>v.department,(i,u)=>{i!==u&&b()}),Ce(()=>v.selectedLocation,(i,u)=>{i!==u&&b()}),Ce(k,(i,u)=>{if(n.value){n.value=!1;return}if(i!==u){const P=i[0].toString()!==""?_e(i[0].toString()).format("YYYY-MM-DD"):"",z=i[1].toString()!==""?_e(i[1].toString()).format("YYYY-MM-DD"):"",Y={...f.query,from:P,to:z};O.replace({query:Y}),b()}},{deep:!0}),Ce(M,i=>{pt(i)},{deep:!0}),nt(()=>{var i,u,P,z,Y,se;g.value={page:Number(f.query.page?f.query.page:1),rowsPerPage:Number(f.query.rowsPerPage?f.query.rowsPerPage:20)},M.value=f.query.status?{name:f.query.status.toString()}:{name:"select status"},D.value=(i=f.query.search)!=null&&i.toString()?(u=f.query.search)==null?void 0:u.toString():"",k.value=[`${(P=f.query.from)!=null&&P.toString()?(z=f.query.from)==null?void 0:z.toString():""}`,`${(Y=f.query.to)!=null&&Y.toString()?(se=f.query.to)==null?void 0:se.toString():""}`],b()}),(i,u)=>{const P=Rt,z=xe,Y=Ct,se=Hs,Ge=Q("datepicker"),Ye=is,Se=Rs,Re=Qo,Ke=ml,ee=$l,Ee=El,Be=fs;return A(),U("div",Bl,[l(P,{pages:t(E)},null,8,["pages"]),e("div",Ul,[u[3]||(u[3]=os('<svg class="w-auto h-8" xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><g fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"><path d="M18.142 4L4 18.142l7.778 7.778L25.92 11.778zm-1.328 4.35l-1.415 1.415l4.95 4.95l1.414-1.415zm-3.536 3.536L11.864 13.3l4.95 4.95l1.414-1.414zm-3.536 3.536l-1.414 1.414l4.95 4.95l1.414-1.415z"></path><path d="m11.864 23.2l11.314-11.314l17.677 17.678a8 8 0 1 1-11.313 11.313zm2.828 0l16.264 16.263a6 6 0 0 0 8.485-8.485L23.178 14.714z"></path><path d="m19.642 23.907l7.779-7.778l12.02 12.02l-7.778 7.779zm2.829 0l9.192 9.192l4.95-4.95l-9.192-9.192z"></path><path d="M27.066 29.917c-1.414.707-3.182 2.475-3.536 3.536l6.718 6.717a7 7 0 0 0 9.9-9.899l-2.122-2.12l-6.363 6.363z"></path><path d="m24.755 33.263l6.2 6.2a6 6 0 0 0 8.486-8.485l-1.415-1.414l-6.363 6.364l-4.755-4.755a9.3 9.3 0 0 0-1.3 1.087a7.3 7.3 0 0 0-.853 1.003m-.562-2.418c.712-.712 1.593-1.406 2.426-1.822l.12-.06l.656-.132l4.268 4.268l6.363-6.363l2.83 2.828a8 8 0 1 1-11.314 11.313l-7.072-7.07l.083-.585l.029-.085c.253-.761.924-1.605 1.611-2.292"></path></g></svg>',1)),e("h3",Il,N(t(H)),1)]),e("div",zl,[e("div",Nl,[l(z,{text:"Refresh",color:"warning",icon:t(hs),click:()=>{fe()},loading:t(p)},null,8,["icon","click","loading"]),e("div",Zl,[l(Y,{items:t(x),modelValue:t(M),"onUpdate:modelValue":u[0]||(u[0]=B=>le(M)?M.value=B:null)},null,8,["items","modelValue"])]),e("div",Gl,[l(se,{wards:t(V).wards,"onUpdate:itemsSelected":Dt},null,8,["wards"])]),e("div",Yl,[e("div",Kl,[l(t(gs),{class:"w-5 h-5 mr-2"}),u[4]||(u[4]=re(" Date Range ")),e("div",Wl,[l(Ge,{required:"",position:"left",onCleared:Ft,placeholder:"select start & end date",range:!0,format:"dd/MM/yyyy","input-class-name":"datepicker",modelValue:t(k),"onUpdate:modelValue":u[1]||(u[1]=B=>le(k)?k.value=B:null),maxDate:new Date},null,8,["modelValue","maxDate"])])])])]),l(Ye,{onUpdate:Ze,search:t(D),"onUpdate:search":u[2]||(u[2]=B=>le(D)?D.value=B:null)},null,8,["search"])]),e("div",Xl,[(A(!0),U(ge,null,je(t(y),(B,oe)=>(A(),ce(Se,{value:B,close:"",color:"green",key:oe,onUpdate:jt},null,8,["value"]))),128))]),l(Be,{headers:t(S),data:t(I),loading:t(p),searchField:t(R),searchValue:t(h),serverItemsLength:t(a),serverOptions:t(g),onUpdate:ne},{actions:T(({item:B})=>[e("div",Ql,[e("div",Jl,[t(r)!==B.id?(A(),U("div",ea,[l(Re,{ref_key:"testsDialog",ref:C,onUpdate:ne,onOrder:J},{default:T(()=>[l(z,{color:"primary",text:"View",icon:t(kt),click:()=>{vt(B)}},null,8,["icon","click"])]),_:2},1536),B.status.toLowerCase()=="verified"&&B.test_type_name.toLowerCase()=="cross-match"&&B.post_crossmatch_process===null?(A(),ce(Ke,{key:0,item:B,onUpdate:ne},null,8,["item"])):te("",!0),B.status.toLowerCase()=="verified"&&B.test_type_name.toLowerCase()=="cross-match"&&B.post_crossmatch_process!==null&&B.post_crossmatch_process.transfusion_outcome===null?(A(),ce(ee,{key:1,item:B,onUpdate:ne},null,8,["item"])):te("",!0),B.status.toLowerCase()==="completed"&&("usePermissions"in i?i.usePermissions:t(He))().can.edit("test_results")?(A(),ce(z,{key:2,click:()=>{X({status:"completed"},B)},text:"Edit",color:"success",icon:t(ut)},null,8,["click","icon"])):te("",!0),(A(!0),U(ge,null,je(t(F),(oe,ft)=>Ne((A(),ce(z,{color:oe.color,text:oe.text,icon:oe.icon,click:()=>{X(oe,B)},key:ft},null,8,["color","text","icon","click"])),[[it,qt(B,oe)]])),128)),Ot(B)?(A(),ce(z,{key:3,color:"success",text:"Accept",icon:t(xs),click:()=>ae("accepted",B.order_id)},null,8,["icon","click"])):te("",!0)])):te("",!0),mt(B)?(A(),ce(z,{key:1,click:()=>m(B.id),color:"",text:"",icon:t(s)==!0?t(ws):t($s)},null,8,["click","icon"])):te("",!0)]),mt(B)&&t(r)==B.id?(A(),U("div",ta,[(A(!0),U(ge,null,je(j(B.status),(oe,ft)=>(A(),ce(Ee,{key:oe.name,item:B,text:oe.name,icon:oe.icon,action:oe.action,onUpdate:ne},null,8,["item","text","icon","action"]))),128))])):te("",!0)])]),_:1},8,["headers","data","loading","searchField","searchValue","serverItemsLength","serverOptions"]),u[5]||(u[5]=e("div",{id:"tests-container"},null,-1))])}}});export{Oa as default};
