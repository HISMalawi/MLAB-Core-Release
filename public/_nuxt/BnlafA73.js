import{_ as xe}from"./Bol9ycNB.js";import{_ as ge}from"./C_cqDzc_.js";import{P as $e}from"./C4zma4Cz.js";import{ah as Re,ai as we,d as z,a as Z,ag as ve,c as g,C as u,T as ee,r as S,aj as te,u as F,w as oe,o as H,y as A,b as d,e as m,g as t,ak as Ce,f as c,h as e,j as I,H as re,z as K,t as y,F as V,k as B,K as L,l as ne,E as se,_ as ae,al as ke,a2 as Te,N as Ne,L as Ee,am as Se}from"./BmFV7TB1.js";import{_ as le}from"./D9DsHv5v.js";import{_ as ie,a as ue}from"./BqdsqKCw.js";import{u as ce,_ as de}from"./c0sDrbOi.js";import{_ as pe}from"./DZlVrI-Y.js";import{u as me}from"./B-73Fo6s.js";import{r as _e}from"./BYZTNMi6.js";import{r as ye}from"./DIdvek0x.js";import{u as Ie}from"./Dv43YOs0.js";import"./BniLAAS6.js";import"./DOBYqiaw.js";const be=f=>Object.values(f).every(i=>i===null),fe=(f,i)=>{f.count!==0&&f.associated_ids!==""?i.$router.push(`/reports/${f.associated_ids}?origin=culture&type=culture-sensitivity-${f.type}-report&from=${f.date_filter}&to=${f.date_filter}&test=${f.test}&department=Microbiology&count=${f.count}`):i.$toast.warning("No data found for this month")},J=Re("culture",{state:()=>({currentRoute:{index:0,reportId:"",period:""},routes:[]}),actions:{setCurrentRoute(f,i,T){this.currentRoute.index=f,this.currentRoute.reportId=i,this.currentRoute.period=T||"",this.updateRoutes(f,i,T)},revertRoute(f){this.currentRoute.index=f,this.currentRoute.reportId="",this.updateRoutes(f,"")},updateRoutes(f,i,T){const E=this.routes.findIndex(N=>N.index===f);E!==-1?i!==""?(this.routes[E].reportId=i,this.routes[E].period=T||""):this.routes.splice(E,1):i!==""&&this.routes.push({index:f,reportId:i,period:T}),this.routes.sort((N,l)=>N.index-l.index)}},persist:{storage:sessionStorage}}),he=()=>{const f=we();return{replaceQuery:l=>f.replace({query:l}),removeQuery:l=>{const C={...f.currentRoute.value.query};return Object.keys(l).forEach($=>delete C[$]),f.replace({query:C})},removeAllQueries:()=>f.replace({query:{}}),replaceOneQuery:(l,C)=>{const $={...f.currentRoute.value.query};return $[l]=C[l],f.replace({query:$})}}},Me={class:"w-full flex items-center justify-between mb-10"},Oe={class:"flex flex-row items-center bg-gray-100 rounded-l pl-2 font-normal text-zinc-500"},Ge={class:"w-44 ml-2"},De={class:"w-48"},Ae={class:"rounded border",id:"print-container"},Ue={class:"rounded-tr rounded-tl border-b px-5 py-5 flex items-center justify-between"},Ye={class:"px-4 py-2.5 font-medium"},je={class:"font-normal"},Fe={key:0,class:"w-full mt-2",ref:"table"},Pe={class:"w-full border-b border-t bg-gray-100 rounded-t"},qe={class:"w-full"},Ve={class:"border-b"},Be={key:1,class:"flex flex-col space-y-3 items-center justify-center py-10"},Le=z({__name:"general-counts",async setup(f){let i,T;const E=Z("token"),N=me(),l=J(),C=ve(),$=g(()=>{const n=C.query.dateFrom;return n&&typeof n=="string"&&n.trim()!==""?u(n.split("/").join("-01-")).format(ee):""}),p=g(async()=>{const n=l.routes.find(a=>a.index==0);return(n==null?void 0:n.period)||""}),_=S(String(([i,T]=te(()=>p.value),i=await i,T(),i))),Y=he(),{$toast:M}=F(),{loading:R,executeCancellableRequest:s,cancelRequest:v}=ce(),x=S({Growth:{total:0,associated_ids:""},"No growth":{total:0,associated_ids:""},"Mixed growth; no predominant organism":{total:0,associated_ids:""},"Growth of normal flora; no pathogens isolated":{total:0,associated_ids:""},"Growth of contaminants":{total:0,associated_ids:""}}),G=S([{name:"Growth"},{name:"No Growth"},{name:"Mixed Growth:  No Predominant Organism"},{name:"Growth Normal Flora: No Pathogens Isolated"},{name:"Growth: Contaminations"}]),q=g(()=>G.value.map(n=>({NAME:n.name,COUNT:x.value[n.name]||0}))),O=(n,a,k)=>{Y.replaceOneQuery("revert",{revert:"true"}),fe({test:n,type:"General Counts",count:a,associated_ids:k,date_filter:u(_.value).format("YYYY-MM-DD")},F())},j=g(()=>_.value.length!==0?u(_.value).format("yyyy"):""),U=g(()=>_.value.length!==0?u(_.value).format("M"):"");async function r(){R.value=!0;const n=await o.value,a={route:`${ne.aggregateReports}culture/general_counts?year=${j.value}&month=${U.value}&report_id=${n||""}`,method:"GET",token:`${E.value}`},{data:k,error:D,pending:P}=await s(a);R.value=P,k.value&&(x.value=k.value,R.value=!1,l.setCurrentRoute(0,k.value.report_id,_.value),M.success("Report data generated successfully")),D.value&&(console.error(D.value),R.value=!1,M.error(se))}const o=g(async()=>{const n=l.routes.find(a=>a.index==0);return(n==null?void 0:n.reportId)||""});return oe(_,()=>{_&&l.setCurrentRoute(0,"")},{deep:!0}),H(async()=>{await o.value||$.value!==""?r():R.value=!1}),(n,a)=>{var w;const k=A("datepicker"),D=ae,P=le,Q=A("excel"),W=ue,h=de;return d(),m("div",null,[t("div",Me,[t("form",{onSubmit:a[1]||(a[1]=Ce(b=>r(),["prevent"])),class:"flex items-center space-x-5"},[t("div",Oe,[c(e(_e),{class:"w-4 h-4 mr-2"}),a[7]||(a[7]=I(" Filter by date ")),t("div",Ge,[c(k,{placeholder:"month & year",required:"","input-class-name":"custom-input",modelValue:e(_),"onUpdate:modelValue":a[0]||(a[0]=b=>re(_)?_.value=b:null),range:!1,format:"M/yyyy",position:"left"},null,8,["modelValue"])])]),t("div",De,[c(D,{type:"submit",color:"primary",text:"Generate Report",icon:e(ye),click:()=>{},loading:e(R)},null,8,["icon","loading"])])],32),t("div",null,[c(Q,{class:"btn btn-default",header:[`CULTURE & SENSITIVITY GENERAL COUNTS REPORT ${e(_)}`,e(N).details.name,e(N).details.address,e(N).details.phone,"",""],data:e(q),worksheet:"report-work-sheet",name:`culture_sensitivity_general_counts_report_${e(u)(e(_)).format("M_YYYY")}.xls`},{default:K(()=>[c(P,{text:"Export Excel",icon:"excel.png"})]),_:1},8,["header","data","name"])])]),t("div",Ae,[t("div",Ue,[a[8]||(a[8]=t("div",{class:"flex flex-col space-y-2"},[t("img",{src:pe,alt:"app-logo",class:"w-24 h-24 object-cover"}),t("h3",{class:"text-xl font-semibold"}," CULTURE & SENSITIVITY GENERAL COUNTS REPORT ")],-1)),c(W)]),t("div",null,[t("h3",Ye,[a[9]||(a[9]=I(" Data for period: ")),t("span",je,y(e(_)==""?" - ":e(u)(e(_)).format("M/yyyy")),1)])]),!("isObjectNull"in n?n.isObjectNull:e(be))(e(x))&&!e(R)?(d(),m("table",Fe,[t("thead",Pe,[t("tr",qe,[(d(!0),m(V,null,B(e(G),(b,X)=>(d(),m("th",{class:"px-2 py-2 border-r text-left uppercase",key:X},y(b.name),1))),128))])]),t("tbody",null,[t("tr",Ve,[t("td",{class:"px-2 py-2 border-r hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:a[2]||(a[2]=b=>O("Growth",e(x).Growth.total,e(x).Growth.associated_ids))},y(e(x).Growth.total),1),t("td",{class:"px-2 py-2 border-r hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:a[3]||(a[3]=b=>O("No growth",e(x)["No growth"].total,e(x)["No growth"].associated_ids))},y(e(x)["No growth"].total),1),t("td",{class:"px-2 py-2 border-r hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:a[4]||(a[4]=b=>{O("Mixed growth; no predominant organism",e(x)["Mixed growth; no predominant organism"].total,e(x)["Mixed growth; no predominant organism"].associated_ids)})},y(e(x)["Mixed growth; no predominant organism"].total),1),t("td",{class:"px-2 py-2 border-r hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:a[5]||(a[5]=b=>{O("Growth of normal flora; no pathogens isolated",e(x)["Growth of normal flora; no pathogens isolated"].total,e(x)["Growth of normal flora; no pathogens isolated"].associated_ids)})},y(e(x)["Growth of normal flora; no pathogens isolated"].total),1),t("td",{class:"px-2 py-2 hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:a[6]||(a[6]=b=>O("Growth of contaminants",e(x)["Growth of contaminants"].total,e(x)["Growth of contaminants"].associated_ids))},y((w=e(x)["Growth of contaminants"])==null?void 0:w.total),1)])])],512)):L("",!0),c(h,{condition:e(R),cancelReportGeneration:()=>e(v)()},null,8,["condition","cancelReportGeneration"]),("isObjectNull"in n?n.isObjectNull:e(be))(e(x))&&!e(R)?(d(),m("div",Be,a[10]||(a[10]=[t("img",{src:ie,class:"w-20 h-20 object-cover",alt:"page-icon"},null,-1),t("p",{class:"text-base"},[I(" Please generate report data to preview the "),t("span",{class:"font-medium"},"General Counts"),I(" report. ")],-1)]))):L("",!0)])])}}}),Qe={class:"w-full flex items-center justify-between mb-10"},We={class:"flex items-center space-x-5"},Ke={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},ze={class:"w-56 ml-2"},He={class:"w-48"},Je={class:"rounded border"},Xe={class:"rounded-tr rounded-tl border-b px-5 py-5 flex items-center justify-between"},Ze={class:"px-4 mt-2 font-medium"},et={class:"font-normal"},tt={key:0,id:"print-container"},ot={class:"w-full mt-3",ref:"table"},rt={class:"w-full border-b border-t bg-gray-50 rounded-t"},nt={class:"w-full"},st={class:"px-2 py-2 border-r"},at={class:"px-2 py-2 border-r"},lt={class:"px-2 py-2 border-r"},it=["onClick"],ut={key:1,class:"flex flex-col space-y-3 items-center justify-center py-10"},ct=z({__name:"wards-counts",async setup(f){let i,T;const E=S([{name:"Ward Name"},{name:"Ward Type"},{name:"Period"},{name:"Total Count"}]),N=Z("token"),l=S([]);ve();const C=me(),$=J();he();const{loading:p,executeCancellableRequest:_,cancelRequest:Y}=ce(),M=g(async()=>{const r=$.routes.find(o=>o.index==1);return(r==null?void 0:r.period)||""}),R=g(async()=>{const r=await M.value;return r&&typeof r=="string"&&r.trim()!==""?u(r.split("/").join("-01-")).format(ee):""}),s=S(String(([i,T]=te(()=>M.value),i=await i,T(),i))),v=()=>{s.value=""},x=g(()=>s.value.length!==0?u(s.value).format("yyyy"):""),G=g(()=>s.value.length!==0?u(s.value).format("M"):""),q=g(()=>E.value.flatMap(()=>l.value.map(r=>({WARD:r.ward,ENCOUNTER:r.encounter,"DATE PERIOD":u(s.value).format("MMMM-yyyy"),COUNT:r.count})))),O=(r,o,n)=>{fe({test:r,type:"General Counts",count:o,associated_ids:n,date_filter:u(s.value).format("YYYY-MM-DD")},F())};async function j(){p.value=!0;const r=await U.value,o={route:`${ne.aggregateReports}culture/wards_based_counts?year=${x.value}&month=${G.value}&report_id=${r||""}`,method:"GET",token:`${N.value}`},{data:n,error:a,pending:k}=await _(o);p.value=k,n.value&&(l.value=n.value.data,p.value=!1,$.setCurrentRoute(1,n.value.report_id,s.value),F().$toast.success("Report data generated successfully")),a.value&&(console.error(a.value),p.value=!1,F().$toast.error(se))}const U=g(async()=>{const r=$.routes.find(o=>o.index==1);return(r==null?void 0:r.reportId)||""});return oe(s,()=>{s&&$.setCurrentRoute(1,"")},{deep:!0}),H(async()=>{await U.value||await R.value!==""?j():p.value=!1}),(r,o)=>{const n=A("datepicker"),a=ae,k=A("FormKit"),D=le,P=A("excel"),Q=ue,W=de;return d(),m("div",null,[t("div",Qe,[c(k,{type:"form","submit-label":"Update",onSubmit:j,actions:!1},{default:K(()=>[t("div",We,[t("div",Ke,[c(e(_e),{class:"w-5 h-5 mr-2"}),o[1]||(o[1]=I(" Filter By Date Range ")),t("div",ze,[c(n,{onCleared:v,required:"",position:"left",placeholder:"select month & year",range:!1,"input-class-name":"datepicker",modelValue:e(s),"onUpdate:modelValue":o[0]||(o[0]=h=>re(s)?s.value=h:null),format:"M/yyyy"},null,8,["modelValue"])])]),t("div",He,[c(a,{type:"submit",color:"primary",text:"Generate Report",icon:e(ye),click:()=>{},loading:e(p)},null,8,["icon","loading"])])])]),_:1}),t("div",null,[c(P,{class:"btn btn-default",header:[`CULTURE & SENSITIVITY WARDS COUNTS REPORT ${e(u)(e(s)).format("M/yyyy")}`,e(C).details.name,e(C).details.address,e(C).details.phone],data:e(q),worksheet:"report-work-sheet",name:`culture_sensitivity_wards_counts_report_${e(u)(e(s)).format("M_yyyy")}.xls`},{default:K(()=>[c(D,{text:"Export Excel"})]),_:1},8,["header","data","name"])])]),t("div",Je,[t("div",Xe,[o[2]||(o[2]=t("div",{class:"flex flex-col space-y-2"},[t("img",{src:pe,alt:"app-logo",class:"w-24 h-24 object-cover"}),t("h3",{class:"text-xl font-semibold"}," CULTURE & SENSITIVITY WARDS COUNTS REPORT ")],-1)),c(Q)]),t("div",null,[t("h3",Ze,[o[3]||(o[3]=I(" Data for period: ")),t("span",et,y(e(s)==""?" - ":e(u)(e(s)).format("M/yyyy")),1)])]),e(l).length>0&&!e(p)?(d(),m("div",tt,[t("table",ot,[t("thead",rt,[t("tr",nt,[(d(!0),m(V,null,B(e(E),(h,w)=>(d(),m("th",{class:"px-2 py-2 border-r text-left uppercase",key:w},y(h.name),1))),128))])]),t("tbody",null,[(d(!0),m(V,null,B(e(l),(h,w)=>(d(),m("tr",{key:w,class:"border-b border-l border-r"},[t("td",st,y(h.ward),1),t("td",at,y(h.encounter),1),t("td",lt,y(e(s)==""?"":e(u)(e(s)).format("M/yyyy")),1),t("td",{class:"px-2 py-2 hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:b=>O(`Ward Based Counts - ${h.ward}, ${h.encounter}`,h.count,h.associated_ids)},y(h.count),9,it)]))),128))])],512)])):L("",!0),c(W,{condition:e(p),cancelReportGeneration:()=>e(Y)()},null,8,["condition","cancelReportGeneration"]),e(l).length==0&&!e(p)?(d(),m("div",ut,o[4]||(o[4]=[t("img",{src:ie,class:"w-20 h-20 object-cover",alt:"page-icon"},null,-1),t("p",{class:"text-base"},[I(" Please generate report data to preview the "),t("span",{class:"font-medium"},"General Counts"),I(" report. ")],-1)]))):L("",!0)])])}}}),dt={class:"w-full flex items-center justify-between mb-10"},pt={class:"flex items-center space-x-5"},mt={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},_t={class:"w-56 ml-2"},yt={class:"w-48"},ft={class:"rounded border",id:"print-container"},vt={class:"rounded-tr rounded-tl border-b px-5 py-5 flex items-center justify-between"},ht={class:"px-4 mt-2"},bt={class:"font-semibold"},xt={key:0},gt={class:"w-full mt-3",ref:"table"},$t={class:"w-full border-b border-t bg-gray-50 rounded-t"},Rt={class:"w-full"},wt={class:"px-2 py-2 text-left border-r"},Ct={class:"px-2 py-2 text-left border-r"},kt=["onClick"],Tt={key:1,class:"flex flex-col space-y-3 items-center justify-center py-10"},Nt=z({__name:"organisms-counts",async setup(f){let i,T;const E=S([{name:"Organism Name"},{name:"Period"},{name:"Total Count"}]),N=Z("token"),l=S([]),C=me(),$=J(),{loading:p,executeCancellableRequest:_,cancelRequest:Y}=ce(),M=g(async()=>{const r=$.routes.find(o=>o.index==2);return(r==null?void 0:r.period)||""}),R=g(async()=>{const r=await M.value;return r&&typeof r=="string"&&r.trim()!==""?u(r.split("/").join("-01-")).format(ee):""}),s=S(String(([i,T]=te(()=>M.value),i=await i,T(),i))),v=g(()=>l.value&&l.value.length>0?l.value.map(r=>({ORGANISM:r.organism,"DATE PERIOD":u(s.value).format("MMMM/yyyy"),COUNT:r.count})):[]),x=(r,o,n)=>{fe({test:r,type:"General Counts",count:o,associated_ids:n,date_filter:u(s.value).format("YYYY-MM-DD")},F())},G=()=>{s.value=""},q=g(()=>s.value.length!==0?u(s.value).format("yyyy"):""),O=g(()=>s.value.length!==0?u(s.value).format("M"):"");async function j(){p.value=!0;let r=await U.value;const o={route:`${ne.aggregateReports}culture/organisms_based_counts?year=${q.value}&month=${O.value}&report_id=${r||""}`,method:"GET",token:`${N.value}`},{data:n,error:a,pending:k}=await _(o);p.value=k,n.value&&(l.value=n.value.data,p.value=!1,$.setCurrentRoute(2,n.value.report_id,s.value),F().$toast.success("Report data generated successfully")),a.value&&(console.error(a.value),p.value=!1,F().$toast.error(se))}const U=g(async()=>{const r=$.routes.find(o=>o.index==2);return(r==null?void 0:r.reportId)||""});return oe(s,()=>{s&&$.setCurrentRoute(2,"")},{deep:!0}),H(async()=>{await U.value||await R.value!==""?j():p.value=!1}),(r,o)=>{const n=A("datepicker"),a=ae,k=A("FormKit"),D=le,P=A("excel"),Q=ue,W=de;return d(),m("div",null,[t("div",dt,[c(k,{type:"form","submit-label":"Update",onSubmit:j,actions:!1},{default:K(()=>[t("div",pt,[t("div",mt,[c(e(_e),{class:"w-5 h-5 mr-2"}),o[1]||(o[1]=I(" Filter By Date Range ")),t("div",_t,[c(n,{onCleared:G,required:"",position:"left",placeholder:"select month & year",range:!1,"input-class-name":"datepicker",modelValue:e(s),"onUpdate:modelValue":o[0]||(o[0]=h=>re(s)?s.value=h:null),format:"M/yyyy"},null,8,["modelValue"])])]),t("div",yt,[c(a,{type:"submit",color:"primary",text:"Generate Report",icon:e(ye),click:()=>{},loading:e(p)},null,8,["icon","loading"])])])]),_:1}),t("div",null,[c(P,{class:"btn btn-default",header:[`CULTURE & SENSITIVITY ORGANISMS COUNTS REPORT ${e(u)(e(s)).format("M/yyyy")}`,e(C).details.name,e(C).details.address,e(C).details.phone],data:e(v),worksheet:"report-work-sheet",name:`culture_sensitivity_organisms_counts_report_${e(u)(e(s)).format("M_yyyy")}.xls`},{default:K(()=>[c(D,{text:"Export Excel"})]),_:1},8,["header","data","name"])])]),t("div",ft,[t("div",vt,[o[2]||(o[2]=t("div",{class:"flex flex-col space-y-2"},[t("img",{src:pe,alt:"app-logo",class:"w-24 h-24 object-cover"}),t("h3",{class:"text-xl font-semibold"}," CULTURE & SENSITIVITY ORGANISMS COUNTS REPORT ")],-1)),c(Q)]),t("div",null,[t("h3",ht,[o[3]||(o[3]=I(" Data for period: ")),t("span",bt,y(e(s)==""?" - ":e(u)(e(s)).format("M/yyyy")),1)])]),e(l)!==void 0&&e(l).length>0&&!e(p)?(d(),m("div",xt,[t("table",gt,[t("thead",$t,[t("tr",Rt,[(d(!0),m(V,null,B(e(E),(h,w)=>(d(),m("th",{class:"px-2 py-2 border-r text-left uppercase",key:w},y(h.name),1))),128))])]),t("tbody",null,[(d(!0),m(V,null,B(e(l),(h,w)=>(d(),m("tr",{key:w,class:"border-b"},[t("td",wt,y(h.organism),1),t("td",Ct,y(e(s)==""?" - ":e(u)(e(s)).format("M/yyyy")),1),t("td",{class:"px-2 py-2 hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:b=>x(`Organisms Based Counts (${h.organism})`,h.count,h.associated_ids)},y(h.count),9,kt)]))),128))])],512)])):L("",!0),c(W,{condition:e(p),cancelReportGeneration:()=>e(Y)()},null,8,["condition","cancelReportGeneration"]),e(l)!==void 0&&e(l).length==0&&!e(p)?(d(),m("div",Tt,o[4]||(o[4]=[t("img",{src:ie,class:"w-20 h-20 object-cover",alt:"page-icon"},null,-1),t("p",{class:"text-base"},[I(" Please generate report data to preview the "),t("span",{class:"font-medium"},"Organisms Count"),I(" report. ")],-1)]))):L("",!0)])])}}}),Et={class:"w-full flex items-center justify-between mb-10"},St={class:"flex items-center space-x-5"},It={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},Mt={class:"w-56 ml-2"},Ot={class:"w-48"},Gt={class:"rounded border",id:"print-container"},Dt={class:"rounded-tr rounded-tl border-b px-5 py-5 flex items-center justify-between"},At={class:"px-4 mt-2 font-medium"},Ut={class:"font-normal"},Yt={key:0},jt={class:"w-full mt-3",ref:"table"},Ft={class:"w-full border-b border-t bg-gray-100 rounded-t"},Pt={class:"w-full"},qt={class:"px-2 py-2 text-center border-r"},Vt={class:"px-2 py-2 text-center border-r"},Bt={class:"px-2 py-2 text-center border-r"},Lt={class:"px-2 py-2 text-center border-r"},Qt=["onClick"],Wt={key:1,class:"flex flex-col space-y-3 items-center justify-center py-10"},Kt=z({__name:"organisms-wards-counts",async setup(f){let i,T;const E=S([{name:"Ward Name"},{name:"Ward Type"},{name:"Period"},{name:"Organism Name"},{name:"Total Count"}]);ve();const N=Z("token"),l=S([]),C=me(),$=J(),{$toast:p}=F(),{loading:_,executeCancellableRequest:Y,cancelRequest:M}=ce(),R=g(async()=>{const o=$.routes.find(n=>n.index==3);return(o==null?void 0:o.period)||""}),s=g(async()=>{const o=await R.value;return o&&typeof o=="string"&&o.trim()!==""?u(o.split("/").join("-01-")).format(ee):""}),v=S(String(([i,T]=te(()=>R.value),i=await i,T(),i))),x=g(()=>l.value.map(o=>({WARD:o.ward,ENCOUNTER:o.encounter,"DATE PERIOD":u(v.value).format(ke),ORGANISMS:o.organism,COUNT:o.count}))),G=(o,n,a)=>{fe({test:o,type:"General Counts",count:n,associated_ids:a,date_filter:u(v.value).format("YYYY-MM-DD")},F())},q=()=>{v.value=""},O=g(()=>v.value.length!==0?u(v.value).format("yyyy"):""),j=g(()=>v.value.length!==0?u(v.value).format("M"):"");async function U(){_.value=!0;let o=await r.value;const n={route:`${ne.aggregateReports}culture/organisms_wards_counts?year=${O.value}&month=${j.value}&report_id=${o||""}`,method:"GET",token:`${N.value}`},{data:a,error:k,pending:D}=await Y(n);_.value=D,a.value&&(l.value=a.value.data,_.value=!1,$.setCurrentRoute(3,a.value.report_id,v.value),p.success("Report data generated successfully")),k.value&&(console.error(k.value),_.value=!1,p.error(se))}oe(v,()=>{v&&$.setCurrentRoute(3,"")},{deep:!0});const r=g(async()=>{const o=$.routes.find(n=>n.index==3);return(o==null?void 0:o.reportId)||""});return H(async()=>{await r.value||await s.value!==""?U():_.value=!1}),(o,n)=>{const a=A("datepicker"),k=ae,D=A("FormKit"),P=le,Q=A("excel"),W=ue,h=de;return d(),m("div",null,[t("div",Et,[c(D,{type:"form","submit-label":"Update",onSubmit:U,actions:!1},{default:K(({value:w})=>[t("div",St,[t("div",It,[c(e(_e),{class:"w-5 h-5 mr-2"}),n[1]||(n[1]=I(" Filter By Date Range ")),t("div",Mt,[c(a,{onCleared:q,required:"",position:"left",placeholder:"select month & year",range:!1,"input-class-name":"datepicker",modelValue:e(v),"onUpdate:modelValue":n[0]||(n[0]=b=>re(v)?v.value=b:null),format:"M/yyyy"},null,8,["modelValue"])])]),t("div",Ot,[c(k,{type:"submit",color:"primary",text:"Generate Report",icon:e(ye),click:()=>{},loading:e(_)},null,8,["icon","loading"])])])]),_:1}),t("div",null,[c(Q,{class:"btn btn-default",header:[`CULTURE & SENSITIVITY ORGANISMS IN WARDS COUNTS REPORT ${e(u)(e(v)).format("M/yyyy")}`,e(C).details.name,e(C).details.address,e(C).details.phone],data:e(x),worksheet:"report-work-sheet",name:`culture_sensitivity_organisms_in_wards_counts_report_${e(u)(e(v)).format("M_yyyy")}.xls`},{default:K(()=>[c(P,{text:"Export Excel"})]),_:1},8,["header","data","name"])])]),t("div",Gt,[t("div",Dt,[n[2]||(n[2]=t("div",{class:"flex flex-col space-y-2"},[t("img",{src:pe,alt:"app-logo",class:"w-24 h-24 object-cover"}),t("h3",{class:"text-xl font-semibold"}," CULTURE & SENSITIVITY ORGANISMS IN WARDS COUNTS REPORT ")],-1)),c(W)]),t("div",null,[t("h3",At,[n[3]||(n[3]=I(" Data for period: ")),t("span",Ut,y(e(v)==""?"":e(u)(e(v)).format("M/yyyy")),1)])]),e(l).length>0&&!e(_)?(d(),m("div",Yt,[t("table",jt,[t("thead",Ft,[t("tr",Pt,[(d(!0),m(V,null,B(e(E),(w,b)=>(d(),m("th",{class:"px-2 py-2 border-r text-left uppercase",key:b},y(w.name),1))),128))])]),t("tbody",null,[(d(!0),m(V,null,B(e(l),(w,b)=>(d(),m("tr",{key:b,class:"border-b"},[t("td",qt,y(w.ward),1),t("td",Vt,y(w.encounter),1),t("td",Bt,y(e(v)==""?"":e(u)(e(v)).format("M/yyyy")),1),t("td",Lt,y(w.organism),1),t("td",{class:"px-2 py-2 hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:X=>G(`Organisms in Wards Counts (${w.organism}) - ${w.ward}, ${w.encounter}`,w.count,w.associated_ids)},y(w.count),9,Qt)]))),128))])],512)])):L("",!0),c(h,{condition:e(_),cancelReportGeneration:()=>e(M)()},null,8,["condition","cancelReportGeneration"]),e(l).length==0&&!e(_)?(d(),m("div",Wt,n[4]||(n[4]=[t("img",{src:ie,class:"w-20 h-20 object-cover",alt:"page-icon"},null,-1),t("p",{class:"text-base"},[I(" Please generate report data to preview the "),t("span",{class:"font-medium"},"Organisms in Wards Count"),I(" report. ")],-1)]))):L("",!0)])])}}}),zt={class:"w-full flex items-center justify-between mb-10"},Ht={class:"flex items-center space-x-5"},Jt={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},Xt={class:"w-56 ml-2"},Zt={class:"w-48"},eo={class:"rounded border",id:"print-container"},to={class:"rounded-tr rounded-tl border-b px-5 py-5 flex items-center justify-between"},oo={class:"px-4 mt-2 font-medium"},ro={class:"font-normal"},no={key:0},so={class:"w-full border-b border-t bg-gray-50 rounded-t"},ao={colspan:4,class:"text-left px-2 py-2"},lo={class:"border-r px-2 py-2 text-left"},io=["onClick"],uo=["onClick"],co=["onClick"],po={key:1,class:"w-full flex flex-col items-center justify-center space-y-2 py-10"},mo=z({__name:"ast",async setup(f){let i,T;const E=Z("token"),N=S([]),l=me(),C=J(),{$toast:$}=F(),{loading:p,executeCancellableRequest:_,cancelRequest:Y}=ce(),M=g(async()=>{const r=C.routes.find(o=>o.index==4);return(r==null?void 0:r.period)||""}),R=g(async()=>{const r=await M.value;return r&&typeof r=="string"&&r.trim()!==""?u(r.split("/").join("-01-")).format(ee):""}),s=S(String(([i,T]=te(()=>M.value),i=await i,T(),i))),v=g(()=>N.value.flatMap(r=>r.drugs.map(o=>({"DRUG NAME":o.drug_name,"INTERPRETATION I":o.interpretations.I.count,"INTERPRETATION R":o.interpretations.R.count,"INTERPRETATION S":o.interpretations.S.count})))),x=()=>{s.value=""},G=g(()=>s.value.length!==0?u(s.value).format("yyyy"):""),q=g(()=>s.value.length!==0?u(s.value).format("M"):""),O=(r,o,n)=>{fe({test:r,type:"General Counts",count:o,associated_ids:n,date_filter:u(s.value).format("YYYY-MM-DD")},F())};async function j(){p.value=!0;const r=await U.value,o={route:`${ne.aggregateReports}culture/ast?year=${G.value}&month=${q.value}&report_id=${r}`,method:"GET",token:`${E.value}`},{data:n,error:a,pending:k}=await _(o);p.value=k,n.value&&(N.value=n.value.data,p.value=!1,C.setCurrentRoute(4,n.value.report_id,s.value),$.success("Report data generated successfully")),a.value&&(console.error(a.value),p.value=!1,$.error(se))}oe(s,()=>{s&&C.setCurrentRoute(4,"")},{deep:!0});const U=g(async()=>{const r=C.routes.find(o=>o.index==4);return(r==null?void 0:r.reportId)||""});return H(async()=>{await U.value||await R.value!==""?j():p.value=!1}),(r,o)=>{const n=A("datepicker"),a=ae,k=A("FormKit"),D=le,P=A("excel"),Q=ue,W=de;return d(),m("div",null,[t("div",zt,[c(k,{type:"form","submit-label":"Update",onSubmit:j,actions:!1},{default:K(({value:h})=>[t("div",Ht,[t("div",Jt,[c(e(_e),{class:"w-5 h-5 mr-2"}),o[1]||(o[1]=I(" Filter By Date Range ")),t("div",Xt,[c(n,{onCleared:x,required:"",position:"left",placeholder:"select month & year",range:!1,"input-class-name":"datepicker",modelValue:e(s),"onUpdate:modelValue":o[0]||(o[0]=w=>re(s)?s.value=w:null),format:"M/yyyy"},null,8,["modelValue"])])]),t("div",Zt,[c(a,{type:"submit",color:"primary",text:"Generate Report",icon:e(ye),click:()=>{},loading:e(p)},null,8,["icon","loading"])])])]),_:1}),t("div",null,[c(P,{class:"btn btn-default",header:[`CULTURE & SENSITIVITY ANTIBIOTIC SUSCEPTIBILITY REPORT ${e(u)(e(s)).format("M/yyyy")}`,e(l).details.name,e(l).details.address,e(l).details.phone],data:e(v),worksheet:"report-work-sheet",name:`culture_sensitivity_antibiotic_susceptibility_report_${e(u)(e(s)).format("M_yyyy")}.xls`},{default:K(()=>[c(D,{text:"Export Excel"})]),_:1},8,["header","data","name"])])]),t("div",eo,[t("div",to,[o[2]||(o[2]=t("div",{class:"flex flex-col space-y-2"},[t("img",{src:pe,alt:"app-logo",class:"w-24 h-24 object-cover"}),t("h3",{class:"text-xl font-semibold"}," CULTURE & SENSITIVITY ANTIBIOTIC SUSCEPTIBILITY REPORT ")],-1)),c(Q)]),t("div",null,[t("h3",oo,[o[3]||(o[3]=I(" Data for period: ")),t("span",ro,y(e(s)==""?"":e(u)(e(s)).format("M/yyyy")),1)])]),e(N).length>0&&!e(p)?(d(),m("div",no,[(d(!0),m(V,null,B(e(N),(h,w)=>(d(),m("table",{key:w,class:"w-full mt-3",ref_for:!0,ref:"table"},[t("thead",so,[t("tr",null,[t("th",ao,y(h.name),1)]),o[4]||(o[4]=t("tr",{class:"border-r border-t"},[t("th",{class:"border-r px-2 py-2 text-left"},"Drug Name"),t("th",{class:"border-r px-2 py-2 text-center"},"I"),t("th",{class:"border-r px-2 py-2 text-center"},"R"),t("th",{class:"px-2 py-2 text-center"},"S")],-1))]),t("tbody",null,[(d(!0),m(V,null,B(h.drugs,b=>(d(),m("tr",{key:b,class:"border-b"},[t("td",lo,y(b.drug_name),1),t("td",{class:"border-r px-2 py-2 text-center hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:X=>O(`Antimicrobial Subsceptibility Testing (${h.name}) - ${b.drug_name}`,b.interpretations.I.count,b.interpretations.I.associated_ids)},y(b.interpretations.I.count),9,io),t("td",{class:"border-r px-2 py-2 text-center hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:X=>O(`Antimicrobial Subsceptibility Testing (${h.name}) - ${b.drug_name}`,b.interpretations.R.count,b.interpretations.R.associated_ids)},y(b.interpretations.R.count),9,uo),t("td",{class:"px-2 py-2 text-center hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:X=>O(`Antimicrobial Subsceptibility Testing (${h.name}) - ${b.drug_name}`,b.interpretations.S.count,b.interpretations.S.associated_ids)},y(b.interpretations.S.count),9,co)]))),128))])],512))),128))])):L("",!0),c(W,{condition:e(p),cancelReportGeneration:()=>e(Y)()},null,8,["condition","cancelReportGeneration"]),e(N).length==0&&!e(p)?(d(),m("div",po,o[5]||(o[5]=[t("img",{src:ie,alt:"page-icon",class:"object-cover w-20 h-20"},null,-1),t("p",null,"Data not found, please generate report",-1)]))):L("",!0)])])}}}),_o={class:"px-5 py-5"},yo={class:"flex items-center py-5"},fo={class:"text-2xl font-semibold uppercase"},vo={class:"font-medium bg-gray-100"},ho=["onClick"],bo={class:"mt-4"},Go=z({__name:"culture-sensitivity",setup(f){Ie({title:`${$e.name.toUpperCase()} - Culture & Sensitivity Report`});const i=J(),T=Te(),E=ve(),N=S("Culture & Sensitivity Report"),l=S(new Array("General Counts","Ward Based Counts","Organisms Based Count","Organisms in Wards Count","Antibiotic Susceptibility Test (AST)")),C=[Le,ct,Nt,Kt,mo],$=S(Number(E.query["current-tab"])||0),p=he(),_=S(new Array({name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"Aggregate Reports",link:"#"})),Y=R=>{var v;const s=((v=i.routes.find(x=>x.index===R))==null?void 0:v.reportId)||"";(s!==""||s!==void 0)&&p.replaceOneQuery("current-tab",{"current-tab":R})};H(()=>{const R=Number(T.currentRoute.value.query["current-tab"])||0;$.value=R,Y(R)});const M=R=>{$.value=R,Y(R)};return(R,s)=>{const v=xe;return d(),m("div",_o,[c(v,{pages:e(_)},null,8,["pages"]),t("div",yo,[s[0]||(s[0]=t("img",{src:ge,alt:"report-icon",class:"w-8 h-8 mr-2"},null,-1)),t("h3",fo,y(e(N)),1)]),t("div",null,[t("div",vo,[(d(!0),m(V,null,B(e(l),(x,G)=>(d(),m("button",{key:G,onClick:q=>M(G),class:Ne(e($)==G?"inline-block px-2 py-2 text-white bg-sky-500":"inline-block px-2 py-2 border-r hover:text-sky-500 transition duration-150")},y(x),11,ho))),128))]),t("div",bo,[(d(),Ee(Se(C[e($)])))])])])}}});export{Go as default};
