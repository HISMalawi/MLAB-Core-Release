import{_ as X}from"./Cx0ps7pt.js";import{_ as K}from"./CRXX2bJW.js";import{S as F,p as P,Y as R,G,V as N,q as U,z as L,a as Y,l as $,m as E,s as J,x as y,b as m,e as g,f as t,y as l,g as e,j as S,t as T,i as B,v as O,F as Q,k as W,_ as M,n as Z,d as A,r as p,h as c,u as q,E as ee,D as te,o as se,H as oe,C as ae}from"./CXJT-Lpc.js";import{r as ne}from"./B60x4Jja.js";import{r as le}from"./BGp3eUUx.js";import{r as z}from"./C6YNPTYJ.js";import{_ as j}from"./BaJf9vfg.js";import{_ as ie}from"./Cqdp_GdC.js";import{r as re}from"./eyAL3cGy.js";import{_ as ce}from"./CkLDbwQx.js";import{u as de}from"./CYhEBZLq.js";import{P as ue}from"./DsF3fssB.js";import{u as me}from"./Di1jx6Ca.js";import"./aXJyd3_m.js";import"./DnBD8KZ6.js";const pe={components:{TransitionRoot:F,TransitionChild:P,Dialog:R,DialogPanel:G,DialogTitle:N,XMarkIcon:U,ExclamationTriangleIcon:ne},data(){return{viewIcon:le,show:!1,loading:!1,editIcon:z,moment:L,cookie:Y("token"),organism:{}}},props:{data:{type:Object,required:!0}},methods:{handleClick(){this.show=!this.show},async init(){this.handleClick(),this.loading=!0;const D={route:`${$.organisms}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:o,error:w,pending:r}=await E(D);this.loading=r,o.value&&(this.organism=o.value,this.loading=!1),w.value&&(console.error("error loading organism data: ",w.value),this.loading=!1)}}},fe={class:"fixed inset-0 overflow-y-auto"},_e={class:"flex min-h-full items-center justify-center p-4 text-center"},ge={class:"border-b px-3 py-3 flex items-center justify-between"},ve={class:"flex items-center justify-center mx-auto my-20"},xe={class:"space-y-3 px-5 py-5"},he={class:"w-full flex flex-col space-y-1"},ye={class:"text-gray-600"},we={class:"w-full flex flex-col space-y-1"},be={key:0,class:"text-gray-600"},ke={key:1,class:"bg-red-50 py-2 px-2 flex items-center space-x-2"},Ce={class:"w-full flex flex-col space-y-1"},De={key:0,class:"text-gray-600"},Te={class:"list-disc pl-5 space-y-1"},$e={key:1,class:"text-gray-600"};function Ee(D,o,w,r,a,v){const f=M,b=y("TransitionChild"),k=y("DialogTitle"),_=y("XMarkIcon"),x=Z,C=y("ExclamationTriangleIcon"),n=y("DialogPanel"),d=y("Dialog"),i=y("TransitionRoot");return m(),g("div",null,[t(f,{click:v.init,color:"primary",text:"View",icon:a.viewIcon},null,8,["click","icon"]),t(i,{appear:"",show:a.show,as:"template"},{default:l(()=>[t(d,{as:"div",class:"relative z-10"},{default:l(()=>[t(b,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>o[1]||(o[1]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",fe,[e("div",_e,[t(b,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[t(n,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[e("div",ge,[t(k,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>{var s;return[o[2]||(o[2]=e("img",{src:j,class:"w-8 h-8 mr-2"},null,-1)),S(" View "+T((s=a.organism)==null?void 0:s.name),1)]}),_:1}),e("button",{onClick:o[0]||(o[0]=(...s)=>v.handleClick&&v.handleClick(...s))},[t(_,{class:"w-5 h-5"})])]),B(e("div",ve,[t(x,{loading:a.loading},null,8,["loading"])],512),[[O,a.loading]]),B(e("div",xe,[e("div",he,[o[3]||(o[3]=e("label",{class:"font-semibold text-lg"},"Preferred name",-1)),e("p",ye,T(a.organism.preferred_name),1)]),e("div",we,[o[5]||(o[5]=e("label",{class:"font-semibold text-lg"},"Description",-1)),a.organism.description?(m(),g("p",be,T(a.organism.description),1)):(m(),g("div",ke,[t(C,{class:"w-5 h-5 text-red-500 rounded-md"}),o[4]||(o[4]=e("p",{class:"text-red-500 font-medium"}," Description not found ",-1))]))]),e("div",Ce,[o[6]||(o[6]=e("label",{class:"font-semibold text-lg"},"Drugs",-1)),a.organism.drugs&&a.organism.drugs.length>0?(m(),g("div",De,[e("ul",Te,[(m(!0),g(Q,null,W(a.organism.drugs,s=>(m(),g("li",{key:s.id},T(s.name),1))),128))])])):(m(),g("p",$e,"No drugs associated with this organism"))])],512),[[O,!a.loading]])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const Ve=J(pe,[["render",Ee]]),Ie={class:"fixed inset-0 overflow-y-auto"},Pe={class:"flex min-h-full items-center justify-center p-4 text-center"},Se={class:"border-b px-3 py-3 flex items-center justify-between"},je={class:"mt-2 space-y-3 px-5"},Be={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"},Oe=A({__name:"index",props:{data:{}},emits:["update"],setup(D,{expose:o,emit:w}){const r=D,a=w,v=z,f=p(!1),b=re,k=p([]),_=p(!1),x=async()=>{n(),k.value=[];const i={route:`${$.organisms}/${r.data.id}`,method:"GET"},{error:s,data:u}=await E(i);u.value&&u.value.drugs.map(h=>{k.value.push(h.name)}),s.value&&console.error(s.value)},C=async()=>{_.value=!0;const i={route:`${$.organisms}/${r.data.id}`,method:"PUT",body:r.data},{pending:s,error:u,data:h}=await E(i);_.value=s,h.value&&(f.value=!1,q().$toast.success("Organism updated successfully!"),_.value=!1,a("update",!0)),u.value&&(f.value=!1,console.error(u.value),_.value=!1,q().$toast.error(ee))},n=()=>{f.value=!f.value},d=()=>{te("submitForm")};return o({init:x,handleClick:n,clearForm:d}),(i,s)=>{const u=M,h=y("FormKit"),V=ie;return m(),g("div",null,[t(u,{click:x,text:"Edit",color:"success",icon:c(v)},null,8,["icon"]),t(c(F),{appear:"",show:c(f),as:"template"},{default:l(()=>[t(c(R),{as:"div",class:"relative z-10"},{default:l(()=>[t(c(P),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>s[1]||(s[1]=[e("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-25"},null,-1)])),_:1}),e("div",Ie,[e("div",Pe,[t(c(P),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[t(c(G),{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[e("div",Se,[t(c(N),{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>s[2]||(s[2]=[e("img",{src:j,class:"w-8 h-8 mr-2"},null,-1),S(" Edit organism ")])),_:1}),e("button",{onClick:n},[t(c(U),{class:"w-5 h-5"})])]),t(h,{type:"form","submit-label":"Update",onSubmit:C,actions:!1,id:"submitForm"},{default:l(({value:I})=>[e("div",je,[t(h,{type:"text",label:"Preferred name",validation:"required",modelValue:i.data.preferred_name,"onUpdate:modelValue":s[0]||(s[0]=H=>i.data.preferred_name=H)},null,8,["modelValue"])]),e("div",Be,[t(V,{text:"Clear form",type:"button",click:()=>{d()}},null,8,["click"]),t(u,{loading:c(_),type:"submit",click:()=>{},color:"success",icon:c(b),text:"Save changes"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}}}),qe={class:"py-5 px-5"},Fe={class:"flex items-center justify-between py-5"},Re={class:"text-2xl font-semibold flex items-center uppercase"},Ge={class:"flex justify-end w-full px-2 py-2 mb-2"},Ne={class:"py-2 flex items-center space-x-2"},st=A({__name:"organisms",setup(D,{expose:o}){me({title:`${ue.name.toUpperCase()} - Organisms`});const w=p("Organisms"),r=p(!1),a=p(""),v=p(""),f=p([{text:"id",value:"id",sortable:!0},{text:"name",value:"name",sortable:!0},{text:"preferred name",value:"preferred_name",sortable:!0},{text:"nlims code",value:"nlims_code",sortable:!0},{text:"description",value:"description",sortable:!1,html:!0},{text:"actions",value:"actions",sortable:!1}]),b=p([]),k=p([{name:"Home",link:"/home"},{name:"Test Catalog",link:"#"}]),_=n=>{v.value=n,a.value=n},x=async()=>{r.value=!0;const n={route:$.organisms,method:"GET"},{data:d,error:i,pending:s}=await E(n);r.value=s,d.value&&(b.value=d.value,r.value=!1),i.value&&(console.error(i.value),r.value=!1)},C=n=>{n&&x()};return se(()=>{x()}),o({init:x,updateOrganisms:C}),(n,d)=>{const i=X,s=K,u=Ve,h=Oe,V=ce;return m(),g("div",qe,[t(i,{pages:k.value},null,8,["pages"]),e("div",Fe,[e("div",Re,[d[0]||(d[0]=e("img",{src:j,alt:"report-icon",class:"w-8 h-8 mr-2"},null,-1)),S(" "+T(w.value),1)])]),e("div",Ge,[t(s,{search:a.value,onUpdate:_},null,8,["search"])]),("usePermissions"in n?n.usePermissions:c(de))().can.manage("test_catalog")?(m(),oe(V,{key:0,headers:f.value,data:b.value,loading:r.value,"search-value":v.value},{actions:l(({item:I})=>[e("div",Ne,[t(u,{data:I},null,8,["data"]),t(h,{data:I,onUpdate:C},null,8,["data"])])]),_:1},8,["headers","data","loading","search-value"])):ae("",!0)])}}});export{st as default};
