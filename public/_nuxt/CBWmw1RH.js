import{_ as K}from"./EhL4ITZ8.js";import{b as r,e as l,g as e,d as M,r as g,a as T,I as A,bp as D,R as z,am as L,x as O,f as d,t as i,h as o,F as U,k as $,J as E,H as R,C as p,j as J,y as C,l as S,m as q,u as y,_ as G}from"./BXyMujmX.js";import{_ as Q}from"./B8Os4NL5.js";import{P as W}from"./CrZr7riT.js";import{u as X}from"./BrSykilB.js";import{r as Y}from"./Cdb0w5fP.js";import{r as ee}from"./CHOuZIuX.js";import"./9_0iIVXm.js";import"./B1ZrIgkL.js";function se(H,x){return r(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M4.5 3.75a3 3 0 0 0-3 3v10.5a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3V6.75a3 3 0 0 0-3-3h-15Zm4.125 3a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Zm-3.873 8.703a4.126 4.126 0 0 1 7.746 0 .75.75 0 0 1-.351.92 7.47 7.47 0 0 1-3.522.877 7.47 7.47 0 0 1-3.522-.877.75.75 0 0 1-.351-.92ZM15 8.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15ZM14.25 12a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H15a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15Z","clip-rule":"evenodd"})])}const te={class:"px-5 py-5 mx-auto"},oe={class:"mb-8"},ae={class:"bg-white rounded border p-6 mb-8"},re={class:"flex items-center space-x-5"},le={class:"space-y-1"},ne={class:"text-xl font-bold text-gray-800"},de={class:"text-gray-600 text-sm"},ie={class:"bg-white rounded border overflow-hidden"},ue={class:"border-b"},me={class:"flex"},ce=["onClick"],pe={class:"flex items-center"},ge={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-sky-600"},ve={key:0,class:"p-6"},_e={class:"space-y-6"},fe={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},be={class:"bg-gray-50 rounded-lg p-4"},ye={class:"mt-1 text-gray-900 font-semibold"},xe={class:"bg-gray-50 rounded-lg p-4"},he={class:"mt-1 text-gray-900 font-semibold"},we={class:"bg-gray-50 rounded-lg p-4"},ke={class:"mt-1 text-gray-900 font-semibold"},Ue={class:"bg-gray-50 rounded-lg p-4"},$e={class:"mt-1 text-gray-900 font-semibold"},Ce={class:"bg-gray-50 rounded-lg p-4"},Pe={class:"mt-1 text-gray-900 font-semibold"},Ve={class:"bg-gray-50 rounded-lg p-4"},Ne={class:"mt-2 flex flex-wrap gap-2"},Be={key:0,class:"text-gray-500 italic"},Re={class:"bg-gray-50 rounded-lg p-4"},Se={class:"mt-2 flex flex-wrap gap-2"},qe={key:0,class:"text-gray-500 italic"},He={key:1,class:"p-6"},Ze={class:"bg-white border border-gray-200 rounded-lg mb-8"},Fe={class:"p-5"},je={class:"flex items-center justify-end mt-5"},Ie={class:"bg-white border border-gray-200 rounded-lg"},Ke={class:"p-5"},Me={class:"space-y-4"},Te={class:"flex items-center justify-end mt-6"},Xe=M({__name:"settings",setup(H){X({title:`${W.name.toUpperCase()} - Settings`});const x=ee,Z=[{name:"Home",link:"/home"}],F=["Personal Information","Credentials"],v=g(0),_=g(!1),f=g(!1),P=T("token"),h=g(""),w=g(""),k=g(""),t=A(),m=D(),V=z(),N=L(),j=async()=>{_.value=!0;const b={route:`${S.users}/change_password/${t.user.id}`,method:"PUT",token:`${P.value}`,body:{user:{old_password:h.value,password:w.value}}},{data:s,error:u,pending:n}=await q(b);_.value=n,s.value&&(m.path&&m.path!=="/"&&m.path!=="/login"&&N.lastKnownRoute(m.path),_.value=!1,y().$toast.success("Password changed successfully!"),t.logUserOut(),V.push("/")),u.value&&(_.value=!1,y().$toast.error(`${u.value.data.error}`),console.error(u.value))},I=async()=>{f.value=!0;const b={route:`${S.users}/change_username/${t.user.id}`,method:"PUT",token:`${P.value}`,body:{user:{username:k.value}}},{data:s,error:u,pending:n}=await q(b);f.value=n,s.value&&(m.path&&m.path!=="/"&&m.path!=="/login"&&N.lastKnownRoute(m.path),f.value=!1,y().$toast.success("Username changed successfully!"),t.logUserOut(),V.push("/")),u.value&&(f.value=!1,y().$toast.error(`${u.value.data.error}`),console.error(u.value))};return(b,s)=>{const u=K,n=O("FormKit"),B=G;return r(),l("div",te,[e("div",oe,[d(u,{pages:Z})]),e("div",ae,[e("div",re,[s[3]||(s[3]=e("div",{class:"relative"},[e("div",{class:"bg-gradient-to-r from-gray-200 to-zinc-300 rounded-full p-1"},[e("img",{src:Q,class:"w-20 h-20 object-cover rounded-full border border-white",alt:"user-icon"})])],-1)),e("div",le,[e("h3",ne,i(o(t).user.username),1),e("p",de,i(`${o(t).user.first_name} ${o(t).user.last_name}`),1)])])]),e("div",ie,[e("div",ue,[e("div",me,[(r(),l(U,null,$(F,(c,a)=>e("button",{key:a,onClick:Ae=>v.value=a,class:E(["px-6 py-4 font-medium focus:outline-none transition duration-200 ease-in-out relative",v.value===a?"text-sky-500 hover:text-sky-600":"text-gray-600 hover:text-gray-800"])},[e("div",pe,[a==0?(r(),R(o(se),{key:0,class:"w-5 h-5 mr-2"})):p("",!0),a==1?(r(),R(o(Y),{key:1,class:"w-5 h-5 mr-2"})):p("",!0),J(" "+i(c),1)]),v.value===a?(r(),l("div",ge)):p("",!0)],10,ce)),64))])]),v.value===0?(r(),l("div",ve,[s[11]||(s[11]=e("h2",{class:"text-xl font-bold text-gray-800 mb-6"}," Personal Information ",-1)),e("div",_e,[e("div",fe,[e("div",be,[s[4]||(s[4]=e("label",{class:"text-sm font-medium text-gray-500"},"Username",-1)),e("p",ye,i(o(t).user.username),1)]),e("div",xe,[s[5]||(s[5]=e("label",{class:"text-sm font-medium text-gray-500"},"First name",-1)),e("p",he,i(o(t).user.first_name),1)]),e("div",we,[s[6]||(s[6]=e("label",{class:"text-sm font-medium text-gray-500"},"Middle name",-1)),e("p",ke,i(o(t).user.middle_name||"-"),1)]),e("div",Ue,[s[7]||(s[7]=e("label",{class:"text-sm font-medium text-gray-500"},"Last name",-1)),e("p",$e,i(o(t).user.last_name),1)]),e("div",Ce,[s[8]||(s[8]=e("label",{class:"text-sm font-medium text-gray-500"},"Date of Birth",-1)),e("p",Pe,i(o(t).user.date_of_birth||"-"),1)])]),e("div",Ve,[s[9]||(s[9]=e("label",{class:"text-sm font-medium text-gray-500"},"Roles",-1)),e("div",Ne,[(r(!0),l(U,null,$(o(t).user.roles,(c,a)=>(r(),l("div",{key:a,class:"bg-blue-50 text-blue-700 text-sm px-3 py-1 rounded-full border border-blue-200"},i(c.role_name),1))),128)),!o(t).user.roles||o(t).user.roles.length===0?(r(),l("div",Be," No roles assigned ")):p("",!0)])]),e("div",Re,[s[10]||(s[10]=e("label",{class:"text-sm font-medium text-gray-500"},"Departments",-1)),e("div",Se,[(r(!0),l(U,null,$(o(t).user.departments,(c,a)=>(r(),l("div",{key:a,class:"bg-green-50 text-green-700 text-sm px-3 py-1 rounded-full border border-green-200"},i(c.name),1))),128)),!o(t).user.departments||o(t).user.departments.length===0?(r(),l("div",qe," No departments assigned ")):p("",!0)])])])])):p("",!0),v.value===1?(r(),l("div",He,[s[14]||(s[14]=e("h2",{class:"text-xl font-bold text-gray-800 mb-6"},"Credentials",-1)),e("div",Ze,[s[12]||(s[12]=e("div",{class:"p-5 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Update Username"),e("p",{class:"mt-1 text-sm text-gray-500"}," Please enter your desired username below and save changes. ")],-1)),e("div",Fe,[d(n,{type:"form","submit-label":"Update",onSubmit:I,actions:!1},{default:C(({value:c})=>[d(n,{type:"text",name:"username",label:"Username",validation:"required",modelValue:k.value,"onUpdate:modelValue":s[0]||(s[0]=a=>k.value=a)},null,8,["modelValue"]),e("div",je,[d(B,{type:"submit",icon:o(x),text:"Update Username",color:"success",click:()=>{},loading:f.value},null,8,["icon","loading"])])]),_:1})])]),e("div",Ie,[s[13]||(s[13]=e("div",{class:"p-5 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Change Password"),e("p",{class:"mt-1 text-sm text-gray-500"}," Please enter your current password to change your password. ")],-1)),e("div",Ke,[d(n,{type:"form","submit-label":"Update",onSubmit:j,actions:!1},{default:C(({value:c})=>[e("div",Me,[d(n,{type:"password",label:"Current Password",validation:"required",modelValue:h.value,"onUpdate:modelValue":s[1]||(s[1]=a=>h.value=a)},null,8,["modelValue"]),d(n,{type:"group"},{default:C(()=>[d(n,{type:"password",name:"password",label:"New Password",validation:"required",modelValue:w.value,"onUpdate:modelValue":s[2]||(s[2]=a=>w.value=a),"validation-visibility":"live"},null,8,["modelValue"]),d(n,{type:"password",label:"Confirm New Password",name:"password_confirm",validation:"required|confirm","validation-label":"Password confirmation","validation-visibility":"live"})]),_:1})]),e("div",Te,[d(B,{type:"submit",icon:o(x),text:"Update Password",color:"success",click:()=>{},loading:_.value},null,8,["icon","loading"])])]),_:1})])])])):p("",!0)])])}}});export{Xe as default};
