import{m as U,x as v,a as V,I as M,g as I,o as n,c as l,e,d as a,h as g,l as t,i as T,z as F,t as c,F as R,r as w,k as E,w as O,v as P,b as k,f as L}from"./entry.c8b97972.js";import{_ as j}from"./ExportButton.vue.e6a12942.js";import{_ as G}from"./Address.vue.0d639059.js";import{_ as Y}from"./Loader.f38c629c.js";import{e as q}from"./constants.4bf506ff.js";import{_ as z}from"./logo.1e847ed6.js";import{_ as K}from"./page.5debc647.js";import{h as p,e as H,f as J}from"./fetch.ea357659.js";import{u as Q}from"./facility.7951e6d0.js";import{r as W}from"./FunnelIcon.2e7a75d7.js";import{r as X}from"./ArrowPathIcon.f95a5ec2.js";import"./transition.3ae60caf.js";import"./hidden.2f662773.js";import"./XMarkIcon.da38a054.js";import"./PencilSquareIcon.2f7e2bec.js";import"./PrinterIcon.a795ed09.js";const Z={class:"w-full flex items-center justify-between mb-10"},ee={class:"flex items-center space-x-5"},te={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},oe={class:"w-56 ml-2"},se={class:"w-48"},re={class:"rounded border",id:"print-container"},ae={class:"rounded-tr rounded-tl border-b px-5 py-5 flex items-center justify-between"},ne=e("div",{class:"flex flex-col space-y-2"},[e("img",{src:z,alt:"app-logo",class:"w-24 h-24 object-cover"}),e("h3",{class:"text-xl font-semibold"},"CULTURE & SENSITIVITY ANTIBIOTIC SUSCEPTIBILITY REPORT ")],-1),le={class:"px-4 mt-2 font-medium"},ce={class:"font-normal"},ie={key:0},de={class:"w-full border-b border-t bg-gray-50 rounded-t"},pe={colspan:4,class:"text-left px-2 py-2"},_e=e("tr",{class:"border-r border-t"},[e("th",{class:"border-r px-2 py-2 text-left"}," Drug Name "),e("th",{class:"border-r px-2 py-2 text-center"}," I "),e("th",{class:"border-r px-2 py-2 text-center"}," R "),e("th",{class:"px-2 py-2 text-center"}," S ")],-1),me={class:"border-r px-2 py-2 text-left"},ue={class:"border-r px-2 py-2 text-center"},fe={class:"border-r px-2 py-2 text-center"},ye={class:"px-2 py-2 text-center"},he={class:"w-full items-center flex flex-col space-y-2 my-10"},xe=e("p",null,[T("Generating report, please wait"),e("span",{class:"animate-pulse"},"...")],-1),be={key:1,class:"w-full flex flex-col items-center justify-center space-y-2 py-10"},ve=e("img",{src:K,alt:"page-icon",class:"object-cover w-20 h-20"},null,-1),Ie=e("p",null,"Data not found, please generate report",-1),Te=[ve,Ie],Pe=U({__name:"ast",setup(ge){const o=v(""),N=V("token"),r=v(!1),i=v([]),f=Q(),C=M(()=>i.value.flatMap(_=>_.drugs.map(s=>({"DRUG NAME":s.drug_name,"INTERPRETATION I":s.interpretations.I,"INTERPRETATION R":s.interpretations.R,"INTERPRETATION S":s.interpretations.S})))),S=()=>{o.value=""};async function $(){r.value=!0;let _=p(o.value).format("M"),s=p(o.value).format("yyyy");const y={route:`${H.aggregateReports}culture/ast?year=${s}&month=${_}`,method:"GET",token:`${N.value}`},{data:m,error:u,pending:h}=await J(y);r.value=h,m.value&&(i.value=m.value.data,r.value=!1,k().$toast.success("Report data generated successfully")),u.value&&(console.error(u.value),r.value=!1,k().$toast.error(q))}return(_,s)=>{const y=I("datepicker"),m=L,u=I("FormKit"),h=j,B=I("excel"),A=G,D=Y;return n(),l("div",null,[e("div",Z,[a(u,{type:"form","submit-label":"Update",onSubmit:$,actions:!1},{default:g(({value:x})=>[e("div",ee,[e("div",te,[a(t(W),{class:"w-5 h-5 mr-2"}),T(" Filter By Date Range "),e("div",oe,[a(y,{onCleared:S,required:"",position:"left",placeholder:"select month & year",range:!1,"input-class-name":"datepicker",modelValue:t(o),"onUpdate:modelValue":s[0]||(s[0]=b=>F(o)?o.value=b:null),format:"M/yyyy"},null,8,["modelValue"])])]),e("div",se,[a(m,{type:"submit",color:"primary",text:"Generate Report",icon:t(X),click:()=>{},loading:t(r)},null,8,["icon","loading"])])])]),_:1}),e("div",null,[a(B,{class:"btn btn-default",header:[`CULTURE & SENSITIVITY ANTIBIOTIC SUSCEPTIBILITY REPORT ${t(p)(t(o)).format("M/yyyy")}`,t(f).details.name,t(f).details.address,t(f).details.phone],data:t(C),worksheet:"report-work-sheet",name:`culture_sensitivity_antibiotic_susceptibility_report_${t(p)(t(o)).format("M_yyyy")}.xls`},{default:g(()=>[a(h,{text:"Export Excel"})]),_:1},8,["header","data","name"])])]),e("div",re,[e("div",ae,[ne,a(A)]),e("div",null,[e("h3",le,[T("Data for period: "),e("span",ce,c(t(o)==""?"":t(p)(t(o)).format("M/yyyy")),1)])]),t(i).length>0&&!t(r)?(n(),l("div",ie,[(n(!0),l(R,null,w(t(i),(x,b)=>(n(),l("table",{key:b,class:"w-full mt-3",ref_for:!0,ref:"table"},[e("thead",de,[e("tr",null,[e("th",pe,c(x.name),1)]),_e]),e("tbody",null,[(n(!0),l(R,null,w(x.drugs,d=>(n(),l("tr",{key:d,class:"border-b border-r border-l"},[e("td",me,c(d.drug_name),1),e("td",ue,c(d.interpretations.I),1),e("td",fe,c(d.interpretations.R),1),e("td",ye,c(d.interpretations.S),1)]))),128))])],512))),128))])):E("",!0),O(e("div",he,[a(D),xe],512),[[P,t(r)]]),t(i).length==0&&!t(r)?(n(),l("div",be,Te)):E("",!0)])])}}});export{Pe as default};
