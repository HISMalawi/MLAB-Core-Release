import{_ as D}from"./BSOqz5j4.js";import{D as C,C as m,a as M,O as y,x as A,y as g,b as l,e as p,f as i,g as e,t as n,N as x,z as b,F as k,k as v,L as I,am as O,K as _,j as Y,i as L,v as N,h as B,_ as V,n as j}from"./27gxMGx-.js";import{_ as P}from"./BpUhCbQO.js";import{u as F}from"./B9AAm1fp.js";import{S as R}from"./4D4NST6H.js";import{a as K,n as G}from"./Ck4zeF2r.js";import{P as H}from"./Dj9465vM.js";import{u as U}from"./BXtJ-a5P.js";import{r as X}from"./DoApyDiL.js";import{r as q}from"./UdSMLOvr.js";import{r as z}from"./D5wPj_8W.js";import{r as W}from"./DP4PBieG.js";import{r as J}from"./CPIF0v1P.js";import{_ as E}from"./BZuVrphp.js";import{_ as Q}from"./DBmflaAt.js";import"./DPOyO2jd.js";import"./eODTOUMG.js";import"./DPrp5pRO.js";import"./C7om58M4.js";import"./Dmqlm_CE.js";import"./BkCxw8YQ.js";import"./DZR_JJ-2.js";import"./BgDFElE0.js";import"./CQnnh4jB.js";const Z={setup(){U({title:`${H.name.toUpperCase()} - Stock Reports`})},components:{ExportToExcel:K,ExportToWord:G,ExclamationCircleIcon:X,CheckCircleIcon:q,ExclamationTriangleIcon:C,ArchiveBoxXMarkIcon:z},data(){return{moment:m,header:"Stock Reports",facility:F(),tab:0,generating:!1,dateRange:[],pages:[{name:"Home",link:"/home"},{name:"Stock Management",link:"#"}],reportData:new Array,generateIcon:W,exportIcon:J,cookie:M("token"),transactionTypes:new Array,selectedType:{name:"-- select type --"}}},created(){this.init()},computed:{generalStockExportData(){return this.reportData.map(o=>({"STOCK ITEM":o.name,DESCRIPTION:o.description,BALANCE:o.consolidated_available_balance,"MINIMUM ORDER LEVEL":o.minimum_order_level,LOCATION:o.stock_location,CATEGORY:o.stock_category,STRENGTH:o.strength,BATCH:o.batch,"LOT NUMBER":o.lot,"TRANSACTION TYPE":o.transaction_type,"EXPIRY DATE":m(o.expiry_date).format(y),RECEIVER:o.receiving_from,SENDER:o.sending_to,REMAKRS:this.checkStock(o)}))},stockMovementExportData(){return this.reportData.map(o=>({"Stock Item":o.name,TYPE:o.transaction_type,"STOCK BEFORE":o.overall_stock_balance_before_transaction,ADJUSTMENT:o.transacted_quantity,"STOCK AFTER":o.overall_stock_balance_after_transaction,DATE:m(o.transaction_date).format(y)}))},generalStockData(){return this.reportData.map(o=>({...o,remarks:this.checkStock(o)}))},getStockClass(){return o=>{const t=(o||"").toLowerCase();return t==="not expired"?"text-green-600":t==="expired"?"text-red-600":t==="near expiry"?"text-yellow-500":t==="out of stock"?"text-gray-600":""}},getStockIcon(){return o=>{const t=(o||"").toLowerCase();return t==="not expired"?"CheckCircleIcon":t==="expired"||t==="near expiry"?"ExclamationTriangleIcon":t==="out of stock"?"ArchiveBoxXMarkIcon":"div"}},getStockText(){return o=>{const t=(o||"").toLowerCase();return t==="not expired"?"":t==="expired"?"Expired":t==="near expiry"?"Near Expiry":t==="out of stock"?"Out of Stock":""}}},methods:{checkStock(o){let t=this.checkExpiryStatus(o);if(t=="Not Expired")if(o.after_transaction_remaining_balance>0){if(o.after_transaction_remaining_balance<o.minimum_order_level)return"Low Stock"}else return"Out of Stock";else return t},checkExpiryStatus(o){const t=new Date;t.setHours(0,0,0,0);const c=new Date(o.expiry_date);if(c.setHours(0,0,0,0),c<t)return"Expired";const d=new Date;return d.setDate(t.getDate()+14),c<=d?"Near Expiry":"Not Expired"},async init(){const o=new R,{data:t,error:c,pending:d}=await o.getStockTransactionTypes(`${this.cookie}`);t.value&&(this.transactionTypes=t.value),c.value&&console.error(c.value)},async generateStockReport(){this.generating=!0;const o=this.dateRange!==null&&this.dateRange.length>0?m(this.dateRange[0]).format("YYYY-MM-DD"):"",t=this.dateRange!==null&&this.dateRange.length>1?m(this.dateRange[1]).format("YYYY-MM-DD"):"",c=this.selectedType.name=="-- select type --"?"":this.selectedType.name,d=new R,{data:r,error:a,pending:f}=await d.generateStockMovementReport(`${this.cookie}`,c,o,t);this.generating=f,r.value&&(this.reportData=r.value.data,this.generating=!1),a.value&&(console.error(a.value),this.generating=!1)}}},$={class:"px-5 py-5"},ee={class:"flex items-center justify-between py-5"},te={class:"text-2xl font-semibold"},re={class:"flex items-center space-x-2 bg-gray-50"},oe={key:0,class:"py-5"},se={class:"w-full flex items-center justify-between py-5"},ne={class:"flex items-center space-x-2"},ae={class:"flex items-center space-x-2"},le={id:"print-container1"},ie={class:"w-full bg-gray-50 rounded-t px-10 py-5"},ce={class:"flex items-center justify-between px-5"},pe={class:"py-5"},de={class:"uppercase font-medium"},me={class:"uppercase font-medium"},ue={class:"uppercase font-medium"},_e={class:"w-full"},fe={class:"w-full"},xe={class:"px-2 py-2 text-left border-r border-l"},ye={class:"px-2 py-2 text-left border-r border-l"},he={class:"px-2 py-2 text-left border-r border-l"},ge={class:"px-2 py-2 text-left border-r border-l text-green-500"},be={class:"px-2 py-2 text-left border-r border-l"},ke={class:"px-2 py-2 text-left border-r border-l"},ve={key:1,class:"px-3 py-3"},Re={class:"flex items-center justify-between py-5"},Ee={class:"flex items-center space-x-2"},Te={class:"border rounded mt-10",id:"print-container"},we={class:"w-full bg-gray-50 rounded-t border-b px-10 py-5"},Se={class:"flex items-center justify-between px-5"},De={class:"py-5"},Ce={class:"uppercase font-medium"},Me={class:"uppercase font-medium"},Ae={class:"uppercase font-medium"},Ie={class:"px-3 py-3"},Oe={class:"mb-2"},Ye={class:"font-medium mb-2"},Le={class:"text-normal font-normal"},Ne={class:"flex itmes-center mx-auto justify-center py-20"},Be={key:0,class:"w-full"},Ve={class:"w-full"},je={class:"px-2 py-2 text-left border-r border-l"},Pe={class:"px-2 py-2 text-left border-r border-l"},Fe={class:"px-2 py-2 text-left border-r border-l"},Ke={class:"px-2 py-2 text-left border-r border-l"},Ge={class:"px-2 py-2 text-left border-r border-l"},He={class:"px-2 py-2 text-left border-r border-l"},Ue={key:0,class:"flex flex-col space-y-3 items-center justify-center"};function Xe(o,t,c,d,r,a){const f=D,u=V,h=g("excel"),T=g("datepicker"),w=P,S=j;return l(),p("div",$,[i(f,{pages:r.pages},null,8,["pages"]),e("div",ee,[e("h3",te,n(r.header),1)]),e("div",null,[e("div",re,[e("button",{onClick:t[0]||(t[0]=s=>r.tab=0),class:x(r.tab==0?"bg-sky-500 text-white py-2 px-4":"font-medium px-4 text-gray-600 hover:text-sky-500 transition duration-150")}," General Stock ",2),e("button",{onClick:t[1]||(t[1]=s=>r.tab=1),class:x(r.tab==1?"bg-sky-500 text-white py-2 px-4":"font-medium px-4 text-gray-600 hover:text-sky-500 transition duration-150")}," Stock Movements ",2)]),r.tab==0?(l(),p("div",oe,[e("div",null,[e("div",se,[e("div",ne,[i(u,{loading:r.generating,click:()=>{a.generateStockReport()},text:"Generate Report",color:"success",icon:r.generateIcon},null,8,["loading","click","icon"])]),e("div",ae,[i(h,{class:"btn btn-default",header:["GENERAL STOCK LABORATORY REPORT",r.facility.details.name,r.facility.details.address,r.facility.details.phone],data:a.generalStockExportData,worksheet:"report-work-sheet",name:"general_stock_laboratory.xls"},{default:b(()=>[i(u,{color:"success",click:()=>{},icon:r.exportIcon,text:"Export"},null,8,["icon"])]),_:1},8,["header","data"])])]),e("div",le,[e("table",ie,[e("tbody",null,[e("tr",ce,[t[5]||(t[5]=e("td",null,[e("img",{src:E,alt:"app-logo",class:"w-24 h-24 object-cover"})],-1)),e("td",pe,[e("p",de,n(r.facility.details.name),1),e("p",me,n(r.facility.details.address),1),e("p",ue,n(r.facility.details.phone),1),t[4]||(t[4]=e("p",{class:"uppercase font-medium underline"},"Laboratory Report",-1))])])])]),e("table",_e,[t[6]||(t[6]=e("thead",{class:"w-full"},[e("tr",{class:"border bg-gray-50"},[e("th",{class:"px-2 py-2 text-left border-r"},"Stock Item"),e("th",{class:"px-2 py-2 text-left border-r"},"Location"),e("th",{class:"px-2 py-2 text-left border-r"},"Batch"),e("th",{class:"px-2 py-2 text-left border-r"},"Lot"),e("th",{class:"px-2 py-2 text-left border-r"},"Quantity"),e("th",{class:"px-2 py-2 text-left border-r"},"Remarks")])],-1)),e("tbody",fe,[(l(!0),p(k,null,v(a.generalStockData,s=>(l(),p("tr",{class:"w-full border-b",key:s.id},[e("td",xe,n(s.name),1),e("td",ye,n(s.stock_location),1),e("td",he,n(s.batch),1),e("td",ge,"#"+n(s.lot),1),e("td",be,n(s.consolidated_available_balance),1),e("td",ke,[e("div",{class:x(["flex items-center space-x-1",a.getStockClass(s==null?void 0:s.remarks)])},[(l(),I(O(a.getStockIcon(s==null?void 0:s.remarks)),{class:"w-5 h-5"})),e("p",null,n(a.getStockText(s==null?void 0:s.remarks)),1)],2)])]))),128))])])])])])):_("",!0),r.tab==1?(l(),p("div",ve,[e("div",null,[e("div",Re,[e("div",Ee,[i(T,{position:"left",range:"",placeholder:"-- start date & end date --","input-classes":"w-72 border rounded px-2 py-1.5 block font-inter focus:outline-none focus:ring-2 focus:ring-sky-500 transition duration-150 focus:border-none",modelValue:r.dateRange,"onUpdate:modelValue":t[2]||(t[2]=s=>r.dateRange=s),format:"dd/MM/yyyy"},null,8,["modelValue"]),i(w,{items:r.transactionTypes,modelValue:r.selectedType,"onUpdate:modelValue":t[3]||(t[3]=s=>r.selectedType=s)},null,8,["items","modelValue"]),i(u,{text:"Generate",click:()=>{a.generateStockReport()},color:"success",icon:r.generateIcon},null,8,["click","icon"])]),e("div",null,[i(h,{class:"btn btn-default",header:["STOCK MOVEMENT LABORATORY REPORT",r.facility.details.name,r.facility.details.address,r.facility.details.phone],data:a.stockMovementExportData,worksheet:"report-work-sheet",name:"stock_movement_laboratory.xls"},{default:b(()=>[i(u,{color:"success",click:()=>{},icon:r.exportIcon,text:"Export"},null,8,["icon"])]),_:1},8,["header","data"])])]),e("div",Te,[e("table",we,[e("tbody",null,[e("tr",Se,[t[8]||(t[8]=e("td",null,[e("img",{src:E,alt:"app-logo",class:"w-24 h-24 object-cover"})],-1)),e("td",De,[e("p",Ce,n(r.facility.details.name),1),e("p",Me,n(r.facility.details.address),1),e("p",Ae,n(r.facility.details.phone),1),t[7]||(t[7]=e("p",{class:"uppercase font-medium underline"},"Laboratory Report",-1))])])])]),e("div",Ie,[e("div",Oe,[e("h4",Ye,[t[9]||(t[9]=Y("Stock Movement Report for Period: ")),e("span",Le,n(r.dateRange!==null&&r.dateRange.length>0?r.moment(r.dateRange[0]).format("YYYY-MM-DD"):"")+" - "+n(r.dateRange!==null&&r.dateRange.length>1?r.moment(r.dateRange[1]).format("YYYY-MM-DD"):""),1)])]),L(e("div",Ne,[i(S,{loading:r.generating},null,8,["loading"])],512),[[N,r.generating]]),r.reportData.length>0&&!r.generating?(l(),p("table",Be,[t[10]||(t[10]=e("thead",{class:"w-full"},[e("tr",{class:"border bg-gray-50"},[e("th",{class:"px-2 py-2 text-left border-r"},"Stock Item"),e("th",{class:"px-2 py-2 text-left border-r"},"Type"),e("th",{class:"px-2 py-2 text-left border-r"},"Stock Before"),e("th",{class:"px-2 py-2 text-left border-r"},"Adjustment"),e("th",{class:"px-2 py-2 text-left border-r"},"Stock After"),e("th",{class:"px-2 py-2 text-left border-r"},"Date")])],-1)),e("tbody",Ve,[(l(!0),p(k,null,v(r.reportData,s=>(l(),p("tr",{class:"w-full border-b",key:s.Lot},[e("td",je,n(s.name),1),e("td",Pe,n(s.transaction_type),1),e("td",Fe,n(s.overall_stock_balance_before_transaction),1),e("td",Ke,n(s.transacted_quantity),1),e("td",Ge,n(s.overall_stock_balance_after_transaction),1),e("td",He,n(r.moment(s.transaction_date).format("DATE_FORMAT"in o?o.DATE_FORMAT:B(y))),1)]))),128))])])):_("",!0)])]),r.reportData.length==0&&!r.generating?(l(),p("div",Ue,t[11]||(t[11]=[e("img",{src:Q,class:"w-20 h-20"},null,-1),e("p",null,"Please generate report data to preview the report",-1)]))):_("",!0)])])):_("",!0)])])}const yt=A(Z,[["render",Xe]]);export{yt as default};
