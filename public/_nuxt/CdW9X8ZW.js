import{_ as X}from"./C2V9k9lt.js";import{_ as Z}from"./BCp5hNWB.js";import{s as ee,x as w,b as T,H as te,d as ae,r as f,u as se,a as oe,c as N,z as v,w as O,o as ne,e as y,f as r,h as e,g as a,t as n,y as U,j as V,A as F,L as R,F as re,k as le,K as ie,D as E,l as de,E as me,_ as ue}from"./CiGEWrP1.js";import{_ as pe}from"./-6w2-jXT.js";import{_ as ce,a as _e}from"./DnZ7ZnPq.js";import{u as fe,_ as ve}from"./C9WebYv2.js";import{C as Te,b as ge,L as xe,B as be,c as he,p as ye,a as Ae,d as Re}from"./BcxBq6uP.js";import{_ as De}from"./B5Xrsdeq.js";import{_ as Ee}from"./9CKvPahf.js";import{u as we}from"./rTD1FFzA.js";import{P as ke}from"./D2Kkx04a.js";import{u as $e}from"./BxknhrXk.js";import{r as Ce}from"./DaqNsm8b.js";import{r as Me}from"./DfhsNadf.js";import"./DP3X_iWl.js";import"./BLsgv4Bu.js";import"./CzCxi2wp.js";import"./usfvbctK.js";import"./CDPKbuTk.js";import"./CKnPRs4B.js";import"./DD5oDxWm.js";import"./Bjml3zsv.js";import"./B158sog7.js";Te.register(ge,xe,be,he,ye,Ae);const Ne={components:{Bar:Re},props:{chartData:{required:!0,type:Object}},data(){return{data:this.chartData,options:{responsive:!0,maintainAspectRatio:!1}}},watch:{chartData:{handler(k){this.data=k},deep:!0}}};function Oe(k,S,A,g,o,B){const $=w("Bar");return T(),te($,{data:o.data,options:o.options},null,8,["data","options"])}const Fe=ee(Ne,[["render",Oe]]),Se={class:"px-5 py-5"},Be={class:"flex justify-between items-center"},Ue={class:"w-full flex items-center space-x-3"},Ve={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},Pe={class:"w-72 ml-2"},Ie={class:"w-48"},Le={class:"w-48"},Ye={class:"w-48"},je={class:"border rounded mt-10",id:"print-container"},qe={class:"flex items-center justify-between px-5 py-5 border-b"},Ge={class:"m-3"},He={class:"font-semibold mb-2"},We={class:"text-normal font-normal"},ze={key:0},Ke={class:"w-full rounded"},Je={class:"border-t bg-gray-50 border-b"},Qe={class:"text-left px-2 py-2 border-r uppercase"},Xe={class:"text-left px-2 py-2 uppercase"},Ze={class:"text-left px-2 py-2 border-r border-b"},et={class:"text-left px-2 py-2 border-r border-b"},tt={class:"text-left px-2 py-2 border-b border-r"},at={class:"text-left px-2 py-2 border-b border-r"},st={class:"text-left px-2 py-2 border-b"},ot={class:"text-left px-2 py-2 border-b"},nt={key:1,class:"w-full flex flex-col items-center justify-center space-y-2 py-10"},rt={key:0,class:"bg-gray-50 rounded mt-5 border"},lt={class:"px-5 py-5 flex flex-col items-center"},it={class:"mt-1"},dt={key:0,style:{height:"400px"}},mt="Turn Around Time Report",Ft=ae({__name:"turn-around-time",setup(k){$e({title:`${ke.name.toUpperCase()} - Turn Around Time Reports`});const S=f([{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"Aggregate Reports",link:"#"}]),A=f([]),g=f({name:"select department",id:0}),{loading:o,executeCancellableRequest:B,cancelRequest:$}=fe(),P=f([{name:"Minutes"},{name:"Hours"},{name:"Days"},{name:"Weeks"}]),d=f({name:"select unit"}),l=f([]),C=we(),{$toast:D,$metadata:I}=se(),L=oe("token"),M=f({}),m=f(new Array("","")),Y=()=>{m.value=new Array("","")},p=N(()=>m.value[0]?v(m.value[0]).format("YYYY-MM-DD"):""),c=N(()=>m.value[1]?v(m.value[1]).format("YYYY-MM-DD"):""),j=N(()=>l.value.length>0?l.value.map(s=>({"TEST TYPE":s.test_type,UNITS:d.value.name,"TURN AROUND TIME":s.turn_around_time,AVERAGE:s.average,"TOTAL TESTS":s.total_tests,"TESTS WITHIN NORMAL TAT":s.tests_within_normal_tat,"PERCENTAGE OF TESTS WITHIN NORMAL TAT":`${s.percentage_within_normal_tat}%`})):[]);async function q(){o.value=!0,M.value={};let s=`from=${p.value}&to=${c.value}&department=${g.value.id}&unit=${d.value.name.toLowerCase()}`;const t={route:`${de.aggregateReports}turn_around_time?${s}`,method:"GET",token:`${L.value}`},{data:i,error:x,pending:b}=await B(t);o.value=b,i.value&&(o.value=!1,l.value=i.value.data,M.value={labels:i.value.data.map(h=>h.test_type),datasets:[{label:"Turn Around Time",backgroundColor:"#030712",data:i.value.data.map(h=>h.turn_around_time)},{label:"Average Turn Around Time",backgroundColor:"#0284c7",data:i.value.data.map(h=>Number(h.average))}]},i.value.data.length>0?D.success("Report data generated successfully"):D.warning(`No data found in period ${v(p.value).format(R)} - ${v(c.value).format(R)}`)),x.value&&(o.value=!1,console.error(x.value),D.error(me))}function G(){const s=g.value.name==="select department"||d.value.name==="select unit";return s&&D.warning("Please select a department and unit"),!s}return O(d,(s,t)=>{s!==t&&(l.value=[])}),O(g,(s,t)=>{s!==t&&(l.value=[])}),O(m,(s,t)=>{s!==t&&(l.value=[])}),ne(()=>{o.value=!1,A.value=I.departments,A.value.some(t=>t.name=="All")||A.value.push({id:0,name:"All"}),A.value.sort((t,i)=>{const x=t.name.toUpperCase(),b=i.name.toUpperCase();return x<b?-1:x>b?1:0})}),(s,t)=>{const i=X,x=w("datepicker"),b=Z,h=ue,H=w("FormKit"),W=pe,z=w("excel"),K=_e,J=ve,Q=Fe;return T(),y("div",Se,[r(i,{pages:e(S)},null,8,["pages"]),a("div",{class:"flex items-center py-5"},[t[4]||(t[4]=a("img",{src:De,alt:"report-icon",class:"w-8 h-8 mr-2"},null,-1)),a("h3",{class:"text-2xl font-semibold uppercase"},n(mt))]),a("div",Be,[r(H,{type:"form","submit-label":"Update",onSubmit:t[3]||(t[3]=_=>G()&&q()),actions:!1,id:"submitForm"},{default:U(({value:_})=>[a("div",Ue,[a("div",Ve,[r(e(Ce),{class:"w-5 h-5 mr-2"}),t[5]||(t[5]=V(" Filter By Date Range ")),a("div",Pe,[r(x,{onCleared:Y,required:"",position:"left",placeholder:"select start & end date",range:!0,"input-class-name":"datepicker",modelValue:e(m),"onUpdate:modelValue":t[0]||(t[0]=u=>F(m)?m.value=u:null),format:"dd/MM/yyyy",maxDate:new Date},null,8,["modelValue","maxDate"])])]),a("div",Ie,[r(b,{items:e(A),modelValue:e(g),"onUpdate:modelValue":t[1]||(t[1]=u=>F(g)?g.value=u:null)},null,8,["items","modelValue"])]),a("div",Le,[r(b,{items:e(P),modelValue:e(d),"onUpdate:modelValue":t[2]||(t[2]=u=>F(d)?d.value=u:null)},null,8,["items","modelValue"])]),a("div",Ye,[r(h,{type:"submit",color:"primary",text:"Generate Report",icon:e(Me),click:()=>{},loading:e(o)},null,8,["icon","loading"])])])]),_:1}),r(z,{class:"btn btn-default",header:[`TURN AROUND TIME REPORT ${e(p)} - ${e(c)}`,e(C).details.name,e(C).details.address,e(C).details.phone],data:e(j),worksheet:"report-work-sheet",name:`turn_around_time_${e(p)}_to_${e(c)}.xls`},{default:U(()=>[r(W,{text:"Export Excel"})]),_:1},8,["header","data","name"])]),a("div",je,[a("div",qe,[t[6]||(t[6]=a("div",{class:"flex flex-col space-y-2"},[a("img",{src:Ee,alt:"app-logo",class:"w-24 h-24 object-cover"}),a("h3",{class:"text-xl font-semibold"}," TURN AROUND TIME REPORT ")],-1)),r(K)]),a("div",Ge,[a("h3",He,[t[7]||(t[7]=V("Tests Performed Period: ")),a("span",We,n(e(p)!==""?e(v)(e(p)).format("DATE_FORMAT"in s?s.DATE_FORMAT:e(R)):"")+" - "+n(e(c)!==""?e(v)(e(c)).format("DATE_FORMAT"in s?s.DATE_FORMAT:e(R)):""),1)])]),e(l).length>0&&!e(o)?(T(),y("div",ze,[a("table",Ke,[a("thead",null,[a("tr",Je,[t[8]||(t[8]=a("th",{class:"text-left px-2 py-2 border-r uppercase"},"Test Type",-1)),a("th",Qe,"Target TAT ("+n(e(d).name)+")",1),a("th",Xe,"Average TAT ("+n(e(d).name)+")",1),t[9]||(t[9]=a("th",{class:"text-left px-2 py-2 uppercase"},"Total Tests",-1)),t[10]||(t[10]=a("th",{class:"text-left px-2 py-2 uppercase"},"Tests Within Normal TAT",-1)),t[11]||(t[11]=a("th",{class:"text-left px-2 py-2 uppercase"},"Percentage of tests within Normal TAT",-1))])]),a("tbody",null,[(T(!0),y(re,null,le(e(l),(_,u)=>(T(),y("tr",{key:u,class:ie({"bg-white":u%2===0,"bg-gray-50":u%2!==0})},[a("td",Ze,n(_.test_type),1),a("td",et,n(_.turn_around_time),1),a("td",tt,n(_.average),1),a("td",at,n(_.total_tests),1),a("td",st,n(_.tests_within_normal_tat),1),a("td",ot,n(_.percentage_within_normal_tat)+"%",1)],2))),128))])])])):E("",!0),e(l).length==0&&!e(o)?(T(),y("div",nt,t[12]||(t[12]=[a("img",{src:ce,alt:"page-icon",class:"object-cover w-20 h-20"},null,-1),a("p",null,"Data not found, please generate report",-1)]))):E("",!0),r(J,{condition:e(o),cancelReportGeneration:()=>e($)()},null,8,["condition","cancelReportGeneration"])]),e(l).length>0&&!e(o)?(T(),y("div",rt,[a("div",lt,[t[13]||(t[13]=a("h3",{class:"text-lg font-medium"},"Average Turn Around Time",-1)),a("p",it,"From: "+n(e(p)!==""?e(v)(e(p)).format("DATE_FORMAT"in s?s.DATE_FORMAT:e(R)):"")+" - To: "+n(e(c)!==""?e(v)(e(c)).format("DATE_FORMAT"in s?s.DATE_FORMAT:e(R)):""),1)]),e(l).length>0?(T(),y("div",dt,[r(Q,{"chart-data":e(M)},null,8,["chart-data"])])):E("",!0)])):E("",!0)])}}});export{Ft as default};
