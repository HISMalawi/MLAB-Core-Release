import{_ as I}from"./Breadcrumb.vue.a5cd8cfb.js";import{_ as K}from"./Dropdown.c225f75a.js";import{l as Q,z as u,u as W,H as k,f as M,o as a,c as n,b as l,k as e,d as t,t as i,h as C,A as T,g as X,F as y,r as x,a as D,e as Z}from"./entry.0b8cd08a.js";import{_ as ee}from"./index.166105c9.js";import{_ as te}from"./ExportButton.vue.38f9fa66.js";import{_ as oe}from"./Address.vue.9a790c88.js";import{u as re}from"./vue.f36acd1f.cbc612d6.js";import{d as F,e as se}from"./constants.1be0c037.js";import{_ as ae}from"./report.5cfe9f08.js";import{_ as ne}from"./logo.168ad185.js";import{h as _,e as P,f as A}from"./fetch.3bebfb7d.js";import{u as le}from"./facility.90d3dd6e.js";import{P as de}from"./package.b2e4a4ff.js";import{r as ce}from"./FunnelIcon.26675cc2.js";import{r as ie}from"./ArrowPathIcon.799ac706.js";import"./nuxt-link.7cdf9b23.js";import"./HomeIcon.4eb0c0eb.js";import"./listbox.9e3dd9c1.js";import"./hidden.7f45844e.js";import"./use-text-value.1a486bc2.js";import"./CheckIcon.dd25a2df.js";import"./CheckCircleIcon.2a112f22.js";import"./MagnifyingGlassIcon.a0160e2a.js";import"./html2canvas.esm.e0a7d97b.js";import"./jspdf.es.min.1f957379.js";import"./XMarkIcon.c65f13ea.js";import"./PrinterIcon.f055bae4.js";import"./transition.29920038.js";import"./PencilSquareIcon.8bd9941b.js";const me={class:"px-5 py-5"},pe=t("img",{src:ae,alt:"report-icon",class:"w-8 h-8 mr-2"},null,-1),ue={class:"w-full flex items-center justify-between"},_e={class:"flex items-center space-x-3"},fe={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},ve={class:"w-72 ml-2"},be={class:"w-44"},he={class:"flex items-center space-x-3"},ye={class:"mt-3"},xe={class:"text-lg font-semibold mb-2"},ge={class:"text-normal font-normal"},Re={class:"border rounded print-container",id:"print-container"},ke={class:"flex items-center justify-between px-5 py-5 border-b"},De=t("div",{class:"flex flex-col space-y-2"},[t("img",{src:ne,alt:"app-logo",class:"w-24 h-24 object-cover"}),t("h3",{class:"text-xl font-semibold"}," REJECTED SAMPLES REPORT ")],-1),we={class:"mt-10"},Ee={class:"w-full border border-dotted rounded overflow-x-auto"},$e={class:"bg-gray-50 border-b border-dotted rounded-t"},Me=t("th",{class:"border-r"},null,-1),Ce=["colspan"],Te=t("th",null,"TOTAL",-1),Fe=t("td",{class:"border-r border-b border-dotted px-2 py-2"},null,-1),Pe={class:"border-r border-b border-dotted px-2 py-2"},Ae={class:"border-r border-t border-b border-dotted px-2 py-2"},Se="Rejected Samples Report",mt=Q({__name:"rejected-samples",setup(Ve){re({title:`${de.name.toUpperCase()} - Rejected Samples Report`});const S=u([{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"Aggregate Reports",link:"#"}]),w=u([]),f=u({name:"select department"}),E=W("token"),g=le(),d=u(["",""]),V=()=>{d.value=new Array("","")},m=u({result:[],value:void 0,wards:void 0}),j=k(()=>[]),v=u(!1),Y=()=>{const o={};return m.value.result.forEach(r=>{r.test_types.forEach(s=>{o[s.name]?o[s.name]+=s.count:o[s.name]=s.count})}),o};async function B(){const o={route:P.departments,method:"GET",token:`${E.value}`},{data:r,error:s}=await A(o);r.value&&(w.value=r.value),s.value&&console.error(s.value)}const b=k(()=>d.value[0]?_(d.value[0]).format("YYYY-MM-DD"):""),h=k(()=>d.value[1]?_(d.value[1]).format("YYYY-MM-DD"):"");async function O(){if(L())D().$toast.warning("Please select a department");else{v.value=!0;const o={route:`${P.aggregateReports}rejected?from=${b.value}&to=${h.value}&department=${f.value.id}`,method:"GET",token:`${E.value}`},{data:r,error:s,pending:R}=await A(o);v.value=R,r.value&&(v.value=!1,m.value=r.value.data,console.log(r.value.data),D().$toast.success("Report generated successfully!")),s.value&&(console.log(s.value),v.value=!1,D().$toast.error(se))}}function L(){return f.value.name=="select department"}return B(),(o,r)=>{const s=I,R=M("datepicker"),q=K,N=Z,G=ee,H=te,U=M("excel"),z=oe;return a(),n("div",me,[l(s,{pages:e(S)},null,8,["pages"]),t("div",{class:"flex items-center py-5"},[pe,t("h3",{class:"text-2xl font-semibold uppercase"},i(Se))]),t("div",ue,[t("div",_e,[t("div",fe,[l(e(ce),{class:"w-5 h-5 mr-2"}),C(" Filter By Date Range "),t("div",ve,[l(R,{onCleared:V,required:"",position:"left",placeholder:"select start & end date",range:!0,"input-class-name":"datepicker",modelValue:e(d),"onUpdate:modelValue":r[0]||(r[0]=p=>T(d)?d.value=p:null),format:"dd/MM/yyyy"},null,8,["modelValue"])])]),t("div",be,[l(q,{items:e(w),modelValue:e(f),"onUpdate:modelValue":r[1]||(r[1]=p=>T(f)?f.value=p:null)},null,8,["items","modelValue"])]),l(N,{color:"primary",text:"Generate Report",icon:e(ie),click:()=>O(),loading:e(v)},null,8,["icon","click","loading"])]),t("div",he,[l(G,{printSmallLabel:!1}),l(U,{class:"btn btn-default",header:["REJECTED SAMPLES REPORT ",`PERIOD FROM ${e(_)(e(b)).format("DD-MM-yyyy")} TO ${e(h)}).format('DD-MM-yyyy')}`,e(g).details.name,e(g).details.address,e(g).details.phone],data:e(j),worksheet:"report-work-sheet",name:`rejected_samples_report_${e(_)(e(b)).format("DD_MM_yyyy")}_to_${e(h)}).format('DD_MM_yyyy')}.xls`},{default:X(()=>[l(H,{text:"Export Excel"})]),_:1},8,["header","data","name"])])]),t("div",ye,[t("h3",xe,[C("Tests Performed Period: "),t("span",ge,i(e(b)!=""?e(_)(e(b)).format("dateFormat"in o?o.dateFormat:e(F)):"")+" - "+i(e(h)!=""?e(_)(e(h)).format("dateFormat"in o?o.dateFormat:e(F)):""),1)])]),t("div",Re,[t("div",ke,[De,l(z)]),t("div",we,[t("table",Ee,[(a(!0),n(y,null,x(e(m).result,(p,J)=>(a(),n(y,{key:J},[t("thead",$e,[t("tr",null,[Me,t("th",{colspan:e(m).wards.length,class:"px-5 py-2 border-r"},i(p.name),9,Ce),Te])]),t("tbody",null,[t("tr",null,[Fe,(a(!0),n(y,null,x(e(m).wards,c=>(a(),n("td",{key:c,class:"border-r border-b border-dotted px-2 py-2"},i(c),1))),128))]),(a(!0),n(y,null,x(p.test_types,c=>(a(),n("tr",{key:c.name},[t("td",Pe,i(c.name),1),(a(!0),n(y,null,x(e(m).wards,$=>(a(),n("td",{key:$,class:"border-r border-b border-dotted px-2 py-2"},i(c.ward===$?c.count:0),1))),128)),t("td",Ae,i(Y()[c.name]),1)]))),128))])],64))),128))])])])])}}});export{mt as default};
