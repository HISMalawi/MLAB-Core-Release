import{m as K,o as l,E as R,u as C,g as ue,l as L,y as re,i as se,j as ie,H as V,t as M,f as A,a as G,p as ve,d as U,b as k,P as O,N as w,T as H}from"./hidden.487babbc.js";import{b as pe}from"./use-text-value.122e2222.js";import{a as ce,p as de,E as fe,n as Y,d as F}from"./transition.2eedb22c.js";import{l as W,B as $,Q as h,aa as z,Z,J as I,F as q,L as X,a5 as _,ab as J}from"./entry.48ba65aa.js";var be=(v=>(v[v.Open=0]="Open",v[v.Closed=1]="Closed",v))(be||{});let ee=Symbol("PopoverContext");function Q(v){let m=J(ee,null);if(m===null){let S=new Error(`<${v} /> is missing a parent <${Se.name} /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(S,Q),S}return m}let Pe=Symbol("PopoverGroupContext");function te(){return J(Pe,null)}let le=Symbol("PopoverPanelContext");function me(){return J(le,null)}let Se=W({name:"Popover",inheritAttrs:!1,props:{as:{type:[Object,String],default:"div"}},setup(v,{slots:m,attrs:S,expose:N}){var o;let e=$(null);N({el:e,$el:e});let b=$(1),d=$(null),x=$(null),g=$(null),f=$(null),E=h(()=>K(e)),B=h(()=>{var t,n;if(!l(d)||!l(f))return!1;for(let j of document.querySelectorAll("body > *"))if(Number(j==null?void 0:j.contains(l(d)))^Number(j==null?void 0:j.contains(l(f))))return!0;let r=R(),P=r.indexOf(l(d)),D=(P+r.length-1)%r.length,oe=(P+1)%r.length,ae=r[D],ne=r[oe];return!((t=l(f))!=null&&t.contains(ae))&&!((n=l(f))!=null&&n.contains(ne))}),c={popoverState:b,buttonId:$(null),panelId:$(null),panel:f,button:d,isPortalled:B,beforePanelSentinel:x,afterPanelSentinel:g,togglePopover(){b.value=C(b.value,{[0]:1,[1]:0})},closePopover(){b.value!==1&&(b.value=1)},close(t){c.closePopover();let n=(()=>t?t instanceof HTMLElement?t:t.value instanceof HTMLElement?l(t):l(c.button):l(c.button))();n==null||n.focus()}};z(ee,c),ue(h(()=>C(b.value,{[0]:L.Open,[1]:L.Closed})));let T={buttonId:c.buttonId,panelId:c.panelId,close(){c.closePopover()}},y=te(),s=y==null?void 0:y.registerPopover,[p,u]=ce(),a=de({mainTreeNodeRef:y==null?void 0:y.mainTreeNodeRef,portals:p,defaultContainers:[d,f]});function i(){var t,n,r,P;return(P=y==null?void 0:y.isFocusWithinPopoverGroup())!=null?P:((t=E.value)==null?void 0:t.activeElement)&&(((n=l(d))==null?void 0:n.contains(E.value.activeElement))||((r=l(f))==null?void 0:r.contains(E.value.activeElement)))}return Z(()=>s==null?void 0:s(T)),fe((o=E.value)==null?void 0:o.defaultView,"focus",t=>{var n,r;t.target!==window&&t.target instanceof HTMLElement&&b.value===0&&(i()||d&&f&&(a.contains(t.target)||(n=l(c.beforePanelSentinel))!=null&&n.contains(t.target)||(r=l(c.afterPanelSentinel))!=null&&r.contains(t.target)||c.closePopover()))},!0),re(a.resolveContainers,(t,n)=>{var r;c.closePopover(),se(n,ie.Loose)||(t.preventDefault(),(r=l(d))==null||r.focus())},h(()=>b.value===0)),()=>{let t={open:b.value===0,close:c.close};return I(q,[I(u,{},()=>V({theirProps:{...v,...S},ourProps:{ref:e},slot:t,slots:m,attrs:S,name:"Popover"})),I(a.MainTreeNode)])}}}),Ee=W({name:"PopoverButton",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:()=>`headlessui-popover-button-${M()}`}},inheritAttrs:!1,setup(v,{attrs:m,slots:S,expose:N}){let o=Q("PopoverButton"),e=h(()=>K(o.button));N({el:o.button,$el:o.button}),X(()=>{o.buttonId.value=v.id}),_(()=>{o.buttonId.value=null});let b=te(),d=b==null?void 0:b.closeOthers,x=me(),g=h(()=>x===null?!1:x.value===o.panelId.value),f=$(null),E=`headlessui-focus-sentinel-${M()}`;g.value||Z(()=>{o.button.value=f.value});let B=pe(h(()=>({as:v.as,type:m.type})),f);function c(a){var i,t,n,r,P;if(g.value){if(o.popoverState.value===1)return;switch(a.key){case k.Space:case k.Enter:a.preventDefault(),(t=(i=a.target).click)==null||t.call(i),o.closePopover(),(n=l(o.button))==null||n.focus();break}}else switch(a.key){case k.Space:case k.Enter:a.preventDefault(),a.stopPropagation(),o.popoverState.value===1&&(d==null||d(o.buttonId.value)),o.togglePopover();break;case k.Escape:if(o.popoverState.value!==0)return d==null?void 0:d(o.buttonId.value);if(!l(o.button)||(r=e.value)!=null&&r.activeElement&&!((P=l(o.button))!=null&&P.contains(e.value.activeElement)))return;a.preventDefault(),a.stopPropagation(),o.closePopover();break}}function T(a){g.value||a.key===k.Space&&a.preventDefault()}function y(a){var i,t;v.disabled||(g.value?(o.closePopover(),(i=l(o.button))==null||i.focus()):(a.preventDefault(),a.stopPropagation(),o.popoverState.value===1&&(d==null||d(o.buttonId.value)),o.togglePopover(),(t=l(o.button))==null||t.focus()))}function s(a){a.preventDefault(),a.stopPropagation()}let p=Y();function u(){let a=l(o.panel);if(!a)return;function i(){C(p.value,{[F.Forwards]:()=>O(a,w.First),[F.Backwards]:()=>O(a,w.Last)})===H.Error&&O(R().filter(t=>t.dataset.headlessuiFocusGuard!=="true"),C(p.value,{[F.Forwards]:w.Next,[F.Backwards]:w.Previous}),{relativeTo:l(o.button)})}i()}return()=>{let a=o.popoverState.value===0,i={open:a},{id:t,...n}=v,r=g.value?{ref:f,type:B.value,onKeydown:c,onClick:y}:{ref:f,id:t,type:B.value,"aria-expanded":o.popoverState.value===0,"aria-controls":l(o.panel)?o.panelId.value:void 0,disabled:v.disabled?!0:void 0,onKeydown:c,onKeyup:T,onClick:y,onMousedown:s};return I(q,[V({ourProps:r,theirProps:{...m,...n},slot:i,attrs:m,slots:S,name:"PopoverButton"}),a&&!g.value&&o.isPortalled.value&&I(A,{id:E,features:G.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:u})])}}}),we=W({name:"PopoverPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},focus:{type:Boolean,default:!1},id:{type:String,default:()=>`headlessui-popover-panel-${M()}`}},inheritAttrs:!1,setup(v,{attrs:m,slots:S,expose:N}){let{focus:o}=v,e=Q("PopoverPanel"),b=h(()=>K(e.panel)),d=`headlessui-focus-sentinel-before-${M()}`,x=`headlessui-focus-sentinel-after-${M()}`;N({el:e.panel,$el:e.panel}),X(()=>{e.panelId.value=v.id}),_(()=>{e.panelId.value=null}),z(le,e.panelId),Z(()=>{var s,p;if(!o||e.popoverState.value!==0||!e.panel)return;let u=(s=b.value)==null?void 0:s.activeElement;(p=l(e.panel))!=null&&p.contains(u)||O(l(e.panel),w.First)});let g=ve(),f=h(()=>g!==null?(g.value&L.Open)===L.Open:e.popoverState.value===0);function E(s){var p,u;switch(s.key){case k.Escape:if(e.popoverState.value!==0||!l(e.panel)||b.value&&!((p=l(e.panel))!=null&&p.contains(b.value.activeElement)))return;s.preventDefault(),s.stopPropagation(),e.closePopover(),(u=l(e.button))==null||u.focus();break}}function B(s){var p,u,a,i,t;let n=s.relatedTarget;n&&l(e.panel)&&((p=l(e.panel))!=null&&p.contains(n)||(e.closePopover(),((a=(u=l(e.beforePanelSentinel))==null?void 0:u.contains)!=null&&a.call(u,n)||(t=(i=l(e.afterPanelSentinel))==null?void 0:i.contains)!=null&&t.call(i,n))&&n.focus({preventScroll:!0})))}let c=Y();function T(){let s=l(e.panel);if(!s)return;function p(){C(c.value,{[F.Forwards]:()=>{var u;O(s,w.First)===H.Error&&((u=l(e.afterPanelSentinel))==null||u.focus())},[F.Backwards]:()=>{var u;(u=l(e.button))==null||u.focus({preventScroll:!0})}})}p()}function y(){let s=l(e.panel);if(!s)return;function p(){C(c.value,{[F.Forwards]:()=>{let u=l(e.button),a=l(e.panel);if(!u)return;let i=R(),t=i.indexOf(u),n=i.slice(0,t+1),r=[...i.slice(t+1),...n];for(let P of r.slice())if(P.dataset.headlessuiFocusGuard==="true"||a!=null&&a.contains(P)){let D=r.indexOf(P);D!==-1&&r.splice(D,1)}O(r,w.First,{sorted:!1})},[F.Backwards]:()=>{var u;O(s,w.Previous)===H.Error&&((u=l(e.button))==null||u.focus())}})}p()}return()=>{let s={open:e.popoverState.value===0,close:e.close},{id:p,focus:u,...a}=v,i={ref:e.panel,id:p,onKeydown:E,onFocusout:o&&e.popoverState.value===0?B:void 0,tabIndex:-1};return V({ourProps:i,theirProps:{...m,...a},attrs:m,slot:s,slots:{...S,default:(...t)=>{var n;return[I(q,[f.value&&e.isPortalled.value&&I(A,{id:d,ref:e.beforePanelSentinel,features:G.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:T}),(n=S.default)==null?void 0:n.call(S,...t),f.value&&e.isPortalled.value&&I(A,{id:x,ref:e.afterPanelSentinel,features:G.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:y})])]}},features:U.RenderStrategy|U.Static,visible:f.value,name:"PopoverPanel"})}}});export{we as W,Ee as j,Se as y};
