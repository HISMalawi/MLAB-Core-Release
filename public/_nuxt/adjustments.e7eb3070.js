import{_ as F}from"./Breadcrumb.vue.730e51a9.js";import{a as V,b as S,_ as C,g as c,o as b,c as j,e,d as s,h as r,i as y,p as L,k as $,f as D,t as f,u as E}from"./entry.c9664464.js";import{_ as K}from"./Dropdown.31274410.js";import{d as B,e as q}from"./constants.c704dc64.js";import{r as z,h as N,a as G}from"./fetch.43cff7e5.js";import{S as x}from"./stock.5fede5cb.js";import{r as T}from"./XMarkIcon.66aec55b.js";import{r as H}from"./UserIcon.3f6f3f55.js";import{r as Q}from"./AdjustmentsVerticalIcon.5eea1403.js";import{r as O}from"./ArrowUturnLeftIcon.5442c0ab.js";import{S as A,h as U,U as M,G as R,V as P}from"./transition.6082f8f4.js";import{_ as J}from"./SearchBar.dde2a70e.js";import{r as W,a as Y}from"./PencilSquareIcon.bfc505ab.js";import{_ as Z}from"./stock_out.be0c69e3.js";import{_ as ee}from"./OutlinedButton.fda58dc4.js";import{_ as te}from"./Datatable.0176a0f4.js";import{P as oe}from"./package.fe63cea7.js";import"./nuxt-link.a3147d35.js";import"./HomeIcon.66c99cc9.js";import"./listbox.22272bac.js";import"./hidden.e99e3a57.js";import"./use-text-value.99f9911b.js";import"./CheckIcon.db006dd5.js";import"./CheckCircleIcon.92b0d0c1.js";import"./MagnifyingGlassIcon.61bb3ead.js";import"./network.9659fb45.js";import"./PrinterIcon.8aa5cb57.js";import"./Loader.9cd3f191.js";const se={components:{TransitionRoot:A,TransitionChild:U,Dialog:M,DialogPanel:R,DialogTitle:P,XMarkIcon:T,UserIcon:H},data(){return{open:!1,addIcon:z,ajustIcon:Q,clearIcon:O,reasons:new Array,loading:!1,reasonSelected:{name:"-- select reason --"},stockItemSelected:{name:"-- select stock item --"},stockItems:new Array,cookie:V("token"),inStock:0,afterStock:0,adjustment:0,stock:{id:0},lot:"",batch:"",reason:"",notes:""}},methods:{handleClick(){this.open=!this.open},async getReasons(){const l=new x,{data:o,error:a}=await l.getStockAdjustmentReasons(`${this.cookie}`);o.value&&(this.reasons=o.value),a.value&&console.error(a.value)},async init(){this.handleClick(),await this.getReasons();const l=new x,{data:o,error:a}=await l.getStockItem(`${this.cookie}`);o.value&&(this.stockItems=o.value.filter(d=>({...d,created_date:N(d.created_date).format(B)}))),a.value&&console.error(a.value)},async getStock(l){const o=new x,{data:a,error:d}=await o.readStockItem(`${this.cookie}`,{id:l});a.value&&(this.afterStock=0,this.adjustment=0,this.inStock=a.value.stock.quantity,this.stock=a.value.stock),d.value&&console.error(d.value)},async submitForm(){this.loading=!0;const l=new x;let o={stock_id:this.stock.id,lot:this.lot,batch:this.batch,quantity_to_adjusted:this.adjustment,reason:this.reason==""?this.reasonSelected.name:this.reason,notes:this.notes};const{data:a,error:d,pending:t}=await l.adjustStock(`${this.cookie}`,o);this.loading=t,a.value&&(this.afterStock=0,this.adjustment=0,this.loading=!1,this.stockItems=new Array,this.reasons=new Array,this.reasonSelected={name:"-- select reason --"},this.stockItemSelected={name:"-- select stock item --"},this.handleClick(),S().$toast.success("Stock adjustment successfully done!"),this.$emit("update",!0)),d.value&&(console.error(d.value),this.loading=!1,S().$toast.error(q))}},watch:{stockItemSelected:{handler(l){this.getStock(l.id)},deep:!0},adjustment:{handler(l){this.afterStock=Number(this.inStock)+Number(l)},deep:!0}}},ae=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),ne={class:"fixed inset-0 overflow-y-auto"},le={class:"flex min-h-full items-center justify-center p-4 text-center"},ie={class:"border-b px-3 py-3 flex items-center justify-between"},ce={class:"py-5 px-5 space-y-3"},re={class:"flex flex-col space-y-1.5"},de=e("label",{class:"font-medium"},"Reason",-1),me={class:"mt-2"},ue=e("label",{class:"font-medium"},"Stock Item",-1),pe={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function _e(l,o,a,d,t,n){const u=D,p=c("TransitionChild"),v=c("DialogTitle"),k=c("XMarkIcon"),h=K,m=c("FormKit"),_=c("DialogPanel"),g=c("Dialog"),I=c("TransitionRoot");return b(),j("div",null,[e("div",null,[s(u,{text:"Create Stock Adjustment",color:"primary",icon:t.addIcon,click:n.init},null,8,["icon","click"])]),s(I,{appear:"",show:t.open,as:"template"},{default:r(()=>[s(g,{as:"div",onClose:n.handleClick,class:"relative z-10"},{default:r(()=>[s(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:r(()=>[ae]),_:1}),e("div",ne,[e("div",le,[s(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:r(()=>[s(_,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:r(()=>[e("div",ie,[s(v,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:r(()=>[y(" Create Stock Adjustment ")]),_:1}),e("button",{onClick:o[0]||(o[0]=(...w)=>n.handleClick&&n.handleClick(...w))},[s(k,{class:"w-5 h-5"})])]),s(m,{type:"form","submit-label":"Update",onSubmit:n.submitForm,actions:!1,id:"submitForm"},{default:r(({value:w})=>[e("div",ce,[e("div",re,[de,s(h,{items:t.reasons,modelValue:t.reasonSelected,"onUpdate:modelValue":o[1]||(o[1]=i=>t.reasonSelected=i)},null,8,["items","modelValue"]),e("div",me,[t.reasonSelected.name.toLowerCase()=="other"?(b(),L(m,{key:0,type:"textarea",label:"Please write your reason for (Other)",validation:"required",modelValue:t.reason,"onUpdate:modelValue":o[2]||(o[2]=i=>t.reason=i)},null,8,["modelValue"])):$("",!0)])]),e("div",null,[ue,s(h,{"is-searchable":!0,items:t.stockItems,modelValue:t.stockItemSelected,"onUpdate:modelValue":o[3]||(o[3]=i=>t.stockItemSelected=i)},null,8,["items","modelValue"])]),s(m,{type:"number",label:"In Stock",disabled:"",modelValue:t.inStock,"onUpdate:modelValue":o[4]||(o[4]=i=>t.inStock=i)},null,8,["modelValue"]),s(m,{type:"number",label:"Adjustment",validation:"required",modelValue:t.adjustment,"onUpdate:modelValue":o[5]||(o[5]=i=>t.adjustment=i)},null,8,["modelValue"]),s(m,{type:"number",label:"Stock After",disabled:"",modelValue:t.afterStock,"onUpdate:modelValue":o[6]||(o[6]=i=>t.afterStock=i)},null,8,["modelValue"]),s(m,{type:"text",label:"Batch",validation:"required",modelValue:t.batch,"onUpdate:modelValue":o[7]||(o[7]=i=>t.batch=i)},null,8,["modelValue"]),s(m,{type:"text",label:"Lot",validation:"required",modelValue:t.lot,"onUpdate:modelValue":o[8]||(o[8]=i=>t.lot=i)},null,8,["modelValue"]),s(m,{type:"textarea",label:"Notes",validation:"required",modelValue:t.notes,"onUpdate:modelValue":o[9]||(o[9]=i=>t.notes=i)},null,8,["modelValue"])]),e("div",pe,[s(u,{loading:t.loading,type:"submit",click:()=>{},color:"success",icon:t.ajustIcon,text:"Adjust"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const fe=C(se,[["render",_e]]),he={components:{TransitionRoot:A,TransitionChild:U,Dialog:M,DialogPanel:R,DialogTitle:P,XMarkIcon:T},data(){return{viewIcon:W,show:!1,editIcon:Y}},props:{data:{type:Object,required:!0}},methods:{handleClick(){this.show=!this.show}}},ve=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),ke={class:"fixed inset-0 overflow-y-auto"},xe={class:"flex min-h-full items-center justify-center p-4 text-center"},ge={class:"border-b px-3 py-3 flex items-center justify-between"},ye=e("img",{src:Z,class:"w-8 h-8 mr-2"},null,-1),be={class:"space-y-3 px-5 py-5"},we={class:"w-full flex flex-col space-y-1"},Se=e("label",{class:"font-semibold text-lg"},"Name",-1),Ce={class:"w-full flex flex-col space-y-1"},je=e("label",{class:"font-semibold text-lg"},"Description",-1),Ie={class:"w-full flex flex-col space-y-1"},Ve=e("label",{class:"font-semibold text-lg"},"Lot",-1),De={class:"w-full flex flex-col space-y-1"},Te=e("label",{class:"font-semibold text-lg"},"Batch",-1),Ae={class:"w-full flex flex-col space-y-1"},Ue=e("label",{class:"font-semibold text-lg"},"Quantity Adjusted",-1),Me={class:"w-full flex flex-col space-y-1"},Re=e("label",{class:"font-semibold text-lg"},"Reason",-1),Pe={class:"w-full flex flex-col space-y-1"},Be=e("label",{class:"font-semibold text-lg"},"Remarks",-1),qe={class:"w-full flex flex-col space-y-1"},Ne=e("label",{class:"font-semibold text-lg"},"Transaction Date",-1);function Oe(l,o,a,d,t,n){const u=D,p=c("TransitionChild"),v=c("DialogTitle"),k=c("XMarkIcon"),h=c("DialogPanel"),m=c("Dialog"),_=c("TransitionRoot");return b(),j("div",null,[s(u,{click:()=>{n.handleClick()},color:"primary",text:"View",icon:t.viewIcon},null,8,["click","icon"]),s(_,{appear:"",show:t.show,as:"template"},{default:r(()=>[s(m,{as:"div",class:"relative z-10"},{default:r(()=>[s(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:r(()=>[ve]),_:1}),e("div",ke,[e("div",xe,[s(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:r(()=>[s(h,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:r(()=>[e("div",ge,[s(v,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:r(()=>[ye,y(" View Stock Adjustment ")]),_:1}),e("button",{onClick:o[0]||(o[0]=(...g)=>n.handleClick&&n.handleClick(...g))},[s(k,{class:"w-5 h-5"})])]),e("div",be,[e("div",we,[Se,e("p",null,f(a.data.name),1)]),e("div",Ce,[je,e("p",null,f(a.data.description),1)]),e("div",Ie,[Ve,e("p",null,f(a.data.lot),1)]),e("div",De,[Te,e("p",null,f(a.data.batch),1)]),e("div",Ae,[Ue,e("p",null,f(a.data.transacted_quantity),1)]),e("div",Me,[Re,e("p",null,f(a.data.reason),1)]),e("div",Pe,[Be,e("p",null,f(a.data.remarks),1)]),e("div",qe,[Ne,e("p",null,f(a.data.transaction_date),1)])])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const Xe=C(he,[["render",Oe]]),Fe={components:{TransitionRoot:A,TransitionChild:U,Dialog:M,DialogPanel:R,DialogTitle:P,XMarkIcon:T,ExclamationTriangleIcon:G},data(){return{show:!1,reverseIcon:O,loading:!1,reason:"",cookie:V("token")}},props:{data:{type:Object,required:!0}},methods:{async voidStockSupplier(l){this.loading=!0;const o=new x,a={stock_transaction_id:this.data.id,reason:this.reason,id:l},{data:d,error:t,pending:n}=await o.reverseStockAdjustment(`${this.cookie}`,a);this.loading=n,d.value&&(this.handleClick(),S().$toast.success("Stock adjustment reversed successfully!"),this.loading=!1,this.reason="",this.$emit("update",!0)),t.value&&(console.error(t.value),S().$toast.error(q),this.loading=!1)},handleClick(){this.show=!this.show}}},Le=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),$e={class:"fixed inset-0 overflow-y-auto"},Ee={class:"flex min-h-full items-center justify-center p-4 text-center"},Ke={class:"border-b px-3 py-3 flex items-center justify-between"},ze={class:"mt-2 space-y-3 px-5"},Ge={class:"rounded px-2 py-2"},He={class:"font-semibold text-red-500"},Qe={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Je(l,o,a,d,t,n){const u=D,p=c("TransitionChild"),v=c("ExclamationTriangleIcon"),k=c("DialogTitle"),h=c("XMarkIcon"),m=c("FormKit"),_=ee,g=c("DialogPanel"),I=c("Dialog"),w=c("TransitionRoot");return b(),j("div",null,[s(u,{click:n.handleClick,color:"error",text:"Reverse",icon:t.reverseIcon},null,8,["click","icon"]),s(w,{appear:"",show:t.show,as:"template"},{default:r(()=>[s(I,{as:"div",class:"relative z-10"},{default:r(()=>[s(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:r(()=>[Le]),_:1}),e("div",$e,[e("div",Ee,[s(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:r(()=>[s(g,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:r(()=>[e("div",Ke,[s(k,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:r(()=>[s(v,{class:"h-5 w-5 mr-2"}),y(" Confirm reverse ")]),_:1}),e("button",{onClick:o[0]||(o[0]=(...i)=>n.handleClick&&n.handleClick(...i))},[s(h,{class:"w-5 h-5"})])]),s(m,{type:"form","submit-label":"Update",onSubmit:o[2]||(o[2]=i=>n.voidStockSupplier(a.data.id)),actions:!1},{default:r(({value:i})=>[e("div",ze,[e("div",Ge,[y(" Do you really want to reverse adjustment of "),e("span",He,f(a.data.name),1),y("? Note that once this action is completed, it can not be undone ")]),s(m,{type:"textarea",label:"Reason",validation:"required",modelValue:t.reason,"onUpdate:modelValue":o[1]||(o[1]=X=>t.reason=X)},null,8,["modelValue"])]),e("div",Qe,[s(_,{click:()=>{n.handleClick()},type:"button",text:"Cancel"},null,8,["click"]),s(u,{loading:t.loading,type:"submit",click:()=>{},color:"error",icon:t.reverseIcon,text:"Reverse"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const We=C(Fe,[["render",Je]]),Ye={setup(){E({title:`${oe.name.toUpperCase()} - Stock Adjustments`})},data(){return{pages:[{name:"Home",link:"/home"},{name:"Stock Management",link:"#"}],header:"Stock Adjustments",search:"",loading:!1,headers:[{text:"item",value:"name",sortable:!0},{text:"lot",value:"lot"},{text:"batch",value:"batch"},{text:"adjustment",value:"transacted_quantity"},{text:"reason",value:"reason"},{text:"date created",value:"transaction_date"},{text:"actions",value:"actions"}],cookie:V("token"),adjustments:new Array,serverItemsLength:0,serverOptions:{page:1,rowsPerPage:25,sortBy:"name"}}},computed:{filteredAdjustments(){return this.adjustments.map(l=>({...l,transaction_date:N(l.transaction_date).format(B)}))}},created(){this.init()},methods:{async init(){this.loading=!0;const l=new x,{page:o,rowsPerPage:a}=this.serverOptions,d=`search=${this.search}&page=${o}&per_page=${a}&transaction_type=adjust stock`,{data:t,pending:n,error:u}=await l.getStockTransactions(`${this.cookie}`,d);this.loading=n,t.value&&(this.adjustments=t.value.data,this.loading=!1,this.serverItemsLength=t.value.meta.total_count),u.value&&(console.error(u.value),this.loading=!1)}},watch:{search(l){this.init()}}},Ze={class:"px-5 py-5"},et={class:"flex items-center justify-between py-5"},tt=e("h3",{class:"text-2xl font-semibold"},"Stock Adjustments",-1),ot={class:"flex items-center space-x-3"},st={class:"flex items-center justify-end py-5"},at={class:"py-2 flex items-center space-x-2"};function nt(l,o,a,d,t,n){const u=F,p=fe,v=J,k=Xe,h=We,m=te;return b(),j("div",Ze,[s(u,{pages:t.pages},null,8,["pages"]),e("div",et,[tt,e("div",ot,[s(p,{onUpdate:n.init},null,8,["onUpdate"])])]),e("div",st,[s(v,{search:t.search,"onUpdate:search":o[0]||(o[0]=_=>t.search=_)},null,8,["search"])]),e("div",null,[s(m,{loading:t.loading,headers:t.headers,data:n.filteredAdjustments,"search-value":t.search,"search-field":"name",serverItemsLength:t.serverItemsLength,serverOptions:t.serverOptions,onUpdate:n.init},{actions:r(({item:_})=>[e("div",at,[s(k,{data:_},null,8,["data"]),s(h,{data:_,onUpdate:n.init},null,8,["data","onUpdate"])])]),_:1},8,["loading","headers","data","search-value","serverItemsLength","serverOptions","onUpdate"])])])}const Rt=C(Ye,[["render",nt]]);export{Rt as default};
