import{_ as L}from"./ClfMiJjE.js";import{b as g,e as w,g as t,S as D,p as V,Y as T,G as A,V as M,q as R,s as X,a as U,C as B,O as q,u as C,E as O,x as j,y as r,f as s,z as c,j as b,L as Z,K as F,_ as P,A as K,B as z,t as _,D as G}from"./CixClB4B.js";import{_ as H}from"./CZnR2foi.js";import{S as x}from"./Cz_aDqjf.js";import{r as Y}from"./sJwSpI0-.js";import{r as N}from"./h-nck--E.js";import{_ as Q}from"./gABIlpKP.js";import{_ as $}from"./DBmflaAt.js";import{_ as J}from"./cY2JJaup.js";import{_ as W}from"./C53nXZ5b.js";import{P as ee}from"./BlxtFnsa.js";import{u as te}from"./CxhUJg9t.js";import"./Byfr2sQ2.js";import"./DrXEl-8J.js";import"./BlKCRsM0.js";import"./DAlPpLNd.js";import"./D9hf2VAK.js";import"./BLRrhyVY.js";import"./C4oDdWzi.js";import"./DPlxV2k2.js";import"./Hu_azF7F.js";import"./CTps4lyc.js";function oe(a,e){return g(),w("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{d:"M6 12a.75.75 0 0 1-.75-.75v-7.5a.75.75 0 1 1 1.5 0v7.5A.75.75 0 0 1 6 12ZM18 12a.75.75 0 0 1-.75-.75v-7.5a.75.75 0 0 1 1.5 0v7.5A.75.75 0 0 1 18 12ZM6.75 20.25v-1.5a.75.75 0 0 0-1.5 0v1.5a.75.75 0 0 0 1.5 0ZM18.75 18.75v1.5a.75.75 0 0 1-1.5 0v-1.5a.75.75 0 0 1 1.5 0ZM12.75 5.25v-1.5a.75.75 0 0 0-1.5 0v1.5a.75.75 0 0 0 1.5 0ZM12 21a.75.75 0 0 1-.75-.75v-7.5a.75.75 0 0 1 1.5 0v7.5A.75.75 0 0 1 12 21ZM3.75 15a2.25 2.25 0 1 0 4.5 0 2.25 2.25 0 0 0-4.5 0ZM12 11.25a2.25 2.25 0 1 1 0-4.5 2.25 2.25 0 0 1 0 4.5ZM15.75 15a2.25 2.25 0 1 0 4.5 0 2.25 2.25 0 0 0-4.5 0Z"})])}const se={components:{TransitionRoot:D,TransitionChild:V,Dialog:T,DialogPanel:A,DialogTitle:M,XMarkIcon:R,UserIcon:Y},data(){return{open:!1,addIcon:X,ajustIcon:oe,clearIcon:N,reasons:new Array,loading:!1,reasonSelected:{name:"-- select reason --"},stockItemSelected:{name:"-- select stock item --"},stockItems:new Array,cookie:U("token"),inStock:0,afterStock:0,adjustment:0,stock:{id:0},lot:"",batch:"",reason:"",notes:""}},methods:{handleClick(){this.open=!this.open},async getReasons(){const a=new x,{data:e,error:n}=await a.getStockAdjustmentReasons(`${this.cookie}`);e.value&&(this.reasons=e.value),n.value&&console.error(n.value)},async init(){this.handleClick(),await this.getReasons();const a=new x,{data:e,error:n}=await a.getStockItem(`${this.cookie}`);e.value&&(this.stockItems=e.value.filter(d=>({...d,created_date:B(d.created_date).format(q)}))),n.value&&console.error(n.value)},async getStock(a){const e=new x,{data:n,error:d}=await e.readStockItem(`${this.cookie}`,{id:a});n.value&&(this.afterStock=0,this.adjustment=0,this.inStock=n.value.stock.quantity,this.stock=n.value.stock),d.value&&console.error(d.value)},async submitForm(){this.loading=!0;const a=new x;let e={stock_id:this.stock.id,lot:this.lot,batch:this.batch,quantity_to_adjusted:this.adjustment,reason:this.reason==""?this.reasonSelected.name:this.reason,notes:this.notes};const{data:n,error:d,pending:o}=await a.adjustStock(`${this.cookie}`,e);this.loading=o,n.value&&(this.afterStock=0,this.adjustment=0,this.loading=!1,this.stockItems=new Array,this.reasons=new Array,this.reasonSelected={name:"-- select reason --"},this.stockItemSelected={name:"-- select stock item --"},this.handleClick(),C().$toast.success("Stock adjustment successfully done!"),this.$emit("update",!0)),d.value&&(console.error(d.value),this.loading=!1,C().$toast.error(O))}},watch:{stockItemSelected:{handler(a){this.getStock(a.id)},deep:!0},adjustment:{handler(a){this.afterStock=Number(this.inStock)+Number(a)},deep:!0}}},ne={class:"fixed inset-0 overflow-y-auto"},ae={class:"flex min-h-full items-center justify-center p-4 text-center"},le={class:"border-b px-3 py-3 flex items-center justify-between"},ie={class:"py-5 px-5 space-y-3"},re={class:"flex flex-col space-y-1.5"},ce={class:"mt-2"},de={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function ue(a,e,n,d,o,l){const m=P,p=r("TransitionChild"),h=r("DialogTitle"),k=r("XMarkIcon"),v=H,u=r("FormKit"),f=r("DialogPanel"),y=r("Dialog"),I=r("TransitionRoot");return g(),w("div",null,[t("div",null,[s(m,{text:"Create Stock Adjustment",color:"primary",icon:o.addIcon,click:l.init},null,8,["icon","click"])]),s(I,{appear:"",show:o.open,as:"template"},{default:c(()=>[s(y,{as:"div",onClose:l.handleClick,class:"relative z-10"},{default:c(()=>[s(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:c(()=>e[10]||(e[10]=[t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),t("div",ne,[t("div",ae,[s(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:c(()=>[s(f,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:c(()=>[t("div",le,[s(h,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:c(()=>e[11]||(e[11]=[b(" Create Stock Adjustment ")])),_:1}),t("button",{onClick:e[0]||(e[0]=(...S)=>l.handleClick&&l.handleClick(...S))},[s(k,{class:"w-5 h-5"})])]),s(u,{type:"form","submit-label":"Update",onSubmit:l.submitForm,actions:!1,id:"submitForm"},{default:c(({value:S})=>[t("div",ie,[t("div",re,[e[12]||(e[12]=t("label",{class:"font-medium"},"Reason",-1)),s(v,{items:o.reasons,modelValue:o.reasonSelected,"onUpdate:modelValue":e[1]||(e[1]=i=>o.reasonSelected=i)},null,8,["items","modelValue"]),t("div",ce,[o.reasonSelected.name.toLowerCase()=="other"?(g(),Z(u,{key:0,type:"textarea",label:"Please write your reason for (Other)",validation:"required",modelValue:o.reason,"onUpdate:modelValue":e[2]||(e[2]=i=>o.reason=i)},null,8,["modelValue"])):F("",!0)])]),t("div",null,[e[13]||(e[13]=t("label",{class:"font-medium"},"Stock Item",-1)),s(v,{"is-searchable":!0,items:o.stockItems,modelValue:o.stockItemSelected,"onUpdate:modelValue":e[3]||(e[3]=i=>o.stockItemSelected=i)},null,8,["items","modelValue"])]),s(u,{type:"number",label:"In Stock",disabled:"",modelValue:o.inStock,"onUpdate:modelValue":e[4]||(e[4]=i=>o.inStock=i)},null,8,["modelValue"]),s(u,{type:"number",label:"Adjustment",validation:"required",modelValue:o.adjustment,"onUpdate:modelValue":e[5]||(e[5]=i=>o.adjustment=i)},null,8,["modelValue"]),s(u,{type:"number",label:"Stock After",disabled:"",modelValue:o.afterStock,"onUpdate:modelValue":e[6]||(e[6]=i=>o.afterStock=i)},null,8,["modelValue"]),s(u,{type:"text",label:"Batch",validation:"required",modelValue:o.batch,"onUpdate:modelValue":e[7]||(e[7]=i=>o.batch=i)},null,8,["modelValue"]),s(u,{type:"text",label:"Lot",validation:"required",modelValue:o.lot,"onUpdate:modelValue":e[8]||(e[8]=i=>o.lot=i)},null,8,["modelValue"]),s(u,{type:"textarea",label:"Notes",validation:"required",modelValue:o.notes,"onUpdate:modelValue":e[9]||(e[9]=i=>o.notes=i)},null,8,["modelValue"])]),t("div",de,[s(m,{loading:o.loading,type:"submit",click:()=>{},color:"success",icon:o.ajustIcon,text:"Adjust"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const me=j(se,[["render",ue]]),pe={components:{TransitionRoot:D,TransitionChild:V,Dialog:T,DialogPanel:A,DialogTitle:M,XMarkIcon:R},data(){return{viewIcon:K,show:!1,editIcon:z}},props:{data:{type:Object,required:!0}},methods:{handleClick(){this.show=!this.show}}},fe={class:"fixed inset-0 overflow-y-auto"},_e={class:"flex min-h-full items-center justify-center p-4 text-center"},ve={class:"border-b px-3 py-3 flex items-center justify-between"},he={class:"space-y-3 px-5 py-5"},ke={class:"w-full flex flex-col space-y-1"},xe={class:"w-full flex flex-col space-y-1"},ge={class:"w-full flex flex-col space-y-1"},ye={class:"w-full flex flex-col space-y-1"},be={class:"w-full flex flex-col space-y-1"},we={class:"w-full flex flex-col space-y-1"},Se={class:"w-full flex flex-col space-y-1"},Ce={class:"w-full flex flex-col space-y-1"};function je(a,e,n,d,o,l){const m=P,p=r("TransitionChild"),h=r("DialogTitle"),k=r("XMarkIcon"),v=r("DialogPanel"),u=r("Dialog"),f=r("TransitionRoot");return g(),w("div",null,[s(m,{click:()=>{l.handleClick()},color:"primary",text:"View",icon:o.viewIcon},null,8,["click","icon"]),s(f,{appear:"",show:o.show,as:"template"},{default:c(()=>[s(u,{as:"div",class:"relative z-10"},{default:c(()=>[s(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:c(()=>e[1]||(e[1]=[t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),t("div",fe,[t("div",_e,[s(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:c(()=>[s(v,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:c(()=>[t("div",ve,[s(h,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:c(()=>e[2]||(e[2]=[t("img",{src:$,class:"w-8 h-8 mr-2"},null,-1),b(" View Stock Adjustment ")])),_:1}),t("button",{onClick:e[0]||(e[0]=(...y)=>l.handleClick&&l.handleClick(...y))},[s(k,{class:"w-5 h-5"})])]),t("div",he,[t("div",ke,[e[3]||(e[3]=t("label",{class:"font-semibold text-lg"},"Name",-1)),t("p",null,_(n.data.name),1)]),t("div",xe,[e[4]||(e[4]=t("label",{class:"font-semibold text-lg"},"Description",-1)),t("p",null,_(n.data.description),1)]),t("div",ge,[e[5]||(e[5]=t("label",{class:"font-semibold text-lg"},"Lot",-1)),t("p",null,_(n.data.lot),1)]),t("div",ye,[e[6]||(e[6]=t("label",{class:"font-semibold text-lg"},"Batch",-1)),t("p",null,_(n.data.batch),1)]),t("div",be,[e[7]||(e[7]=t("label",{class:"font-semibold text-lg"},"Quantity Adjusted",-1)),t("p",null,_(n.data.transacted_quantity),1)]),t("div",we,[e[8]||(e[8]=t("label",{class:"font-semibold text-lg"},"Reason",-1)),t("p",null,_(n.data.reason),1)]),t("div",Se,[e[9]||(e[9]=t("label",{class:"font-semibold text-lg"},"Remarks",-1)),t("p",null,_(n.data.remarks),1)]),t("div",Ce,[e[10]||(e[10]=t("label",{class:"font-semibold text-lg"},"Transaction Date",-1)),t("p",null,_(n.data.transaction_date),1)])])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const Ie=j(pe,[["render",je]]),De={components:{TransitionRoot:D,TransitionChild:V,Dialog:T,DialogPanel:A,DialogTitle:M,XMarkIcon:R,ExclamationTriangleIcon:G},data(){return{show:!1,reverseIcon:N,loading:!1,reason:"",cookie:U("token")}},props:{data:{type:Object,required:!0}},methods:{async voidStockSupplier(a){this.loading=!0;const e=new x,n={stock_transaction_id:this.data.id,reason:this.reason,id:a},{data:d,error:o,pending:l}=await e.reverseStockAdjustment(`${this.cookie}`,n);this.loading=l,d.value&&(this.handleClick(),C().$toast.success("Stock adjustment reversed successfully!"),this.loading=!1,this.reason="",this.$emit("update",!0)),o.value&&(console.error(o.value),C().$toast.error(O),this.loading=!1)},handleClick(){this.show=!this.show}}},Ve={class:"fixed inset-0 overflow-y-auto"},Te={class:"flex min-h-full items-center justify-center p-4 text-center"},Ae={class:"border-b px-3 py-3 flex items-center justify-between"},Me={class:"mt-2 space-y-3 px-5"},Re={class:"rounded px-2 py-2"},Ue={class:"font-semibold text-red-500"},Pe={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Be(a,e,n,d,o,l){const m=P,p=r("TransitionChild"),h=r("ExclamationTriangleIcon"),k=r("DialogTitle"),v=r("XMarkIcon"),u=r("FormKit"),f=J,y=r("DialogPanel"),I=r("Dialog"),S=r("TransitionRoot");return g(),w("div",null,[s(m,{click:l.handleClick,color:"error",text:"Reverse",icon:o.reverseIcon},null,8,["click","icon"]),s(S,{appear:"",show:o.show,as:"template"},{default:c(()=>[s(I,{as:"div",class:"relative z-10"},{default:c(()=>[s(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:c(()=>e[3]||(e[3]=[t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),t("div",Ve,[t("div",Te,[s(p,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:c(()=>[s(y,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:c(()=>[t("div",Ae,[s(k,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:c(()=>[s(h,{class:"h-5 w-5 mr-2"}),e[4]||(e[4]=b(" Confirm reverse "))]),_:1}),t("button",{onClick:e[0]||(e[0]=(...i)=>l.handleClick&&l.handleClick(...i))},[s(v,{class:"w-5 h-5"})])]),s(u,{type:"form","submit-label":"Update",onSubmit:e[2]||(e[2]=i=>l.voidStockSupplier(n.data.id)),actions:!1},{default:c(({value:i})=>[t("div",Me,[t("div",Re,[e[5]||(e[5]=b(" Do you really want to reverse adjustment of ")),t("span",Ue,_(n.data.name),1),e[6]||(e[6]=b("? Note that once this action is completed, it can not be undone "))]),s(u,{type:"textarea",label:"Reason",validation:"required",modelValue:o.reason,"onUpdate:modelValue":e[1]||(e[1]=E=>o.reason=E)},null,8,["modelValue"])]),t("div",Pe,[s(f,{click:()=>{l.handleClick()},type:"button",text:"Cancel"},null,8,["click"]),s(m,{loading:o.loading,type:"submit",click:()=>{},color:"error",icon:o.reverseIcon,text:"Reverse"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const qe=j(De,[["render",Be]]),Oe={setup(){te({title:`${ee.name.toUpperCase()} - Stock Adjustments`})},data(){return{pages:[{name:"Home",link:"/home"},{name:"Stock Management",link:"#"}],header:"Stock Adjustments",search:"",loading:!1,headers:[{text:"item",value:"name",sortable:!0},{text:"lot",value:"lot"},{text:"batch",value:"batch"},{text:"adjustment",value:"transacted_quantity"},{text:"reason",value:"reason"},{text:"date created",value:"transaction_date"},{text:"actions",value:"actions"}],cookie:U("token"),adjustments:new Array,serverItemsLength:0,serverOptions:{page:1,rowsPerPage:25,sortBy:"name"}}},computed:{filteredAdjustments(){return this.adjustments.map(a=>({...a,transaction_date:B(a.transaction_date).format(q)}))}},created(){this.init()},methods:{async init(){this.loading=!0;const a=new x,{page:e,rowsPerPage:n}=this.serverOptions,d=`search=${this.search}&page=${e}&per_page=${n}&transaction_type=adjust stock`,{data:o,pending:l,error:m}=await a.getStockTransactions(`${this.cookie}`,d);this.loading=l,o.value&&(this.adjustments=o.value.data,this.loading=!1,this.serverItemsLength=o.value.meta.total_count),m.value&&(console.error(m.value),this.loading=!1)}},watch:{search(a){this.init()}}},Ne={class:"px-5 py-5"},Ee={class:"flex items-center justify-between py-5"},Le={class:"flex items-center space-x-3"},Xe={class:"flex items-center justify-end py-5"},Ze={class:"py-2 flex items-center space-x-2"};function Fe(a,e,n,d,o,l){const m=L,p=me,h=Q,k=Ie,v=qe,u=W;return g(),w("div",Ne,[s(m,{pages:o.pages},null,8,["pages"]),t("div",Ee,[e[1]||(e[1]=t("h3",{class:"text-2xl font-semibold"},"Stock Adjustments",-1)),t("div",Le,[s(p,{onUpdate:l.init},null,8,["onUpdate"])])]),t("div",Xe,[s(h,{search:o.search,"onUpdate:search":e[0]||(e[0]=f=>o.search=f)},null,8,["search"])]),t("div",null,[s(u,{loading:o.loading,headers:o.headers,data:l.filteredAdjustments,"search-value":o.search,"search-field":"name",serverItemsLength:o.serverItemsLength,serverOptions:o.serverOptions,onUpdate:l.init},{actions:c(({item:f})=>[t("div",Ze,[s(k,{data:f},null,8,["data"]),s(v,{data:f,onUpdate:l.init},null,8,["data","onUpdate"])])]),_:1},8,["loading","headers","data","search-value","serverItemsLength","serverOptions","onUpdate"])])])}const pt=j(Oe,[["render",Fe]]);export{pt as default};
