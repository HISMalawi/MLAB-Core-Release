import{_ as me}from"./COJDNupw.js";import{_ as he}from"./CoQgzhbz.js";import{d as V,C as w,x as q,b as n,e as c,g as e,F as S,j as k,t as r,h as s,O as I,K as $,k as M,a6 as Z,r as u,a as fe,c as Y,w as J,y as X,f as m,aA as be,H as N,z as ye,L as F,l as C,m as P,u as U,_ as ve,n as xe,as as $e}from"./BxD-h1LR.js";import{_ as Ee}from"./BNhNOnHe.js";import{_ as Te}from"./Cs7plFji.js";import{u as ge}from"./BmiBNsbw.js";import{_ as Ae}from"./CKMQEpqg.js";import{_ as Re}from"./B4cMvEBz.js";import{_ as De}from"./CQcCm1L6.js";import{u as Se}from"./DRcUz5ts.js";import{P as ke}from"./C1C0mJ5v.js";import{r as Ne}from"./BkJfYQCG.js";import{r as we}from"./CQe3LSWs.js";import"./Dm9r4zu1.js";import"./Cpa0DX47.js";import"./CV2CrNCX.js";import"./Bu7bZmRE.js";import"./pmVMiK7H.js";import"./BuhIHGoH.js";import"./2qDGpbGm.js";import"./DiIN0LOU.js";import"./DQVzKFZd.js";const Me=V({props:{data:{required:!0,type:Object}},data(){return{moment:w,headers:[{name:"SN"},{name:"Patient ID"},{name:"Patient Name"},{name:"Accession Number"},{name:"Specimen"},{name:"Receipt Date"},{name:"Tests"},{name:"Performed By"},{name:"Results"},{name:"Remarks"},{name:"Results Entry Date"},{name:"Authorized By"}],reportData:this.data}}}),Oe={class:"w-full overflow-x-auto"},Ce={class:"w-full text-left overflow-y-auto"},Pe={class:"uppercase bg-gray-100"},Ie={class:"border-b"},Ve={class:"px-2 py-2 font-normal border-r"},Le={class:"px-2 py-2 font-normal border-r"},je={class:"px-2 py-2 font-normal border-r"},Be={class:"px-2 py-2 font-normal border-r"},Ye={class:"px-2 py-2 font-normal border-r"},Fe={class:"px-2 py-2 font-normal border-r"},Ue={class:"px-2 py-2 font-normal border-r"},qe={class:"px-2 py-2 font-normal border-r"},Ge={class:"px-2 py-2 font-normal border-r"},ze={key:0,class:"font-medium"},He={class:"px-2 py-2 font-normal border-r"},Ke={class:"px-2 py-2 font-normal border-r"},Je={class:"px-2 py-2 font-normal"};function Xe(a,E,R,f,T,b){return n(),c("div",Oe,[e("table",Ce,[e("thead",Pe,[e("tr",Ie,[(n(!0),c(S,null,k(a.headers,(o,i)=>(n(),c("th",{class:"uppercase py-2 px-2 border-r",key:i},r(o.name),1))),128))])]),e("tbody",null,[(n(!0),c(S,null,k(a.data.data,(o,i)=>(n(),c("tr",{class:"bg-white border-b",key:i},[e("th",Ve,r(i+1),1),e("th",Le,r(o.patient_id),1),e("th",je,r(o.patient_name),1),e("th",Be,r(o.accession_number),1),e("th",Ye,r(o.specimen),1),e("th",Fe,r(a.moment(o.receipt_date).format("DATE_FORMAT"in a?a.DATE_FORMAT:s(I))),1),e("th",Ue,r(o.test),1),e("th",qe,r(o.performed_by),1),e("th",Ge,[(n(!0),c(S,null,k(o.results,(h,g)=>(n(),c("p",{key:g},[h!=null&&h!==""?(n(),c("span",ze,r(`${g}:`),1)):$("",!0),M(" "+r(h),1)]))),128))]),e("th",He,r(o.remarks),1),e("th",Ke,r(a.moment(o.result_date).format("DATE_FORMAT"in a?a.DATE_FORMAT:s(I))),1),e("th",Je,r(o.authorized_by),1)]))),128))])])])}const Ze=q(Me,[["render",Xe]]),Qe=V({props:{data:{required:!0,type:Object}},data(){var a;return{details:(a=this.data)==null?void 0:a.data}},methods:{removeDuplicates(a){return a.filter((R,f)=>a.findIndex(T=>T.patient_no===R.patient_no)===f)}}}),We={class:"w-full text-left"},et=e("thead",{class:"uppercase bg-gray-100"},[e("tr",{class:"border-b"},[e("th",{class:"uppercase py-2 px-2 border-r"},"SN"),e("th",{class:"uppercase py-2 px-2 border-r"},"PATIENT NO"),e("th",{class:"uppercase py-2 px-2 border-r"},"PATIENT NAME"),e("th",{class:"uppercase py-2 px-2 border-r"},"AGE"),e("th",{class:"uppercase py-2 px-2 border-r"},"SEX"),e("th",{class:"uppercase py-2 px-2 border-r"},"ACCESSION NUMBER"),e("th",{class:"uppercase py-2 px-2 border-r"},"SPECIMEN TYPE"),e("th",{class:"uppercase py-2 px-2 border-r"},"TESTS")])],-1),tt={class:"px-2 py-2 font-normal border-r border-b"},st={class:"px-2 py-2 font-normal border-r border-b"},ot={class:"px-2 py-2 font-normal border-r border-b"},rt={class:"px-2 py-2 font-normal border-r border-b"},at={class:"px-2 py-2 font-normal border-r border-b"},nt={class:"px-2 py-2 font-normal border-r border-b"},lt={class:"px-2 py-2 font-normal border-r border-b"},ct={class:"px-2 py-2 font-normal border-r border-b space-y-1"},pt=e("div",{class:"px-3 py-3 uppercase"},"SUMMARY",-1),dt={class:"w-full text-left"},it=e("thead",{class:"uppercase bg-gray-100"},[e("tr",{class:"border-b"},[e("th",{class:"uppercase py-2 px-2 border-r"},"TOTAL VISITS"),e("th",{class:"uppercase py-2 px-2 border-r"},"MALE"),e("th",{class:"uppercase py-2 px-2 border-r"},"FEMALE")])],-1),ut={class:"px-2 py-2 font-normal border-r border-b"},_t={class:"px-2 py-2 font-normal border-r border-b"},mt={class:"px-2 py-2 font-normal border-r border-b"};function ht(a,E,R,f,T,b){return n(),c("div",null,[e("div",null,[e("table",We,[et,e("tbody",null,[(n(!0),c(S,null,k(a.details,(o,i)=>(n(),c("tr",{key:i},[e("th",tt,r(i+1),1),e("th",st,r(o.patient_no),1),e("th",ot,r(o.patient_name),1),e("th",rt,r(("calculateAge"in a?a.calculateAge:s(Z))(o.dob)),1),e("th",at,r(o.gender),1),e("th",nt,r(o.accession_number),1),e("th",lt,r(o.specimen),1),e("th",ct,[(n(!0),c(S,null,k(o.test_type,(h,g)=>(n(),c("p",{key:g},r(h),1))),128))])]))),128))])])]),pt,e("table",dt,[it,e("tbody",null,[e("tr",null,[e("th",ut,r(a.data.visits.length),1),e("th",_t,r(a.removeDuplicates(a.details).filter(o=>o.gender=="M").length),1),e("th",mt,r(a.removeDuplicates(a.details).filter(o=>o.gender=="F").length),1)])])])])}const ft=q(Qe,[["render",ht]]),bt=V({props:{data:{required:!0,type:Object}},data(){var a;return{details:(a=this.data)==null?void 0:a.data}}}),yt={class:"w-full text-left"},vt=e("thead",{class:"uppercase bg-gray-100"},[e("tr",{class:"border-b"},[e("th",{class:"uppercase py-2 px-2 border-r"}," SN "),e("th",{class:"uppercase py-2 px-2 border-r"}," ACCESSION NUMBER "),e("th",{class:"uppercase py-2 px-2 border-r"}," SPECIMEN "),e("th",{class:"uppercase py-2 px-2 border-r"}," RECEIPT DATE "),e("th",{class:"uppercase py-2 px-2 border-r"}," TESTS "),e("th",{class:"uppercase py-2 px-2 border-r"}," LAB selection "),e("th",{class:"uppercase py-2 px-2 border-r"}," REJECTION REASON "),e("th",{class:"uppercase py-2 px-2 border-r"}," PERSON TALKED TO "),e("th",{class:"uppercase py-2 px-2 border-r"}," DATE REJECTED ")])],-1),xt={class:"px-2 py-2 font-normal border-r border-b"},$t={class:"px-2 py-2 font-normal border-r border-b"},Et={class:"px-2 py-2 font-normal border-r border-b"},Tt={class:"px-2 py-2 font-normal border-r border-b"},gt={class:"px-2 py-2 font-normal border-r border-b"},At={class:"px-2 py-2 font-normal border-r border-b"},Rt={class:"px-2 py-2 font-normal border-r border-b"},Dt={class:"px-2 py-2 font-normal border-r border-b"},St={class:"px-2 py-2 font-normal border-r border-b"};function kt(a,E,R,f,T,b){return n(),c("div",null,[e("table",yt,[vt,e("tbody",null,[(n(!0),c(S,null,k(a.details,(o,i)=>(n(),c("tr",{key:i},[e("th",xt,r(i+1),1),e("th",$t,r(o.accession_number),1),e("th",Et,r(o.specimen),1),e("th",Tt,r(o.receipt_date),1),e("th",gt,r(o.test),1),e("th",At,r(o.department),1),e("th",Rt,r(o.rejection_reason),1),e("th",Dt,r(o.person_talked_to),1),e("th",St,r(o.test_status_date),1)]))),128))])])])}const Nt=q(bt,[["render",kt]]),wt={class:"px-5 py-5"},Mt=e("div",{class:"flex items-center py-5"},[e("img",{src:Ae,alt:"report-icon",class:"w-8 h-8 mr-2"}),e("h3",{class:"text-2xl font-semibold uppercase"},"Daily Log Report")],-1),Ot={class:"flex items-center"},Ct={class:"bg-white flex space-x-5 py-5 flex-wrap"},Pt={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},It={class:"w-72 ml-2"},Vt={class:"flex flex-col"},Lt={class:"flex flex-col"},jt={class:"flex flex-col"},Bt={class:"flex flex-col"},Yt={class:"border rounded"},Ft={class:"flex items-center justify-between px-5 py-5 border-b"},Ut=e("div",{class:"flex flex-col space-y-2"},[e("img",{src:Re,alt:"app-logo",class:"w-24 h-24 object-cover"}),e("h3",{class:"text-xl font-semibold"},"DAILY LOG REPORT")],-1),qt={class:"px-5 py-3"},Gt={key:0,class:"text-lg font-semibold"},zt={class:"text-md font-normal"},Ht={class:"text-lg font-semibold"},Kt={class:"text-md font-normal"},Jt={key:0,class:"w-full border-t"},Xt={key:1,class:"w-full flex flex-col items-center justify-center space-y-2 py-10"},Zt=e("img",{src:De,alt:"page-icon",class:"object-cover w-20 h-20"},null,-1),Qt=e("p",null,"Data not found, please generate report",-1),Wt=[Zt,Qt],es={key:2,class:"mx-auto justify-center flex flex-col items-center space-y-3 py-10"},ts=e("p",{class:"text-base"},[M(" Generating report, please wait"),e("span",{class:"animate-ping"},"...")],-1),gs=V({__name:"daily-log",setup(a){ge({title:`${ke.name} - Daily Log Reports`});const E=Se(),R=u([{name:"Home",link:"/home"},{name:"Reports",link:"#"}]),f=fe("token"),T=u([]),b=u({name:"select department"}),o=u([]),i=new $e,h=u({name:"select test type"}),g=u([]),A=u({name:"select test status"}),v=u(["",""]),_=u({}),G=u(0),Q=u([{name:"Test record",value:"test_record"},{name:"Patient record",value:"patient_record"}]),d=u({name:"select report type",value:"select report type"}),x=u(!1),L=Y(()=>v.value[0]?w(v.value[0]).format("YYYY-MM-DD"):""),j=Y(()=>v.value[1]?w(v.value[1]).format("YYYY-MM-DD"):""),W=()=>{v.value=["",""]};async function ee(){const l={route:C.departments,method:"GET",token:`${f.value}`},{data:t,error:p}=await P(l);t.value&&(T.value=t.value),p.value&&console.error(p.value)}async function z(){const l={route:`${C.testTypes}/by_department?department_id=${b.value.id}`,method:"GET",token:`${f.value}`},{data:t,error:p}=await P(l);t.value&&(o.value=t.value),p.value&&console.error(p.value)}function B(l){let t="";return l=="select department"||l==="select test type"||l==="select test status"?t="":t=l,t}async function te(){const l={route:`${C.testStatus}/all`,method:"GET",token:`${f.value}`},{data:t,error:p}=await P(l);t.value&&(g.value=t.value),p.value&&console.error(p.value)}const se=l=>Object.entries(l).map(([t,p])=>`${t}: ${p}`).join(", "),oe=Y(()=>{let l=new Array;return d.value.value=="test_record"&&_.value.data&&_.value.data.map(t=>{l.push({"PATIENT ID":t.patient_id,"PATIENT NAME":t.patient_name,"ACCESSION NUMBER":t.accession_number,SPECIMEN:t.specimen,"RECEIPT DATE":w(t.receipt_date).format(I),TEST:t.test,"PERFORMED BY":t.performed_by,RESULTS:se(t.results),REMARKS:t.remarks,"RESULTS ENTRY DATE":w(t.result_date).format(I),"AUTHORIZED BY":t.authorized_by})}),d.value.value=="patient_record"&&_.value.data&&_.value.data.map(t=>{l.push({"PATIENT ID":t.patient_no,"PATIENT NAME":t.patient_name,AGE:Z(t.dob),SEX:t.gender,"ACCESSION NUMBER":t.accession_number,"SPECIMEN TYPE":t.specimen,TESTS:t.test_type.join(", ")})}),l}),re=()=>{i.cancel(U)};async function ae(){var l;if(x.value=!0,d.value.value!="select report type"){let t=`from=${L.value}&to=${j.value}&department=${B(b.value.name)}&report_type=${d.value.value}&test_status=${B(A.value.name)}&test_type=${B(h.value.name)}`;const{data:p,error:O,pending:D}=await P({route:`${C.dailyReports}/daily_log?${t}`,method:"GET",token:`${f.value}`},i);x.value=D,p.value&&(x.value=!1,((l=p.value)==null?void 0:l.data.length)==0&&U().$toast.warning("No data found for specified parameters"),_.value=p.value,d.value.value=="test_record"&&(G.value=p.value.completed_tests)),O.value&&(x.value=!1,console.error(O.value))}else U().$toast.warning("Please select the report type before generating the report"),x.value=!1}return J(()=>b.value,()=>{z()}),J(()=>d.value,()=>{_.value=[]}),ee(),z(),te(),(l,t)=>{var H,K;const p=me,O=X("datepicker"),D=he,ne=ve,le=Ee,ce=X("excel"),pe=Te,de=Ze,ie=ft,ue=Nt,_e=xe;return n(),c("div",wt,[m(p,{pages:s(R)},null,8,["pages"]),Mt,e("div",Ot,[e("div",Ct,[e("div",Pt,[m(s(Ne),{class:"w-5 h-5 mr-2"}),M(" Filter By Date Range "),e("div",It,[m(O,{required:"",position:"left",placeholder:"select start & end date",range:!0,format:"DATE_FORMAT_NO_TIME"in l?l.DATE_FORMAT_NO_TIME:s(be),onCleared:W,"input-class-name":"datepicker",modelValue:s(v),"onUpdate:modelValue":t[0]||(t[0]=y=>N(v)?v.value=y:null)},null,8,["format","modelValue"])])]),e("div",Vt,[m(D,{items:s(T),modelValue:s(b),"onUpdate:modelValue":t[1]||(t[1]=y=>N(b)?b.value=y:null)},null,8,["items","modelValue"])]),e("div",Lt,[m(D,{items:s(o),modelValue:s(h),"onUpdate:modelValue":t[2]||(t[2]=y=>N(h)?h.value=y:null)},null,8,["items","modelValue"])]),e("div",jt,[m(D,{items:s(g),modelValue:s(A),"onUpdate:modelValue":t[3]||(t[3]=y=>N(A)?A.value=y:null)},null,8,["items","modelValue"])]),e("div",Bt,[m(D,{items:s(Q),modelValue:s(d),"onUpdate:modelValue":t[4]||(t[4]=y=>N(d)?d.value=y:null)},null,8,["items","modelValue"])]),m(ne,{color:"primary",text:"Generate Report",icon:s(we),loading:s(x),click:()=>ae()},null,8,["icon","loading","click"]),m(ce,{class:"btn btn-default",header:[`DAILY LOG ${s(d).name.toUpperCase()} REPORT`,`PERIOD: ${s(L)} - ${s(j)}`,s(E).details.name,s(E).details.address,s(E).details.phone],data:s(oe),worksheet:"report-work-sheet",name:`daily_log_${s(d).value}_report.xls`},{default:ye(()=>[m(le,{text:"Export Excel"})]),_:1},8,["header","data","name"])])]),e("div",Yt,[e("div",Ft,[Ut,m(pe)]),e("div",qt,[s(d).value=="test_record"&&s(A).name!=="test-rejected"?(n(),c("h3",Gt,[M(" Test Record: "),e("span",zt,r(s(G).toLocaleString())+" completed tests",1)])):$("",!0),e("h3",Ht,[M(" Tests Performed Period: "),e("span",Kt,r(s(L))+" - "+r(s(j)),1)])]),((K=(H=s(_))==null?void 0:H.data)==null?void 0:K.length)>0?(n(),c("div",Jt,[s(d).value=="test_record"&&s(A).name!=="test-rejected"?(n(),F(de,{key:0,data:s(_)},null,8,["data"])):$("",!0),s(d).value=="patient_record"?(n(),F(ie,{key:1,data:s(_)},null,8,["data"])):$("",!0),s(A).name=="test-rejected"?(n(),F(ue,{key:2,data:s(_)},null,8,["data"])):$("",!0)])):$("",!0),s(_).length==0&&!s(x)?(n(),c("div",Xt,Wt)):$("",!0),s(x)&&s(_).length==0?(n(),c("div",es,[m(_e),ts,e("button",{class:"font-medium text-base text-sky-500",onClick:re},"Cancel")])):$("",!0)])])}}});export{gs as default};
