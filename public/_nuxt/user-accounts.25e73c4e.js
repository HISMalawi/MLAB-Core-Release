import{_ as te}from"./Breadcrumb.vue.6f7f01db.js";import{o as g,c as x,e as t,a as A,b as q,_ as L,g as c,d as o,h as u,i as I,w as U,j as R,f as F,v as $,t as D,F as O,r as G,k as Y,u as se}from"./entry.5bdb8488.js";import{_ as X}from"./OutlinedButton.f18d48ca.js";import{e as J}from"./constants.b04a9525.js";import{r as Q,e as w,f as b,h as oe,a as le}from"./fetch.7dc9d831.js";import{r as M}from"./XMarkIcon.49b75dff.js";import{r as z}from"./UserIcon.ef43faf0.js";import{r as W}from"./ArrowDownTrayIcon.1d4f2a31.js";import{r as K}from"./ArrowUturnLeftIcon.182cf6f5.js";import{S as N,h as P,U as j,G as B,V as E}from"./transition.ad4c8a99.js";import{_ as ae}from"./SearchBar.5d48c2eb.js";import{_ as Z}from"./Loader.2016ba72.js";import{r as ne,a as ee}from"./PencilSquareIcon.551b626a.js";import{_ as ie}from"./Datatable.d21eac23.js";import{P as re}from"./package.62af87d2.js";import{r as de}from"./MagnifyingGlassIcon.d967f597.js";import"./nuxt-link.e30313a8.js";import"./HomeIcon.db590299.js";import"./network.3c519541.js";import"./PrinterIcon.df26e017.js";import"./hidden.b0c25628.js";function ce(l,s){return g(),x("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[t("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.72 6.97a.75.75 0 10-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 101.06 1.06L12 13.06l1.72 1.72a.75.75 0 101.06-1.06L13.06 12l1.72-1.72a.75.75 0 10-1.06-1.06L12 10.94l-1.72-1.72z","clip-rule":"evenodd"})])}const ue={components:{TransitionRoot:N,TransitionChild:P,Dialog:j,DialogPanel:B,DialogTitle:E,XMarkIcon:M,UserIcon:z},data(){return{open:!1,addIcon:Q,saveIcon:W,clearIcon:K,departmentSelected:null,departments:new Array,rawDepartments:new Array,cookie:A("token"),roles:new Array,rawRoles:new Array,roleSelected:null,rawLocations:new Array,locations:new Array,locationSelected:null,firstName:"",middleName:"",lastName:"",username:"",sex:"",password:"",confirmPassword:"",dateOfBirth:"",loading:!1,maxDate:(()=>{const l=new Date;return l.setFullYear(l.getFullYear()-14),l.setDate(l.getDate()+1),l})()}},methods:{async loadRoles(){const l={route:w.roles,method:"GET",token:`${this.cookie}`},{data:s,error:a}=await b(l);s.value&&(this.rawRoles=s.value,s.value.map(d=>{this.roles.push(d.name)})),a.value&&console.error(a.value)},async loadLocations(){const l={route:w.locations,method:"GET",token:`${this.cookie}`},{data:s,error:a}=await b(l);s.value&&(this.rawLocations=s.value,s.value.map(d=>{this.locations.push(d.name)})),a.value&&console.error(a.value)},async loadDepartments(){const l={route:w.departments,method:"GET",token:`${this.cookie}`},{data:s,error:a}=await b(l);s.value&&(this.rawDepartments=s.value,s.value.map(d=>{this.departments.push(d.name)})),a.value&&console.error(a.value)},async submitForm(){this.loading=!0;const l=this.departmentSelected?this.departmentSelected.map(n=>{var r;return(r=this.rawDepartments.find(_=>n===_.name))==null?void 0:r.id}).filter(n=>n!==void 0).map(Number):[],s=this.roleSelected?this.roleSelected.map(n=>{var r;return(r=this.rawRoles.find(_=>n===_.name))==null?void 0:r.id}).filter(n=>n!==void 0):[],a=this.locationSelected?this.locationSelected.map(n=>{var r;return(r=this.rawLocations.find(_=>n===_.name))==null?void 0:r.id}).filter(n=>n!==void 0).map(Number):[],d={route:w.users,method:"POST",token:`${this.cookie}`,body:{person:{first_name:this.firstName,middle_name:this.middleName,last_name:this.lastName,sex:this.sex,date_of_birth:this.dateOfBirth},user:{username:this.username,password:this.password},roles:s,departments:l,lab_locations:a}},{data:e,error:i,pending:m}=await b(d);this.loading=m,e.value&&(this.handleClick(),q().$toast.success("User created successfully!"),this.$emit("update",!0),this.loading=!1),i.value&&(this.handleClick(),q().$toast.error(J),this.loading=!1,console.error(i.value))},async init(){await this.loadDepartments(),await this.loadRoles(),await this.loadLocations(),this.handleClick()},clearForm(){this.$formkit.reset("submitForm")},handleClick(){this.open=!this.open}}},H=""+new URL("person.534f8b85.svg",import.meta.url).href,me=t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),pe={class:"fixed inset-0 overflow-y-auto"},_e={class:"flex min-h-full items-center justify-center p-4 text-center"},fe={class:"border-b px-3 py-3 flex items-center justify-between"},he=t("img",{src:H,class:"w-8 h-8 mr-2"},null,-1),ve={class:"mt-2 space-y-3 px-5"},ge={class:"grid grid-cols-2 gap-4"},xe={class:"grid grid-cols-2 gap-4"},ye={class:"grid grid-cols-2 gap-4"},we={class:"flex items-center"},be=t("label",{class:"mr-5 font-medium text-lg"},"Sex",-1),ke={class:"flex items-center"},Ve=t("span",{class:"ml-2"},"Male",-1),Ce={class:"flex items-center ml-2"},De=t("span",{class:"ml-2"},"Female",-1),Ue={class:"w-full flex flex-col"},Se={class:"w-full flex flex-col space-y-2"},Te=t("label",{class:"font-medium"},"Select Role(s)",-1),Ie={class:"w-full flex flex-col"},qe={class:"w-full flex flex-col space-y-2"},Ae=t("label",{class:"font-medium"},"Select Laboratory Location(s)",-1),Le={class:"w-full flex flex-col"},Re={class:"w-full flex flex-col space-y-2"},$e=t("label",{class:"font-medium"},"Select Lab Section(s)",-1),Fe={class:"px-5"},Me=t("p",{class:"py-2 font-medium text-base"},"Date Of Birth",-1),Ne={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Pe(l,s,a,d,e,i){const m=F,n=c("TransitionChild"),r=c("DialogTitle"),_=c("XMarkIcon"),v=c("FormKit"),h=c("multi-select"),k=c("datepicker"),V=X,y=c("DialogPanel"),C=c("Dialog"),S=c("TransitionRoot");return g(),x("div",null,[t("div",null,[o(m,{text:"Add user",color:"primary",icon:e.addIcon,click:i.init},null,8,["icon","click"])]),o(S,{appear:"",show:e.open,as:"template"},{default:u(()=>[o(C,{as:"div",onClose:i.handleClick,class:"relative z-10"},{default:u(()=>[o(n,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>[me]),_:1}),t("div",pe,[t("div",_e,[o(n,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[o(y,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[t("div",fe,[o(r,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:u(()=>[he,I(" Add user ")]),_:1}),t("button",{onClick:s[0]||(s[0]=(...T)=>i.handleClick&&i.handleClick(...T))},[o(_,{class:"w-5 h-5"})])]),o(v,{type:"form",id:"submitForm","submit-label":"Update",onSubmit:i.submitForm,actions:!1},{default:u(({value:T})=>[t("div",ve,[t("div",ge,[o(v,{type:"text",label:"Username",validation:"required",modelValue:e.username,"onUpdate:modelValue":s[1]||(s[1]=p=>e.username=p)},null,8,["modelValue"]),o(v,{type:"text",label:"First name",modelValue:e.firstName,"onUpdate:modelValue":s[2]||(s[2]=p=>e.firstName=p),validation:"required"},null,8,["modelValue"])]),t("div",xe,[o(v,{type:"text",label:"Middle name",modelValue:e.middleName,"onUpdate:modelValue":s[3]||(s[3]=p=>e.middleName=p)},null,8,["modelValue"]),o(v,{type:"text",label:"Last name",validation:"required",modelValue:e.lastName,"onUpdate:modelValue":s[4]||(s[4]=p=>e.lastName=p)},null,8,["modelValue"])]),o(v,{type:"group"},{default:u(()=>[t("div",ye,[o(v,{type:"password",label:"Password",name:"password",validation:"required",modelValue:e.password,"onUpdate:modelValue":s[5]||(s[5]=p=>e.password=p),"validation-visibility":"live"},null,8,["modelValue"]),o(v,{type:"password",label:"Confirm password",name:"password_confirm",validation:"required|confirm","validation-label":"Password confirmation","validation-visibility":"live"})])]),_:1}),t("div",we,[be,t("label",ke,[U(t("input",{required:"","onUpdate:modelValue":s[6]||(s[6]=p=>e.sex=p),type:"radio",value:"M",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[R,e.sex]]),Ve]),t("label",Ce,[U(t("input",{required:"","onUpdate:modelValue":s[7]||(s[7]=p=>e.sex=p),type:"radio",value:"F",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[R,e.sex]]),De])]),t("div",Ue,[t("div",Se,[Te,o(h,{style:{"--ms-max-height":"none !important"},modelValue:e.roleSelected,"onUpdate:modelValue":s[8]||(s[8]=p=>e.roleSelected=p),options:e.roles,mode:"tags",searchable:!0,required:!0,clear:"",class:"outline-none focus:ring-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),t("div",Ie,[t("div",qe,[Ae,o(h,{style:{"--ms-max-height":"none !important"},modelValue:e.locationSelected,"onUpdate:modelValue":s[9]||(s[9]=p=>e.locationSelected=p),options:e.locations,mode:"tags",searchable:!0,required:!0,clear:"",class:"outline-none focus:ring-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),t("div",Le,[t("div",Re,[$e,o(h,{style:{"--ms-max-height":"none !important"},modelValue:e.departmentSelected,"onUpdate:modelValue":s[10]||(s[10]=p=>e.departmentSelected=p),options:e.departments,mode:"tags",searchable:!0,required:!0,clear:"",class:"outline-none focus:ring-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])])]),t("div",Fe,[Me,o(k,{range:!1,"input-class-name":"datepicker",format:"dd/MM/yyyy",position:"left",placeholder:"select date of birth",modelValue:e.dateOfBirth,"onUpdate:modelValue":s[11]||(s[11]=p=>e.dateOfBirth=p)},null,8,["modelValue"])]),t("div",Ne,[o(V,{type:"button",click:()=>{i.clearForm()},text:"Clear form"},null,8,["click"]),o(m,{loading:e.loading,type:"submit",click:()=>{},color:"success",icon:e.saveIcon,text:"Save Changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const je=L(ue,[["render",Pe]]),Be={components:{TransitionRoot:N,TransitionChild:P,Dialog:j,DialogPanel:B,DialogTitle:E,XMarkIcon:M,UserIcon:z},props:{data:{required:!0,type:Object}},data(){return{moment:oe,open:!1,addIcon:Q,viewIcon:ne,editIcon:ee,clearIcon:K,details:{id:"",username:"",first_name:"",last_name:"",middle_name:"",sex:"",date_of_birth:"",lab_locations:new Array,roles:new Array,departments:new Array},loading:!1,cookie:A("token")}},methods:{async init(){this.loading=!0;const l={route:`${w.users}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:s,error:a,pending:d}=await b(l);this.loading=d,s.value&&(this.details=s.value,this.loading=!1,this.adjustVisibility()),a.value&&(console.error(a.value),this.loading=!1)},adjustVisibility(){this.open=!this.open}}},Ee=t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Oe={class:"fixed inset-0 overflow-y-auto"},Ge={class:"flex min-h-full items-center justify-center p-4 text-center"},Xe={class:"border-b px-3 py-3 flex items-center justify-between"},ze=t("img",{src:H,class:"w-6 h-6 mr-2"},null,-1),Ke={class:"flex items-center justify-center mx-auto my-20"},He={class:"space-y-3 px-5 py-5"},Ye={class:"w-full flex flex-col space-y-1"},Je=t("label",{class:"font-semibold text-lg"},"Username",-1),Qe={class:"underline"},We={class:"w-full flex flex-col space-y-1"},Ze=t("label",{class:"font-semibold text-lg"},"First name",-1),et={class:"underline"},tt={class:"w-full flex flex-col space-y-1"},st=t("label",{class:"font-semibold text-lg"},"Last name",-1),ot={class:"underline"},lt={class:"w-full flex flex-col space-y-1"},at=t("label",{class:"font-semibold text-lg"},"Date of birth",-1),nt={class:"underline"},it={class:"w-full flex flex-col space-y-1"},rt=t("label",{class:"font-semibold text-lg"},"Roles",-1),dt={class:"w-full flex flex-col space-y-1"},ct=t("label",{class:"font-semibold text-lg"},"Locations",-1),ut={class:"w-full flex flex-col space-y-1"},mt=t("label",{class:"font-semibold text-lg"},"Departments",-1);function pt(l,s,a,d,e,i){const m=F,n=c("TransitionChild"),r=c("DialogTitle"),_=c("XMarkIcon"),v=Z,h=c("DialogPanel"),k=c("Dialog"),V=c("TransitionRoot");return g(),x("div",null,[t("div",null,[o(m,{text:"View",color:"primary",icon:e.viewIcon,click:i.init},null,8,["icon","click"])]),o(V,{appear:"",show:e.open,as:"template"},{default:u(()=>[o(k,{as:"div",onClose:i.adjustVisibility,class:"relative z-10"},{default:u(()=>[o(n,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>[Ee]),_:1}),t("div",Oe,[t("div",Ge,[o(n,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[o(h,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[t("div",Xe,[o(r,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:u(()=>[ze,I(" View User Account ")]),_:1}),t("button",{onClick:s[0]||(s[0]=(...y)=>i.adjustVisibility&&i.adjustVisibility(...y))},[o(_,{class:"w-5 h-5"})])]),U(t("div",Ke,[o(v,{loading:e.loading},null,8,["loading"])],512),[[$,e.loading]]),U(t("div",He,[t("div",Ye,[Je,t("p",Qe,D(e.details.username),1)]),t("div",We,[Ze,t("p",et,D(e.details.first_name),1)]),t("div",tt,[st,t("p",ot,D(e.details.last_name),1)]),t("div",lt,[at,t("p",nt,D(e.details.date_of_birth),1)]),t("div",it,[rt,(g(!0),x(O,null,G(e.details.roles,(y,C)=>(g(),x("p",{class:"underline",key:C},D(y.role_name),1))),128))]),t("div",dt,[ct,(g(!0),x(O,null,G(e.details.lab_locations,(y,C)=>(g(),x("p",{class:"underline",key:C},D(y.name),1))),128))]),t("div",ut,[mt,(g(!0),x(O,null,G(e.details.departments,(y,C)=>(g(),x("p",{class:"underline",key:C},D(y.name),1))),128))])],512),[[$,!e.loading]])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const _t=L(Be,[["render",pt]]),ft={components:{TransitionRoot:N,TransitionChild:P,Dialog:j,DialogPanel:B,DialogTitle:E,XMarkIcon:M,UserIcon:z},data(){return{open:!1,editIcon:ee,saveIcon:W,clearIcon:K,departmentSelected:null,departments:new Array,rawDepartments:new Array,rawLocations:new Array,locations:new Array,locationSelected:null,cookie:A("token"),roles:new Array,rawRoles:new Array,roleSelected:null,firstName:"",middleName:"",lastName:"",username:"",sex:"",password:"",confirmPassword:"",dateOfBirth:"",loading:!1,fetching:!1,details:{id:"",username:"",first_name:"",last_name:"",middle_name:"",old_password:"",new_password:"",sex:"",date_of_birth:"",roles:new Array,lab_locations:new Array,departments:new Array}}},props:{data:{required:!0,type:Object}},methods:{handleClick(){this.open=!this.open},async init(){await this.loadRoles(),await this.loadDepartments(),await this.loadLocations(),this.handleClick(),this.fetching=!0;const l={route:`${w.users}/${this.data.id}`,method:"GET",token:`${this.cookie}`},{data:s,error:a,pending:d}=await b(l);if(this.fetching=d,s.value){this.details=s.value,this.fetching=!1;const e=s.value.roles.map(({role_name:m})=>{var n;return(n=this.rawRoles.find(r=>m===r.name))==null?void 0:n.name}).filter(m=>m!==void 0);this.roleSelected=e;const i=s.value.departments.map(({name:m})=>{var n;return(n=this.rawDepartments.find(r=>m===r.name))==null?void 0:n.name}).filter(m=>m!==void 0);this.departmentSelected=i,this.locationSelected=s.value.lab_locations.map(({name:m})=>{var n;return(n=this.rawLocations.find(r=>m===r.name))==null?void 0:n.name}).filter(m=>m!==void 0)}a.value&&(console.error(a.value),this.fetching=!1)},async loadRoles(){const l={route:w.roles,method:"GET",token:`${this.cookie}`},{data:s,error:a}=await b(l);s.value&&(this.rawRoles=s.value,s.value.map(d=>{this.roles.push(d.name)})),a.value&&console.error(a.value)},async loadLocations(){const l={route:w.locations,method:"GET",token:`${this.cookie}`},{data:s,error:a}=await b(l);s.value&&(this.rawLocations=s.value,s.value.map(d=>{this.locations.push(d.name)})),a.value&&console.error(a.value)},async loadDepartments(){const l={route:w.departments,method:"GET",token:`${this.cookie}`},{data:s,error:a}=await b(l);s.value&&(this.rawDepartments=s.value,s.value.map(d=>{this.departments.push(d.name)})),a.value&&console.error(a.value)},async submitForm(){this.loading=!0;const l=this.departmentSelected?this.departmentSelected.map(n=>{var r;return(r=this.rawDepartments.find(_=>n===_.name))==null?void 0:r.id}).filter(n=>n!==void 0).map(Number):[],s=this.roleSelected?this.roleSelected.map(n=>{var r;return(r=this.rawRoles.find(_=>n===_.name))==null?void 0:r.id}).filter(n=>n!==void 0):[],a=this.locationSelected?this.locationSelected.map(n=>{var r;return(r=this.rawLocations.find(_=>n===_.name))==null?void 0:r.id}).filter(n=>n!==void 0).map(Number):[];console.log(a);const d={route:`${w.users}/${this.data.id}`,method:"PUT",token:`${this.cookie}`,body:{person:{first_name:this.details.first_name,middle_name:this.details.middle_name,last_name:this.details.last_name,sex:this.details.sex,date_of_birth:this.details.date_of_birth},user:{username:this.details.username,old_password:this.details.old_password,password:this.details.new_password},roles:s,departments:l,lab_locations:a}},{data:e,error:i,pending:m}=await b(d);this.loading=m,e.value&&(this.handleClick(),q().$toast.success("User updated successfully!"),this.loading=!1,this.$emit("update",!0)),i.value&&(console.error(i.value),this.handleClick(),q().$toast.error(J),this.loading=!1)}}},ht=t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),vt={class:"mx-auto flex justify-center py-20 bg-white"},gt={class:"fixed inset-0 overflow-y-auto"},xt={class:"flex min-h-full items-center justify-center p-4 text-center"},yt={class:"border-b px-3 py-3 flex items-center justify-between"},wt=t("img",{src:H,class:"w-8 h-8 mr-2"},null,-1),bt={class:"mt-2 space-y-3 px-5 py-5"},kt={class:"grid grid-cols-2 gap-4"},Vt={class:"grid grid-cols-2 gap-4"},Ct={class:"grid grid-cols-2 gap-4"},Dt={class:"w-full flex flex-col space-y-2"},Ut={class:"w-full flex flex-col space-y-2"},St={class:"flex items-center"},Tt=t("label",{class:"mr-5 font-medium text-lg"},"Sex",-1),It={class:"flex items-center"},qt=t("span",{class:"ml-2"},"Male",-1),At={class:"flex items-center ml-2"},Lt=t("span",{class:"ml-2"},"Female",-1),Rt={class:"w-full flex flex-col"},$t={class:"w-full flex flex-col space-y-2"},Ft=t("label",{class:"font-medium"},"Select Role(s)",-1),Mt={class:"w-full flex flex-col"},Nt={class:"w-full flex flex-col space-y-2"},Pt=t("label",{class:"font-medium"},"Select Laboratory Location(s)",-1),jt={class:"w-full flex flex-col"},Bt={class:"w-full flex flex-col space-y-2"},Et=t("label",{class:"font-medium"},"Select Lab Section(s)",-1),Ot={class:"px-5"},Gt=t("p",{class:"py-2 font-medium text-base"},"Date Of Birth",-1),Xt={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function zt(l,s,a,d,e,i){const m=F,n=c("TransitionChild"),r=Z,_=c("DialogTitle"),v=c("XMarkIcon"),h=c("FormKit"),k=c("multi-select"),V=c("datepicker"),y=X,C=c("DialogPanel"),S=c("Dialog"),T=c("TransitionRoot");return g(),x("div",null,[t("div",null,[o(m,{text:"Edit",color:"primary",icon:e.editIcon,click:i.init},null,8,["icon","click"])]),o(T,{appear:"",show:e.open,as:"template"},{default:u(()=>[o(S,{as:"div",onClose:i.handleClick,class:"relative z-10"},{default:u(()=>[o(n,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>[ht]),_:1}),U(t("div",vt,[o(r)],512),[[$,e.fetching]]),U(t("div",gt,[t("div",xt,[o(n,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[o(C,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[t("div",yt,[o(_,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:u(()=>[wt,I(" Edit user ")]),_:1}),t("button",{onClick:s[0]||(s[0]=(...p)=>i.handleClick&&i.handleClick(...p))},[o(v,{class:"w-5 h-5"})])]),o(h,{type:"form","submit-label":"Update",onSubmit:i.submitForm,actions:!1},{default:u(({value:p})=>[t("div",bt,[t("div",kt,[o(h,{type:"text",label:"Username",validation:"required",modelValue:e.details.username,"onUpdate:modelValue":s[1]||(s[1]=f=>e.details.username=f)},null,8,["modelValue"]),o(h,{type:"text",label:"First name",modelValue:e.details.first_name,"onUpdate:modelValue":s[2]||(s[2]=f=>e.details.first_name=f),validation:"required"},null,8,["modelValue"])]),t("div",Vt,[o(h,{type:"text",label:"Middle name",modelValue:e.details.middle_name,"onUpdate:modelValue":s[3]||(s[3]=f=>e.details.middle_name=f)},null,8,["modelValue"]),o(h,{type:"text",label:"Last name",validation:"required",modelValue:e.details.last_name,"onUpdate:modelValue":s[4]||(s[4]=f=>e.details.last_name=f)},null,8,["modelValue"])]),o(h,{type:"group"},{default:u(()=>[t("div",Ct,[t("div",Dt,[o(h,{type:"password",label:"New password",name:"password",modelValue:e.details.new_password,"onUpdate:modelValue":s[5]||(s[5]=f=>e.details.new_password=f),"validation-visibility":"live"},null,8,["modelValue"])]),t("div",Ut,[o(h,{type:"password",label:"Confirm new password",name:"password_confirm",validation:e.details.new_password&&"required|confirm","validation-label":"Password confirmation","validation-visibility":"live"},null,8,["validation"])])])]),_:1}),t("div",St,[Tt,t("label",It,[U(t("input",{required:"","onUpdate:modelValue":s[6]||(s[6]=f=>e.details.sex=f),type:"radio",value:"M",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[R,e.details.sex]]),qt]),t("label",At,[U(t("input",{required:"","onUpdate:modelValue":s[7]||(s[7]=f=>e.details.sex=f),type:"radio",value:"F",name:"gender",class:"w-4 h-4 rounded-full bg-sky-500 border-sky-800 text-sky-500 focus:ring-sky-800"},null,512),[[R,e.details.sex]]),Lt])]),t("div",Rt,[t("div",$t,[Ft,o(k,{style:{"--ms-max-height":"none !important"},modelValue:e.roleSelected,"onUpdate:modelValue":s[8]||(s[8]=f=>e.roleSelected=f),options:e.roles,mode:"tags",searchable:!0,required:!0,clear:"",class:"outline-none focus:ring-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),t("div",Mt,[t("div",Nt,[Pt,o(k,{style:{"--ms-max-height":"none !important"},modelValue:e.locationSelected,"onUpdate:modelValue":s[9]||(s[9]=f=>e.locationSelected=f),options:e.locations,mode:"tags",searchable:!0,required:!0,clear:"",class:"outline-none focus:ring-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])]),t("div",jt,[t("div",Bt,[Et,o(k,{style:{"--ms-max-height":"none !important"},modelValue:e.departmentSelected,"onUpdate:modelValue":s[10]||(s[10]=f=>e.departmentSelected=f),options:e.departments,mode:"tags",searchable:!0,required:!0,clear:"",class:"outline-none focus:ring-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])])])]),t("div",Ot,[Gt,o(V,{range:!1,"input-class-name":"datepicker",format:"dd/MM/yyyy",position:"left",placeholder:"select date of birth",modelValue:e.details.date_of_birth,"onUpdate:modelValue":s[11]||(s[11]=f=>e.details.date_of_birth=f)},null,8,["modelValue"])]),t("div",Xt,[o(y,{type:"button",click:()=>{},text:"Clear form"}),o(m,{loading:e.loading,type:"submit",click:()=>{},color:"success",icon:e.saveIcon,text:"Save Changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])],512),[[$,!e.fetching]])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const Kt=L(ft,[["render",zt]]),Ht={components:{TransitionRoot:N,TransitionChild:P,Dialog:j,DialogPanel:B,DialogTitle:E,XMarkIcon:M,ExclamationTriangleIcon:le},data(){return{show:!1,disableIcon:ce,loading:!1,reason:""}},props:{data:{type:Object,required:!0}},setup(){return{cookie:A("token")}},methods:{async deleteData(l){this.loading=!0;const s={route:`${w.users}/${l}`,method:"DELETE",token:`${this.cookie}`},{pending:a,error:d,data:e}=await b(s);this.loading=a,e.value&&(this.handleClick(),q().$toast.success(`${e.value.message}`),this.loading=!1,this.$emit("update",!0),this.reason=""),d.value&&(console.log(e.value),this.loading=!1)},async activate(l){this.loading=!0;const s={route:`${w.users}/activate/${l}`,method:"PUT",token:`${this.cookie}`,body:{retired_reason:this.reason}},{pending:a,error:d,data:e}=await b(s);this.loading=a,e.value&&(this.handleClick(),q().$toast.success(`${e.value.message}`),this.loading=!1,this.$emit("update",!0),this.reason=""),d.value&&(console.log(e.value),this.loading=!1)},handleClick(){this.show=!this.show}}},Yt={key:0},Jt={key:1},Qt=t("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Wt={class:"fixed inset-0 overflow-y-auto"},Zt={class:"flex min-h-full items-center justify-center p-4 text-center"},es={class:"border-b px-3 py-3 flex items-center justify-between"},ts={class:"mt-2 space-y-3 px-5"},ss={class:"rounded px-2 py-2"},os={class:"font-semibold text-red-500"},ls={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function as(l,s,a,d,e,i){const m=F,n=c("TransitionChild"),r=c("ExclamationTriangleIcon"),_=c("DialogTitle"),v=c("XMarkIcon"),h=c("FormKit"),k=X,V=c("DialogPanel"),y=c("Dialog"),C=c("TransitionRoot");return g(),x("div",null,[t("div",null,[a.data.is_active?(g(),x("div",Yt,[o(m,{click:i.handleClick,color:"error",text:"Disable",icon:e.disableIcon},null,8,["click","icon"])])):Y("",!0),a.data.is_active?Y("",!0):(g(),x("div",Jt,[o(m,{click:i.handleClick,color:"success",text:"Enable",icon:e.disableIcon},null,8,["click","icon"])]))]),o(C,{appear:"",show:e.show,as:"template"},{default:u(()=>[o(y,{as:"div",class:"relative z-10"},{default:u(()=>[o(n,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:u(()=>[Qt]),_:1}),t("div",Wt,[t("div",Zt,[o(n,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:u(()=>[o(V,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:u(()=>[t("div",es,[o(_,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:u(()=>[o(r,{class:"h-5 w-5 mr-2"}),I(" "+D(a.data.is_active?"Confirm disable":"Confirm activate"),1)]),_:1}),t("button",{onClick:s[0]||(s[0]=(...S)=>i.handleClick&&i.handleClick(...S))},[o(v,{class:"w-5 h-5"})])]),o(h,{type:"form","submit-label":"Update",onSubmit:s[2]||(s[2]=S=>a.data.is_active?i.deleteData(a.data.id):i.activate(a.data.id)),actions:!1},{default:u(({value:S})=>[t("div",ts,[t("div",ss,[I(" Do you want to "+D(a.data.is_active?"disable":"activate")+" ",1),t("span",os,D(a.data.username),1),I(" account? Note that once this action is completed, it can not be undone ")]),o(h,{type:"textarea",label:"Reason",validation:"required",modelValue:e.reason,"onUpdate:modelValue":s[1]||(s[1]=T=>e.reason=T)},null,8,["modelValue"])]),t("div",ls,[o(k,{click:i.handleClick,type:"button",text:"Cancel"},null,8,["click"]),o(m,{loading:e.loading,type:"submit",click:()=>{},color:"success",icon:e.disableIcon,text:"Continue"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const ns=L(Ht,[["render",as]]),is={components:{MagnifyingGlassIcon:de},setup(){se({title:`${re.name.toUpperCase()} - User Accounts`})},data(){return{header:"List of Users",headers:[{text:"id",value:"id",sortable:!0},{text:"username",value:"username",sortable:!0},{text:"full name",value:"fullname",sortable:!0},{text:"sex",value:"sex",sortable:!0},{text:"actions",value:"actions"}],users:new Array,cookie:A("token"),loading:!1,search:"",searchValue:"",pages:[{name:"Home",link:"/home"},{name:"Access Controls",link:"#"}],serverItemsLength:0,serverOptions:{page:1,rowsPerPage:25,sortBy:"name"}}},created(){this.init()},methods:{updateSearch(l){this.searchValue=l,this.search=l,this.updateUsers(l)},async init(){this.loading=!0;const{page:l,rowsPerPage:s}=this.serverOptions,a={route:`${w.users}?page=${l}&per_page=${s}&search=${this.search}`,method:"GET",token:`${this.cookie}`},{data:d,error:e,pending:i}=await b(a);this.loading=i,d.value&&(this.users=d.value.data,this.loading=!1,this.serverItemsLength=d.value.meta.total_count),e.value&&(console.error(e.value),this.loading=!1)},updateUsers(l){typeof l=="object"&&(this.serverOptions=l),this.init()}},computed:{filteredUsers(){return this.users.map(l=>({id:l.id,is_active:l.is_active,username:l.username.charAt(0).toUpperCase()+l.username.slice(1),fullname:`${l.first_name} ${l.last_name}`,sex:l.sex}))}}},rs={class:"py-5 px-5"},ds={class:"flex items-center justify-between py-5"},cs={class:"text-2xl font-semibold"},us={class:"flex justify-end w-full px-2 py-2 mb-2"},ms={class:"py-2 flex items-center space-x-2"};function ps(l,s,a,d,e,i){const m=te,n=je,r=ae,_=_t,v=Kt,h=ns,k=ie;return g(),x("div",rs,[o(m,{pages:e.pages},null,8,["pages"]),t("div",ds,[t("h3",cs,D(e.header),1),o(n,{onUpdate:i.init},null,8,["onUpdate"])]),t("div",us,[o(r,{search:e.search,onUpdate:i.updateSearch},null,8,["search","onUpdate"])]),o(k,{headers:e.headers,data:i.filteredUsers,loading:e.loading,searchField:"username",searchValue:e.searchValue,serverItemsLength:e.serverItemsLength,serverOptions:e.serverOptions,onUpdate:i.updateUsers},{actions:u(({item:V})=>[t("div",ms,[o(_,{data:V},null,8,["data"]),o(v,{data:V,onUpdate:i.init},null,8,["data","onUpdate"]),o(h,{data:V,onUpdate:i.init},null,8,["data","onUpdate"])])]),_:1},8,["headers","data","loading","searchValue","serverItemsLength","serverOptions","onUpdate"])])}const $s=L(is,[["render",ps]]);export{$s as default};
