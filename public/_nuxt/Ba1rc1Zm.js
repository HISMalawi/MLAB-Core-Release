import{_ as X}from"./ucPVlGIa.js";import{_ as q}from"./BvHVvoZk.js";import{S as O,p as E,Y as V,G as B,V as P,q as b,C as $,A as z,B as G,x as T,y as l,b as h,e as y,f as o,z as c,g as e,k,t as u,F as K,j as H,h as R,O as D,_ as S,D as Y,a as L,u as w,E as U,L as A,K as M}from"./CnHVHtNb.js";import{_ as Q}from"./BM3s60a1.js";import{_ as J}from"./B_Awot1K.js";import{S as I}from"./BeCoPwSi.js";import{_ as W}from"./D79OLBMa.js";import{u as Z}from"./Bnl9n6mh.js";import{P as ee}from"./O-3ebvIT.js";import{r as te}from"./-fElmZzr.js";import"./BZb3bzVo.js";import"./n6mkMIpm.js";import"./DCavMtdm.js";const oe={components:{TransitionRoot:O,TransitionChild:E,Dialog:V,DialogPanel:B,DialogTitle:P,XMarkIcon:b},data(){return{moment:$,viewIcon:z,show:!1,editIcon:G}},props:{data:{type:Object,required:!0}},methods:{handleClick(){this.show=!this.show}}},se=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),ae={class:"fixed inset-0 overflow-y-auto"},ne={class:"flex min-h-full items-center justify-center p-4 text-center"},ie={class:"border-b px-3 py-3 flex items-center justify-between"},le=e("img",{src:Q,class:"w-8 h-8 mr-2"},null,-1),ce={class:"space-y-3 px-5 py-5"},re={class:"rounded border"},de=e("div",{class:"bg-gray-50 border-b px-2 py-2 font-semibold rounded-t text-lg"}," Details ",-1),_e={class:"w-full px-2 py-2 flex items-center space-x-2"},ue=e("label",{class:"font-medium"},"Destination:",-1),pe={class:"w-full px-2 py-2 flex items-center space-x-2"},me=e("label",{class:"font-medium"},"Movement Date:",-1),he={class:"w-full"},fe=e("thead",null,[e("tr",{class:"border bg-gray-50"},[e("th",{class:"px-2 py-2 text-left border-r"},"Stock Item"),e("th",{class:"px-2 py-2 text-left border-r"},"Quantity Issued"),e("th",{class:"px-2 py-2 text-left border-r"},"Batch"),e("th",{class:"px-2 py-2 text-left border-r"},"Lot"),e("th",{class:"px-2 py-2 text-left border-r"},"Expiry Date"),e("th",{class:"px-2 py-2 text-left border-r"},"Transaction Date")])],-1),xe={class:"border"},ve={class:"px-2 py-2 text-left border-r"},ge={class:"px-2 py-2 text-left border-r"},ye={class:"px-2 py-2 text-left border-r"},ke={class:"px-2 py-2 text-left border-r"},be={class:"px-2 py-2 text-left border-r"},we={class:"px-2 py-2 text-left border-r"};function Ce(n,a,i,d,t,s){const p=S,m=l("TransitionChild"),x=l("DialogTitle"),v=l("XMarkIcon"),g=l("DialogPanel"),f=l("Dialog"),r=l("TransitionRoot");return h(),y("div",null,[o(p,{click:()=>{s.handleClick()},color:"primary",text:"View",icon:t.viewIcon},null,8,["click","icon"]),o(r,{appear:"",show:t.show,as:"template"},{default:c(()=>[o(f,{as:"div",class:"relative z-10"},{default:c(()=>[o(m,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:c(()=>[se]),_:1}),e("div",ae,[e("div",ne,[o(m,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:c(()=>[o(g,{class:"w-full max-w-4xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:c(()=>[e("div",ie,[o(x,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:c(()=>[le,k(" View Stock Issue ")]),_:1}),e("button",{onClick:a[0]||(a[0]=(..._)=>s.handleClick&&s.handleClick(..._))},[o(v,{class:"w-5 h-5"})])]),e("div",ce,[e("div",re,[de,e("div",_e,[ue,e("p",null,u(i.data.movement_to),1)]),e("div",pe,[me,e("p",null,u(i.data.movement_date),1)])]),e("table",he,[fe,e("tbody",null,[(h(!0),y(K,null,H(i.data.stock_transactions,(_,j)=>(h(),y("tr",xe,[e("td",ve,u(_.name),1),e("td",ge,u(_.transacted_quantity),1),e("td",ye,u(_.batch),1),e("td",ke,u(_.lot),1),e("td",be,u(t.moment(_.expiry_date).format("DATE_FORMAT"in n?n.DATE_FORMAT:R(D))),1),e("td",we,u(t.moment(_.transaction_date).format("DATE_FORMAT"in n?n.DATE_FORMAT:R(D))),1)]))),256))])])])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const De=T(oe,[["render",Ce]]),Ie={components:{TransitionRoot:O,TransitionChild:E,Dialog:V,DialogPanel:B,DialogTitle:P,XMarkIcon:b,ExclamationTriangleIcon:Y},data(){return{show:!1,rejectIcon:b,loading:!1,reason:"",cookie:L("token")}},props:{data:{type:Object,required:!0}},methods:{async voidStockCategory(n){this.loading=!0;const a=new I,{data:i,error:d,pending:t}=await a.rejectStockIssues(`${this.cookie}`,this.data.id,this.reason);this.loading=t,i.value&&(this.handleClick(),w().$toast.success("Stock issue rejected successfully!"),this.loading=!1,this.reason="",this.$emit("update",!0)),d.value&&(console.error(d.value),w().$toast.error(U),this.loading=!1)},handleClick(){this.show=!this.show}}},Te=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Se={class:"fixed inset-0 overflow-y-auto"},je={class:"flex min-h-full items-center justify-center p-4 text-center"},Re={class:"border-b px-3 py-3 flex items-center justify-between"},Ae={class:"mt-2 space-y-3 px-5"},Me={class:"rounded px-2 py-2"},Oe={class:"font-semibold text-red-500"},Ee={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Ve(n,a,i,d,t,s){const p=S,m=l("TransitionChild"),x=l("ExclamationTriangleIcon"),v=l("DialogTitle"),g=l("XMarkIcon"),f=l("FormKit"),r=J,_=l("DialogPanel"),j=l("Dialog"),F=l("TransitionRoot");return h(),y("div",null,[o(p,{click:s.handleClick,color:"error",text:"Reject",icon:t.rejectIcon},null,8,["click","icon"]),o(F,{appear:"",show:t.show,as:"template"},{default:c(()=>[o(j,{as:"div",class:"relative z-10"},{default:c(()=>[o(m,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:c(()=>[Te]),_:1}),e("div",Se,[e("div",je,[o(m,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:c(()=>[o(_,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:c(()=>[e("div",Re,[o(v,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:c(()=>[o(x,{class:"h-5 w-5 mr-2"}),k(" Reject Stock Issue ")]),_:1}),e("button",{onClick:a[0]||(a[0]=(...C)=>s.handleClick&&s.handleClick(...C))},[o(g,{class:"w-5 h-5"})])]),o(f,{type:"form","submit-label":"Update",onSubmit:a[2]||(a[2]=C=>s.voidStockCategory(i.data.id)),actions:!1},{default:c(({value:C})=>[e("div",Ae,[e("div",Me,[k(" Do you really want to reject stock issue to "),e("span",Oe,u(i.data.movement_to),1),k("? Note that once this action is completed, it can not be undone ")]),o(f,{type:"textarea",label:"Reason",validation:"required",modelValue:t.reason,"onUpdate:modelValue":a[1]||(a[1]=N=>t.reason=N)},null,8,["modelValue"])]),e("div",Ee,[o(r,{click:()=>{s.handleClick()},type:"button",text:"Cancel"},null,8,["click"]),o(p,{loading:t.loading,type:"submit",click:()=>{},color:"error",icon:t.rejectIcon,text:"Reject"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const Be=T(Ie,[["render",Ve]]),Pe={setup(){Z({title:`${ee.name.toUpperCase()} - Issues Stock`})},data(){return{header:"Stock Issue",pages:[{name:"Home",link:"/home"},{name:"Stock Management",link:"#"}],search:"",headers:[{text:"destination",value:"movement_to",sortable:!0},{text:"status",value:"stock_status"},{text:"transaction items",value:"stock_transactions.length"},{text:"movement date",value:"movement_date"},{text:"actions",value:"actions"}],data:new Array,cookie:L("token"),loading:!1,addIcon:te,rejectIcon:b,serverItemsLength:0,serverOptions:{page:1,rowsPerPage:25,sortBy:"name"}}},created(){this.init(this.search)},computed:{filteredData(){return this.data.map(n=>({...n,movement_date:$(n.movement_date).format(D)}))}},methods:{async init(n){this.loading=!0;const a=new I,{page:i,rowsPerPage:d}=this.serverOptions,t=`search=${n}&page=${i}&per_page=${d}`,{data:s,error:p,pending:m}=await a.getStockIssues(`${this.cookie}`,t);this.loading=m,s.value&&(console.log(s.value),this.loading=!1,this.data=s.value.data,this.serverItemsLength=s.value.meta.total_count),p.value&&(console.error(p.value),this.loading=!1)},async approveStockIssue(n){this.loading=!0;const a=new I,{data:i,error:d,pending:t}=await a.approveStockIssues(`${this.cookie}`,n);this.loading=t,i.value&&(console.log(i.value),this.loading=!1,w().$toast.success("Stock issue approved successfully"),this.init(this.search)),d.value&&(console.error(d.value),w().$toast.error(U),this.loading=!1)}}},$e={class:"px-5 py-5"},Le={class:"flex items-center justify-between py-5"},Ue={class:"text-2xl font-semibold"},Fe={class:"flex items-center justify-end py-5"},Ne={class:"py-2 flex items-center space-x-2"};function Xe(n,a,i,d,t,s){const p=X,m=q,x=De,v=S,g=Be,f=W;return h(),y("div",$e,[o(p,{pages:t.pages},null,8,["pages"]),e("div",Le,[e("h3",Ue,u(t.header),1)]),e("div",Fe,[o(m,{search:t.search,"onUpdate:search":a[0]||(a[0]=r=>t.search=r),onUpdate:s.init},null,8,["search","onUpdate"])]),e("div",null,[o(f,{loading:t.loading,headers:t.headers,data:s.filteredData,"search-field":"movement_to",searchValue:t.search,serverItemsLength:t.serverItemsLength,serverOptions:t.serverOptions,onUpdate:s.init},{actions:c(({item:r})=>[e("div",Ne,[o(x,{data:r},null,8,["data"]),r.stock_status.toLowerCase()=="pending"?(h(),A(v,{key:0,click:()=>s.approveStockIssue(r.id),text:"Approve",color:"success",icon:t.addIcon},null,8,["click","icon"])):M("",!0),r.stock_status.toLowerCase()=="pending"?(h(),A(g,{key:1,data:r,onUpdate:s.init},null,8,["data","onUpdate"])):M("",!0)])]),_:1},8,["loading","headers","data","searchValue","serverItemsLength","serverOptions","onUpdate"])])])}const st=T(Pe,[["render",Xe]]);export{st as default};
