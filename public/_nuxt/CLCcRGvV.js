import{_ as E}from"./BBiETNY7.js";import{_ as q}from"./DRMfFlf3.js";import{l as S,m as r,b as h,e as y,f as o,n as l,g as e,p as k,t as p,F as z,j as G,h as V,_ as T,a as P,u as b,x as M,s as B}from"./Br_iYJbE.js";import{d as C,e as R}from"./D_g9DqRP.js";import{h as $}from"./Dog3sDT3.js";import{r as w}from"./BoyxTlis.js";import{r as H,a as K}from"./BxXqpYSD.js";import{S as U,h as F,Y as L,G as O,V as A}from"./a0kEX_gA.js";import{_ as Y}from"./BM3s60a1.js";import{_ as Q}from"./BWngzJgz.js";import{S as D}from"./CtCsDpHC.js";import{r as J}from"./AtAlRHB5.js";import{_ as W}from"./_RoJ7CPk.js";import{u as Z}from"./C7tJ_rpQ.js";import{P as ee}from"./CsuZ4PXZ.js";import{r as te}from"./DG7tqCU3.js";import"./C3HP_w3b.js";import"./CsEX3TnJ.js";import"./tiZpgdZ8.js";import"./CKyme56o.js";import"./2-4F2Czp.js";import"./BIfGgD6z.js";const oe={components:{TransitionRoot:U,TransitionChild:F,Dialog:L,DialogPanel:O,DialogTitle:A,XMarkIcon:w},data(){return{moment:$,viewIcon:H,show:!1,editIcon:K}},props:{data:{type:Object,required:!0}},methods:{handleClick(){this.show=!this.show}}},se=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),ae={class:"fixed inset-0 overflow-y-auto"},ne={class:"flex min-h-full items-center justify-center p-4 text-center"},ie={class:"border-b px-3 py-3 flex items-center justify-between"},re=e("img",{src:Y,class:"w-8 h-8 mr-2"},null,-1),le={class:"space-y-3 px-5 py-5"},ce={class:"rounded border"},de=e("div",{class:"bg-gray-50 border-b px-2 py-2 font-semibold rounded-t text-lg"}," Details ",-1),me={class:"w-full px-2 py-2 flex items-center space-x-2"},pe=e("label",{class:"font-medium"},"Destination:",-1),ue={class:"w-full px-2 py-2 flex items-center space-x-2"},_e=e("label",{class:"font-medium"},"Movement Date:",-1),he={class:"w-full"},fe=e("thead",null,[e("tr",{class:"border bg-gray-50"},[e("th",{class:"px-2 py-2 text-left border-r"},"Stock Item"),e("th",{class:"px-2 py-2 text-left border-r"},"Quantity Issued"),e("th",{class:"px-2 py-2 text-left border-r"},"Batch"),e("th",{class:"px-2 py-2 text-left border-r"},"Lot"),e("th",{class:"px-2 py-2 text-left border-r"},"Expiry Date"),e("th",{class:"px-2 py-2 text-left border-r"},"Transaction Date")])],-1),xe={class:"border"},ve={class:"px-2 py-2 text-left border-r"},ge={class:"px-2 py-2 text-left border-r"},ye={class:"px-2 py-2 text-left border-r"},ke={class:"px-2 py-2 text-left border-r"},be={class:"px-2 py-2 text-left border-r"},we={class:"px-2 py-2 text-left border-r"};function Ie(n,a,i,d,t,s){const u=T,_=r("TransitionChild"),x=r("DialogTitle"),v=r("XMarkIcon"),g=r("DialogPanel"),f=r("Dialog"),c=r("TransitionRoot");return h(),y("div",null,[o(u,{click:()=>{s.handleClick()},color:"primary",text:"View",icon:t.viewIcon},null,8,["click","icon"]),o(c,{appear:"",show:t.show,as:"template"},{default:l(()=>[o(f,{as:"div",class:"relative z-10"},{default:l(()=>[o(_,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>[se]),_:1}),e("div",ae,[e("div",ne,[o(_,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[o(g,{class:"w-full max-w-4xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[e("div",ie,[o(x,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>[re,k(" View Stock Issue ")]),_:1}),e("button",{onClick:a[0]||(a[0]=(...m)=>s.handleClick&&s.handleClick(...m))},[o(v,{class:"w-5 h-5"})])]),e("div",le,[e("div",ce,[de,e("div",me,[pe,e("p",null,p(i.data.movement_to),1)]),e("div",ue,[_e,e("p",null,p(i.data.movement_date),1)])]),e("table",he,[fe,e("tbody",null,[(h(!0),y(z,null,G(i.data.stock_transactions,(m,j)=>(h(),y("tr",xe,[e("td",ve,p(m.name),1),e("td",ge,p(m.transacted_quantity),1),e("td",ye,p(m.batch),1),e("td",ke,p(m.lot),1),e("td",be,p(t.moment(m.expiry_date).format("dateFormat"in n?n.dateFormat:V(C))),1),e("td",we,p(t.moment(m.transaction_date).format("dateFormat"in n?n.dateFormat:V(C))),1)]))),256))])])])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const Ce=S(oe,[["render",Ie]]),De={components:{TransitionRoot:U,TransitionChild:F,Dialog:L,DialogPanel:O,DialogTitle:A,XMarkIcon:w,ExclamationTriangleIcon:J},data(){return{show:!1,rejectIcon:w,loading:!1,reason:"",cookie:P("token")}},props:{data:{type:Object,required:!0}},methods:{async voidStockCategory(n){this.loading=!0;const a=new D,{data:i,error:d,pending:t}=await a.rejectStockIssues(`${this.cookie}`,this.data.id,this.reason);this.loading=t,i.value&&(this.handleClick(),b().$toast.success("Stock issue rejected successfully!"),this.loading=!1,this.reason="",this.$emit("update",!0)),d.value&&(console.error(d.value),b().$toast.error(R),this.loading=!1)},handleClick(){this.show=!this.show}}},Se=e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1),Te={class:"fixed inset-0 overflow-y-auto"},je={class:"flex min-h-full items-center justify-center p-4 text-center"},Ve={class:"border-b px-3 py-3 flex items-center justify-between"},Me={class:"mt-2 space-y-3 px-5"},Be={class:"rounded px-2 py-2"},Pe={class:"font-semibold text-red-500"},Re={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function $e(n,a,i,d,t,s){const u=T,_=r("TransitionChild"),x=r("ExclamationTriangleIcon"),v=r("DialogTitle"),g=r("XMarkIcon"),f=r("FormKit"),c=Q,m=r("DialogPanel"),j=r("Dialog"),N=r("TransitionRoot");return h(),y("div",null,[o(u,{click:s.handleClick,color:"error",text:"Reject",icon:t.rejectIcon},null,8,["click","icon"]),o(N,{appear:"",show:t.show,as:"template"},{default:l(()=>[o(j,{as:"div",class:"relative z-10"},{default:l(()=>[o(_,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>[Se]),_:1}),e("div",Te,[e("div",je,[o(_,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[o(m,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[e("div",Ve,[o(v,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>[o(x,{class:"h-5 w-5 mr-2"}),k(" Reject Stock Issue ")]),_:1}),e("button",{onClick:a[0]||(a[0]=(...I)=>s.handleClick&&s.handleClick(...I))},[o(g,{class:"w-5 h-5"})])]),o(f,{type:"form","submit-label":"Update",onSubmit:a[2]||(a[2]=I=>s.voidStockCategory(i.data.id)),actions:!1},{default:l(({value:I})=>[e("div",Me,[e("div",Be,[k(" Do you really want to reject stock issue to "),e("span",Pe,p(i.data.movement_to),1),k("? Note that once this action is completed, it can not be undone ")]),o(f,{type:"textarea",label:"Reason",validation:"required",modelValue:t.reason,"onUpdate:modelValue":a[1]||(a[1]=X=>t.reason=X)},null,8,["modelValue"])]),e("div",Re,[o(c,{click:()=>{s.handleClick()},type:"button",text:"Cancel"},null,8,["click"]),o(u,{loading:t.loading,type:"submit",click:()=>{},color:"error",icon:t.rejectIcon,text:"Reject"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const Ue=S(De,[["render",$e]]),Fe={setup(){Z({title:`${ee.name.toUpperCase()} - Issues Stock`})},data(){return{header:"Stock Issue",pages:[{name:"Home",link:"/home"},{name:"Stock Management",link:"#"}],search:"",headers:[{text:"destination",value:"movement_to",sortable:!0},{text:"status",value:"stock_status"},{text:"transaction items",value:"stock_transactions.length"},{text:"movement date",value:"movement_date"},{text:"actions",value:"actions"}],data:new Array,cookie:P("token"),loading:!1,addIcon:te,rejectIcon:w,serverItemsLength:0,serverOptions:{page:1,rowsPerPage:25,sortBy:"name"}}},created(){this.init(this.search)},computed:{filteredData(){return this.data.map(n=>({...n,movement_date:$(n.movement_date).format(C)}))}},methods:{async init(n){this.loading=!0;const a=new D,{page:i,rowsPerPage:d}=this.serverOptions,t=`search=${n}&page=${i}&per_page=${d}`,{data:s,error:u,pending:_}=await a.getStockIssues(`${this.cookie}`,t);this.loading=_,s.value&&(console.log(s.value),this.loading=!1,this.data=s.value.data,this.serverItemsLength=s.value.meta.total_count),u.value&&(console.error(u.value),this.loading=!1)},async approveStockIssue(n){this.loading=!0;const a=new D,{data:i,error:d,pending:t}=await a.approveStockIssues(`${this.cookie}`,n);this.loading=t,i.value&&(console.log(i.value),this.loading=!1,b().$toast.success("Stock issue approved successfully"),this.init(this.search)),d.value&&(console.error(d.value),b().$toast.error(R),this.loading=!1)}}},Le={class:"px-5 py-5"},Oe={class:"flex items-center justify-between py-5"},Ae={class:"text-2xl font-semibold"},Ne={class:"flex items-center justify-end py-5"},Xe={class:"py-2 flex items-center space-x-2"};function Ee(n,a,i,d,t,s){const u=E,_=q,x=Ce,v=T,g=Ue,f=W;return h(),y("div",Le,[o(u,{pages:t.pages},null,8,["pages"]),e("div",Oe,[e("h3",Ae,p(t.header),1)]),e("div",Ne,[o(_,{search:t.search,"onUpdate:search":a[0]||(a[0]=c=>t.search=c),onUpdate:s.init},null,8,["search","onUpdate"])]),e("div",null,[o(f,{loading:t.loading,headers:t.headers,data:s.filteredData,"search-field":"movement_to",searchValue:t.search,serverItemsLength:t.serverItemsLength,serverOptions:t.serverOptions,onUpdate:s.init},{actions:l(({item:c})=>[e("div",Xe,[o(x,{data:c},null,8,["data"]),c.stock_status.toLowerCase()=="pending"?(h(),M(v,{key:0,click:()=>s.approveStockIssue(c.id),text:"Approve",color:"success",icon:t.addIcon},null,8,["click","icon"])):B("",!0),c.stock_status.toLowerCase()=="pending"?(h(),M(g,{key:1,data:c,onUpdate:s.init},null,8,["data","onUpdate"])):B("",!0)])]),_:1},8,["loading","headers","data","searchValue","serverItemsLength","serverOptions","onUpdate"])])])}const pt=S(Fe,[["render",Ee]]);export{pt as default};
