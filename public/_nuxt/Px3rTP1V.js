import{_ as X}from"./Db3TL93P.js";import{_ as K}from"./GJeFnoFx.js";import{_ as G}from"./SW4eMder.js";import{S,p as R,Y as U,G as j,V as B,q as F,B as z,a as $,l as A,m as I,u as k,E as H,x as P,y as i,b as f,e as V,f as t,z as l,g as o,j as v,_ as q,D as L,t as Y,C as J,O as Q,bk as W,h as w,L as C,K as T}from"./CexOikvH.js";import{_ as M}from"./DpkAgBRk.js";import{r as Z}from"./CyIftPXO.js";import{_ as N}from"./DqZXw9ey.js";import{r as ee}from"./Hqy8rHTQ.js";import{_ as te}from"./BFgFNRB8.js";import{u as E}from"./C78fMFb2.js";import{P as oe}from"./DwOgcnpE.js";import{u as se}from"./8eNCHlT3.js";import"./Cr2uUJHO.js";import"./Cg8mjwS6.js";import"./CCBrn6hi.js";import"./ykDvGVMM.js";const ae={components:{TransitionRoot:S,TransitionChild:R,Dialog:U,DialogPanel:j,DialogTitle:B,XMarkIcon:F},data(){return{editIcon:z,show:!1,saveIcon:Z,name:this.data.name,description:this.data.description,drugSelected:new Array,drugs:new Array,rawDrugs:new Array,loading:!1,cookie:$("token")}},props:{data:{type:Object,required:!0}},methods:{async submitForm(){this.loading=!0;const s={route:`${A.disease.edit}/${this.data.id}`,method:"PUT",token:`${this.cookie}`,body:this.data},{pending:e,error:r,data:c}=await I(s);this.loading=e,c.value&&(this.show=!1,k().$toast.success("Disease updated successfully!"),this.loading=!1,this.$emit("update",!0)),r.value&&(this.show=!1,console.error(r.value),this.loading=!1,k().$toast.error(H))},handleClick(){this.show=!this.show},clearForm(){this.$formkit.reset("editForm")}}},ne={class:"fixed inset-0 overflow-y-auto"},ie={class:"flex min-h-full items-center justify-center p-4 text-center"},le={class:"border-b px-3 py-3 flex items-center justify-between"},re={class:"mt-2 space-y-3"},ce={class:"w-full flex items-center px-5"},de={class:"w-full flex flex-col space-y-2"},ue={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function me(s,e,r,c,a,n){const d=q,u=i("TransitionChild"),h=i("DialogTitle"),g=i("XMarkIcon"),m=i("FormKit"),p=M,_=i("DialogPanel"),D=i("Dialog"),b=i("TransitionRoot");return f(),V("div",null,[t(d,{click:n.handleClick,text:"Edit",color:"success",icon:a.editIcon},null,8,["click","icon"]),t(b,{appear:"",show:a.show,as:"template"},{default:l(()=>[t(D,{as:"div",class:"relative z-10"},{default:l(()=>[t(u,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>e[2]||(e[2]=[o("div",{class:"fixed inset-0 bg-gray-900 bg-opacity-25"},null,-1)])),_:1}),o("div",ne,[o("div",ie,[t(u,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[t(_,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[o("div",le,[t(h,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>e[3]||(e[3]=[o("img",{src:N,class:"w-8 h-8 mr-2"},null,-1),v(" Edit Disease ")])),_:1}),o("button",{onClick:e[0]||(e[0]=(...y)=>n.handleClick&&n.handleClick(...y))},[t(g,{class:"w-5 h-5"})])]),t(m,{id:"editForm",type:"form","submit-label":"Update",onSubmit:n.submitForm,actions:!1},{default:l(({value:y})=>[o("div",re,[o("div",ce,[o("div",de,[t(m,{type:"text",label:"Name",validation:"required",modelValue:r.data.name,"onUpdate:modelValue":e[1]||(e[1]=x=>r.data.name=x)},null,8,["modelValue"])])])]),o("div",ue,[t(p,{text:"Clear form",type:"button",click:()=>{n.clearForm()}},null,8,["click"]),t(d,{loading:a.loading,type:"submit",click:()=>{},color:"success",icon:a.saveIcon,text:"Save changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const pe=P(ae,[["render",me]]),_e={components:{TransitionRoot:S,TransitionChild:R,Dialog:U,DialogPanel:j,DialogTitle:B,XMarkIcon:F,ExclamationTriangleIcon:L},data(){return{show:!1,deleteIcon:ee,loading:!1,cookie:$("token"),reason:""}},props:{data:{type:Object,required:!0}},methods:{async deleteData(s){this.loading=!0;const e={route:`${A.disease.delete}/${s}`,method:"DELETE",token:`${this.cookie}`,body:{voided_reason:this.reason}},{pending:r,error:c,data:a}=await I(e);this.loading=r,a.value&&(this.handleClick(),k().$toast.success("Disease deleted successfully!"),this.reason="",this.loading=!1,this.$emit("update",!0)),c.value&&(console.log(c.value),k().$toast.error("An error occurred, please try again!"),this.loading=!1)},handleClick(){this.show=!this.show}}},fe={class:"fixed inset-0 overflow-y-auto"},he={class:"flex min-h-full items-center justify-center p-4 text-center"},ge={class:"border-b px-3 py-3 flex items-center justify-between"},xe={class:"mt-2 space-y-3 px-5"},ve={class:"rounded px-2 py-2"},ye={class:"font-semibold text-red-500"},ke={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function De(s,e,r,c,a,n){const d=q,u=i("TransitionChild"),h=i("ExclamationTriangleIcon"),g=i("DialogTitle"),m=i("XMarkIcon"),p=i("FormKit"),_=M,D=i("DialogPanel"),b=i("Dialog"),y=i("TransitionRoot");return f(),V("div",null,[t(d,{click:n.handleClick,color:"error",text:"Delete",icon:a.deleteIcon},null,8,["click","icon"]),t(y,{appear:"",show:a.show,as:"template"},{default:l(()=>[t(b,{as:"div",class:"relative z-10"},{default:l(()=>[t(u,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:l(()=>e[3]||(e[3]=[o("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),o("div",fe,[o("div",he,[t(u,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:l(()=>[t(D,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:l(()=>[o("div",ge,[t(g,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:l(()=>[t(h,{class:"h-5 w-5 mr-2"}),e[4]||(e[4]=v(" Confirm delete "))]),_:1}),o("button",{onClick:e[0]||(e[0]=(...x)=>n.handleClick&&n.handleClick(...x))},[t(m,{class:"w-5 h-5"})])]),t(p,{type:"form","submit-label":"Update",onSubmit:e[2]||(e[2]=x=>n.deleteData(r.data.id)),actions:!1},{default:l(({value:x})=>[o("div",xe,[o("div",ve,[e[5]||(e[5]=v(" Do you really want to delete ")),o("span",ye,Y(r.data.name),1),e[6]||(e[6]=v("? Note that once this action is completed, it can not be undone "))]),t(p,{type:"textarea",label:"Reason",validation:"required",modelValue:a.reason,"onUpdate:modelValue":e[1]||(e[1]=O=>a.reason=O)},null,8,["modelValue"])]),o("div",ke,[t(_,{click:()=>{},type:"button",text:"Cancel"}),t(d,{loading:a.loading,type:"submit",click:()=>{},color:"error",icon:a.deleteIcon,text:"Delete"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const be=P(_e,[["render",De]]),we={setup(){se({title:`${oe.name.toUpperCase()} - Diseases`})},data(){return{header:"Diseases",pages:[{name:"Home",link:"/home"},{name:"Test Catalog",link:"#"}],headers:[{text:"ID",value:"id",sortable:!0},{text:"NAME",value:"name",sortable:!0},{text:"DATE CREATED",value:"created_date"},{text:"Actions",value:"actions"}],diseases:new Array,cookie:$("token"),search:"",searchValue:"",loading:!1}},created(){this.init()},computed:{filteredDiseases(){return this.diseases.map(s=>({...s,created_date:J(s.created_date).format(Q)}))}},methods:{async init(){this.loading=!0;const s={route:A.disease.index,method:"GET",token:`${this.cookie}`},{data:e,error:r,pending:c}=await I(s);this.loading=c,e.value&&(this.diseases=e.value,this.loading=!1),r.value&&(console.log(r.value),this.loading=!1)},updateSearch(s){W&&(this.searchValue=s,this.search=s)},updateDiseases(s){this.init()}}},Ce={class:"px-5 py-5"},Te={class:"flex items-center justify-between py-5"},Ee={class:"flex items-center space-x-3"},$e={class:"flex justify-end w-full px-2 py-2 mb-2"},Ae={class:"py-2 flex items-center space-x-2"};function Ie(s,e,r,c,a,n){const d=X,u=K,h=G,g=pe,m=be,p=te;return f(),V("div",Ce,[t(d,{pages:a.pages},null,8,["pages"]),o("div",Te,[e[0]||(e[0]=o("div",{class:"text-2xl font-semibold flex items-center uppercase"},[o("img",{src:N,alt:"report-icon",class:"w-8 h-8 mr-2"}),v(" Diseases ")],-1)),o("div",Ee,[("usePermissions"in s?s.usePermissions:w(E))().can.manage("test_catalog")?(f(),C(u,{key:0,onActionCompleted:n.updateDiseases},null,8,["onActionCompleted"])):T("",!0)])]),o("div",$e,[("usePermissions"in s?s.usePermissions:w(E))().can.manage("test_catalog")?(f(),C(h,{key:0,search:a.search,onUpdate:n.updateSearch},null,8,["search","onUpdate"])):T("",!0)]),("usePermissions"in s?s.usePermissions:w(E))().can.manage("test_catalog")?(f(),C(p,{key:0,headers:a.headers,data:n.filteredDiseases,loading:a.loading,"search-value":a.searchValue,"search-field":"name"},{actions:l(({item:_})=>[o("div",Ae,[t(g,{data:_,onUpdate:n.updateDiseases},null,8,["data","onUpdate"]),t(m,{data:_,onUpdate:n.updateDiseases},null,8,["data","onUpdate"])])]),_:1},8,["headers","data","loading","search-value"])):T("",!0)])}const He=P(we,[["render",Ie]]);export{He as default};
