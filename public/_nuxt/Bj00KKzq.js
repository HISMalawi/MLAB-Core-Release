import{_ as A}from"./DUcBFwG-.js";import{S as R,p as j,Y as M,G as P,V as K,q as z,s as S,a as w,u as X,az as g,x as $,y as a,b as d,e as m,g as e,f as s,z as c,j as _,t as f,F as V,k as T,_ as D,L as E,K as G}from"./CDwe1-SJ.js";import{_ as H}from"./CGDWQBys.js";import{S as O}from"./DOj21NNK.js";import{r as L}from"./BDOfGDQY.js";import{r as B}from"./BgazPtc9.js";import{r as Q}from"./CklX0FMy.js";import{r as Y}from"./DuIkQGvG.js";import{r as F}from"./BFhpbPD2.js";import{_ as J}from"./CRnblg2U.js";import{P as W}from"./BwDL8_Sz.js";import{u as Z}from"./BkeblDPe.js";import{r as ee}from"./-fVn8w7g.js";import"./Cr7jFdem.js";import"./vhynW_sA.js";import"./CQp75_qS.js";import"./DCQ0oKBy.js";import"./BxsmiORF.js";import"./q3yIABP6.js";import"./Dx2qB7Ad.js";import"./Cvp6I_hU.js";import"./Bnd455-l.js";import"./CXu3vKTG.js";const te={props:{voucherId:{required:!0,type:String},requisitions:{required:!0,type:Array}},components:{TransitionRoot:R,TransitionChild:j,Dialog:M,DialogPanel:P,DialogTitle:K,XMarkIcon:z,UserIcon:L,TicketIcon:B},data(){return{open:!1,addIcon:S,saveIcon:Q,clearIcon:Y,completeIcon:F,loading:!1,name:"",description:"",cookie:w("token")}},methods:{async createStockOrder(){this.loading=!0;const o=new O,t={voucher_number:Number(this.voucherId),requisitions:this.requisitions.map(n=>({stock_item_id:n.stock_item.id,quantity_requested:n.quantity_requested}))},{data:i,error:l,pending:r}=await o.createStockOrder(`${this.cookie}`,t);this.loading=r,i.value&&(this.loading=!1,X().$toast.success(`Stock order ${(this._.provides[g]||this.$route).params.voucherId} created successfully`),this.handleClick(),this.$emit("update",!0)),l.value&&(this.loading=!1,console.error(l.value))},handleClick(){this.open=!this.open},clearForm(){this.$formkit.reset("submitForm")}}},oe={class:"fixed inset-0 overflow-y-auto"},se={class:"flex min-h-full items-center justify-center p-4 text-center"},re={class:"border-b px-3 py-3 flex items-center justify-between"},ne={class:"py-5 px-5 space-y-3"},ie={class:"flex bg-gray-50 border-l-4 border-l-100 rounded-r px-2 py-2 items-center space-x-2"},ae={class:"mt-3"},le={class:"w-full"},ce={class:"px-2 py-2 border-r"},de={class:"px-2 py-2"},ue={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function me(o,t,i,l,r,n){const h=D,k=a("TransitionChild"),b=a("TicketIcon"),y=a("DialogTitle"),x=a("XMarkIcon"),I=H,u=a("FormKit"),v=a("DialogPanel"),p=a("Dialog"),N=a("TransitionRoot");return d(),m("div",null,[e("div",null,[s(h,{icon:r.completeIcon,text:"Complete",color:"primary",click:()=>{n.handleClick()}},null,8,["icon","click"])]),s(N,{appear:"",show:r.open,as:"template"},{default:c(()=>[s(p,{as:"div",onClose:n.handleClick,class:"relative z-10"},{default:c(()=>[s(k,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:c(()=>t[1]||(t[1]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",oe,[e("div",se,[s(k,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:c(()=>[s(v,{class:"w-full max-w-4xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:c(()=>[e("div",re,[s(y,{as:"h3",class:"text-xl text-black flex items-center font-medium leading-6"},{default:c(()=>[s(b,{class:"w-8 h-8 mr-2"}),t[2]||(t[2]=_(" Order Checkout "))]),_:1}),e("button",{onClick:t[0]||(t[0]=(...q)=>n.handleClick&&n.handleClick(...q))},[s(x,{class:"w-5 h-5"})])]),s(u,{type:"form","submit-label":"Update",onSubmit:n.createStockOrder,actions:!1,id:"submitForm"},{default:c(({value:q})=>[e("div",ne,[e("div",ie,[s(b,{class:"h-5 w-5"}),e("p",null,[t[3]||(t[3]=_("Voucher Number: ")),e("strong",null,f((o._.provides[g]||o.$route).params.voucherId),1)])]),e("div",ae,[e("table",le,[t[4]||(t[4]=e("thead",{clas:"w-full border-t border-l border-r"},[e("tr",{class:"border-b border-t border-r border-l rounded"},[e("th",{colspan:2,class:"text-left p-2"}," Requisitions ")]),e("tr",{class:"border-b border-t border-r border-l rounded"},[e("th",{class:"px-2 py-2 text-left border-r"}," Stock Item "),e("th",{class:"px-2 py-2 text-left"}," Quantity Being Requested ")])],-1)),e("tbody",null,[(d(!0),m(V,null,T(i.requisitions,(C,U)=>(d(),m("tr",{key:U,class:"border-b border-t border-r border-l rounded"},[e("td",ce,f(C.stock_item.name),1),e("td",de,f(C.quantity_requested),1)]))),128))])])])]),e("div",ue,[s(I,{type:"button",click:()=>{},text:"Cancel"}),s(h,{loading:r.loading,type:"submit",click:()=>{},color:"success",icon:r.saveIcon,text:"Save changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])])}const pe=$(te,[["render",me]]),_e={setup(){Z({title:`${W.name.toUpperCase()} - Create Stock Order`})},components:{TicketIcon:B},data(){return{header:"Create Stock Order",pages:[{name:"Home",link:"/home"},{name:"Stock Orders",link:"/stock-management/orders"}],cookie:w("token"),addIcon:S,deleteicon:ee,completeIcon:F,loading:!1,requisitions:new Array,stockItems:new Array}},created(){this.init()},methods:{async init(){const o=new O,{data:t,error:i}=await o.getStockItem(`${this.cookie}`);t.value&&(this.stockItems=t.value),i.value&&console.error(i.value)},addStockItem(){this.requisitions.push({stock_item:{name:"-- select item --",id:0},quantity_requested:0,id:0,batch_number:"",lot_number:""})},deleteStockItem(o){o>=0&&o<this.requisitions.length&&this.requisitions.splice(o,1)},isValidRequisitions(o){let t=!1;o.length>0&&(t=!0);let i=!1;for(const l of o)l.stock_item.name=="-- select item --"||l.quantity_requested==0?i=!1:i=!0;return t&&i},navigateOrders(o){o&&this.$router.push("/stock-management/orders")}}},fe={class:"px-5 py-5"},he={class:"py-5 flex items-center justify-between"},ke={class:"text-2xl font-semibold"},be={class:"rounded border"},ye={class:"flex rounded-t justify-between bg-gray-50 border-b px-2 py-2 cursor-text"},ve={class:"flex items-center space-x-2"},ge={class:"px-5 py-5"},xe={class:"grid grid-cols-4 gap-4 mt-5"},Ie={class:"flex flex-col space-y-2"},qe={class:"mt-8"};function Ce(o,t,i,l,r,n){const h=A,k=a("TicketIcon"),b=pe,y=D,x=J,I=a("FormKit");return d(),m("div",fe,[s(h,{pages:r.pages},null,8,["pages"]),e("div",he,[e("h3",ke,f(r.header),1)]),e("div",be,[e("div",ye,[e("div",ve,[s(k,{class:"h-5 w-5"}),e("p",null,[t[0]||(t[0]=_("Voucher Number: ")),e("strong",null,f((o._.provides[g]||o.$route).params.voucherId),1)])]),n.isValidRequisitions(r.requisitions)?(d(),E(b,{key:0,onUpdate:n.navigateOrders,"voucher-id":`${(o._.provides[g]||o.$route).params.voucherId}`,requisitions:r.requisitions},null,8,["onUpdate","voucher-id","requisitions"])):G("",!0)]),e("div",ge,[t[2]||(t[2]=e("div",{class:"flex px-2 py-2 mb-4 rounded-r border-l-4 border-sky-100 bg-sky-50"},[_(" Click on the "),e("strong",{class:"mx-2"},'"Add Stock Item"'),_(" button to start creating your order requisition items ")],-1)),s(y,{icon:r.addIcon,text:"Add Stock Item",color:"success",click:()=>{n.addStockItem()}},null,8,["icon","click"]),(d(!0),m(V,null,T(r.requisitions,(u,v)=>(d(),m("div",{class:"flex flex-col space-y-3",key:v},[e("div",xe,[e("div",Ie,[t[1]||(t[1]=e("label",{class:"font-medium mb-0"},"Stock item",-1)),s(x,{"is-searchable":!0,items:r.stockItems,modelValue:u.stock_item,"onUpdate:modelValue":p=>u.stock_item=p},null,8,["items","modelValue","onUpdate:modelValue"])]),s(I,{label:"Quantity requested",type:"number",validation:"required",modelValue:u.quantity_requested,"onUpdate:modelValue":p=>u.quantity_requested=p},null,8,["modelValue","onUpdate:modelValue"]),e("div",qe,[s(y,{icon:r.deleteicon,text:"Delete",color:"error",click:()=>{n.deleteStockItem(v)}},null,8,["icon","click"])])])]))),128))])])])}const Qe=$(_e,[["render",Ce]]);export{Qe as default};
