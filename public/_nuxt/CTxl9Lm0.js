import{_ as X}from"./B0LaQ5Ul.js";import{_ as Z}from"./BfF5L8Si.js";import{d as ee,r as v,a as te,c as M,m as re,b as r,e as o,f as b,h as t,g as e,t as c,p as R,y as E,n as oe,F as d,j as i,s as T,i as se,v as ae,u as z,_ as ne,k as le}from"./JBsVKZmo.js";import{_ as ce}from"./DZH9Y4M7.js";import{_ as de}from"./C1Kkhh8H.js";import{_ as ie}from"./us_p91AA.js";import{u as pe}from"./B76wTae4.js";import{d as L}from"./D__F487H.js";import{_ as ue}from"./B7V4hso6.js";import{_ as _e}from"./C-QZrv9j.js";import{_ as me}from"./BW_TZ2bL.js";import{h as w,e as N,f as Y}from"./CZ6eCgXt.js";import{P as be}from"./CrgnIM47.js";import{F as ye}from"./DJpjRKvH.js";import{u as he}from"./Bfp68H6u.js";import{r as fe}from"./MXsTUCyV.js";import{r as xe}from"./jGqCdn13.js";import"./WJywbfjK.js";import"./BXOjIDzI.js";import"./DAHdFzVE.js";import"./C61IPztP.js";import"./B-WBCWpg.js";import"./Bvy4dQbz.js";import"./xplkPwj7.js";import"./DXJOBCvN.js";import"./rvUhT-B_.js";import"./5DhtzSAE.js";import"./B_mMcxuE.js";import"./BhnZKBDU.js";import"./n4_or2sV.js";import"./T519L7Bv.js";const ge={class:"px-5 py-5"},ve=e("img",{src:ue,alt:"report-icon",class:"w-8 h-8 mr-2"},null,-1),we={class:"w-full flex items-center justify-between"},ke={class:"flex items-center space-x-3"},De={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},Re={class:"w-72 ml-2"},Ce={class:"w-44"},$e={class:"flex items-center space-x-3"},Se={class:"border rounded print-container mt-5"},Ae={class:"w-full rounded-tr rounded-tl border-b px-5 py-5 flex items-center justify-between"},Te=e("div",{class:"flex flex-col space-y-2"},[e("img",{src:_e,alt:"app-logo",class:"w-24 h-24 object-cover"}),e("h3",{class:"text-xl font-semibold"},"LABORATORY DEPARTMENT REPORT")],-1),je={class:"mt-3 px-5 border-b"},Me={class:"font-medium mb-2"},Oe={class:"font-normal"},Pe={key:0,class:"overflow-x-auto",id:"print-container"},Fe={class:"w-full border border-dotted rounded overflow-x-auto"},Ve={class:"w-full"},Be=e("th",{class:"px-2 py-2 text-center border-r"},"TESTS",-1),Ee=["colspan"],ze=e("th",{class:"px-2 py-2 text-center"},"TOTAL",-1),Le={class:"border-b"},Ne=e("th",{class:"border-r"},null,-1),Ye={class:"capitalize px-2 py-2 text-center bg-gray-50 border-b border-t"},qe=e("th",{class:"capitalize px-2 py-2 text-center bg-gray-50 border-b border-t"},null,-1),Ue={class:"capitalize font-medium px-2 py-2 text-center border-r bg-gray-50"},Ge={class:"px-2 py-2 text-center font-medium"},We={key:0,class:"w-full border border-dotted rounded overflow-x-auto mt-10"},He=e("th",{class:"border-b px-2 py-2",rowspan:4},"Blood Product",-1),Ie=e("th",{class:"border-b px-2 py-2"},null,-1),Je=["colspan"],Ke={class:"border-t"},Qe={class:"capitalize px-2 py-2 text-center bg-gray-50 border-r"},Xe=e("td",{class:"px-2 py-2 border-r border-b"},null,-1),Ze=e("td",{class:"px-2 py-2 bg-gray-50 border-r"}," ",-1),et=e("td",{class:"px-2 py-2 border-b border-r"},"Age-Ranges",-1),tt=e("td",{class:"px-2 py-2 border-b border-r"},"0-5",-1),rt=e("td",{class:"px-2 py-2 border-b border-r"},"6-14",-1),ot=e("td",{class:"border-r px-2 py-2 border-b"},"15-120",-1),st=e("td",{class:"px-2 py-2 bg-gray-50 border-r"}," ",-1),at=e("td",{class:"px-2 py-2 border-b border-r"},"Female",-1),nt={class:"px-2 py-2 border-b border-r"},lt={class:"px-2 py-2 border-b border-r"},ct={class:"border-r px-2 py-2 border-b"},dt=e("td",{class:"px-2 py-2 bg-gray-50 border-r"}," ",-1),it=e("td",{class:"px-2 py-2 border-b border-r"},"Male",-1),pt={class:"px-2 py-2 border-b border-r"},ut={class:"px-2 py-2 border-b border-r"},_t={class:"border-r px-2 py-2 border-b"},mt=e("div",{class:"w-full py-2 mt-2.5 border-b"},[e("h3",{class:"text-xl font-semibold uppercase text-center"}," CRITICAL VALUES ")],-1),bt={key:1,class:"w-full border border-dotted rounded overflow-x-auto"},yt=e("th",{class:"px-2 py-2 text-center border-r"},"Measure",-1),ht=["colspan"],ft=e("th",{class:"px-2 py-2 text-center font-bold uppercase"},"Total",-1),xt={class:"border-b"},gt=e("th",{class:"border-r"},null,-1),vt={class:"capitalize px-2 py-2 text-center bg-gray-50 border-b border-t"},wt=e("th",{class:"capitalize px-2 py-2 text-center bg-gray-50 border-b border-t"},null,-1),kt={class:"capitalize px-2 py-2 text-center border-r"},Dt={class:"px-2 py-2 text-center font-bold"},Rt={class:"w-full items-center flex flex-col space-y-2 my-10"},Ct=e("p",null,[R("Generating report, please wait"),e("span",{class:"animate-pulse"},"...")],-1),$t={key:1,class:"flex flex-col space-y-3 items-center justify-center py-10"},St=e("img",{src:me,class:"w-20 h-20 object-cover",alt:"page-icon"},null,-1),At={class:"font-medium"},Tt="Department Report",dr=ee({__name:"department",setup(jt){pe({title:`${be.name.toUpperCase()} - Department Report`});const q=he(),O=v(new Array),u=v(new Array("","")),U=()=>{u.value=new Array("","")},x=v({name:"select department"}),P=te("token"),s=v({wards:[],data:[]}),f=v(!1),G=v([{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"Aggregate Reports",link:"#"}]),W=M(()=>{const{id:l,name:p}=x.value;return l===0||l===void 0?"":p}),F=M(()=>u.value[0]?w(u.value[0]).format("YYYY-MM-DD"):""),V=M(()=>u.value[1]?w(u.value[1]).format("YYYY-MM-DD"):"");async function H(){const l={route:N.departments,method:"GET",token:`${P.value}`},{data:p,error:_}=await Y(l);p.value&&(O.value=p.value),_.value&&console.error(_.value)}async function I(){if(K())z().$toast.warning("Please select a department!");else{f.value=!0,s.value={wards:[],data:[]};let l=`from=${F.value}&to=${V.value}&department=${J(x.value.name)}`;const p={route:`${N.aggregateReports}/department?${l}`,method:"GET",token:`${P.value}`},{data:_,error:y,pending:C}=await Y(p);f.value=C,_.value&&(f.value=!1,s.value=_.value,z().$toast.success("Report generated successfully!")),y.value&&(f.value=!1,console.error(y.value))}}function J(l){return l==="select department"||l==="-- select test type --"||l==="-- select test status --"?"":l}function K(){return x.value.name=="select department"}function B(l){return s.value.wards.reduce((_,y)=>_+(l.ward[y]?l.ward[y]:0),0)}function g(l,p,_,y){const $=JSON.parse(JSON.stringify(l[Object.keys(l)[0]])).find(k=>k.gender===p);if(!$)return 0;const S=$.ward.find(k=>Object.keys(k)[0]===_.toLowerCase());if(!S)return 0;const A=S[_.toLowerCase()][y];return A===void 0?0:A}return H(),(l,p)=>{const _=X,y=re("datepicker"),C=Z,$=ne,S=ce,A=de,k=ie,Q=le;return r(),o("div",ge,[b(_,{pages:t(G)},null,8,["pages"]),e("div",{class:"flex items-center py-5"},[ve,e("h3",{class:"text-2xl font-semibold uppercase"},c(Tt))]),e("div",we,[e("div",ke,[e("div",De,[b(t(fe),{class:"w-5 h-5 mr-2"}),R(" Filter By Date Range "),e("div",Re,[b(y,{onCleared:U,required:"",position:"left",placeholder:"select start & end date",range:!0,"input-class-name":"datepicker",format:"dd/MM/yyyy",modelValue:t(u),"onUpdate:modelValue":p[0]||(p[0]=n=>E(u)?u.value=n:null)},null,8,["modelValue"])])]),e("div",Ce,[b(C,{items:t(O),modelValue:t(x),"onUpdate:modelValue":p[1]||(p[1]=n=>E(x)?x.value=n:null)},null,8,["items","modelValue"])]),e("div",null,[b($,{color:"primary",text:"Generate Report",icon:t(xe),click:()=>I(),loading:t(f)},null,8,["icon","click","loading"])])]),e("div",$e,[b(S,{printSmallLabel:!1}),b(t(ye),{element:"print-container",filename:`department_report_from_${t(w)(t(F)).format("DD_MM_yyyy")}_to_${t(w)(t(V)).format("DD_MM_yyyy")}_for_${t(q).details.name.toLowerCase().split(" ").join("_")}`},{default:oe(()=>[b(A,{text:"Export Excel"})]),_:1},8,["filename"])])]),e("div",Se,[e("div",Ae,[Te,b(k)]),e("div",je,[e("h3",Me,[R(" Tests Performed Period: "),e("span",Oe,c(t(u)[0].toString()!=""?t(w)(t(u)[0].toString()).format("dateFormat"in l?l.dateFormat:t(L)):"")+" - "+c(t(u)[1].toString()!=""?t(w)(t(u)[1].toString()).format("dateFormat"in l?l.dateFormat:t(L)):""),1)])]),t(s).wards.length>0&&t(s).data.length>0?(r(),o("div",Pe,[e("table",Fe,[e("thead",Ve,[e("tr",null,[Be,e("th",{class:"px-2 py-2 text-center border-r border-b bg-gray-100",colspan:t(s).wards.length}," WARDS ",8,Ee),ze]),e("tr",Le,[Ne,(r(!0),o(d,null,i(t(s).wards,(n,h)=>(r(),o("th",{class:"px-2 py-2 text-center border-r",key:h},c(n),1))),128))])]),e("tbody",null,[(r(!0),o(d,null,i(t(s).data,(n,h)=>(r(),o(d,{key:h},[e("th",Ye,c(Object.keys(n)[0].toString().toUpperCase()),1),(r(!0),o(d,null,i(t(s).wards,(a,m)=>(r(),o("th",{class:"capitalize px-2 py-2 text-center bg-gray-50 border-b border-t",key:m}))),128)),qe,(r(!0),o(d,null,i(n[Object.keys(n)[0]],(a,m)=>(r(),o("tr",{class:"border-t border-b",key:m},[e("td",Ue,c(a.test_type),1),(r(!0),o(d,null,i(t(s).wards,(D,j)=>(r(),o("td",{key:j,class:"border-r px-2 py-2 text-center"},c(a.ward[D]?a.ward[D]:0),1))),128)),e("td",Ge,c(B(a)),1)]))),128))],64))),128))])]),t(s).blood_bank_products.length>0?(r(),o("table",We,[e("thead",null,[e("tr",null,[He,Ie,e("th",{class:"border-b px-2 py-2 bg-gray-100",colspan:t(s).wards.length}," Wards ",8,Je)])]),e("tbody",null,[(r(!0),o(d,null,i(t(s).blood_bank_products,(n,h)=>(r(),o(d,{key:h},[e("tr",Ke,[e("td",Qe,c(Object.keys(n)[0]),1),Xe,(r(!0),o(d,null,i(t(s).wards,(a,m)=>(r(),o("th",{colspan:3,class:"px-2 py-2 text-center border-r border-b",key:m},c(a),1))),128))]),e("tr",null,[Ze,et,(r(!0),o(d,null,i(t(s).wards,(a,m)=>(r(),o(d,{key:m},[tt,rt,ot],64))),128))]),e("tr",null,[st,at,(r(!0),o(d,null,i(t(s).wards,a=>(r(),o(d,{key:a},[e("td",nt,c(g(n,"female",a,"0-5")),1),e("td",lt,c(g(n,"female",a,"6-14")),1),e("td",ct,c(g(n,"female",a,"15-120")),1)],64))),128))]),e("tr",null,[dt,it,(r(!0),o(d,null,i(t(s).wards,a=>(r(),o(d,{key:a},[e("td",pt,c(g(n,"male",a,"0-5")),1),e("td",ut,c(g(n,"male",a,"6-14")),1),e("td",_t,c(g(n,"male",a,"15-120")),1)],64))),128))])],64))),128))])])):T("",!0),mt,t(s).critical_values.length>0?(r(),o("table",bt,[e("thead",null,[e("tr",null,[yt,e("th",{class:"px-2 py-2 text-center border-r border-b bg-gray-100",colspan:t(s).wards.length}," Wards ",8,ht),ft]),e("tr",xt,[gt,(r(!0),o(d,null,i(t(s).wards,(n,h)=>(r(),o("th",{class:"px-2 py-2 text-center border-r",key:h},c(n),1))),128))])]),e("tbody",null,[(r(!0),o(d,null,i(t(s).critical_values,(n,h)=>(r(),o(d,{key:h},[e("th",vt,c(Object.keys(n)[0]),1),(r(!0),o(d,null,i(t(s).wards,(a,m)=>(r(),o("th",{class:"capitalize px-2 py-2 text-center bg-gray-50 border-b border-t",key:m}))),128)),wt,(r(!0),o(d,null,i(n[Object.keys(n)[0]],(a,m)=>(r(),o("tr",{class:"border-t border-b",key:m},[e("td",kt,c(a.critical_value_level),1),(r(!0),o(d,null,i(t(s).wards,(D,j)=>(r(),o("td",{key:j,class:"border-r px-2 py-2 text-center"},c(a.ward[D]?a.ward[D]:0),1))),128)),e("td",Dt,c(B(a)),1)]))),128))],64))),128))])])):T("",!0)])):T("",!0),se(e("div",Rt,[b(Q),Ct],512),[[ae,t(f)]]),t(s).wards.length==0&&t(s).data.length==0&&!t(f)?(r(),o("div",$t,[St,e("p",null,[R(" Please generate report data to preview the "),e("span",At,c(t(W)),1),R(" report. ")])])):T("",!0)])])}}});export{dr as default};
