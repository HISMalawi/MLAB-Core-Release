import{_ as X}from"./B38OGO74.js";import{_ as Z}from"./BWe303fu.js";import{x as ee,y as k,b as h,L as te,d as ae,r as _,u as oe,a as se,c as F,C as f,w as O,o as ne,e as T,f as n,h as e,g as t,t as i,z as V,k as S,H as B,O as A,F as re,j as le,N as ie,K as E,l as ce,E as de,_ as ue}from"./DaVfplCl.js";import{_ as me}from"./BNBlrbgu.js";import{_ as pe,a as _e}from"./B5IH3IIM.js";import{u as fe,_ as he}from"./qDaxYYZu.js";import{C as ve,b as ge,L as be,B as ye,c as Te,p as xe,a as Ae,d as Re}from"./hJihSr_A.js";import{u as De}from"./MuIwof8c.js";import{_ as Ee}from"./aVKuZZVS.js";import{_ as ke}from"./DlVh0w5e.js";import{u as we}from"./TCrkXuHj.js";import{P as $e}from"./Dr0mg474.js";import{r as Ce}from"./B6aIjIoK.js";import{r as Me}from"./Dqe_SWQt.js";import"./CaCwXEk-.js";import"./Bk1fID9q.js";import"./CrLTzj8x.js";import"./BeuONbta.js";import"./C4Sn6TUr.js";import"./WTOBM9CX.js";import"./BBPlnGp-.js";import"./dfRNb6Oz.js";import"./zVsiTWFb.js";ve.register(ge,be,ye,Te,xe,Ae);const Fe={components:{Bar:Re},props:{chartData:{required:!0,type:Object}},data(){return{data:this.chartData,options:{responsive:!0,maintainAspectRatio:!1}}},watch:{chartData:{handler(w){this.data=w},deep:!0}}};function Oe(w,N,x,v,s,U){const $=k("Bar");return h(),te($,{data:s.data,options:s.options},null,8,["data","options"])}const Be=ee(Fe,[["render",Oe]]),Ne={class:"px-5 py-5"},Ue=t("img",{src:Ee,alt:"report-icon",class:"w-8 h-8 mr-2"},null,-1),Ve={class:"flex justify-between items-center"},Se={class:"w-full flex items-center space-x-3"},Pe={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},Ye={class:"w-72 ml-2"},je={class:"w-48"},qe={class:"w-48"},Ge={class:"w-48"},Le={class:"border rounded mt-10",id:"print-container"},Ie={class:"flex items-center justify-between px-5 py-5 border-b"},He=t("div",{class:"flex flex-col space-y-2"},[t("img",{src:ke,alt:"app-logo",class:"w-24 h-24 object-cover"}),t("h3",{class:"text-xl font-semibold"}," TURN AROUND TIME REPORT ")],-1),ze={class:"m-3"},Ke={class:"font-semibold mb-2"},We={class:"text-normal font-normal"},Je={key:0},Qe={class:"w-full rounded"},Xe={class:"border-t bg-gray-100 border-b"},Ze=t("th",{class:"text-left px-2 py-2 border-r uppercase"},"Test Type",-1),et={class:"text-left px-2 py-2 border-r uppercase"},tt={class:"text-left px-2 py-2 uppercase"},at={class:"text-left px-2 py-2 border-r border-b"},ot={class:"text-left px-2 py-2 border-r border-b"},st={class:"text-left px-2 py-2 border-b"},nt={key:1,class:"w-full flex flex-col items-center justify-center space-y-2 py-10"},rt=t("img",{src:_e,alt:"page-icon",class:"object-cover w-20 h-20"},null,-1),lt=t("p",null,"Data not found, please generate report",-1),it=[rt,lt],ct={key:0,class:"bg-gray-50 rounded mt-5 border"},dt={class:"px-5 py-5 flex flex-col items-center"},ut=t("h3",{class:"text-lg font-medium"},"Average Turn Around Time",-1),mt={class:"mt-1"},pt={key:0,style:{height:"400px"}},_t="Turn Around Time Report",St=ae({__name:"turn-around-time",setup(w){De({title:`${$e.name.toUpperCase()} - Turn Around Time Reports`});const N=_([{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"Aggregate Reports",link:"#"}]),x=_([]),v=_({name:"select department",id:0}),{loading:s,executeCancellableRequest:U,cancelRequest:$}=fe(),P=_([{name:"Minutes"},{name:"Hours"},{name:"Days"},{name:"Weeks"}]),c=_({name:"select unit"}),r=_([]),C=we(),{$toast:D,$metadata:Y}=oe(),j=se("token"),M=_({}),d=_(new Array("","")),q=()=>{d.value=new Array("","")},m=F(()=>d.value[0]?f(d.value[0]).format("YYYY-MM-DD"):""),p=F(()=>d.value[1]?f(d.value[1]).format("YYYY-MM-DD"):""),G=F(()=>r.value.length>0?r.value.map(a=>({"TEST TYPE":a.test_type,UNITS:c.value.name,"TURN AROUND TIME":a.turn_around_time,AVERAGE:a.average})):[]);async function L(){s.value=!0,M.value={};let a=`from=${m.value}&to=${p.value}&department=${v.value.id}&unit=${c.value.name.toLowerCase()}`;const o={route:`${ce.aggregateReports}turn_around_time?${a}`,method:"GET",token:`${j.value}`},{data:l,error:g,pending:b}=await U(o);s.value=b,l.value&&(s.value=!1,r.value=l.value.data,M.value={labels:l.value.data.map(y=>y.test_type),datasets:[{label:"Turn Around Time",backgroundColor:"#030712",data:l.value.data.map(y=>y.turn_around_time)},{label:"Average Turn Around Time",backgroundColor:"#0284c7",data:l.value.data.map(y=>Number(y.average))}]},l.value.data.length>0?D.success("Report data generated successfully"):D.warning(`No data found in period ${f(m.value).format(A)} - ${f(p.value).format(A)}`)),g.value&&(s.value=!1,console.error(g.value),D.error(de))}function I(){const a=v.value.name==="select department"||c.value.name==="select unit";return a&&D.warning("Please select a department and unit"),!a}return O(c,(a,o)=>{a!==o&&(r.value=[])}),O(v,(a,o)=>{a!==o&&(r.value=[])}),O(d,(a,o)=>{a!==o&&(r.value=[])}),ne(()=>{s.value=!1,x.value=Y.departments,x.value.some(o=>o.name=="All")||x.value.push({id:0,name:"All"}),x.value.sort((o,l)=>{const g=o.name.toUpperCase(),b=l.name.toUpperCase();return g<b?-1:g>b?1:0})}),(a,o)=>{const l=X,g=k("datepicker"),b=Z,y=ue,H=k("FormKit"),z=me,K=k("excel"),W=pe,J=he,Q=Be;return h(),T("div",Ne,[n(l,{pages:e(N)},null,8,["pages"]),t("div",{class:"flex items-center py-5"},[Ue,t("h3",{class:"text-2xl font-semibold uppercase"},i(_t))]),t("div",Ve,[n(H,{type:"form","submit-label":"Update",onSubmit:o[3]||(o[3]=R=>I()&&L()),actions:!1,id:"submitForm"},{default:V(({value:R})=>[t("div",Se,[t("div",Pe,[n(e(Ce),{class:"w-5 h-5 mr-2"}),S(" Filter By Date Range "),t("div",Ye,[n(g,{onCleared:q,required:"",position:"left",placeholder:"select start & end date",range:!0,"input-class-name":"datepicker",modelValue:e(d),"onUpdate:modelValue":o[0]||(o[0]=u=>B(d)?d.value=u:null),format:"dd/MM/yyyy"},null,8,["modelValue"])])]),t("div",je,[n(b,{items:e(x),modelValue:e(v),"onUpdate:modelValue":o[1]||(o[1]=u=>B(v)?v.value=u:null)},null,8,["items","modelValue"])]),t("div",qe,[n(b,{items:e(P),modelValue:e(c),"onUpdate:modelValue":o[2]||(o[2]=u=>B(c)?c.value=u:null)},null,8,["items","modelValue"])]),t("div",Ge,[n(y,{type:"submit",color:"primary",text:"Generate Report",icon:e(Me),click:()=>{},loading:e(s)},null,8,["icon","loading"])])])]),_:1}),n(K,{class:"btn btn-default",header:[`TURN AROUND TIME REPORT ${e(m)} - ${e(p)}`,e(C).details.name,e(C).details.address,e(C).details.phone],data:e(G),worksheet:"report-work-sheet",name:`turn_around_time_${e(m)}_to_${e(p)}.xls`},{default:V(()=>[n(z,{text:"Export Excel"})]),_:1},8,["header","data","name"])]),t("div",Le,[t("div",Ie,[He,n(W)]),t("div",ze,[t("h3",Ke,[S("Tests Performed Period: "),t("span",We,i(e(m)!==""?e(f)(e(m)).format("DATE_FORMAT"in a?a.DATE_FORMAT:e(A)):"")+" - "+i(e(p)!==""?e(f)(e(p)).format("DATE_FORMAT"in a?a.DATE_FORMAT:e(A)):""),1)])]),e(r).length>0&&!e(s)?(h(),T("div",Je,[t("table",Qe,[t("thead",null,[t("tr",Xe,[Ze,t("th",et,"Turn Around Time ("+i(e(c).name)+")",1),t("th",tt,"Average Turn Around Time ("+i(e(c).name)+")",1)])]),t("tbody",null,[(h(!0),T(re,null,le(e(r),(R,u)=>(h(),T("tr",{key:u,class:ie({"bg-white":u%2===0,"bg-gray-100":u%2!==0})},[t("td",at,i(R.test_type),1),t("td",ot,i(R.turn_around_time),1),t("td",st,i(R.average),1)],2))),128))])])])):E("",!0),e(r).length==0&&!e(s)?(h(),T("div",nt,it)):E("",!0),n(J,{condition:e(s),cancelReportGeneration:()=>e($)()},null,8,["condition","cancelReportGeneration"])]),e(r).length>0&&!e(s)?(h(),T("div",ct,[t("div",dt,[ut,t("p",mt,"From: "+i(e(m)!==""?e(f)(e(m)).format("DATE_FORMAT"in a?a.DATE_FORMAT:e(A)):"")+" - To: "+i(e(p)!==""?e(f)(e(p)).format("DATE_FORMAT"in a?a.DATE_FORMAT:e(A)):""),1)]),e(r).length>0?(h(),T("div",pt,[n(Q,{"chart-data":e(M)},null,8,["chart-data"])])):E("",!0)])):E("",!0)])}}});export{St as default};
