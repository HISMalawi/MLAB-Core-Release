import{_ as X}from"./9st0-0tz.js";import{_ as q}from"./BZkefcnP.js";import{S as E,p as O,Y as V,G as B,V as P,q as b,z as $,s as T,x as l,b as f,e as y,f as s,y as r,g as e,j as k,t as u,F as z,k as G,h as R,L as I,_ as S,a as L,u as w,E as U,H as M,D as A}from"./DFRCgfJ7.js";import{r as H}from"./C-CyX-lv.js";import{r as K}from"./CNSNb7H9.js";import{_ as Y}from"./BM3s60a1.js";import{_ as Q}from"./DKZ0QoWC.js";import{S as C}from"./BPBrVMfj.js";import{r as J}from"./DMnRMKKE.js";import{_ as W}from"./DJS9VRo6.js";import{P as Z}from"./BJWqiItS.js";import{u as ee}from"./DX-fG2iE.js";import{r as te}from"./CGZGMScv.js";import"./_gKYxzJq.js";import"./ETY0v-Ty.js";const oe={components:{TransitionRoot:E,TransitionChild:O,Dialog:V,DialogPanel:B,DialogTitle:P,XMarkIcon:b},data(){return{moment:$,viewIcon:H,show:!1,editIcon:K}},props:{data:{type:Object,required:!0}},methods:{handleClick(){this.show=!this.show}}},se={class:"fixed inset-0 overflow-y-auto"},ae={class:"flex min-h-full items-center justify-center p-4 text-center"},ne={class:"border-b px-3 py-3 flex items-center justify-between"},ie={class:"space-y-3 px-5 py-5"},le={class:"rounded border"},re={class:"w-full px-2 py-2 flex items-center space-x-2"},ce={class:"w-full px-2 py-2 flex items-center space-x-2"},de={class:"w-full"},pe={class:"border"},ue={class:"px-2 py-2 text-left border-r"},me={class:"px-2 py-2 text-left border-r"},_e={class:"px-2 py-2 text-left border-r"},fe={class:"px-2 py-2 text-left border-r"},he={class:"px-2 py-2 text-left border-r"},xe={class:"px-2 py-2 text-left border-r"};function ve(n,t,i,d,o,a){const m=S,_=l("TransitionChild"),x=l("DialogTitle"),v=l("XMarkIcon"),g=l("DialogPanel"),h=l("Dialog"),c=l("TransitionRoot");return f(),y("div",null,[s(m,{click:()=>{a.handleClick()},color:"primary",text:"View",icon:o.viewIcon},null,8,["click","icon"]),s(c,{appear:"",show:o.show,as:"template"},{default:r(()=>[s(h,{as:"div",class:"relative z-10"},{default:r(()=>[s(_,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:r(()=>t[1]||(t[1]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",se,[e("div",ae,[s(_,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:r(()=>[s(g,{class:"w-full max-w-4xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:r(()=>[e("div",ne,[s(x,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:r(()=>t[2]||(t[2]=[e("img",{src:Y,class:"w-8 h-8 mr-2"},null,-1),k(" View Stock Issue ")])),_:1}),e("button",{onClick:t[0]||(t[0]=(...p)=>a.handleClick&&a.handleClick(...p))},[s(v,{class:"w-5 h-5"})])]),e("div",ie,[e("div",le,[t[5]||(t[5]=e("div",{class:"bg-gray-50 border-b px-2 py-2 font-semibold rounded-t text-lg"}," Details ",-1)),e("div",re,[t[3]||(t[3]=e("label",{class:"font-medium"},"Destination:",-1)),e("p",null,u(i.data.movement_to),1)]),e("div",ce,[t[4]||(t[4]=e("label",{class:"font-medium"},"Movement Date:",-1)),e("p",null,u(i.data.movement_date),1)])]),e("table",de,[t[6]||(t[6]=e("thead",null,[e("tr",{class:"border bg-gray-50"},[e("th",{class:"px-2 py-2 text-left border-r"},"Stock Item"),e("th",{class:"px-2 py-2 text-left border-r"},"Quantity Issued"),e("th",{class:"px-2 py-2 text-left border-r"},"Batch"),e("th",{class:"px-2 py-2 text-left border-r"},"Lot"),e("th",{class:"px-2 py-2 text-left border-r"},"Expiry Date"),e("th",{class:"px-2 py-2 text-left border-r"},"Transaction Date")])],-1)),e("tbody",null,[(f(!0),y(z,null,G(i.data.stock_transactions,(p,j)=>(f(),y("tr",pe,[e("td",ue,u(p.name),1),e("td",me,u(p.transacted_quantity),1),e("td",_e,u(p.batch),1),e("td",fe,u(p.lot),1),e("td",he,u(o.moment(p.expiry_date).format("DATE_FORMAT"in n?n.DATE_FORMAT:R(I))),1),e("td",xe,u(o.moment(p.transaction_date).format("DATE_FORMAT"in n?n.DATE_FORMAT:R(I))),1)]))),256))])])])]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const ge=T(oe,[["render",ve]]),ye={components:{TransitionRoot:E,TransitionChild:O,Dialog:V,DialogPanel:B,DialogTitle:P,XMarkIcon:b,ExclamationTriangleIcon:J},data(){return{show:!1,rejectIcon:b,loading:!1,reason:"",cookie:L("token")}},props:{data:{type:Object,required:!0}},methods:{async voidStockCategory(n){this.loading=!0;const t=new C,{data:i,error:d,pending:o}=await t.rejectStockIssues(`${this.cookie}`,this.data.id,this.reason);this.loading=o,i.value&&(this.handleClick(),w().$toast.success("Stock issue rejected successfully!"),this.loading=!1,this.reason="",this.$emit("update",!0)),d.value&&(console.error(d.value),w().$toast.error(U),this.loading=!1)},handleClick(){this.show=!this.show}}},ke={class:"fixed inset-0 overflow-y-auto"},be={class:"flex min-h-full items-center justify-center p-4 text-center"},we={class:"border-b px-3 py-3 flex items-center justify-between"},De={class:"mt-2 space-y-3 px-5"},Ie={class:"rounded px-2 py-2"},Ce={class:"font-semibold text-red-500"},Te={class:"mt-4 justify-end flex items-center space-x-3 px-3 py-2 border-t"};function Se(n,t,i,d,o,a){const m=S,_=l("TransitionChild"),x=l("ExclamationTriangleIcon"),v=l("DialogTitle"),g=l("XMarkIcon"),h=l("FormKit"),c=Q,p=l("DialogPanel"),j=l("Dialog"),F=l("TransitionRoot");return f(),y("div",null,[s(m,{click:a.handleClick,color:"error",text:"Reject",icon:o.rejectIcon},null,8,["click","icon"]),s(F,{appear:"",show:o.show,as:"template"},{default:r(()=>[s(j,{as:"div",class:"relative z-10"},{default:r(()=>[s(_,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:r(()=>t[3]||(t[3]=[e("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)])),_:1}),e("div",ke,[e("div",be,[s(_,{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:r(()=>[s(p,{class:"w-full max-w-3xl transform overflow-hidden rounded bg-white text-left align-middle shadow-xl transition-all"},{default:r(()=>[e("div",we,[s(v,{as:"h3",class:"text-lg flex items-center font-medium leading-6"},{default:r(()=>[s(x,{class:"h-5 w-5 mr-2"}),t[4]||(t[4]=k(" Reject Stock Issue "))]),_:1}),e("button",{onClick:t[0]||(t[0]=(...D)=>a.handleClick&&a.handleClick(...D))},[s(g,{class:"w-5 h-5"})])]),s(h,{type:"form","submit-label":"Update",onSubmit:t[2]||(t[2]=D=>a.voidStockCategory(i.data.id)),actions:!1},{default:r(({value:D})=>[e("div",De,[e("div",Ie,[t[5]||(t[5]=k(" Do you really want to reject stock issue to ")),e("span",Ce,u(i.data.movement_to),1),t[6]||(t[6]=k("? Note that once this action is completed, it can not be undone "))]),s(h,{type:"textarea",label:"Reason",validation:"required",modelValue:o.reason,"onUpdate:modelValue":t[1]||(t[1]=N=>o.reason=N)},null,8,["modelValue"])]),e("div",Te,[s(c,{click:()=>{a.handleClick()},type:"button",text:"Cancel"},null,8,["click"]),s(m,{loading:o.loading,type:"submit",click:()=>{},color:"error",icon:o.rejectIcon,text:"Reject"},null,8,["loading","icon"])])]),_:1})]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])])}const je=T(ye,[["render",Se]]),Re={setup(){ee({title:`${Z.name.toUpperCase()} - Issues Stock`})},data(){return{header:"Stock Issue",pages:[{name:"Home",link:"/home"},{name:"Stock Management",link:"#"}],search:"",headers:[{text:"destination",value:"movement_to",sortable:!0},{text:"status",value:"stock_status"},{text:"transaction items",value:"stock_transactions.length"},{text:"movement date",value:"movement_date"},{text:"actions",value:"actions"}],data:new Array,cookie:L("token"),loading:!1,addIcon:te,rejectIcon:b,serverItemsLength:0,serverOptions:{page:1,rowsPerPage:25,sortBy:"name"}}},created(){this.init(this.search)},computed:{filteredData(){return this.data.map(n=>({...n,movement_date:$(n.movement_date).format(I)}))}},methods:{async init(n){this.loading=!0;const t=new C,{page:i,rowsPerPage:d}=this.serverOptions,o=`search=${n}&page=${i}&per_page=${d}`,{data:a,error:m,pending:_}=await t.getStockIssues(`${this.cookie}`,o);this.loading=_,a.value&&(console.log(a.value),this.loading=!1,this.data=a.value.data,this.serverItemsLength=a.value.meta.total_count),m.value&&(console.error(m.value),this.loading=!1)},async approveStockIssue(n){this.loading=!0;const t=new C,{data:i,error:d,pending:o}=await t.approveStockIssues(`${this.cookie}`,n);this.loading=o,i.value&&(console.log(i.value),this.loading=!1,w().$toast.success("Stock issue approved successfully"),this.init(this.search)),d.value&&(console.error(d.value),w().$toast.error(U),this.loading=!1)}}},Me={class:"px-5 py-5"},Ae={class:"flex items-center justify-between py-5"},Ee={class:"text-2xl font-semibold"},Oe={class:"flex items-center justify-end py-5"},Ve={class:"py-2 flex items-center space-x-2"};function Be(n,t,i,d,o,a){const m=X,_=q,x=ge,v=S,g=je,h=W;return f(),y("div",Me,[s(m,{pages:o.pages},null,8,["pages"]),e("div",Ae,[e("h3",Ee,u(o.header),1)]),e("div",Oe,[s(_,{search:o.search,"onUpdate:search":t[0]||(t[0]=c=>o.search=c),onUpdate:a.init},null,8,["search","onUpdate"])]),e("div",null,[s(h,{loading:o.loading,headers:o.headers,data:a.filteredData,"search-field":"movement_to",searchValue:o.search,serverItemsLength:o.serverItemsLength,serverOptions:o.serverOptions,onUpdate:a.init},{actions:r(({item:c})=>[e("div",Ve,[s(x,{data:c},null,8,["data"]),c.stock_status.toLowerCase()=="pending"?(f(),M(v,{key:0,click:()=>a.approveStockIssue(c.id),text:"Approve",color:"success",icon:o.addIcon},null,8,["click","icon"])):A("",!0),c.stock_status.toLowerCase()=="pending"?(f(),M(g,{key:1,data:c,onUpdate:a.init},null,8,["data","onUpdate"])):A("",!0)])]),_:1},8,["loading","headers","data","searchValue","serverItemsLength","serverOptions","onUpdate"])])])}const We=T(Re,[["render",Be]]);export{We as default};
