import{_ as I}from"./CSp2YO-U.js";import{a as q,P as c,C as h,O as b,u as m,E as y,x as O,y as x,b as _,e as f,f as a,g as e,t as i,j as $,F as N,k as R,i as A,v as U,K as P,_ as j}from"./byrs3Ots.js";import{_ as C,a as E}from"./BI5xOIVi.js";import{S as g}from"./BZJBUt7x.js";import{P as M}from"./DJ4B06VU.js";import{u as T}from"./JQtyNrok.js";import{r as B}from"./DvkwANBP.js";import{r as F}from"./DqjuqaIQ.js";import{r as K}from"./D4TaIKV1.js";import{r as Q}from"./CDuVWNNI.js";import{r as H}from"./CQPCRkye.js";import{_ as L}from"./IQzdcCmk.js";import"./CiGacxWW.js";import"./BMxHOE3o.js";import"./Dippuhly.js";import"./C3pt0xtn.js";const G={setup(){T({title:`${M.name.toUpperCase()} - Approve Stock Order`})},components:{TicketIcon:B},data(){return{header:"Approve Stock Order",checkIcon:F,allIcon:K,rejectIcon:Q,pages:[{name:"Home",link:"/home"},{name:"Stock Orders",link:"/stock-management/orders"}],cookie:q("token"),deleteicon:H,loading:!1,approving:!1,verifying:!1,requisitions:new Array,voidReason:"",issuerName:"",issuerDesignation:"",issuerPhone:"",issuerSignature:"",approverName:"",approverDesignation:"",approverPhone:"",approverSignature:"",issuedDate:"",approvedDate:""}},created(){this.init()},methods:{async init(){this.loading=!0;const t=new g,{data:o,error:l,pending:n}=await t.getStockOrder(`${this.cookie}`,`${(this._.provides[c]||this.$route).query.order_id}`);this.loading=n,o.value&&(this.requisitions=o.value.stock_requisitions,this.loading=!1,o.value.stock_pharmacy_approver_and_issuers.map(s=>{s.record_type=="issuer"?(this.issuerName=s.name,this.issuerPhone=s.phone_number,this.issuerDesignation=s.designation,this.issuerSignature=s.signature,this.issuedDate=h(s.created_date).format(b)):(this.approverName=s.name,this.approverPhone=s.phone_number,this.approverDesignation=s.designation,this.approverSignature=s.signature,this.approvedDate=h(s.created_date).format(b))})),l.value&&(console.error(l.value),this.loading=!1)},async approveStockOrder(){this.approving=!0;const t=new g;let o=this.requisitions.map(p=>p.id);const{data:l,error:n,pending:s}=await t.approveStockOrder(`${this.cookie}`,{stock_order_id:`${(this._.provides[c]||this.$route).query.order_id}`,stock_requisition_ids:o});this.approving=s,l.value&&(this.approving=!1,this.$router.push("/stock-management/orders"),m().$toast.success(`Stock order request #${(this._.provides[c]||this.$route).params.voucherId} approved successfully`)),n.value&&(console.error(n.value),m().$toast.error(y),this.approving=!1)},async approveRequisition(t){this.loading=!0;const o=new g,{data:l,error:n,pending:s}=await o.approveStockOrderRequisition(`${this.cookie}`,{stock_requisition_id:t});this.loading=s,l.value&&(this.loading=!1,m().$toast.success("Stock order requisition approved successfully")),n.value&&(console.error(n.value),m().$toast.error(y),this.loading=!1)}}},z={class:"px-5 py-5"},J={class:"py-5 flex items-center justify-between"},W={class:"text-2xl font-semibold"},X={class:"px-4 py-2 bg-gray-50 flex items-center justify-between"},Y={class:"flex items-center space-x-2"},Z={class:"flex items-center space-x-3 justify-end"},ee={class:"rounded border mt-5"},se={class:"w-full grid grid-cols-2 gap-5 py-5 px-5"},oe={class:"col-span-1 flex flex-col space-y-2"},te={class:"w-full flex items-center space-x-2"},re={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ae={class:"w-full flex items-center space-x-2"},ie={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ne={class:"w-full flex items-center space-x-2"},le={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},de={class:"w-full flex items-center space-x-2"},ce={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},pe={class:"col-span-1 flex flex-col space-y-2"},ue={class:"w-full flex items-center space-x-2"},me={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},_e={class:"w-full flex items-center space-x-2"},fe={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ge={class:"w-full flex items-center space-x-2"},ve={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},he={class:"w-full flex items-center space-x-2"},be={class:"w-full border-b-2 text-gray-700 border-dotted pb-1 font-normal border-gray-300"},ye={key:0,class:"grid grid-cols-5 gap-4 mt-5"},xe={class:"flex flex-col space-y-2"},ke={class:"flex items-center space-x-2 pt-8"};function we(t,o,l,n,s,p){const k=I,w=x("TicketIcon"),v=j,S=C,u=x("FormKit"),V=E;return _(),f("div",z,[a(k,{pages:s.pages},null,8,["pages"]),e("div",J,[e("h3",W,i(s.header),1)]),e("div",X,[e("div",Y,[a(w,{class:"h-5 w-5"}),e("p",null,[o[0]||(o[0]=$("Voucher Number: ")),e("strong",null,i((t._.provides[c]||t.$route).params.voucherId),1)])]),e("div",Z,[a(v,{loading:s.approving,icon:s.allIcon,text:"Approve Order",color:"success",click:p.approveStockOrder},null,8,["loading","icon","click"]),a(S,{stockId:`${(t._.provides[c]||t.$route).query.order_id}`,orderId:`${(t._.provides[c]||t.$route).params.voucherId}`},null,8,["stockId","orderId"])])]),e("div",ee,[o[9]||(o[9]=e("div",{class:"flex items-center space-x-3 bg-gray-50 py-2 rounded-t px-2 border-b"},[e("img",{src:L,class:"w-6 h-6"}),e("h3",{class:"text-lg font-semibold"},"Pharmacy")],-1)),e("div",se,[e("div",oe,[e("div",te,[o[1]||(o[1]=e("p",{class:"w-72 font-medium"},"Issued by: ",-1)),e("span",re,i(s.issuerName),1)]),e("div",ae,[o[2]||(o[2]=e("p",{class:"w-72 font-medium"},"Designation: ",-1)),e("span",ie,i(s.issuerDesignation),1)]),e("div",ne,[o[3]||(o[3]=e("p",{class:"w-72 font-medium"},"Signature: ",-1)),e("span",le,i(s.issuerSignature),1)]),e("div",de,[o[4]||(o[4]=e("p",{class:"w-72 font-medium"},"Date:",-1)),e("span",ce,i(s.issuedDate),1)])]),e("div",pe,[e("div",ue,[o[5]||(o[5]=e("p",{class:"w-72 font-medium"},"Approved by: ",-1)),e("span",me,i(s.approverName),1)]),e("div",_e,[o[6]||(o[6]=e("p",{class:"w-72 font-medium"},"Designation: ",-1)),e("span",fe,i(s.approverDesignation),1)]),e("div",ge,[o[7]||(o[7]=e("p",{class:"w-72 font-medium"},"Signature: ",-1)),e("span",ve,i(s.issuerSignature),1)]),e("div",he,[o[8]||(o[8]=e("p",{class:"w-72 font-medium"},"Date:",-1)),e("span",be,i(s.approvedDate),1)])])])]),(_(!0),f(N,null,R(s.requisitions,(r,D)=>A((_(),f("div",{class:"flex flex-col space-y-3",key:D},[r.requisition_status.toLowerCase()!=="rejected"?(_(),f("div",ye,[e("div",xe,[a(u,{label:"Stock item",disabled:!0,modelValue:r.item.name,"onUpdate:modelValue":d=>r.item.name=d},null,8,["modelValue","onUpdate:modelValue"])]),a(u,{label:"Quantity requested",type:"number",disabled:!0,modelValue:r.quantity_requested,"onUpdate:modelValue":d=>r.quantity_requested=d},null,8,["modelValue","onUpdate:modelValue"]),a(u,{label:"Quantity issued",type:"number",disabled:!0,modelValue:r.quantity_issued,"onUpdate:modelValue":d=>r.quantity_issued=d},null,8,["modelValue","onUpdate:modelValue"]),a(u,{label:"Quantity collected",type:"number",disabled:!0,modelValue:r.quantity_collected,"onUpdate:modelValue":d=>r.quantity_collected=d},null,8,["modelValue","onUpdate:modelValue"]),e("div",ke,[a(v,{text:"Approve",icon:s.checkIcon,color:"success",click:()=>{p.approveRequisition(r.id)}},null,8,["icon","click"]),a(V,{onUpdate:p.init,data:r,orderId:`${(t._.provides[c]||t.$route).params.voucherId}`},null,8,["onUpdate","data","orderId"])])])):P("",!0)])),[[U,!s.loading]])),128))])}const Te=O(G,[["render",we]]);export{Te as default};
