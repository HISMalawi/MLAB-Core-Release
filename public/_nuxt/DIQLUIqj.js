import{S as N,p as L,Y as W,G as B,V as G,q as A,s as O,B as j,P as T,a as K,l as h,m as g,bs as I,a2 as H,u as R,x as X,y as w,b as u,e as m,f as l,g as s,t as U,z as Y,i as k,aD as q,v as z,h as J,bn as Q,F as f,j as v,K as x,bt as Z,k as $,n as ee,_ as te}from"./B6Tj7v0x.js";import{_ as se}from"./Bo9Y6Pu_.js";import{r as oe,_ as le}from"./Dwb4xzFl.js";import{_ as ne}from"./DUGoDEYW.js";import{u as ae}from"./BU27LF7R.js";import{P as ie}from"./D0dD8Pjq.js";import{r as re}from"./DopEa1Gw.js";import{r as de}from"./DDhblu8r.js";import{r as ue}from"./B1xyAgl0.js";import{r as me}from"./LlNZ35XP.js";import{r as ce}from"./DjbowuN7.js";import{r as pe}from"./DmLkMLbG.js";import{I as _e,E as he,j as ge,A as ye,F as fe}from"./CeQk7h_J.js";import"./BbLbM4kr.js";import"./Ch3yEbHE.js";import"./Bhrz-4gH.js";import"./DcNW31lB.js";import"./B3lZ31pd.js";import"./qSwcIyrJ.js";import"./BWO9R2Jr.js";const ve={components:{TransitionRoot:N,TransitionChild:L,Dialog:W,DialogPanel:B,DialogTitle:G,Listbox:_e,ListboxLabel:he,ListboxButton:ge,ListboxOptions:ye,ListboxOption:fe,XMarkIcon:A,UserIcon:re,CheckCircleIcon:de,InformationCircleIcon:ue,ChevronUpDownIcon:oe},setup(){ae({title:`${ie.name.toUpperCase()} - Test Types`})},data(){return{open:!1,addIcon:O,saveIcon:me,clearIcon:ce,removeIcon:A,trashIcon:pe,loadingSpecimens:!1,showMeasures:!1,measures:1,ranges:0,indicators:[{name:"",test_indicator_type:0,unit:"",description:"",indicator_ranges:[]}],numericRange:{max_age:0,min_age:0,lower_range:0,upper_range:0,interpretation:""},autocompleteRange:{value:"",interpretation:""},name:"",sexSelected:"",shortName:"",turnAroundTime:"",measureTypes:Array(),measureSelected:{name:"",id:0},loading:!1,updating:!1,editIcon:j,id:(this._.provides[T]||this.$route).query.testType,patientSex:new Array({name:"Male",label:"Male",value:"M"},{name:"Female",label:"Female",value:"F"},{name:"Both",label:"Both",value:"Both"}),details:{name:"",short_name:"",expected_turn_around_time:{value:"",unit:""},test_indicator_type:{id:0,name:""},department:{id:0,name:""},specimens:{id:0,name:"",created_date:""},indicators:new Array,organisms:new Array},specimensSelected:new Array,rawOrganisms:new Array,organisms:new Array,organismsSelected:new Array,shouldPrintResults:!1,showCultureWorksheet:!1,timeTypes:new Array({name:"Month"},{name:"Weeks"},{name:"Days"},{name:"Hours"},{name:"Minutes"}),duration:{name:"-- select value --"},expected_turn_around_time:"",cookie:K("token"),rawSpecimens:new Array,specimens:new Array,departments:new Array,measureType:"",pages:[{name:"Home",link:"/home"},{name:"Test Catalog",link:"#"},{name:"Test Types",link:"/test-catalog/test-types"}]}},created(){this.init()},methods:{async init(){var t,p,b;this.loading=!0,await this.loadSpecimens(),await this.loadDepartments(),await this.loadTestTypeIndicators(),await this.loadOrganisms();const i={route:`${h.viewTestType}/${(this._.provides[T]||this.$route).query.testType}`,method:"GET",token:`${this.cookie}`},{data:e,error:a,pending:c}=await g(i);this.loading=c,e.value&&(this.details=e.value,this.specimensSelected=I(e.value.specimens),this.organismsSelected=I(e.value.organisms),this.showCultureWorksheet=e.value.organisms.length>0,this.shouldPrintResults=e.value.print_device,this.duration={name:((t=e.value.expected_turn_around_time)==null?void 0:t.unit)!==null?(p=e.value.expected_turn_around_time)==null?void 0:p.unit:"-- select value --"},this.expected_turn_around_time=(b=e.value.expected_turn_around_time)==null?void 0:b.value,this.sexSelected=e.value.sex,this.loading=!1),a.value&&(console.error("error:",a.value),this.loading=!1)},async loadOrganisms(){const i={route:h.organisms,method:"GET",token:`${this.cookie}`},{error:e,data:a}=await g(i);a.value&&(this.rawOrganisms=a.value,a.value.map(c=>{this.organisms.push(c.name)})),e.value&&console.log(e.value)},async loadSpecimens(){const i={route:h.specimens,method:"GET",token:`${this.cookie}`},{data:e,pending:a,error:c}=await g(i);this.loadingSpecimens=a,e.value&&(this.loadingSpecimens=!1,this.rawSpecimens=e.value,e.value.map(t=>{this.specimens.push(t.name)})),c.value&&(this.loadingSpecimens=!1,console.error(c.value))},async loadDepartments(){const i={route:h.departments,method:"GET",token:`${this.cookie}`},{data:e,error:a}=await g(i);e.value&&(this.departments=e.value),a.value&&console.error("error:",a.value)},async loadTestTypeIndicators(){const i={route:`${h.testTypes}/test_indicator_types`,method:"GET",token:`${this.cookie}`},{data:e,error:a}=await g(i);e.value&&(this.measureTypes=e.value,this.measureSelected=e.value[0],this.measureType=this.measureSelected.name),a.value&&console.error(a.value)},addMeasure(i){i.push({name:"",test_indicator_type:this.measureSelected,unit:"",description:"",indicator_ranges:[]})},addRange(i,e){if(this.ranges=this.ranges+1,this.measureSelected.name=="Numeric")try{e.indicator_ranges.push(this.numericRange)}catch(a){console.error("error:",a)}else if(this.measureSelected.name==="Auto Complete")try{e.indicator_ranges.push({value:"",interpretation:""})}catch(a){console.error("error:",a)}},filterSpecimens(i,e){let a=new Array;return e.map(c=>{const t=i.filter(p=>p.name===c);a.push(t[0].id)}),a},async submitForm(){this.updating=!0,this.details.specimens=this.filterSpecimens(this.rawSpecimens,this.specimensSelected),this.details.department=this.details.department.id,this.details.organisms=this.showCultureWorksheet?H(this.rawOrganisms,this.organismsSelected):new Array,this.details.expected_turn_around_time={value:this.expected_turn_around_time,unit:this.duration.name},this.details.print_device=this.shouldPrintResults;const i={route:`${h.testTypes}/${(this._.provides[T]||this.$route).query.testType}`,method:"PUT",token:`${this.cookie}`,body:this.details},{pending:e,data:a,error:c}=await g(i);this.updating=e,a.value&&(this.open=!1,R().$toast.success("Test type updated successfully!"),this.updating=!1,this.$emit("update",!0)),c.value&&(R().$toast.error("An error occurred, please try again!"),console.error("error:",c.value),this.updating=!1)},removeObjectKeys(i,e){(i=="rich_text"||i=="free_text")&&delete this.details[e]}}},xe={class:"px-5 py-5"},be={key:0,class:"w-full flex flex-col space-y-2 items-center justify-center py-20"},Ve=s("label",null,"Loading test type data, please wait...",-1),we={key:1},ke={class:"flex items-center justify-between py-5"},Se={class:"text-2xl font-semibold"},Te={class:"mt-2 space-y-3"},Ue={class:"grid grid-cols-2 gap-4"},Ce={class:"w-full flex"},Ae={class:"py-1 ml-2"},Ie=s("label",{class:"font-medium text-base"},"Duration",-1),Re={class:"w-full flex items-center space-x-2"},qe=s("label",{for:"showCultureWorksheet"},"Show Culture Worksheet?",-1),Me={class:"w-full flex flex-col space-y-2"},De=s("label",{class:"font-medium"},"Organisms",-1),Ee={class:"w-full flex flex-col space-y-2"},Pe=s("label",{class:"font-medium"},"Specimens",-1),Fe={class:"w-full flex items-center space-x-2"},Ne=s("label",{for:"shouldPrintResults"},"Print Results On Small Label?",-1),Le={class:"w-full flex items-center"},We={class:"w-full flex flex-col space-y-2"},Be=s("label",{class:"font-medium"},"Lab section",-1),Ge={class:"w-full flex"},Oe={class:"py-3 flex items-center justify-between"},je={class:"text-lg text-grameasuresy-700 font-semibold"},Ke=["onClick"],He={class:"grid grid-cols-4 gap-2 mb-3"},Xe={class:"mt-1"},Ye=s("label",{class:"font-medium"},"Type",-1),ze={key:0},Je={class:"flex items-center space-x-3"},Qe={class:"grid grid-cols-2 gap-2"},Ze={class:""},$e=s("label",{class:"mb-2 text-lg font-semibold text-gray-600"},"Age Range",-1),et={class:"grid grid-cols-2 gap-2"},tt=s("label",{class:"-mb-2 font-semibold"},"Sex",-1),st=["onUpdate:modelValue"],ot=["value"],lt={class:""},nt=s("label",{class:"mb-2 text-lg font-semibold text-gray-600"},"Measure Range",-1),at={class:"grid grid-cols-2 gap-2"},it={class:"-mt-20"},rt={class:"w-full items-center flex space-x-3"},dt={class:"flex items-center gap-2"},ut={class:"mt-8"},mt={class:"justify-end flex items-center space-x-3 px-3 py-2"};function ct(i,e,a,c,t,p){const b=ee,M=se,d=w("FormKit"),S=le,C=w("multi-select"),D=ne,y=te,E=w("XMarkIcon"),P=w("InformationCircleIcon");return u(),m("div",xe,[t.loading?(u(),m("div",be,[l(b),Ve])):(u(),m("div",we,[l(M,{pages:t.pages},null,8,["pages"]),s("div",ke,[s("h3",Se,U(t.details.name),1)]),s("div",null,[l(d,{type:"form","submit-label":"Update",onSubmit:p.submitForm,actions:!1},{default:Y(({value:pt})=>[s("div",Te,[s("div",Ue,[l(d,{type:"text",label:"Name",validation:"required",modelValue:t.details.name,"onUpdate:modelValue":e[0]||(e[0]=o=>t.details.name=o)},null,8,["modelValue"]),l(d,{type:"text",label:"Short name",validation:"required",modelValue:t.details.short_name,"onUpdate:modelValue":e[1]||(e[1]=o=>t.details.short_name=o)},null,8,["modelValue"])]),s("div",Ce,[l(d,{type:"number",label:"Expected Turn Around Time",validation:"required|number",modelValue:t.expected_turn_around_time,"onUpdate:modelValue":e[2]||(e[2]=o=>t.expected_turn_around_time=o)},null,8,["modelValue"]),s("div",Ae,[Ie,l(S,{items:t.timeTypes,modelValue:t.duration,"onUpdate:modelValue":e[3]||(e[3]=o=>t.duration=o)},null,8,["items","modelValue"])])]),s("div",Re,[k(s("input",{id:"showCultureWorksheet",name:"showCultureWorksheet",type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=o=>t.showCultureWorksheet=o)},null,512),[[q,t.showCultureWorksheet]]),qe]),k(s("div",Me,[De,l(C,{style:{"--ms-max-height":"none !important"},modelValue:t.organismsSelected,"onUpdate:modelValue":e[5]||(e[5]=o=>t.organismsSelected=o),options:t.organisms,mode:"tags",clear:"",searchable:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])],512),[[z,t.showCultureWorksheet]]),s("div",Ee,[Pe,l(C,{style:{"--ms-max-height":"none !important"},modelValue:t.specimensSelected,"onUpdate:modelValue":e[6]||(e[6]=o=>t.specimensSelected=o),options:t.specimens,mode:"tags",required:"",clear:"",class:"focus:ring-none fcus:border-none focus:outline-none multiselect-green"},null,8,["modelValue","options"])]),s("div",Fe,[k(s("input",{id:"shouldPrintResults",name:"shouldPrintResults",type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=o=>t.shouldPrintResults=o)},null,512),[[q,t.shouldPrintResults]]),Ne]),s("div",Le,[s("div",We,[Be,l(S,{items:t.departments,modelValue:t.details.department,"onUpdate:modelValue":e[8]||(e[8]=o=>t.details.department=o)},null,8,["items","modelValue"])])]),l(D,{label:"Specific Sex","items-selected":t.details.sex,"onUpdate:itemsSelected":e[9]||(e[9]=o=>t.details.sex=o),items:("GENDER"in i?i.GENDER:J(Q)).map(o=>o.name),mode:"single"},null,8,["items-selected","items"]),s("div",Ge,[l(y,{type:"button",click:()=>{p.addMeasure(t.details.indicators)},color:"primary",text:"Add Measure",icon:t.addIcon},null,8,["click","icon"])]),t.details.indicators.length!=0?(u(!0),m(f,{key:0},v(t.details.indicators,(o,V)=>(u(),m("div",{key:V,class:"border py-3 px-3 rounded"},[s("div",Oe,[s("h3",je," Measures ("+U(V+1)+") ",1),s("button",{type:"button",onClick:()=>{t.details.indicators.splice(V,1)}},[l(E,{class:"w-5 h-5"})],8,Ke)]),s("div",He,[l(d,{type:"text",label:"Name",validation:"required",modelValue:o.name,"onUpdate:modelValue":n=>o.name=n},null,8,["modelValue","onUpdate:modelValue"]),s("div",Xe,[Ye,l(S,{items:t.measureTypes,modelValue:o.test_indicator_type,"onUpdate:modelValue":n=>o.test_indicator_type=n},null,8,["items","modelValue","onUpdate:modelValue"])]),l(d,{type:"text",label:"Unit",modelValue:o.unit,"onUpdate:modelValue":n=>o.unit=n},null,8,["modelValue","onUpdate:modelValue"]),l(d,{type:"text",label:"Description",modelValue:o.description,"onUpdate:modelValue":n=>o.description=n},null,8,["modelValue","onUpdate:modelValue"])]),o.test_indicator_type.name!="Free Text"?(u(),m("div",ze,[l(y,{type:"button",click:()=>{p.addRange(V,o)},color:"primary",text:"Add New Range",icon:t.addIcon},null,8,["click","icon"])])):x("",!0),o.indicator_ranges.length>0&&o.test_indicator_type.name==="Numeric"?(u(!0),m(f,{key:1},v(o.indicator_ranges,(n,_)=>(u(),m("div",{class:"px-3 py-3",key:_},[s("div",Je,[s("div",Qe,[s("div",Ze,[$e,s("div",et,[l(d,{type:"number",label:"Minimum",validation:"required",modelValue:n.min_age,"onUpdate:modelValue":r=>n.min_age=r},null,8,["modelValue","onUpdate:modelValue"]),l(d,{type:"number",label:"Maximum",validation:"required",modelValue:n.max_age,"onUpdate:modelValue":r=>n.max_age=r},null,8,["modelValue","onUpdate:modelValue"]),s("div",null,[tt,k(s("select",{class:"w-full bg-white border px-2 py-2 focus:ring-none rounded","onUpdate:modelValue":r=>n.sex=r},[(u(!0),m(f,null,v(t.patientSex,(r,F)=>(u(),m("option",{key:F,value:r.name},U(r.name),9,ot))),128))],8,st),[[Z,n.sex]])])])]),s("div",lt,[nt,s("div",at,[l(d,{type:"number",step:"any",number:"",label:"Minimum",validation:"required|float",modelValue:n.lower_range,"onUpdate:modelValue":r=>n.lower_range=r},null,8,["modelValue","onUpdate:modelValue"]),l(d,{type:"number",step:"any",number:"",label:"Maximum",validation:"required|float",modelValue:n.upper_range,"onUpdate:modelValue":r=>n.upper_range=r},null,8,["modelValue","onUpdate:modelValue"])])]),l(d,{type:"text",label:"Interpretation",modelValue:n.interpretation,"onUpdate:modelValue":r=>n.interpretation=r},null,8,["modelValue","onUpdate:modelValue"])]),s("div",it,[l(y,{type:"button",color:"error",text:"Remove",icon:t.trashIcon,click:()=>{o.indicator_ranges.splice(_,1)}},null,8,["icon","click"])])])]))),128)):x("",!0),o.indicator_ranges.length!=0&&o.test_indicator_type.name==="Auto Complete"?(u(!0),m(f,{key:2},v(o.indicator_ranges,(n,_)=>(u(),m("div",{class:"px-3 py-3",key:_},[s("div",rt,[s("div",dt,[l(d,{type:"text",label:"Value",validation:"required",modelValue:n.value,"onUpdate:modelValue":r=>n.value=r},null,8,["modelValue","onUpdate:modelValue"]),l(d,{type:"text",label:"Interpretation",modelValue:n.interpretation,"onUpdate:modelValue":r=>n.interpretation=r},null,8,["modelValue","onUpdate:modelValue"])]),s("div",ut,[l(y,{type:"button",color:"error",text:"Remove",icon:t.trashIcon,click:()=>{o.indicator_ranges.splice(_,1)}},null,8,["icon","click"])])])]))),128)):x("",!0),t.ranges!=0&&o.test_indicator_type.name==="Free Text"?(u(!0),m(f,{key:3},v(t.ranges,(n,_)=>(u(),m("div",{class:"flex items-center px-3 py-3 rounded bg-gray-50 mt-3",key:_},[l(P,{class:"w-5 h-5 mr-2"}),$(" A text box will appear for results entry ")]))),128)):x("",!0)]))),128)):x("",!0)]),s("div",mt,[l(y,{type:"submit",click:()=>{},loading:t.updating,color:"success",icon:t.saveIcon,text:"Save Changes"},null,8,["loading","icon"])])]),_:1},8,["onSubmit"])])]))])}const Dt=X(ve,[["render",ct]]);export{Dt as default};
