import{_ as ee}from"./ucPVlGIa.js";import{_ as te}from"./C525PUnr.js";import{d as oe,aF as re,r as $,a as ae,a5 as se,ak as ne,u as ce,w as de,C as N,c as ie,o as P,y as le,b as R,e as C,f as m,h as o,g as t,k as q,H as ue,z as pe,t as s,K as V,F as me,j as _e,l as H,m as I,aG as ye,E as he,_ as be,n as xe}from"./CnHVHtNb.js";import{_ as ve}from"./BmVeJhZC.js";import{_ as fe,a as ke}from"./D-MoOnWN.js";import{u as ge}from"./Bnl9n6mh.js";import{_ as $e}from"./D8FNkFa0.js";import{_ as Re}from"./n49EBazs.js";import{u as Ce}from"./DY202iD-.js";import{P as we}from"./O-3ebvIT.js";import{r as je}from"./YtRYkxjm.js";import{r as De}from"./lw9t-99L.js";import"./BZb3bzVo.js";import"./n6mkMIpm.js";import"./B0PCQlmK.js";import"./BNP8985R.js";import"./DHZFDxBX.js";import"./Cj8g3RT8.js";import"./DpVzKT_I.js";import"./4iVNZzzj.js";import"./C20_EJt5.js";const Qe={class:"px-5 py-5"},Ne=t("div",{class:"py-5"},[t("div",{class:"text-2xl font-semibold flex items-center uppercase"},[t("img",{src:$e,class:"w-8 h-8 mr-2"}),q(" Serology Report ")])],-1),Ye={class:"w-full flex justify-between py-5"},Te={class:"flex items-center space-x-3"},Ee={class:"bg-gray-100 pl-2.5 rounded flex items-center text-zinc-500"},Ae={class:"w-36 ml-2 bg-white"},Oe={class:"border rounded"},Me={class:"rounded-tr rounded-tl border-b px-5 py-5 flex items-center justify-between"},Se=t("div",{class:"flex flex-col space-y-2"},[t("img",{src:Re,alt:"app-logo",class:"w-24 h-24 object-cover"}),t("h3",{class:"text-xl font-semibold"},"SEROLOGY MoH LABORATORY REPORT")],-1),qe={class:"px-4 py-2.5 font-medium"},Fe={class:"font-normal"},Be={class:"overflow-x-auto rounded border-t relative"},Le={key:0,class:"w-full bg-black bg-opacity-5 absolute flex space-y-2 justify-center py-20 mx-auto h-full"},Ge={class:"flex flex-col items-center space-y-"},Pe={class:"overflow-x-auto"},Ve=t("thead",{class:"border-b"},[t("tr",{class:"w-full bg-gray-50"},[t("th",{class:"px-4 py-2 uppercase border-r"},"Laboratory Service"),t("th",{class:"px-4 py-2 uppercase border-r"},"Jan"),t("th",{class:"px-4 py-2 uppercase border-r"},"Feb"),t("th",{class:"px-4 py-2 uppercase"},"March"),t("th",{class:"px-4 py-2 uppercase bg-sky-50 text-sky-500 border border-sky-100"},"Total Q1"),t("th",{class:"px-4 py-2 uppercase border-r"},"Apr"),t("th",{class:"px-4 py-2 uppercase border-r"},"May"),t("th",{class:"px-4 py-2 uppercase"},"Jun"),t("th",{class:"px-4 py-2 uppercase bg-sky-50 text-sky-500 border border-sky-100"},"Total Q2"),t("th",{class:"px-4 py-2 uppercase border-r"},"Jul"),t("th",{class:"px-4 py-2 uppercase border-r"},"Aug"),t("th",{class:"px-4 py-2 uppercase"},"Sep"),t("th",{class:"px-4 py-2 uppercase bg-sky-50 text-sky-500 border border-sky-100"},"Total Q3"),t("th",{class:"px-4 py-2 uppercase border-r"},"Oct"),t("th",{class:"px-4 py-2 uppercase border-r"},"Nov"),t("th",{class:"px-4 py-2 uppercase"},"Dec"),t("th",{class:"px-4 py-2 uppercase bg-sky-50 text-sky-500 border-t border-l border-b border-sky-100"},"Total Q4 "),t("th",{class:"px-4 py-2 uppercase bg-green-600 text-white border border-green-400"},"Total")])],-1),He={class:"px-4 py-2 text-center border-r border-b"},Ie=["onClick"],Je=["onClick"],Ue=["onClick"],ze={class:"px-4 py-2 text-center bg-sky-50 text-sky-500 border border-sky-100"},Ke=["onClick"],We=["onClick"],Xe=["onClick"],Ze={class:"px-4 py-2 text-center bg-sky-50 text-sky-500 border border-sky-100"},et=["onClick"],tt=["onClick"],ot=["onClick"],rt={class:"px-4 py-2 text-center bg-sky-50 text-sky-500 border border-sky-100"},at=["onClick"],st=["onClick"],nt=["onClick"],ct={class:"px-4 py-2 text-center bg-sky-50 text-sky-500 border-t border-l border-b border-sky-100"},dt={class:"px-4 py-2 text-center bg-green-600 border text-white border-green-400"},it={key:1,class:"w-full flex flex-col items-center justify-center space-y-2 py-10"},lt=t("img",{src:ke,alt:"page-icon",class:"object-cover w-20 h-20"},null,-1),ut=t("p",{class:"text-base"},"Could not load data, please try again",-1),pt=[lt,ut],Ot=oe({__name:"serology",setup(mt){ge({title:`${we.name.toUpperCase()} - Biochemistry Report`});const J=re([{name:"Home",link:"/home"},{name:"Reports",link:"#"},{name:"MoH Diagnistic Reports",link:"#"}]),y=$([]),a=$({name:"select year"}),F=$([]),B=ae("token"),u=$(!1),h=se(),b=ne(),{$toast:x}=ce(),Y=Ce(),L=$([]),l=(n,r,c,p)=>{if(c!==0&&p!==""){const _=N(r).format("MMMM-YYYY");h.push(`/reports/${p}?origin=moh&type=serology-report&dateRange=${_}&test=${n} - ${_}&department=serology&count=${c}`)}else x.warning("No data found for this month")},U=async()=>{u.value=!0;const n={route:`${H.reportIndicators}?department=serology`,method:"GET",token:`${B.value}`},{data:r,error:c}=await I(n);r.value&&(y.value=r.value.map(p=>({indicator:p,jan:{count:"!",associated_ids:""},feb:{count:"!",associated_ids:""},mar:{count:"!",associated_ids:""},totalQ1:"!",apr:{count:"!",associated_ids:""},may:{count:"!",associated_ids:""},june:{count:"!",associated_ids:""},totalQ2:"!",jul:{count:"!",associated_ids:""},aug:{count:"!",associated_ids:""},sept:{count:"!",associated_ids:""},totalQ3:"!",oct:{count:"!",associated_ids:""},nov:{count:"!",associated_ids:""},dec:{count:"!",associated_ids:""},totalQ4:"!",total:"!"})),u.value=!1),c.value&&(console.error(c.value),u.value=!1,x.error(ye))},z=async()=>{a.value.name==="select year"?x.warning("Please select a year"):G()},K=()=>{let n="";if(a.value.name!=="select year"&&(n=`&year=${a.value.name}`),b.query.period){const r=`1/${String(b.query.period)}`;n=`&year=${N(r).format("YYYY")}`,a.value={name:N(r).format("YYYY")}}return n},G=async()=>{u.value=!0;const n={route:`${H.mohReport}serology?report_id=${b.query.report_id}${K()}`,method:"GET",token:`${B.value}`},{data:r,error:c,pending:p}=await I(n);if(u.value=p,r.value){let _=[];y.value.map(d=>{let v=r.value.january[d.indicator],f=r.value.february[d.indicator],k=r.value.march[d.indicator],e=r.value.april[d.indicator],g=r.value.may[d.indicator],i=r.value.june[d.indicator],T=r.value.july[d.indicator],E=r.value.august[d.indicator],A=r.value.september[d.indicator],O=r.value.october[d.indicator],M=r.value.november[d.indicator],S=r.value.december[d.indicator],w=v.count+f.count+k.count,j=e.count+g.count+i.count,D=T.count+E.count+A.count,Q=O.count+M.count+S.count;_.push({indicator:d.indicator,jan:v,feb:f,mar:k,totalQ1:w,apr:e,may:g,june:i,totalQ2:j,jul:T,aug:E,sept:A,totalQ3:D,oct:O,nov:M,dec:S,totalQ4:Q,total:w+j+D+Q}),L.value.push({"Laboratory Service":d.indicator,January:v.count,February:f.count,March:k.count,"Total Q1":w,April:e.count,May:g.count,June:i.count,"Total Q2":j,July:T.count,August:E.count,September:A.count,"Total Q3":D,October:O.count,November:M.count,December:S.count,"Total Q4":Q,Total:w+j+D+Q})}),y.value=[],y.value.push(..._),u.value=!1,W(r.value.report_id),x.success("Report data generated successfully!")}c.value&&(u.value=!1,console.error(c.value),x.error(he))},W=n=>{const c={...h.currentRoute.value.query,report_id:n};h.replace({query:c}).catch(p=>{console.error("Failed to replace route:",p)})},X=()=>{const n=new Date().getFullYear();F.value=Array.from({length:n-1999},(r,c)=>({name:(n-c).toString(),id:n-c}))};de(a,()=>{if(a){const r={...h.currentRoute.value.query,period:N(a.value.name).format("M/yyyy"),report_id:""};h.replace({query:r}).catch(c=>{console.error("Failed to replace route:",c)})}},{deep:!0});const Z=ie(()=>b.query.period!==void 0&&b.query.period!=="");return P(()=>{Z.value&&G()}),P(()=>{X(),U()}),(n,r)=>{const c=ee,p=te,_=be,d=ve,v=le("excel"),f=fe,k=xe;return R(),C("div",Qe,[m(c,{pages:o(J)},null,8,["pages"]),Ne,t("div",Ye,[t("div",Te,[t("div",Ee,[m(o(je),{class:"w-5 h-5 mr-2"}),q(" Filter By Year "),t("div",Ae,[m(p,{items:o(F),modelValue:o(a),"onUpdate:modelValue":r[0]||(r[0]=e=>ue(a)?a.value=e:null)},null,8,["items","modelValue"])])]),m(_,{class:"mt-1",loading:o(u),click:()=>{z()},color:"primary",icon:o(De),text:"Generate report"},null,8,["loading","click","icon"])]),t("div",null,[m(v,{class:"btn btn-default",header:[`SEROLOGY MoH LABORATORY REPORT ${o(a).name}`,o(Y).details.name,o(Y).details.address,o(Y).details.phone],data:o(L),worksheet:"report-work-sheet",name:`moh_serology_report_${o(a).name}.xls`},{default:pe(()=>[m(d,{text:"Export Excel"})]),_:1},8,["header","data","name"])])]),t("div",Oe,[t("div",Me,[Se,m(f)]),t("div",null,[t("h3",qe,[q(" Data for the year: "),t("span",Fe,s(o(a).name=="select year"?"-:-":o(a).name),1)])]),t("div",Be,[o(u)?(R(),C("div",Le,[t("div",Ge,[m(k,{width:100,height:100})])])):V("",!0),t("table",Pe,[Ve,t("tbody",null,[(R(!0),C(me,null,_e(o(y),(e,g)=>(R(),C("tr",{class:"px-2",key:g},[t("td",He,s(e.indicator),1),t("td",{class:"px-4 py-2 text-center border-r border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:i=>l(e.indicator,`01-01-${o(a).name}`,Number(e.jan.count),e.jan.associated_ids)},s(e.jan.count),9,Ie),t("td",{class:"px-4 py-2 text-center border-r border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:i=>l(e.indicator,`02-01-${o(a).name}`,Number(e.feb.count),e.feb.associated_ids)},s(e.feb.count),9,Je),t("td",{class:"px-4 py-2 text-center border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:i=>l(e.indicator,`03-01-${o(a).name}`,Number(e.mar.count),e.mar.associated_ids)},s(e.mar.count),9,Ue),t("td",ze,s(e.totalQ1),1),t("td",{class:"px-4 py-2 text-center border-r border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:i=>l(e.indicator,`04-01-${o(a).name}`,Number(e.apr.count),e.apr.associated_ids)},s(e.apr.count),9,Ke),t("td",{class:"px-4 py-2 text-center border-r border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:i=>l(e.indicator,`05-01-${o(a).name}`,Number(e.may.count),e.may.associated_ids)},s(e.may.count),9,We),t("td",{class:"px-4 py-2 text-center border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:i=>l(e.indicator,`06-01-${o(a).name}`,Number(e.june.count),e.june.associated_ids)},s(e.june.count),9,Xe),t("td",Ze,s(e.totalQ2),1),t("td",{class:"px-4 py-2 text-center border-r border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:i=>l(e.indicator,`07-01-${o(a).name}`,Number(e.jul.count),e.jul.associated_ids)},s(e.jul.count),9,et),t("td",{class:"px-4 py-2 text-center border-r border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:i=>l(e.indicator,`08-08-${o(a).name}`,Number(e.aug.count),e.aug.associated_ids)},s(e.aug.count),9,tt),t("td",{class:"px-4 py-2 text-center border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:i=>l(e.indicator,`09-9-${o(a).name}`,Number(e.sept.count),e.sept.associated_ids)},s(e.sept.count),9,ot),t("td",rt,s(e.totalQ3),1),t("td",{class:"px-4 py-2 text-center border-r border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:i=>l(e.indicator,`10-10-${o(a).name}`,Number(e.oct.count),e.oct.associated_ids)},s(e.oct.count),9,at),t("td",{class:"px-4 py-2 text-center border-r border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:i=>l(e.indicator,`11-11-${o(a).name}`,Number(e.nov.count),e.nov.associated_ids)},s(e.nov.count),9,st),t("td",{class:"px-4 py-2 text-center border-b hover:font-medium cursor-pointer hover:text-sky-500 hover:underline transition duration-150",onClick:i=>l(e.indicator,`12-12-${o(a).name}`,Number(e.dec.count),e.dec.associated_ids)},s(e.dec.count),9,nt),t("td",ct,s(e.totalQ4),1),t("td",dt,s(e.total),1)]))),128))])]),o(y).length==0&&!o(u)?(R(),C("div",it,pt)):V("",!0)])])])}}});export{Ot as default};
