import{l as C,s as p,u as T,H as $,f as v,o as x,c as y,d as e,I as M,b as n,k as t,h as w,y as S,g as I,t as r,F as U,r as V,a as b,e as A}from"./entry.b51c7940.js";import{_ as F}from"./ExportButton.vue.8b20e855.js";import{_ as O}from"./Address.vue.6cd5ea75.js";import{e as Y}from"./constants.f9070035.js";import{_ as B}from"./logo.b2eed704.js";import{h as u,e as L,f as D}from"./fetch.1b976651.js";import{u as P}from"./facility.7ce18275.js";import{r as j}from"./FunnelIcon.8d1a5535.js";import{r as q}from"./ArrowPathIcon.31dd2cbd.js";import"./transition.f96680a2.js";import"./hidden.553b83b2.js";import"./XMarkIcon.e7deb21c.js";import"./PencilSquareIcon.afcaebc6.js";import"./PrinterIcon.0b3e5367.js";const z={class:"w-full flex items-center justify-between mb-10"},H={class:"flex flex-row items-center bg-gray-100 rounded-l pl-2 font-normal text-zinc-500"},J={class:"w-44 ml-2"},K={class:"w-48"},Q={class:"rounded border",id:"print-container"},W={class:"rounded-tr rounded-tl border-b px-5 py-5 flex items-center justify-between"},X=e("div",{class:"flex flex-col space-y-2"},[e("img",{src:B,alt:"app-logo",class:"w-24 h-24 object-cover"}),e("h3",{class:"text-xl font-semibold"},"CULTURE & SENSITIVITY GENERAL COUNTS REPORT ")],-1),Z={class:"px-4 py-2.5 font-medium"},ee={class:"font-normal"},te={class:"w-full mt-2",ref:"table"},oe={class:"w-full border-b border-t bg-gray-100 rounded-t"},se={class:"w-full"},re={class:"border-b"},ae={class:"px-2 py-2 text-center border-r"},ne={class:"px-2 py-2 text-center border-r"},le={class:"px-2 py-2 text-center border-r"},ie={class:"px-2 py-2 text-center border-r"},ce={class:"px-2 py-2 text-center"},Ge=C({__name:"general-counts",setup(de){const o=p(""),N=T("token"),_=P(),l=p(!1),s=p({Growth:0,"No growth":0,"Mixed growth; no predominant organism":0,"Growth of normal flora; no pathogens isolated":0,"Growth of contaminants":0}),g=p([{name:"Growth"},{name:"No Growth"},{name:"Mixed Growth:  No Predominant Organism"},{name:"Growth Normal Flora: No Pathogens Isolated"},{name:"Growth: Contaminations"}]),E=$(()=>g.value.map(i=>({NAME:i.name,COUNT:s.value[i.name]||0})));async function G(){l.value=!0;let i=u(o.value).format("M"),a=u(o.value).format("yyyy");const f={route:`${L.aggregateReports}culture/general_counts?year=${a}&month=${i}`,method:"GET",token:`${N.value}`},{data:c,error:d,pending:h}=await D(f);l.value=h,c.value&&(s.value=c.value.data,l.value=!1,b().$toast.success("Report data generated successfully")),d.value&&(console.error(d.value),l.value=!1,b().$toast.error(Y))}return(i,a)=>{const f=v("datepicker"),c=A,d=F,h=v("excel"),R=O;return x(),y("div",null,[e("div",z,[e("form",{onSubmit:a[1]||(a[1]=M(m=>G(),["prevent"])),class:"flex items-center space-x-5"},[e("div",H,[n(t(j),{class:"w-4 h-4 mr-2"}),w(" Filter by date "),e("div",J,[n(f,{placeholder:"month & year",required:"","input-class-name":"custom-input",modelValue:t(o),"onUpdate:modelValue":a[0]||(a[0]=m=>S(o)?o.value=m:null),range:!1,format:"M/yyyy",position:"left"},null,8,["modelValue"])])]),e("div",K,[n(c,{type:"submit",color:"primary",text:"Generate Report",icon:t(q),click:()=>{},loading:t(l)},null,8,["icon","loading"])])],32),e("div",null,[n(h,{class:"btn btn-default",header:[`CULTURE & SENSITIVITY GENERAL COUNTS REPORT ${t(o)}`,t(_).details.name,t(_).details.address,t(_).details.phone,"",""],data:t(E),worksheet:"report-work-sheet",name:`culture_sensitivity_general_counts_report_${t(u)(t(o)).format("M_YYYY")}.xls`},{default:I(()=>[n(d,{text:"Export Excel",icon:"excel.png"})]),_:1},8,["header","data","name"])])]),e("div",Q,[e("div",W,[X,n(R)]),e("div",null,[e("h3",Z,[w("Data for period: "),e("span",ee,r(t(o)==""?"-":t(u)(t(o)).format("M/yyyy")),1)])]),e("table",te,[e("thead",oe,[e("tr",se,[(x(!0),y(U,null,V(t(g),(m,k)=>(x(),y("th",{class:"px-2 py-2 border-r",key:k},r(m.name),1))),128))])]),e("tbody",null,[e("tr",re,[e("td",ae,r(t(s).Growth),1),e("td",ne,r(t(s)["No growth"]),1),e("td",le,r(t(s)["Mixed growth; no predominant organism"]),1),e("td",ie,r(t(s)["Growth of normal flora; no pathogens isolated"]),1),e("td",ce,r(t(s)["Growth of contaminants"]),1)])])],512)])])}}});export{Ge as default};
