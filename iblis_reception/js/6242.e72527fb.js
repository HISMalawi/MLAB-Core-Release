"use strict";(globalThis["webpackChunkIBLISReception"]=globalThis["webpackChunkIBLISReception"]||[]).push([[6242],{1940:(e,t,n)=>{n.d(t,{Z:()=>l});n(8858),n(1318),n(3228);var o=n(4542),a=n(6188);class l{async writeLbl(e,t,n=`${Date.now()}.lbl`){const l=(0,o.KU)();try{const o=await l.getText(e,t),i=new Blob([null===o||void 0===o?void 0:o.data],{type:"text/plain"});e=URL.createObjectURL(i);const r=document.createElement("a");r.setAttribute("href",e),r.setAttribute("download",n),r.click(),URL.revokeObjectURL(e),(0,a.x9)("Accession number printed!")}catch(i){console.error(i)}}}},8688:(e,t,n)=>{n.d(t,{C:()=>o});n(278);function o(e,t){const n=Object.values(Object.values(e)),o=n.filter((e=>!!e[t])).reduce(((e,n)=>(Array.isArray(n[t])?e[t]=n[t]:e[t]={...e[t],...n[t]},e)),{});return o}},4982:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});n(560);var o=n(6252),a=n(9013),l=n(516),i=n(9652),r=n(4542),u=n(8688),d=n(2201),s=n(6188),c=n(1940),p=n(2262),m=n(3577);function v(e,t,n,a,l,i){const r=(0,o.up)("ion-title"),u=(0,o.up)("IonIcon"),d=(0,o.up)("ion-button"),s=(0,o.up)("ion-buttons"),c=(0,o.up)("ion-toolbar"),p=(0,o.up)("ion-header"),v=(0,o.up)("ion-label"),f=(0,o.up)("ion-item"),_=(0,o.up)("ion-list"),w=(0,o.up)("ion-content"),h=(0,o.up)("ion-footer"),y=(0,o.up)("ion-modal"),g=(0,o.up)("ion-page");return(0,o.wg)(),(0,o.j4)(g,null,{default:(0,o.w5)((()=>[(0,o.Wm)(w,{class:"ion-padding"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{"is-open":e.open},{default:(0,o.w5)((()=>[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Wm)(r,{style:{"font-size":"20px","font-weight":"600"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Patient order")])),_:1}),(0,o.Wm)(s,{slot:"end"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{strong:!0,onClick:t[0]||(t[0]=t=>e.handleDialog())},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{size:"large",icon:e.close},null,8,["icon"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Wm)(_,null,{default:(0,o.w5)((()=>[(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Tracking Number")])),_:1}),(0,o.Wm)(v,{slot:"end"},{default:(0,o.w5)((()=>{var t;return[(0,o.Uk)((0,m.zw)(null===(t=e.order)||void 0===t?void 0:t.tracking_number),1)]})),_:1})])),_:1}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Accession Number")])),_:1}),(0,o.Wm)(v,{slot:"end"},{default:(0,o.w5)((()=>{var t;return[(0,o.Uk)((0,m.zw)(null===(t=e.order)||void 0===t?void 0:t.accession_number),1)]})),_:1})])),_:1}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Patient Name")])),_:1}),(0,o.Wm)(v,{slot:"end"},{default:(0,o.w5)((()=>{var t,n,a;return[(0,o.Uk)((0,m.zw)(`${null===(t=e.order)||void 0===t?void 0:t.client.first_name} ${null===(n=e.order)||void 0===n?void 0:n.client.middle_name}\n                                                            ${null===(a=e.order)||void 0===a?void 0:a.client.last_name}`),1)]})),_:1})])),_:1}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Specimen Type")])),_:1}),(0,o.Wm)(v,{slot:"end"},{default:(0,o.w5)((()=>{var t;return[(0,o.Uk)((0,m.zw)(null===(t=e.order)||void 0===t?void 0:t.specimen),1)]})),_:1})])),_:1}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Test(s) Ordered")])),_:1}),(0,o.Wm)(v,{slot:"end"},{default:(0,o.w5)((()=>{var t;return[(0,o.Uk)((0,m.zw)(e.extractedTests(null===(t=e.order)||void 0===t?void 0:t.test_types)),1)]})),_:1})])),_:1}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Specimen Status")])),_:1}),(0,o.Wm)(v,{slot:"end"},{default:(0,o.w5)((()=>{var t,n;return[(0,o.Uk)((0,m.zw)("specimen-not-collected"==(null===(t=e.order)||void 0===t?void 0:t.order_status)?"Specimen not collected":null===(n=e.order)||void 0===n?void 0:n.order_status),1)]})),_:1})])),_:1})])),_:1})])),_:1}),(0,o.Wm)(h,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c,{color:"light",style:{padding:"5px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{onClick:t[1]||(t[1]=t=>e.changeSpecimenStatus("accepted")),slot:"end",size:"large",color:"success"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Accept ")])),_:1}),(0,o.Wm)(d,{onClick:t[2]||(t[2]=t=>e.changeSpecimenStatus("rejected")),slot:"end",size:"large",color:"danger"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Reject ")])),_:1}),(0,o.Wm)(d,{slot:"end",size:"large",color:"primary"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Add Test ")])),_:1})])),_:1})])),_:1})])),_:1},8,["is-open"])])),_:1})])),_:1})}var f=n(3231),_=n(9126),w=n(8903);const h=(0,o.aZ)({components:{IonPage:_._i,IonButtons:_.Sm,IonButton:_.YG,IonIcon:_.gu,IonModal:_.ki,IonHeader:_.Gu,IonContent:_.W2,IonToolbar:_.sr,IonTitle:_.wd,IonFooter:_.fr,IonItem:_.Ie,IonLabel:_.Q$,IonList:_.q_},data(){return{open:!0,close:w.xvD}},props:{order:{required:!0,type:Object},show:{required:!0,default:!1,type:Boolean}},methods:{extractedTests(e){return e.map((e=>e.name)).join(", ")},handleDialog(){this.open=!1},async changeSpecimenStatus(e){const t=(0,r.KU)(),n=await t.putJson(`order_statuses/${e}`,{order_id:this.order.id});null!==n&&void 0!==n&&n.ok&&((0,s.x9)(`Specimen ${e} successfully!`),f.Z.push("/home"))}}});var y=n(3744);const g=(0,y.Z)(h,[["render",v]]),T=g;var b=n(9963);function k(e,t){console.log("PatientDialog"),console.log(t);const n=document.getElementById("rootContainer"),o=(0,b.ri)(T,{show:e,order:t});o.mount(n,!1)}const W=(0,o._)("div",{id:"rootContainer"},null,-1),S=(0,o.aZ)({__name:"NewOrder",setup(e){const t=(0,p.iH)(),n=(0,p.iH)(!1),m=()=>{n.value=!0,k(n.value,t.value)},v=(0,d.yj)(),_=(0,r.KU)(),w=()=>{const e=[];return{id:"visit_type",helpText:"Visit type",type:i.f.TT_SELECT,validation:e=>a.Z.required(e),computedValue:e=>({encounter:{encounter_type:e.value}}),init:async()=>{var t;const n=await _.getJson("encounter_types");return!(null===n||void 0===n||!n.ok)&&(null===(t=n.data)||void 0===t||t.data.forEach((t=>{e.push({label:t.name,value:t.id})})),!0)},options:()=>e}},h=()=>({id:"clinician",helpText:"Requesting Clinician",type:i.f.TT_TEXT,computedValue:e=>({order:{requested_by:e.value}}),validation:e=>a.Z.required(e)}),y=()=>({id:"collector",helpText:"Sample collected by (Optional)",type:i.f.TT_TEXT,computedValue:e=>({order:{collected_by:(null===e||void 0===e?void 0:e.value)||""}})}),g=()=>{const e=[];let t=null;return{id:"ward",helpText:"Requesting ward/location",type:i.f.TT_SELECT,init:async()=>{var n;const o=await _.getJson("global");o.ok&&(t=o.data.id);const a=await _.getJson("facility_sections");return!(null===a||void 0===a||!a.ok)&&(null===(n=a.data)||void 0===n||n.data.forEach((t=>{e.push({label:t.name,value:t.id})})),!0)},computedValue:e=>({encounter:{facility_section:e.value,sending_facility:t||-1}}),validation:e=>a.Z.required(e),options:()=>e}},T=()=>({id:"date",helpText:"Date",type:i.f.TT_DATE_PICKER,validation:e=>a.Z.required(e)}),b=()=>{let e=[];return{id:"specimen_type",helpText:"Specimen type",type:i.f.TT_SELECT,init:async()=>{const t=await _.getJson("specimen");return!(null===t||void 0===t||!t.ok)&&(e=t.data.map((e=>({label:e.name,value:e.id}))),!0)},options:()=>e,validation:e=>a.Z.required(e)}},S=()=>{let e=[];return{id:"priority",helpText:"Specify priority",type:i.f.TT_SELECT,computedValue:e=>({order:{priority:e.value}}),validation:e=>a.Z.required(e),init:async()=>{const t=await _.getJson("priorities");return!(null===t||void 0===t||!t.ok)&&(e=t.data.map((e=>({label:e.name,value:e.id}))),!0)},options:()=>e}},x=()=>{let e=[],t=null;return{id:"test_types",helpText:"Select test types",type:i.f.TT_MULTIPLE_SELECT,config:{showKeyboard:!0},computedValue:(e,t)=>({tests:e.map((e=>({specimen:t.specimen_type.value,test_type:e.value})))}),options:async n=>{if(n.specimen_type.value!=t){e=[],t=n.specimen_type.value;const o=await _.getJson("specimen/test_types",{specimen_id:t});if(null===o||void 0===o||!o.ok)return[];e=o.data.map((e=>({label:e,value:e})))}return e},validation:e=>a.Z.required(e)}},I=()=>({id:"time_sample_collected",helpText:"Time Sample Collected",type:i.f.TT_TIME,computedValue:(e,t)=>({order:{sample_collected_time:`${t.date} ${e.value}`}}),validation:e=>a.Z.required(e)}),U=[w(),g(),h(),y(),b(),x(),T(),I(),S()],E=async(e,o)=>{const a=new c.Z,l={client:{id:parseInt(`${v.params.client_id}`)},...(0,u.C)(o,"encounter"),...(0,u.C)(o,"order"),...(0,u.C)(o,"tests")};_.postJson("orders",l).then((e=>{t.value=e.data;const o=e.data.accession_number;if(!e.ok)return(0,s.L6)(e.error);a.writeLbl("printout/accession_number",{accession_number:o},`${o}.lbl`),n.value=!0,f.Z.push(`/patient-details/${e.data.client_id}`),(0,s.x9)("Order as been created!"),m()})).catch((()=>(0,s.N$)(r.XF.GENERAL_ERROR)))};return(e,t)=>((0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(l.Z,{fields:U,onFinish:E,skipSummary:!0,cancelDestinationPath:"/home"}),W]))}}),x=S,I=x},2148:(e,t,n)=>{var o=n(8702),a=n(2560);e.exports=function(e,t,n){return n.get&&o(n.get,t,{getter:!0}),n.set&&o(n.set,t,{setter:!0}),a.f(e,t,n)}},1500:e=>{var t=TypeError;e.exports=function(e,n){if(e<n)throw new t("Not enough arguments");return e}},8858:(e,t,n)=>{var o=n(1880),a=n(8844),l=n(4327),i=n(1500),r=URLSearchParams,u=r.prototype,d=a(u.append),s=a(u["delete"]),c=a(u.forEach),p=a([].push),m=new r("a=1&a=2&b=3");m["delete"]("a",1),m["delete"]("b",void 0),m+""!=="a=2"&&o(u,"delete",(function(e){var t=arguments.length,n=t<2?void 0:arguments[1];if(t&&void 0===n)return s(this,e);var o=[];c(this,(function(e,t){p(o,{key:t,value:e})})),i(t,1);var a,r=l(e),u=l(n),m=0,v=0,f=!1,_=o.length;while(m<_)a=o[m++],f||a.key===r?(f=!0,s(this,a.key)):v++;while(v<_)a=o[v++],a.key===r&&a.value===u||d(this,a.key,a.value)}),{enumerable:!0,unsafe:!0})},1318:(e,t,n)=>{var o=n(1880),a=n(8844),l=n(4327),i=n(1500),r=URLSearchParams,u=r.prototype,d=a(u.getAll),s=a(u.has),c=new r("a=1");!c.has("a",2)&&c.has("a",void 0)||o(u,"has",(function(e){var t=arguments.length,n=t<2?void 0:arguments[1];if(t&&void 0===n)return s(this,e);var o=d(this,e);i(t,1);var a=l(n),r=0;while(r<o.length)if(o[r++]===a)return!0;return!1}),{enumerable:!0,unsafe:!0})},3228:(e,t,n)=>{var o=n(7697),a=n(8844),l=n(2148),i=URLSearchParams.prototype,r=a(i.forEach);o&&!("size"in i)&&l(i,"size",{get:function(){var e=0;return r(this,(function(){e++})),e},configurable:!0,enumerable:!0})}}]);
//# sourceMappingURL=6242.e72527fb.js.map