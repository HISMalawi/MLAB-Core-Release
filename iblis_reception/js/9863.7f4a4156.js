"use strict";(globalThis["webpackChunkIBLISReception"]=globalThis["webpackChunkIBLISReception"]||[]).push([[9863],{7045:(e,t,n)=>{var o=n(6339),l=n(3070);e.exports=function(e,t,n){return n.get&&o(n.get,t,{getter:!0}),n.set&&o(n.set,t,{setter:!0}),l.f(e,t,n)}},8053:e=>{var t=TypeError;e.exports=function(e,n){if(e<n)throw t("Not enough arguments");return e}},6229:(e,t,n)=>{var o=n(8052),l=n(1702),a=n(1340),i=n(8053),r=URLSearchParams,u=r.prototype,s=l(u.append),d=l(u["delete"]),c=l(u.forEach),p=l([].push),m=new r("a=1&a=2&b=3");m["delete"]("a",1),m["delete"]("b",void 0),m+""!=="a=2"&&o(u,"delete",(function(e){var t=arguments.length,n=t<2?void 0:arguments[1];if(t&&void 0===n)return d(this,e);var o=[];c(this,(function(e,t){p(o,{key:t,value:e})})),i(t,1);var l,r=a(e),u=a(n),m=0,v=0,f=!1,_=o.length;while(m<_)l=o[m++],f||l.key===r?(f=!0,d(this,l.key)):v++;while(v<_)l=o[v++],l.key===r&&l.value===u||s(this,l.key,l.value)}),{enumerable:!0,unsafe:!0})},7330:(e,t,n)=>{var o=n(8052),l=n(1702),a=n(1340),i=n(8053),r=URLSearchParams,u=r.prototype,s=l(u.getAll),d=l(u.has),c=new r("a=1");!c.has("a",2)&&c.has("a",void 0)||o(u,"has",(function(e){var t=arguments.length,n=t<2?void 0:arguments[1];if(t&&void 0===n)return d(this,e);var o=s(this,e);i(t,1);var l=a(n),r=0;while(r<o.length)if(o[r++]===l)return!0;return!1}),{enumerable:!0,unsafe:!0})},2062:(e,t,n)=>{var o=n(9781),l=n(1702),a=n(7045),i=URLSearchParams.prototype,r=l(i.forEach);o&&!("size"in i)&&a(i,"size",{get:function(){var e=0;return r(this,(function(){e++})),e},configurable:!0,enumerable:!0})},9834:(e,t,n)=>{n.d(t,{Z:()=>a});n(6229),n(7330),n(2062);var o=n(4542),l=n(6188);class a{async writeLbl(e,t,n=`${Date.now()}.lbl`){const a=(0,o.KU)();try{const o=await a.getText(e,t),i=new Blob([null===o||void 0===o?void 0:o.data],{type:"text/plain"});e=URL.createObjectURL(i);const r=document.createElement("a");r.setAttribute("href",e),r.setAttribute("download",n),r.click(),URL.revokeObjectURL(e),(0,l.x9)("Accession number printed!")}catch(i){console.error(i)}}}},8688:(e,t,n)=>{n.d(t,{C:()=>o});n(5827);function o(e,t){const n=Object.values(Object.values(e)),o=n.filter((e=>!!e[t])).reduce(((e,n)=>(Array.isArray(n[t])?e[t]=n[t]:e[t]={...e[t],...n[t]},e)),{});return o}},2203:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});n(7658);var o=n(6252),l=n(9013),a=n(516),i=n(9652),r=n(4542),u=n(8688),s=n(2201),d=n(6188),c=n(9834),p=n(2262),m=n(3577);function v(e,t,n,l,a,i){const r=(0,o.up)("ion-title"),u=(0,o.up)("IonIcon"),s=(0,o.up)("ion-button"),d=(0,o.up)("ion-buttons"),c=(0,o.up)("ion-toolbar"),p=(0,o.up)("ion-header"),v=(0,o.up)("ion-label"),f=(0,o.up)("ion-item"),_=(0,o.up)("ion-list"),w=(0,o.up)("ion-content"),y=(0,o.up)("ion-footer"),h=(0,o.up)("ion-modal"),g=(0,o.up)("ion-page");return(0,o.wg)(),(0,o.j4)(g,null,{default:(0,o.w5)((()=>[(0,o.Wm)(w,{class:"ion-padding"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{"is-open":e.open},{default:(0,o.w5)((()=>[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Wm)(r,{style:{"font-size":"20px","font-weight":"600"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Patient order")])),_:1}),(0,o.Wm)(d,{slot:"end"},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{strong:!0,onClick:t[0]||(t[0]=t=>e.handleDialog())},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{size:"large",icon:e.close},null,8,["icon"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Wm)(_,null,{default:(0,o.w5)((()=>[(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Tracking Number")])),_:1}),(0,o.Wm)(v,{slot:"end"},{default:(0,o.w5)((()=>{var t;return[(0,o.Uk)((0,m.zw)(null===(t=e.order)||void 0===t?void 0:t.tracking_number),1)]})),_:1})])),_:1}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Accession Number")])),_:1}),(0,o.Wm)(v,{slot:"end"},{default:(0,o.w5)((()=>{var t;return[(0,o.Uk)((0,m.zw)(null===(t=e.order)||void 0===t?void 0:t.accession_number),1)]})),_:1})])),_:1}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Patient Name")])),_:1}),(0,o.Wm)(v,{slot:"end"},{default:(0,o.w5)((()=>{var t,n,l,a;return[(0,o.Uk)((0,m.zw)(`${null===(t=e.order)||void 0===t?void 0:t.client.first_name} ${null!=(null===(n=e.order)||void 0===n?void 0:n.client.middle_name)?null===(l=e.order)||void 0===l?void 0:l.client.middle_name:""} ${null===(a=e.order)||void 0===a?void 0:a.client.last_name}`),1)]})),_:1})])),_:1}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Specimen Type")])),_:1}),(0,o.Wm)(v,{slot:"end"},{default:(0,o.w5)((()=>{var t;return[(0,o.Uk)((0,m.zw)(null===(t=e.order)||void 0===t?void 0:t.specimen),1)]})),_:1})])),_:1}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Test(s) Ordered")])),_:1}),(0,o.Wm)(v,{slot:"end"},{default:(0,o.w5)((()=>{var t;return[(0,o.Uk)((0,m.zw)(e.extractedTests(null===(t=e.order)||void 0===t?void 0:t.test_types)),1)]})),_:1})])),_:1}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,o.w5)((()=>[(0,o.Uk)("Specimen Status")])),_:1}),(0,o.Wm)(v,{slot:"end"},{default:(0,o.w5)((()=>{var t,n;return[(0,o.Uk)((0,m.zw)("specimen-not-collected"==(null===(t=e.order)||void 0===t?void 0:t.order_status)?"Specimen not collected":null===(n=e.order)||void 0===n?void 0:n.order_status),1)]})),_:1})])),_:1})])),_:1})])),_:1}),(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c,{color:"light",style:{padding:"5px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(s,{onClick:t[1]||(t[1]=t=>e.changeSpecimenStatus("accepted")),slot:"end",size:"large",color:"success"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Accept ")])),_:1}),(0,o.Wm)(s,{onClick:t[2]||(t[2]=t=>e.changeSpecimenStatus("rejected")),slot:"end",size:"large",color:"danger"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Reject ")])),_:1}),(0,o.Wm)(s,{slot:"end",size:"large",color:"primary"},{default:(0,o.w5)((()=>[(0,o.Uk)(" Add Test ")])),_:1})])),_:1})])),_:1})])),_:1},8,["is-open"])])),_:1})])),_:1})}var f=n(3231),_=n(1869),w=n(8903);const y=(0,o.aZ)({components:{IonPage:_._i,IonButtons:_.Sm,IonButton:_.YG,IonIcon:_.gu,IonModal:_.ki,IonHeader:_.Gu,IonContent:_.W2,IonToolbar:_.sr,IonTitle:_.wd,IonFooter:_.fr,IonItem:_.Ie,IonLabel:_.Q$,IonList:_.q_},data(){return{open:!0,close:w.xvD}},props:{order:{required:!0,type:Object},show:{required:!0,default:!1,type:Boolean}},methods:{extractedTests(e){return e.map((e=>e.name)).join(", ")},handleDialog(){this.open=!1},async changeSpecimenStatus(e){const t=(0,r.KU)(),n=await t.putJson(`order_statuses/${e}`,{order_id:this.order.id});null!==n&&void 0!==n&&n.ok&&((0,d.x9)(`Specimen ${e} successfully!`),this.open=!1,f.Z.push(`/test/details?test_id=${this.order.id}`))}}});var h=n(3744);const g=(0,h.Z)(y,[["render",v]]),T=g;var b=n(9963);function k(e,t){console.log("PatientDialog"),console.log(t);const n=document.getElementById("rootContainer"),o=(0,b.ri)(T,{show:e,order:t});o.mount(n,!1)}const W=(0,o._)("div",{id:"rootContainer"},null,-1),S=(0,o.aZ)({__name:"NewOrder",setup(e){const t=(0,p.iH)(),n=(0,p.iH)(!1),m=()=>{n.value=!0,k(n.value,t.value)},v=(0,s.yj)(),_=(0,r.KU)(),w=()=>{const e=[];return{id:"visit_type",helpText:"Visit type",type:i.f.TT_SELECT,validation:e=>l.Z.required(e),computedValue:e=>({encounter:{encounter_type:e.value}}),init:async()=>{var t;const n=await _.getJson("encounter_types");return!(null===n||void 0===n||!n.ok)&&(null===(t=n.data)||void 0===t||t.data.forEach((t=>{e.push({label:t.name,value:t.id})})),!0)},options:()=>e}},y=()=>({id:"clinician",helpText:"Requesting Clinician",type:i.f.TT_TEXT,computedValue:e=>({order:{requested_by:e.value}}),validation:e=>l.Z.required(e)}),h=()=>({id:"collector",helpText:"Sample collected by (Optional)",type:i.f.TT_TEXT,computedValue:e=>({order:{collected_by:(null===e||void 0===e?void 0:e.value)||""}})}),g=()=>{let e=null;return{id:"ward",helpText:"Requesting ward/location",type:i.f.TT_SELECT,init:async()=>{const t=await _.getJson("global");return t.ok&&(e=t.data.id),!0},computedValue:t=>({encounter:{facility_section:t.value,sending_facility:e||-1}}),validation:e=>l.Z.required(e),options:async e=>{const t=await _.getJson("encounter_type_facility_section_mappings/facility_sections",{encounter_type_id:e.visit_type.value});return(t.data||[]).map((e=>({label:e.name,value:e.id})))}}},T=()=>({id:"date",helpText:"Date",type:i.f.TT_DATE_PICKER,validation:e=>l.Z.required(e)}),b=()=>{let e=[];return{id:"specimen_type",helpText:"Specimen type",type:i.f.TT_SELECT,init:async()=>{const t=await _.getJson("specimen");return!(null===t||void 0===t||!t.ok)&&(e=t.data.map((e=>({label:e.name,value:e.id}))),!0)},options:()=>e,validation:e=>l.Z.required(e)}},S=()=>{let e=[];return{id:"priority",helpText:"Specify priority",type:i.f.TT_SELECT,computedValue:e=>({order:{priority:e.value}}),validation:e=>l.Z.required(e),init:async()=>{const t=await _.getJson("priorities");return!(null===t||void 0===t||!t.ok)&&(e=t.data.map((e=>({label:e.name,value:e.id}))),!0)},options:()=>e}},x=()=>{let e=[],t=null;return{id:"test_types",helpText:"Select test types",type:i.f.TT_MULTIPLE_SELECT,config:{showKeyboard:!0},computedValue:(e,t)=>({tests:e.map((e=>({specimen:t.specimen_type.value,test_type:e.value})))}),options:async n=>{if(n.specimen_type.value!=t){e=[],t=n.specimen_type.value;const o=await _.getJson("specimen/test_types",{specimen_id:t});if(null===o||void 0===o||!o.ok)return[];e=o.data.map((e=>({label:e,value:e})))}return e},validation:e=>l.Z.required(e)}},I=()=>({id:"time_sample_collected",helpText:"Time Sample Collected",type:i.f.TT_TIME,computedValue:(e,t)=>({order:{sample_collected_time:`${t.date} ${e.value}`}}),validation:e=>l.Z.required(e)}),U=[w(),g(),y(),h(),b(),x(),T(),I(),S()],E=async(e,o)=>{const l=new c.Z,a={client:{id:parseInt(`${v.params.client_id}`)},...(0,u.C)(o,"encounter"),...(0,u.C)(o,"order"),...(0,u.C)(o,"tests")};_.postJson("orders",a).then((e=>{t.value=e.data;const o=e.data.accession_number;if(!e.ok)return(0,d.L6)(e.error);l.writeLbl("printout/accession_number",{accession_number:o},`${o}.lbl`),n.value=!0;try{f.Z.push("/tests")}catch(a){console.log(a)}(0,d.x9)("Order as been created!"),m()})).catch((()=>(0,d.N$)(r.XF.GENERAL_ERROR)))};return(e,t)=>((0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(a.Z,{fields:U,onFinish:E,skipSummary:!0,cancelDestinationPath:"/home"}),W]))}}),x=S,I=x}}]);
//# sourceMappingURL=9863.7f4a4156.js.map