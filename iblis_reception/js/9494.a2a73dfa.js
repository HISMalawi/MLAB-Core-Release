"use strict";(globalThis["webpackChunkIBLISReception"]=globalThis["webpackChunkIBLISReception"]||[]).push([[9494],{7045:(e,t,n)=>{var a=n(6339),o=n(3070);e.exports=function(e,t,n){return n.get&&a(n.get,t,{getter:!0}),n.set&&a(n.set,t,{setter:!0}),o.f(e,t,n)}},8053:e=>{var t=TypeError;e.exports=function(e,n){if(e<n)throw t("Not enough arguments");return e}},6229:(e,t,n)=>{var a=n(8052),o=n(1702),l=n(1340),i=n(8053),r=URLSearchParams,u=r.prototype,s=o(u.append),d=o(u["delete"]),c=o(u.forEach),p=o([].push),m=new r("a=1&a=2&b=3");m["delete"]("a",1),m["delete"]("b",void 0),m+""!=="a=2"&&a(u,"delete",(function(e){var t=arguments.length,n=t<2?void 0:arguments[1];if(t&&void 0===n)return d(this,e);var a=[];c(this,(function(e,t){p(a,{key:t,value:e})})),i(t,1);var o,r=l(e),u=l(n),m=0,f=0,v=!1,_=a.length;while(m<_)o=a[m++],v||o.key===r?(v=!0,d(this,o.key)):f++;while(f<_)o=a[f++],o.key===r&&o.value===u||s(this,o.key,o.value)}),{enumerable:!0,unsafe:!0})},7330:(e,t,n)=>{var a=n(8052),o=n(1702),l=n(1340),i=n(8053),r=URLSearchParams,u=r.prototype,s=o(u.getAll),d=o(u.has),c=new r("a=1");!c.has("a",2)&&c.has("a",void 0)||a(u,"has",(function(e){var t=arguments.length,n=t<2?void 0:arguments[1];if(t&&void 0===n)return d(this,e);var a=s(this,e);i(t,1);var o=l(n),r=0;while(r<a.length)if(a[r++]===o)return!0;return!1}),{enumerable:!0,unsafe:!0})},2062:(e,t,n)=>{var a=n(9781),o=n(1702),l=n(7045),i=URLSearchParams.prototype,r=o(i.forEach);a&&!("size"in i)&&l(i,"size",{get:function(){var e=0;return r(this,(function(){e++})),e},configurable:!0,enumerable:!0})},9834:(e,t,n)=>{n.d(t,{Z:()=>l});n(6229),n(7330),n(2062);var a=n(4542),o=n(6188);class l{async writeLbl(e,t,n=`${Date.now()}.lbl`){const l=(0,a.KU)();try{const a=await l.getText(e,t),i=new Blob([null===a||void 0===a?void 0:a.data],{type:"text/plain"});e=URL.createObjectURL(i);const r=document.createElement("a");r.setAttribute("href",e),r.setAttribute("download",n),r.click(),URL.revokeObjectURL(e),(0,o.x9)("Accession number printed!")}catch(i){console.error(i)}}}},8688:(e,t,n)=>{n.d(t,{C:()=>a});n(5827);function a(e,t){const n=Object.values(Object.values(e)),a=n.filter((e=>!!e[t])).reduce(((e,n)=>(Array.isArray(n[t])?e[t]=n[t]:e[t]={...e[t],...n[t]},e)),{});return a}},447:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});n(7658);var a=n(6252),o=n(9013),l=n(516),i=n(9652),r=n(4542),u=n(8688),s=n(2201),d=n(6188),c=n(9834),p=n(2262),m=n(3577);function f(e,t,n,o,l,i){const r=(0,a.up)("ion-title"),u=(0,a.up)("IonIcon"),s=(0,a.up)("ion-button"),d=(0,a.up)("ion-buttons"),c=(0,a.up)("ion-toolbar"),p=(0,a.up)("ion-header"),f=(0,a.up)("ion-label"),v=(0,a.up)("ion-item"),_=(0,a.up)("ion-list"),w=(0,a.up)("ion-content"),h=(0,a.up)("ion-footer"),y=(0,a.up)("ion-modal"),g=(0,a.up)("ion-page");return(0,a.wg)(),(0,a.j4)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"ion-padding"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{"is-open":e.open},{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r,{style:{"font-size":"20px","font-weight":"600"}},{default:(0,a.w5)((()=>[(0,a.Uk)("Patient order")])),_:1}),(0,a.Wm)(d,{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{strong:!0,onClick:t[0]||(t[0]=t=>e.handleDialog())},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{size:"large",icon:e.close},null,8,["icon"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,a.w5)((()=>[(0,a.Uk)("Tracking Number")])),_:1}),(0,a.Wm)(f,{slot:"end"},{default:(0,a.w5)((()=>{var t;return[(0,a.Uk)((0,m.zw)(null===(t=e.order)||void 0===t?void 0:t.tracking_number),1)]})),_:1})])),_:1}),(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,a.w5)((()=>[(0,a.Uk)("Accession Number")])),_:1}),(0,a.Wm)(f,{slot:"end"},{default:(0,a.w5)((()=>{var t;return[(0,a.Uk)((0,m.zw)(null===(t=e.order)||void 0===t?void 0:t.accession_number),1)]})),_:1})])),_:1}),(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,a.w5)((()=>[(0,a.Uk)("Patient Name")])),_:1}),(0,a.Wm)(f,{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,m.zw)(`${e.details.first_name} ${null!=e.details.middle_name?e.details.middle_name:""} ${e.details.last_name}`),1)])),_:1})])),_:1}),(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,a.w5)((()=>[(0,a.Uk)("Specimen Type")])),_:1}),(0,a.Wm)(f,{slot:"end"},{default:(0,a.w5)((()=>{var t;return[(0,a.Uk)((0,m.zw)(null===(t=e.order)||void 0===t?void 0:t.specimen),1)]})),_:1})])),_:1}),(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,a.w5)((()=>[(0,a.Uk)("Test(s) Ordered")])),_:1}),(0,a.Wm)(f,{slot:"end"},{default:(0,a.w5)((()=>{var t;return[(0,a.Uk)((0,m.zw)(e.extractedTests(null===(t=e.order)||void 0===t?void 0:t.test_types)),1)]})),_:1})])),_:1}),(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,{style:{"font-size":"18px","font-weight":"600"}},{default:(0,a.w5)((()=>[(0,a.Uk)("Specimen Status")])),_:1}),(0,a.Wm)(f,{slot:"end"},{default:(0,a.w5)((()=>{var t,n;return[(0,a.Uk)((0,m.zw)("specimen-not-collected"==(null===(t=e.order)||void 0===t?void 0:t.order_status)?"Specimen not collected":null===(n=e.order)||void 0===n?void 0:n.order_status),1)]})),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{color:"light",style:{padding:"5px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{onClick:t[1]||(t[1]=t=>e.changeSpecimenStatus("accepted")),slot:"end",size:"large",color:"success"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Accept ")])),_:1}),(0,a.Wm)(s,{onClick:t[2]||(t[2]=t=>e.changeSpecimenStatus("rejected")),slot:"end",size:"large",color:"danger"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Reject ")])),_:1}),(0,a.Wm)(s,{slot:"end",size:"large",color:"primary"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Add Test ")])),_:1})])),_:1})])),_:1})])),_:1},8,["is-open"])])),_:1})])),_:1})}var v=n(3231),_=n(1869),w=n(8903);const h=(0,a.aZ)({components:{IonPage:_._i,IonButtons:_.Sm,IonButton:_.YG,IonIcon:_.gu,IonModal:_.ki,IonHeader:_.Gu,IonContent:_.W2,IonToolbar:_.sr,IonTitle:_.wd,IonFooter:_.fr,IonItem:_.Ie,IonLabel:_.Q$,IonList:_.q_},data(){return{open:!0,close:w.xvD}},props:{order:{required:!0,type:Object},show:{required:!0,default:!1,type:Boolean}},methods:{extractedTests(e){return e.map((e=>e.name)).join(", ")},handleDialog(){this.open=!1},async changeSpecimenStatus(e){const t=(0,r.KU)(),n=await t.putJson(`order_statuses/${e}`,{order_id:this.order.id});null!==n&&void 0!==n&&n.ok&&((0,d.x9)(`Specimen ${e} successfully!`),v.Z.push("/home"))}}});var y=n(3744);const g=(0,y.Z)(h,[["render",f]]),T=g;var b=n(9963);function k(e,t){console.log("PatientDialog"),console.log(t);const n=document.getElementById("rootContainer"),a=(0,b.ri)(T,{show:e,order:t});a.mount(n,!1)}const W=(0,a._)("div",{id:"rootContainer"},null,-1),S=(0,a.aZ)({__name:"NewOrder",setup(e){const t=(0,p.iH)(),n=(0,p.iH)(!1),m=()=>{n.value=!0,k(n.value,t.value)},f=(0,s.yj)(),_=(0,r.KU)(),w=()=>{const e=[];return{id:"visit_type",helpText:"Visit type",type:i.f.TT_SELECT,validation:e=>o.Z.required(e),computedValue:e=>({encounter:{encounter_type:e.value}}),init:async()=>{var t;const n=await _.getJson("encounter_types");return!(null===n||void 0===n||!n.ok)&&(null===(t=n.data)||void 0===t||t.data.forEach((t=>{e.push({label:t.name,value:t.id})})),!0)},options:()=>e}},h=()=>({id:"clinician",helpText:"Requesting Clinician",type:i.f.TT_TEXT,computedValue:e=>({order:{requested_by:e.value}}),validation:e=>o.Z.required(e)}),y=()=>({id:"collector",helpText:"Sample collected by (Optional)",type:i.f.TT_TEXT,computedValue:e=>({order:{collected_by:(null===e||void 0===e?void 0:e.value)||""}})}),g=()=>{const e=[];let t=null;return{id:"ward",helpText:"Requesting ward/location",type:i.f.TT_SELECT,init:async()=>{var n;const a=await _.getJson("global");a.ok&&(t=a.data.id);const o=await _.getJson("facility_sections");return!(null===o||void 0===o||!o.ok)&&(null===(n=o.data)||void 0===n||n.data.forEach((t=>{e.push({label:t.name,value:t.id})})),!0)},computedValue:e=>({encounter:{facility_section:e.value,sending_facility:t||-1}}),validation:e=>o.Z.required(e),options:()=>e}},T=()=>({id:"date",helpText:"Date",type:i.f.TT_DATE_PICKER,validation:e=>o.Z.required(e)}),b=()=>{let e=[];return{id:"specimen_type",helpText:"Specimen type",type:i.f.TT_SELECT,init:async()=>{const t=await _.getJson("specimen");return!(null===t||void 0===t||!t.ok)&&(e=t.data.map((e=>({label:e.name,value:e.id}))),!0)},options:()=>e,validation:e=>o.Z.required(e)}},S=()=>{let e=[];return{id:"priority",helpText:"Specify priority",type:i.f.TT_SELECT,computedValue:e=>({order:{priority:e.value}}),validation:e=>o.Z.required(e),init:async()=>{const t=await _.getJson("priorities");return!(null===t||void 0===t||!t.ok)&&(e=t.data.map((e=>({label:e.name,value:e.id}))),!0)},options:()=>e}},x=()=>{let e=[],t=null;return{id:"test_types",helpText:"Select test types",type:i.f.TT_MULTIPLE_SELECT,config:{showKeyboard:!0},computedValue:(e,t)=>({tests:e.map((e=>({specimen:t.specimen_type.value,test_type:e.value})))}),options:async n=>{if(n.specimen_type.value!=t){e=[],t=n.specimen_type.value;const a=await _.getJson("specimen/test_types",{specimen_id:t});if(null===a||void 0===a||!a.ok)return[];e=a.data.map((e=>({label:e,value:e})))}return e},validation:e=>o.Z.required(e)}},I=()=>({id:"time_sample_collected",helpText:"Time Sample Collected",type:i.f.TT_TIME,computedValue:(e,t)=>({order:{sample_collected_time:`${t.date} ${e.value}`}}),validation:e=>o.Z.required(e)}),U=[w(),g(),h(),y(),b(),x(),T(),I(),S()],E=async(e,a)=>{const o=new c.Z,l={client:{id:parseInt(`${f.params.client_id}`)},...(0,u.C)(a,"encounter"),...(0,u.C)(a,"order"),...(0,u.C)(a,"tests")};_.postJson("orders",l).then((e=>{t.value=e.data;const a=e.data.accession_number;if(!e.ok)return(0,d.L6)(e.error);o.writeLbl("printout/accession_number",{accession_number:a},`${a}.lbl`),n.value=!0,v.Z.push(`/patient-details/${e.data.client_id}`),(0,d.x9)("Order as been created!"),m()})).catch((()=>(0,d.N$)(r.XF.GENERAL_ERROR)))};return(e,t)=>((0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(l.Z,{fields:U,onFinish:E,skipSummary:!0,cancelDestinationPath:"/home"}),W]))}}),x=S,I=x}}]);
//# sourceMappingURL=9494.a2a73dfa.js.map