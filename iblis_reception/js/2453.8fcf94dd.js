"use strict";(globalThis["webpackChunkIBLISReception"]=globalThis["webpackChunkIBLISReception"]||[]).push([[2453],{3553:(e,a,t)=>{t.d(a,{Ab:()=>o,C_:()=>i,b9:()=>p,hd:()=>d,tr:()=>c,xL:()=>u});var n=t(3283);const l=[n.t$,[["","Delete"]]],i=[n.RH,[["Delete"]]],u=(n.RH,[n.RH,[["N/A"],["Delete","Unknown"]]]),o=[n.RH,[["Delete"]]],r=[n.RH,[["Unknown","Delete"],["Qwerty","A-Z"]]],d=[n.RK,[["Unknown"]]],s=[n.Xh,[["0-9","Delete"],["Qwerty","Unknown"],["","Space"]]],p=[n.dX,[["","Delete"],["?123","0-9"],["Space","Unknown"]]],c=[{btn:"0-9",keyboard:r},{btn:"?123",keyboard:l},{btn:"A-Z",keyboard:s},{btn:"Qwerty",keyboard:p}]},3468:(e,a,t)=>{t.d(a,{bJ:()=>i,e5:()=>D});t(7658),t(6699),t(5827),t(4916);var n=t(9652);const l=[{label:"Jan",value:1},{label:"Feb",value:2},{label:"Mar",value:3},{label:"Apr",value:4},{label:"May",value:5},{label:"Jun",value:6},{label:"Jul",value:7},{label:"Aug",value:8},{label:"Sep",value:9},{label:"Oct",value:10},{label:"Nov",value:11},{label:"Dec",value:12}];var i,u=t(905),o=t(9013),r=t(3283),d=t(3553),s=t(7484),p=t.n(s),c=t(60);function m(e,a,t=!0){const l=[];return t&&l.push("UNKNOWN"),{id:e,helpText:`${a} Year`,appearInSummary:()=>!1,type:n.f.TT_TEXT,config:{customKeyboard:[r.RH,[l,["DELETE"]]]}}}function f(e,a){return{id:e,helpText:`${a} Month`,appearInSummary:()=>!1,type:n.f.TT_SELECT,options:()=>l}}function v(e,a){return{id:e,helpText:`${a} Day`,type:n.f.TT_MONTHLY_DAYS,appearInSummary:()=>!1}}function y(e,a){return{id:e,helpText:`${a} Estimated period`,type:n.f.TT_SELECT,appearInSummary:()=>!1,options:()=>[{label:"6 months ago",value:180},{label:"12 months ago",value:365},{label:"18 months ago",value:540},{label:"24 months ago",value:730},{label:"Over 2 years ago",value:730}]}}function T(e,a){return{id:e,helpText:`${a} Age Estimate`,type:n.f.TT_NUMBER,appearInSummary:()=>!1,config:{keypad:d.Ab}}}function h(e){return parseInt(e)<10?`0${e}`:e}async function b(e,a,t){if(a.defaultValue){const n=await a.defaultValue(e);if(n){const[e,a,l]=n.split("-");switch(t){case"Year":return e||"";case"Month":return parseInt(a)||"";case"Day":return parseInt(l)||""}}}return""}function _(e){return u.Z.toStandardHisDisplayFormat(e)}function x(e,a,t,n){if(a.minDate){const l=a.minDate(t,n);if(new Date(e)<new Date(l))return[`${_(e)} is less than minimum date of ${_(l)}`]}if(a.maxDate){const l=a.maxDate(t,n);if(l&&new Date(e)>new Date(l))return[`${_(e)} is greater than max date of  ${_(l)}`]}}function D(e,a=""){let t="",n="",r="",d="",s=!1;const D=`year_${e.id}`,$=`month_${e.id}`,w=`day_${e.id}`,E=`age_estimate_${e.id}`,k=`duration_estimate_${e.id}`,g=m(D,e.helpText,e.estimation.allowUnknown),V=f($,e.helpText),I=v(w,e.helpText),N=T(E,e.helpText),S=y(k,e.helpText),M="boolean"===typeof e.estimation.allowUnknownMonthDay&&e.estimation.allowUnknownMonthDay,A=a=>!(a[D]&&a[D].value&&["Unknown"].includes(a[D].value))&&(!e.condition||e.condition(a)),U=(e,a)=>{const t=[{type:"year",value:n,default:"YYYY"},{type:"month",value:r,default:"MM"},{type:"day",value:d,default:"DD"}];return t.reduce(((t,n)=>{const l=[null,void 0,"Unknown",""];return a===n.type?l.includes(e)?t.push(n.default):t.push(e):l.includes(n.value)?t.push(n.default):t.push(n.value),t}),[]).join("-")};"function"===typeof e.init&&(g.init=e.init),g.updateHelpTextOnValue=e=>`${g.helpText} (${U(null===e||void 0===e?void 0:e.label,"year")})`,g.proxyID=e.id,g.unload=e=>n=e.value.toString(),g.config={...g.config,...e.config},g.defaultValue=a=>b(a,e,"Year"),g.condition=a=>!e.condition||e.condition(a),g.validation=(a,t,n)=>{if(e.required&&o.Z.required(a))return["Year cannot be empty"];const l=a?a.value:"";if(!e.estimation.allowUnknown&&l.toString().match(/unknown/i))return["Value unknown is not permitted"];if(l&&!["Unknown"].includes(l)&&isNaN(l)||Number(l)<1900)return["Invalid Year"];if(l&&"function"===typeof e.minDate){const a=u.Z.getYear(e.minDate(t,n));if(parseInt(l)<a)return[`Year of ${l} is less than Minimum year of ${a}`]}if(l&&"function"===typeof e.maxDate){const a=e.maxDate(t,n);if(a&&Number(l)>u.Z.getYear(a))return[`Year of ${l} exceeds Maximum year of ${u.Z.getYear(a)}`]}return null},g.summaryMapValue=()=>({label:e.summaryLabel||e.helpText,value:t?_(t):"Unknown"}),g.appearInSummary=(a,t)=>t===e.id,g.computedValue=a=>{if(t){const[n,l,i]=t.split("-");return t=`${a.value}-${l}-${i}`,e.computeValue(t,!1)}if(a&&"Unknown"===a.value)return t="",e.computeValue("Unknown",!1)},V.updateHelpTextOnValue=e=>`${V.helpText} (${U(null===e||void 0===e?void 0:e.label,"month")})`,V.proxyID=e.id,V.unload=e=>r=h(e.value.toString()),V.condition=e=>A(e),V.validation=e=>o.Z.required(e),V.defaultValue=a=>b(a,e,"Month"),M&&(V.options=()=>[...l,{label:"Unknown",value:"Unknown"}]),V.computedValue=(a,n)=>{if(`${a.value}`.match(/unknown/i))return t=`${n[D].value}-07-15`,e.computeValue(t,!0);if(t){const[n,l,i]=t.split("-"),u=h(`${a.value}`);return t=`${n}-${u}-${i}`,e.computeValue(t,!1)}},I.proxyID=e.id,I.updateHelpTextOnValue=e=>`${I.helpText} (${U(null===e||void 0===e?void 0:e.label,"day")})`,I.condition=e=>!`${e[$].value}`.match(/unknown/i)&&A(e),I.validation=(a,l,i)=>o.Z.required(a)?["Day is required for date"]:(s=!!`${a.value}`.match(/unknown/i),d=s?"15":h(`${a.value}`),t=`${n}-${r}-${d}`,x(t,e,l,i)),I.defaultValue=a=>b(a,e,"Day"),I.computedValue=()=>e.computeValue(t,s),I.unload=(a,t,n,l)=>{e.unload&&e.unload(a,t,n,l)},I.beforeNext=(a,n)=>!e.beforeNext||e.beforeNext(t,n),I.config={year:e=>e[D].value,month:e=>e[$].value},M||(I.config.keyboardActions=[]);const F=(a,t)=>{const n=["Unknown"===a[D].value,!e.condition||e.condition(a),e.estimation.estimationFieldType===t];return n.every(Boolean)};return N.proxyID=e.id,N.validation=(a,n,l)=>{if(!a)return["Age estimate is required"];const i=/^(12[0-7]|1[01][0-9]|[1-9]?[0-9])$/;if(!`${null===a||void 0===a?void 0:a.value}`.match(i))return["Not a valid age estimate"];const u=parseInt(`${(null===a||void 0===a?void 0:a.value)||-1}`);if(u<0)return["Please enter a valid number"];if(u>300)return["Age estimate is too high and exceeding hard limit of 300"];const o=p()(c.t6.getSessionDate()).subtract(u,"years").year();return t=`${o}-07-15`,x(t,e,n,l)},N.condition=e=>F(e,i.AGE_ESTIMATE_FIELD),N.computedValue=()=>e.computeValue(t,!0),N.beforeNext=(a,n)=>!e.beforeNext||e.beforeNext(t,n),S.proxyID=e.id,S.validation=(a,n,l)=>o.Z.required(a)?["Please select an estimate"]:(t=p()(c.t6.getSessionDate()).subtract(a.value,"day").format(u.i),x(t,e,n,l)),S.condition=e=>F(e,i.MONTH_ESTIMATE_FIELD),S.computedValue=()=>e.computeValue(t,!0),S.beforeNext=(a,n)=>!e.beforeNext||e.beforeNext(t,n),[g,V,I,N,S]}(function(e){e["AGE_ESTIMATE_FIELD"]="age-estimate-field",e["MONTH_ESTIMATE_FIELD"]="month-period-estimate-field"})(i||(i={}))},8688:(e,a,t)=>{t.d(a,{C:()=>n});t(5827);function n(e,a){const t=Object.values(Object.values(e)),n=t.filter((e=>!!e[a])).reduce(((e,t)=>(Array.isArray(t[a])?e[a]=t[a]:e[a]={...e[a],...t[a]},e)),{});return n}},3760:(e,a,t)=>{t.r(a),t.d(a,{default:()=>T});var n=t(6252),l=t(9013),i=t(682),u=t(9652),o=t(4542),r=t(6188),d=t(2262),s=t(3231),p=t(905),c=t(3468),m=t(8688),f=t(2201);const v=(0,n.aZ)({__name:"EditClient",setup(e){const a=(0,o.KU)(),t=(0,f.yj)(),v=(0,d.iH)(""),y=(0,d.iH)({}),T=(0,d.iH)([]),h=()=>({id:"first_name",helpText:"First name",type:u.f.TT_TEXT,defaultValue:()=>y.value.first_name,computedValue:e=>({person:{first_name:e.value}}),validation:e=>l.Z.isName(e)}),b=()=>({id:"last_name",helpText:"Last name",defaultValue:()=>y.value.last_name,type:u.f.TT_TEXT,computedValue:e=>({person:{last_name:e.value}}),validation:e=>l.Z.isName(e)}),_=()=>({id:"middle_name",helpText:"Middle name(Optional)",defaultValue:()=>y.value.middle_name,type:u.f.TT_TEXT,computedValue:e=>{if(e)return{person:{middle_name:e.value}}}}),x=()=>({id:"sex",helpText:"Gender",defaultValue:()=>"F"==y.value.sex?"Female":"Male",type:u.f.TT_SELECT,computedValue:e=>({person:{sex:e.value}}),validation:e=>l.Z.required(e),options:()=>[{label:"Female",value:"F"},{label:"Male",value:"M"}]}),D=()=>{const e={id:"date_of_birth",summaryLabel:"Date of Birth",helpText:"Birth",defaultValue:()=>y.value.date_of_birth,required:!0,minDate:()=>p.Z.estimateDateFromAge(100),maxDate:()=>p.Z.sessionDate(),estimation:{allowUnknown:!0,allowUnknownMonthDay:!0,estimationFieldType:c.bJ.AGE_ESTIMATE_FIELD},computeValue:(e,a)=>({person:{date_of_birth:e,birth_date_estimated:a}})};return(0,c.e5)(e)},$=()=>({id:"physical_address",helpText:"Physical address",defaultValue:()=>y.value.physical_address?y.value.physical_address:"Unknown",type:u.f.TT_TEXT,computedValue:e=>({client_identifiers:{physical_address:e.value}}),validation:e=>l.Z.required(e)}),w=()=>({id:"npid",helpText:"External Patient Number (Option)",defaultValue:()=>y.value.uuid,type:u.f.TT_TEXT,computedValue:e=>{if(e)return{client_identifiers:{npid:(null===e||void 0===e?void 0:e.value)||""}}}}),E=(e,n)=>{a.putJson(`clients/${t.params.client_id}`,{client:{id:t.params.client_id,uuid:y.value.uuid},...(0,m.C)(n,"person"),client_identifiers:[n]}).then((e=>{if(null!==e&&void 0!==e&&e.ok)return s.Z.back(),(0,r.x9)("Client updated successfully!");(0,r.L6)((null===e||void 0===e?void 0:e.error)||"An error occurred, please try again")})).catch((()=>(0,r.N$)(o.XF.GENERAL_ERROR)))},k=async()=>{const e=await a.getJson(`clients/${t.params.client_id}`);y.value=null===e||void 0===e?void 0:e.data,null!==e&&void 0!==e&&e.data&&(T.value=[h(),_(),b(),x(),...D(),$(),w()])};return(0,n.bv)((async()=>{await k()})),(e,a)=>((0,n.wg)(),(0,n.j4)(i.Z,{fields:T.value,onFinish:E,skipSummary:!0,onOnIndex:a[0]||(a[0]=e=>v.value=""),activeField:v.value},null,8,["fields","activeField"]))}}),y=v,T=y}}]);
//# sourceMappingURL=2453.8fcf94dd.js.map