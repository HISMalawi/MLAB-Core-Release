"use strict";(globalThis["webpackChunkIBLISReception"]=globalThis["webpackChunkIBLISReception"]||[]).push([[1842],{31588:(e,t,a)=>{a.d(t,{J8:()=>c,Jj:()=>u,bB:()=>p,m8:()=>d,ti:()=>o,yg:()=>i});var n=a(52110);const l=[n.Am,[["","Delete"]]],i=[n.aD,[["Delete"]]],o=(n.aD,[n.aD,[["N/A"],["Delete","Unknown"]]]),u=[n.aD,[["Delete"]]],r=[n.aD,[["Unknown","Delete"],["Qwerty","A-Z"]]],d=[n.uY,[["Unknown"]]],s=[n.ZY,[["0-9","Delete"],["Qwerty","Unknown"],["","Space"]]],c=[n.lJ,[["","Delete"],["?123","0-9"],["Space","Unknown"]]],p=[{btn:"0-9",keyboard:r},{btn:"?123",keyboard:l},{btn:"A-Z",keyboard:s},{btn:"Qwerty",keyboard:c}]},15291:(e,t,a)=>{a.d(t,{I6:()=>i,LE:()=>k});a(16280),a(74423),a(44114),a(72712),a(27495),a(98992),a(23215),a(8872);var n=a(77270);const l=[{label:"Jan",value:1},{label:"Feb",value:2},{label:"Mar",value:3},{label:"Apr",value:4},{label:"May",value:5},{label:"Jun",value:6},{label:"Jul",value:7},{label:"Aug",value:8},{label:"Sep",value:9},{label:"Oct",value:10},{label:"Nov",value:11},{label:"Dec",value:12}];var i,o=a(71035),u=a(1590),r=a(52110),d=a(31588),s=a(74353),c=a.n(s),p=a(9450);function m(e,t,a=!0){const l=[];return a&&l.push("UNKNOWN"),{id:e,helpText:`${t} Year`,appearInSummary:()=>!1,type:n.P.TT_TEXT,config:{customKeyboard:[r.aD,[l,["DELETE"]]]}}}function v(e,t){return{id:e,helpText:`${t} Month`,appearInSummary:()=>!1,type:n.P.TT_SELECT,options:()=>l}}function f(e,t){return{id:e,helpText:`${t} Day`,type:n.P.TT_MONTHLY_DAYS,appearInSummary:()=>!1}}function T(e){const{value:t,timeUnit:a}=e;if(t<0)throw new Error("Estimate value must be positive");const n=p.kl.getSessionDate();let l=c()(n);switch(a.toLowerCase()){case"hours":l=l.subtract(t,"hour");break;case"days":l=l.subtract(t,"day");break;case"weeks":l=l.subtract(t,"week");break;case"months":l=l.subtract(t,"month");break;case"years":l=l.subtract(t,"year");break;default:throw new Error(`Invalid time unit: ${a}`)}const i=l.year(),u=l.month()+1,r=l.date(),d=x(i,u,r);return d!==r&&(l=l.date(d)),l.format(o.l)}function y(e,t){return{id:e,helpText:`${t} Estimated period`,type:n.P.TT_SELECT,appearInSummary:()=>!1,options:()=>[{label:"6 months ago",value:180},{label:"12 months ago",value:365},{label:"18 months ago",value:540},{label:"24 months ago",value:730},{label:"Over 2 years ago",value:730}]}}function h(e,t){return{id:e,helpText:`${t} Age Estimate`,type:n.P.TT_AGE_INPUT,appearInSummary:()=>!1,config:{keypad:d.Jj}}}function b(e){return parseInt(e)<10?`0${e}`:e}async function _(e,t,a){if(t.defaultValue){const n=await t.defaultValue(e);if(n){const[e,t,l]=n.split("-");switch(a){case"Year":return e||"";case"Month":return parseInt(t)||"";case"Day":return parseInt(l)||""}}}return""}function D(e){return o.A.toStandardHisDisplayFormat(e)}function E(e,t,a,n){if(t.minDate){const l=t.minDate(a,n);if(new Date(e)<new Date(l))return[`${D(e)} is less than minimum date of ${D(l)}`]}if(t.maxDate){const l=t.maxDate(a,n);if(l&&new Date(e)>new Date(l))return[`${D(e)} is greater than max date of  ${D(l)}`]}}function w(e){return e%4===0&&e%100!==0||e%400===0}function x(e,t,a){return 2===t&&29===a?w(e)?29:28:a}function k(e,t=""){let a="",n="",r="",d="",s=!1;const w=`year_${e.id}`,k=`month_${e.id}`,I=`day_${e.id}`,$=`age_estimate_${e.id}`,A=`duration_estimate_${e.id}`,V=m(w,e.helpText,e.estimation.allowUnknown),g=v(k,e.helpText),S=f(I,e.helpText),M=h($,e.helpText),N=y(A,e.helpText),U="boolean"===typeof e.estimation.allowUnknownMonthDay&&e.estimation.allowUnknownMonthDay,L=t=>!(t[w]&&t[w].value&&["Unknown"].includes(t[w].value))&&(!e.condition||e.condition(t)),F=(e,t)=>{const a=[{type:"year",value:n,default:"YYYY"},{type:"month",value:r,default:"MM"},{type:"day",value:d,default:"DD"}];return a.reduce(((a,n)=>{const l=[null,void 0,"Unknown",""];return t===n.type?l.includes(e)?a.push(n.default):a.push(e):l.includes(n.value)?a.push(n.default):a.push(n.value),a}),[]).join("-")};"function"===typeof e.init&&(V.init=e.init),V.updateHelpTextOnValue=e=>`${V.helpText} (${F(null===e||void 0===e?void 0:e.label,"year")})`,V.proxyID=e.id,V.unload=e=>n=e.value.toString(),V.config={...V.config,...e.config},V.defaultValue=t=>_(t,e,"Year"),V.condition=t=>!e.condition||e.condition(t),V.validation=(t,a,n)=>{if(e.required&&u.A.required(t))return["Year cannot be empty"];const l=t?t.value:"";if(!e.estimation.allowUnknown&&l.toString().match(/unknown/i))return["Value unknown is not permitted"];if(l&&!["Unknown"].includes(l)&&isNaN(l)||Number(l)<1900)return["Invalid Year"];if(l&&"function"===typeof e.minDate){const t=o.A.getYear(e.minDate(a,n));if(parseInt(l)<t)return[`Year of ${l} is less than Minimum year of ${t}`]}if(l&&"function"===typeof e.maxDate){const t=e.maxDate(a,n);if(t&&Number(l)>o.A.getYear(t))return[`Year of ${l} exceeds Maximum year of ${o.A.getYear(t)}`]}return null},V.summaryMapValue=()=>({label:e.summaryLabel||e.helpText,value:a?D(a):"Unknown"}),V.appearInSummary=(t,a)=>a===e.id,V.computedValue=t=>{if(a){const[n,l,i]=a.split("-");return a=`${t.value}-${l}-${i}`,e.computeValue(a,!1)}if(t&&"Unknown"===t.value)return a="",e.computeValue("Unknown",!1)},g.updateHelpTextOnValue=e=>`${g.helpText} (${F(null===e||void 0===e?void 0:e.label,"month")})`,g.proxyID=e.id,g.unload=e=>r=b(e.value.toString()),g.condition=e=>L(e),g.validation=e=>u.A.required(e),g.defaultValue=t=>_(t,e,"Month"),U&&(g.options=()=>[...l,{label:"Unknown",value:"Unknown"}]),g.computedValue=(t,n)=>{if(`${t.value}`.match(/unknown/i)){const t=n[w].value,l=c()().format("MM"),i=x(t,Number(l),Number(c()().format("DD")));return a=`${t}-${l}-${i}`,e.computeValue(a,!0)}if(a){const[n,l,i]=a.split("-"),o=b(`${t.value}`);return a=`${n}-${o}-${i}`,e.computeValue(a,!1)}},S.proxyID=e.id,S.updateHelpTextOnValue=e=>`${S.helpText} (${F(null===e||void 0===e?void 0:e.label,"day")})`,S.condition=e=>!`${e[k].value}`.match(/unknown/i)&&L(e),S.validation=(t,l,i)=>u.A.required(t)?["Day is required for date"]:(s=!!`${t.value}`.match(/unknown/i),d=s?"15":b(`${t.value}`),a=`${n}-${r}-${d}`,E(a,e,l,i)),S.defaultValue=t=>_(t,e,"Day"),S.computedValue=()=>e.computeValue(a,s),S.unload=(t,a,n,l)=>{e.unload&&e.unload(t,a,n,l)},S.beforeNext=(t,n)=>!e.beforeNext||e.beforeNext(a,n),S.config={year:e=>e[w].value,month:e=>e[k].value},U||(S.config.keyboardActions=[]);const O=(t,a)=>{const n=["Unknown"===t[w].value,!e.condition||e.condition(t),e.estimation.estimationFieldType===a];return n.every(Boolean)};M.proxyID=e.id;return M.validation=(t,n,l)=>{var i,o;if(!t)return["Age estimate is required"];const u=null===t||void 0===t||null===(i=t.other)||void 0===i?void 0:i.value,r=null===t||void 0===t||null===(o=t.other)||void 0===o||null===(o=o.timeUnit)||void 0===o?void 0:o.toLowerCase();if(!u||!r)return["Invalid age estimate format"];const d=/^(0|[1-9]\d*)$/;if(!u.match(d))return["Not a valid number"];try{const t=parseInt(u);return a=T({value:t,timeUnit:r}),E(a,e,n,l)}catch(s){return[s.message]}},M.condition=e=>O(e,i.AGE_ESTIMATE_FIELD),M.computedValue=()=>e.computeValue(a,!0),M.beforeNext=(t,n)=>!e.beforeNext||e.beforeNext(a,n),N.proxyID=e.id,N.validation=(t,n,l)=>u.A.required(t)?["Please select an estimate"]:(a=c()(p.kl.getSessionDate()).subtract(t.value,"day").format(o.l),E(a,e,n,l)),N.condition=e=>O(e,i.MONTH_ESTIMATE_FIELD),N.computedValue=()=>e.computeValue(a,!0),N.beforeNext=(t,n)=>!e.beforeNext||e.beforeNext(a,n),[V,g,S,M,N]}(function(e){e["AGE_ESTIMATE_FIELD"]="age-estimate-field",e["MONTH_ESTIMATE_FIELD"]="month-period-estimate-field",e["WEEKS_ESTIAMATE_FIELD"]="weeks-period-estimate-field",e["DAY_ESTIMATE_FIELD"]="day-period-estimate-field",e["HOURS_ESTIMATE_FIELD"]="hours-period-estimate-field"})(i||(i={}))},88049:(e,t,a)=>{a.d(t,{T:()=>n});a(72712),a(98992),a(54520),a(8872);function n(e,t){const a=Object.values(Object.values(e)),n=a.filter((e=>!!e[t])).reduce(((e,a)=>(Array.isArray(a[t])?e[t]=a[t]:e[t]={...e[t],...a[t]},e)),{});return n}},91842:(e,t,a)=>{a.r(t),a.d(t,{default:()=>y});a(81454);var n=a(20641),l=a(1590),i=a(25486),o=a(77270),u=a(741),r=a(85901),d=a(50953),s=a(46079),c=a(71035),p=a(15291),m=a(88049),v=a(75220);const f=(0,n.pM)({__name:"EditClient",setup(e){const t=(0,u.Kj)(),a=(0,v.lq)(),f=(0,d.KR)(""),T=(0,d.KR)({}),y=(0,d.KR)([]),h=()=>({id:"first_name",helpText:"First name",type:o.P.TT_TEXT,defaultValue:()=>T.value.first_name,computedValue:e=>({person:{first_name:e.value}}),validation:e=>l.A.isName(e)}),b=()=>({id:"last_name",helpText:"Last name",defaultValue:()=>T.value.last_name,type:o.P.TT_TEXT,computedValue:e=>({person:{last_name:e.value}}),validation:e=>l.A.isName(e)}),_=()=>({id:"middle_name",helpText:"Middle name(Optional)",defaultValue:()=>T.value.middle_name,type:o.P.TT_TEXT,computedValue:e=>{if(e)return{person:{middle_name:e.value}}}}),D=()=>({id:"sex",helpText:"Gender",defaultValue:()=>"F"==T.value.sex?"Female":"Male",type:o.P.TT_SELECT,computedValue:e=>({person:{sex:e.value}}),validation:e=>l.A.required(e),options:()=>[{label:"Female",value:"F"},{label:"Male",value:"M"}]}),E=()=>{const e={id:"date_of_birth",summaryLabel:"Date of Birth",helpText:"Birth",defaultValue:()=>T.value.date_of_birth,required:!0,minDate:()=>c.A.estimateDateFromAge(100),maxDate:()=>c.A.sessionDate(),estimation:{allowUnknown:!0,allowUnknownMonthDay:!0,estimationFieldType:p.I6.AGE_ESTIMATE_FIELD},computeValue:(e,t)=>({person:{date_of_birth:e,birth_date_estimated:t}})};return(0,p.LE)(e)},w=()=>({id:"physical_address",helpText:"Physical address",defaultValue:()=>T.value.physical_address?T.value.physical_address:"Unknown",type:o.P.TT_TEXT,computedValue:e=>({client_identifiers:{physical_address:e.value}}),validation:e=>l.A.required(e)}),x=()=>({id:"npid",helpText:"External Patient Number (Option)",defaultValue:()=>T.value.npid,type:o.P.TT_TEXT,computedValue:e=>({client_identifiers:{npid:(null===e||void 0===e?void 0:e.value)||""}})}),k=(e,n)=>{t.putJson(`clients/${a.params.client_id}`,{client:{id:a.params.client_id,uuid:T.value.uuid},...(0,m.T)(n,"person"),client_identifiers:Object.entries((0,m.T)(n,"client_identifiers").client_identifiers||{}).map((([e,t])=>({type:e,value:t})))}).then((e=>{if(null!==e&&void 0!==e&&e.ok)return s.A.back(),(0,r.tP)("Client updated successfully!");(0,r._O)((null===e||void 0===e?void 0:e.error)||"An error occurred, please try again")})).catch((()=>(0,r.L_)(u.MZ.GENERAL_ERROR)))},I=async()=>{const e=await t.getJson(`clients/${a.params.client_id}`);T.value=null===e||void 0===e?void 0:e.data,null!==e&&void 0!==e&&e.data&&(y.value=[h(),_(),b(),D(),...E(),w(),x()])};return(0,n.sV)((async()=>{await I()})),(e,t)=>((0,n.uX)(),(0,n.Wv)(i.A,{fields:y.value,onFinish:k,skipSummary:!0,onOnIndex:t[0]||(t[0]=e=>f.value=""),activeField:f.value},null,8,["fields","activeField"]))}}),T=f,y=T},81148:(e,t,a)=>{var n=a(46518),l=a(72652),i=a(79306),o=a(28551),u=a(1767);n({target:"Iterator",proto:!0,real:!0},{every:function(e){o(this),i(e);var t=u(this),a=0;return!l(t,(function(t,n){if(!e(t,a++))return n()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},23215:(e,t,a)=>{a(81148)}}]);
//# sourceMappingURL=1842.4ddbce3a.js.map