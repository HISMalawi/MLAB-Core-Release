"use strict";(globalThis["webpackChunkIBLISReception"]=globalThis["webpackChunkIBLISReception"]||[]).push([[4811],{32336:(e,t,n)=>{n.d(t,{i:()=>i});n(98992),n(72577),n(81454);var l=n(741),a=n(50953);const o=(0,a.KR)("full_name");let r=!1;function i(){const e=()=>{var e;if(r)return o.value;const t=(0,l.Kj)(),n=null===(e=t.token)||void 0===e||null===(e=e.value)||void 0===e||null===(e=e.authorization)||void 0===e?void 0:e.user;if(n&&n.preferences){const e=n.preferences.find((e=>"test_name_display"===e.name&&"site"===e.target));if(e)return o.value=e.value,r=!0,o.value}return o.value="full_name",r=!0,o.value},t=e=>{if(!e)return"";const t=e.split(" ");return t.length>1?t.map((e=>e.charAt(0))).join("").toUpperCase():e.substring(0,4).toUpperCase()},n=(t,n)=>{const l=e();return"full_name"===l?t:n||(t||t)};return{getPreference:e,generatePreferredName:t,getDisplayName:n,preference:o}}},24811:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Y});n(44114),n(98992),n(54520),n(81454);var l=n(20641),a=(n(27495),n(90033));const o={key:0},r={class:"his-sm-text"},i={class:"art-report-theme"},s={class:"stick-report-header"},u=["colspan","rowspan","onClick"],d={style:{"font-size":"19px"}},c=["onClick"],p={class:"his-sm-text"};function v(e,t,n,v,f,_){const m=(0,l.g2)("ion-title"),g=(0,l.g2)("ion-icon"),b=(0,l.g2)("ion-button"),y=(0,l.g2)("ion-label"),h=(0,l.g2)("ion-chip"),k=(0,l.g2)("ion-buttons"),C=(0,l.g2)("ion-toolbar"),F=(0,l.g2)("ion-header"),T=(0,l.g2)("ion-item"),w=(0,l.g2)("ion-content"),I=(0,l.g2)("ion-footer"),x=(0,l.g2)("ion-page");return(0,l.uX)(),(0,l.Wv)(x,null,{default:(0,l.k6)((()=>[t[6]||(t[6]=(0,l.Lk)("div",{id:"rootContainer"},null,-1)),(0,l.bF)(F,null,{default:(0,l.k6)((()=>[(0,l.bF)(C,null,{default:(0,l.k6)((()=>[(0,l.bF)(m,{class:"his-md-text"},{default:(0,l.k6)((()=>[(0,l.eW)((0,a.v_)(e.title)+" ",1),e.subtitle?((0,l.uX)(),(0,l.CE)("br",o)):(0,l.Q3)("",!0),(0,l.Lk)("span",r,(0,a.v_)(e.subtitle),1)])),_:1}),(0,l.bF)(k,{slot:"end"},{default:(0,l.k6)((()=>["function"===typeof e.onConfigure?((0,l.uX)(),(0,l.Wv)(b,{key:0,onClick:t[0]||(t[0]=()=>e.onConfigure&&e.onConfigure())},{default:(0,l.k6)((()=>[(0,l.bF)(g,{size:"large",icon:e.document},null,8,["icon"])])),_:1})):(0,l.Q3)("",!0),e.searchTerm?((0,l.uX)(),(0,l.Wv)(h,{key:1,onClick:e.clearSearch,class:"his-md-text",color:"warning"},{default:(0,l.k6)((()=>[(0,l.bF)(y,null,{default:(0,l.k6)((()=>[(0,l.eW)((0,a.v_)(e.searchTerm),1)])),_:1}),(0,l.bF)(g,{icon:e.close},null,8,["icon"])])),_:1},8,["onClick"])):(0,l.Q3)("",!0),(0,l.bF)(b,{onClick:e.searchTable,size:"large"},{default:(0,l.k6)((()=>[(0,l.bF)(g,{size:"large",icon:e.search},null,8,["icon"])])),_:1},8,["onClick"]),"function"===typeof e.onRefresh?((0,l.uX)(),(0,l.Wv)(b,{key:2,onClick:t[1]||(t[1]=()=>e.onRefresh&&e.onRefresh()),color:"success",size:"large"},{default:(0,l.k6)((()=>[(0,l.bF)(g,{size:"large",icon:e.sync},null,8,["icon"])])),_:1})):(0,l.Q3)("",!0)])),_:1})])),_:1})])),_:1}),(0,l.bF)(w,{"scroll-y":"","scroll-x":""},{default:(0,l.k6)((()=>[(0,l.Lk)("table",i,[(0,l.Lk)("thead",s,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.columns,((t,n)=>((0,l.uX)(),(0,l.CE)("tr",{key:n},[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(t,((t,n)=>{var o,r;return(0,l.uX)(),(0,l.CE)("th",{key:n,colspan:(null===t||void 0===t||null===(o=t.span)||void 0===o?void 0:o.thColspan)||1,rowspan:(null===t||void 0===t||null===(r=t.span)||void 0===r?void 0:r.thRowspan)||1,onClick:n=>e.sortColumn(t.ref)},[(0,l.bF)(T,{lines:"none"},{default:(0,l.k6)((()=>[e.columnSorted&&e.columnSorted===t.ref?((0,l.uX)(),(0,l.Wv)(g,{key:0,icon:"asc"===e.sortOrder?e.arrowUp:e.arrowDown},null,8,["icon"])):(0,l.Q3)("",!0),(0,l.bF)(y,{class:"ion-text-center uppercase"},{default:(0,l.k6)((()=>[(0,l.Lk)("b",d,(0,a.v_)(t.label),1)])),_:2},1024)])),_:2},1024)],8,u)})),128))])))),128))]),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.page,((t,n)=>((0,l.uX)(),(0,l.CE)("tr",{key:n},[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(t.row,((n,o)=>{var r;return(0,l.uX)(),(0,l.CE)("td",{key:o,onClick:()=>e.onClickTablecell(t),class:(0,a.C4)({"clickable-cell":null===n||void 0===n||null===(r=n.column)||void 0===r?void 0:r.tdClick})},[(0,l.Lk)("span",p,(0,a.v_)(0==o&&e.moment(n.value).isValid()?e.moment(n.value).format("DD/MMMM/YYYY HH:mm"):n.value),1)],10,c)})),128))])))),128))])])])),_:1}),(0,l.bF)(I,null,{default:(0,l.k6)((()=>[(0,l.bF)(C,{color:"light"},{default:(0,l.k6)((()=>[e.totalPages>1?((0,l.uX)(),(0,l.Wv)(b,{key:0,onClick:e.first,disabled:1===e.currentPage,size:"large",slot:"end"},{default:(0,l.k6)((()=>t[2]||(t[2]=[(0,l.eW)(" First ")]))),_:1},8,["onClick","disabled"])):(0,l.Q3)("",!0),e.totalPages>1?((0,l.uX)(),(0,l.Wv)(b,{key:1,onClick:e.prev,disabled:!e.canPrev,color:"light",size:"large",slot:"end"},{default:(0,l.k6)((()=>t[3]||(t[3]=[(0,l.eW)(" Prev ")]))),_:1},8,["onClick","disabled"])):(0,l.Q3)("",!0),e.totalPages>1?((0,l.uX)(),(0,l.Wv)(b,{key:2,onClick:e.next,disabled:!e.canNext,color:"light",size:"large",slot:"end"},{default:(0,l.k6)((()=>t[4]||(t[4]=[(0,l.eW)(" Next ")]))),_:1},8,["onClick","disabled"])):(0,l.Q3)("",!0),(0,l.bF)(b,{onClick:e.finish,color:"success",size:"large",slot:"end"},{default:(0,l.k6)((()=>t[5]||(t[5]=[(0,l.eW)(" Finish ")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})}n(72712),n(3949),n(8872);var f=n(95093),_=n.n(f),m=n(72433),g=n(35480),b=n(50953),y=n(27311),h=n(2543),k=function(e){return function(t,n,l){return e(t,n,l)*l}},C=function(e,t){if(e)throw Error("Invalid sort config: "+t)},F=function(e){var t=e||{},n=t.asc,l=t.desc,a=n?1:-1,o=n||l;C(!o,"Expected `asc` or `desc` property"),C(n&&l,"Ambiguous object with `asc` and `desc` config properties");var r=e.comparer&&k(e.comparer);return{order:a,sortBy:o,comparer:r}},T=function(e){return function t(n,l,a,o,r,i,s){var u,d;if("string"===typeof n)u=i[n],d=s[n];else{if("function"!==typeof n){var c=F(n);return t(c.sortBy,l,a,c.order,c.comparer||e,i,s)}u=n(i),d=n(s)}var p=r(u,d,o);return(0===p||null==u&&null==d)&&l.length>a?t(l[a],l,a+1,o,r,i,s):p}};function w(e,t,n){if(void 0===e||!0===e)return function(e,l){return t(e,l,n)};if("string"===typeof e)return C(e.includes("."),"String syntax not allowed for nested properties."),function(l,a){return t(l[e],a[e],n)};if("function"===typeof e)return function(l,a){return t(e(l),e(a),n)};if(Array.isArray(e)){var l=T(t);return function(a,o){return l(e[0],e,1,n,t,a,o)}}var a=F(e);return w(a.sortBy,a.comparer||t,a.order)}var I=function(e,t,n,l){var a;return Array.isArray(t)?(Array.isArray(n)&&n.length<2&&(a=n,n=a[0]),t.sort(w(n,l,e))):t};function x(e){var t=k(e.comparer);return function(n){var l=Array.isArray(n)&&!e.inPlaceSorting?n.slice():n;return{asc:function(e){return I(1,l,e,t)},desc:function(e){return I(-1,l,e,t)},by:function(e){return I(1,l,e,t)}}}}var W=function(e,t,n){return null==e?n:null==t?-n:typeof e!==typeof t?typeof e<typeof t?-1:1:e<t?-1:e>t?1:0},P=x({comparer:W}),A=(x({comparer:W,inPlaceSorting:!0}),n(77270)),S=n(47120),z=n(75220),E=n(53751);n(74423);function N(e,t,n,o,r,i){const s=(0,l.g2)("ion-title"),u=(0,l.g2)("IonIcon"),d=(0,l.g2)("ion-button"),c=(0,l.g2)("ion-buttons"),p=(0,l.g2)("ion-toolbar"),v=(0,l.g2)("ion-header"),f=(0,l.g2)("ion-label"),_=(0,l.g2)("ion-item"),m=(0,l.g2)("ion-list"),g=(0,l.g2)("ion-content"),b=(0,l.g2)("ion-footer"),y=(0,l.g2)("ion-modal"),h=(0,l.g2)("ion-page");return(0,l.uX)(),(0,l.Wv)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(g,{class:"ion-padding"},{default:(0,l.k6)((()=>[(0,l.bF)(y,{"is-open":e.open,style:{"--width":"70%"},fullscreen:""},{default:(0,l.k6)((()=>[(0,l.bF)(v,null,{default:(0,l.k6)((()=>[(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(s,{style:{"font-size":"20px","font-weight":"600"}},{default:(0,l.k6)((()=>t[3]||(t[3]=[(0,l.eW)("Test Details")]))),_:1}),(0,l.bF)(c,{slot:"end"},{default:(0,l.k6)((()=>[(0,l.bF)(d,{strong:!0,onClick:e.handleDialog},{default:(0,l.k6)((()=>[(0,l.bF)(u,{size:"large",icon:e.close},null,8,["icon"])])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),(0,l.bF)(g,null,{default:(0,l.k6)((()=>[(0,l.bF)(m,null,{default:(0,l.k6)((()=>[(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.bF)(f,{style:{"font-size":"23px","font-weight":"600"}},{default:(0,l.k6)((()=>t[4]||(t[4]=[(0,l.eW)("Tracking Number")]))),_:1}),(0,l.bF)(f,{slot:"end",style:{"font-size":"20px"}},{default:(0,l.k6)((()=>{var t;return[(0,l.eW)((0,a.v_)(null===(t=e.details)||void 0===t?void 0:t.tracking_number),1)]})),_:1})])),_:1}),(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.bF)(f,{style:{"font-size":"23px","font-weight":"600"}},{default:(0,l.k6)((()=>t[5]||(t[5]=[(0,l.eW)("Accession Number")]))),_:1}),(0,l.bF)(f,{slot:"end",style:{"font-size":"20px"}},{default:(0,l.k6)((()=>{var t;return[(0,l.eW)((0,a.v_)(null===(t=e.details)||void 0===t?void 0:t.accession_number),1)]})),_:1})])),_:1}),(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.bF)(f,{style:{"font-size":"23px","font-weight":"600"}},{default:(0,l.k6)((()=>t[6]||(t[6]=[(0,l.eW)("Patient Name")]))),_:1}),(0,l.bF)(f,{slot:"end",style:{"font-size":"20px"}},{default:(0,l.k6)((()=>{var t,n,o,r;return[(0,l.eW)((0,a.v_)(`${null===(t=e.details)||void 0===t?void 0:t.client.first_name} ${null!==(null===(n=e.details)||void 0===n?void 0:n.client.middle_name)?null===(o=e.details)||void 0===o?void 0:o.client.middle_name:""}\n                ${null===(r=e.details)||void 0===r?void 0:r.client.last_name}`),1)]})),_:1})])),_:1}),(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.bF)(f,{style:{"font-size":"23px","font-weight":"600"}},{default:(0,l.k6)((()=>t[7]||(t[7]=[(0,l.eW)("Specimen Type")]))),_:1}),(0,l.bF)(f,{slot:"end",style:{"font-size":"20px"}},{default:(0,l.k6)((()=>{var t;return[(0,l.eW)((0,a.v_)(null===(t=e.details)||void 0===t?void 0:t.specimen_type),1)]})),_:1})])),_:1}),(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.bF)(f,{style:{"font-size":"23px","font-weight":"600"}},{default:(0,l.k6)((()=>t[8]||(t[8]=[(0,l.eW)("Test(s) Ordered")]))),_:1}),(0,l.bF)(f,{slot:"end",style:{"font-size":"20px"}},{default:(0,l.k6)((()=>[(0,l.eW)((0,a.v_)(e.testDisplayName),1)])),_:1})])),_:1}),(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.bF)(f,{style:{"font-size":"23px","font-weight":"600"}},{default:(0,l.k6)((()=>t[9]||(t[9]=[(0,l.eW)("Specimen Status")]))),_:1}),(0,l.bF)(f,{slot:"end",style:{"font-size":"20px"}},{default:(0,l.k6)((()=>{var t,n;return[(0,l.eW)((0,a.v_)("specimen-not-collected"==(null===(t=e.details)||void 0===t?void 0:t.order_status)?"Specimen not collected":null===(n=e.details)||void 0===n?void 0:n.order_status),1)]})),_:1})])),_:1})])),_:1})])),_:1}),(0,l.bF)(b,null,{default:(0,l.k6)((()=>[(0,l.bF)(p,{color:"light",style:{padding:"5px"}},{default:(0,l.k6)((()=>{var n,a,o,r,i,s,u;return[(0,l.bF)(d,{slot:"end",size:"large",color:"primary",onClick:e.viewTestDetails},{default:(0,l.k6)((()=>t[10]||(t[10]=[(0,l.eW)(" View ")]))),_:1},8,["onClick"]),(0,l.bF)(d,{size:"large",slot:"end",onClick:t[0]||(t[0]=t=>{var n;return e.printAccessNumber(null===(n=e.details)||void 0===n?void 0:n.accession_number)})},{default:(0,l.k6)((()=>t[11]||(t[11]=[(0,l.eW)(" Print Accession Number ")]))),_:1}),"specimen-accepted"===(null===(n=e.details)||void 0===n?void 0:n.order_status)||"specimen-rejected"===(null===(a=e.details)||void 0===a?void 0:a.order_status)||!e.details.status||null!==(o=e.details)&&void 0!==o&&o.status.includes("rejected")?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(d,{key:0,onClick:t[1]||(t[1]=t=>e.changeSpecimenStatus("accepted")),slot:"end",size:"large",color:"success"},{default:(0,l.k6)((()=>t[12]||(t[12]=[(0,l.eW)(" Accept ")]))),_:1})),"specimen-accepted"===(null===(r=e.details)||void 0===r?void 0:r.order_status)||"specimen-rejected"===(null===(i=e.details)||void 0===i?void 0:i.order_status)||!e.details.status||null!==(s=e.details)&&void 0!==s&&s.status.includes("rejected")?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(d,{key:1,onClick:e.rejectOrder,slot:"end",size:"large",color:"danger"},{default:(0,l.k6)((()=>t[13]||(t[13]=[(0,l.eW)(" Reject ")]))),_:1},8,["onClick"])),"specimen-rejected"!==(null===(u=e.details)||void 0===u?void 0:u.order_status)?((0,l.uX)(),(0,l.Wv)(d,{key:2,onClick:e.addTest,slot:"end",size:"large",color:"primary"},{default:(0,l.k6)((()=>t[14]||(t[14]=[(0,l.eW)(" Add Test ")]))),_:1},8,["onClick"])):(0,l.Q3)("",!0),(0,l.bF)(d,{onClick:t[2]||(t[2]=t=>e.addOrderToEncounter(e.details.encounter_id)),slot:"end",size:"large",color:"success"},{default:(0,l.k6)((()=>t[15]||(t[15]=[(0,l.eW)(" Add Order ")]))),_:1})]})),_:1})])),_:1})])),_:1},8,["is-open"])])),_:1})])),_:1})}n(72577);var O=n(741),D=n(32336),L=n(46079),K=n(85901),R=n(94355),X=n(1590),j=n(82077);const M=(0,l.pM)({useTestNamePreference:D.i,components:{IonButtons:m.QW,IonButton:m.Jm,IonIcon:m.iq,IonModal:m.Sb,IonHeader:m.eU,IonContent:m.W9,IonToolbar:m.ai,IonTitle:m.BC,IonFooter:m.M0,IonItem:m.uz,IonLabel:m.he,IonList:m.nf,IonPage:m.AO},data(){return{open:this.show,details:{client:{date_of_birth:"",first_name:"",id:"",last_name:"",middle_name:"",sex:""}},close:g.VNx,options:[{label:"Order Id",value:"-"},{label:"Tracking Number",value:"-"},{label:"Accession Number",value:"-"},{label:"Patient Name",value:"-"},{label:"Specimen Type",value:"-"},{label:"Test(s) Ordered",value:"-"},{label:"Specimen Status",value:"-"}]}},props:{test:{required:!0,type:Object},show:{required:!0,default:!1,type:Boolean}},async created(){const e=(0,O.Kj)(),t=await e.getJson(`tests/${this.test.id}`);null!==t&&void 0!==t&&t.ok&&(this.details=null===t||void 0===t?void 0:t.data,!this.details.preferred_name&&this.details.test_type_name&&(this.details.preferred_name=this.getPreferredName(this.details.test_type_name)))},computed:{testDisplayName(){var e,t;const{getDisplayName:n}=(0,D.i)();return n(null===(e=this.details)||void 0===e?void 0:e.test_type_name,null===(t=this.details)||void 0===t?void 0:t.test_type_preferred_name)}},methods:{getPreferredName(e){const{generatePreferredName:t}=(0,D.i)();return t(e)},viewTestDetails(){this.handleDialog(),L.A.push(`test/details?test_id=${this.test.id}`)},rejectOrder(){this.open=!1,L.A.push(`test/reject/${this.test.id}`)},handleDialog(){this.open=!1},async changeSpecimenStatus(e){const t=(0,O.Kj)(),n=await t.putJson(`order_statuses/${e}`,{order_id:this.details.order_id});null!==n&&void 0!==n&&n.ok&&((0,K.tP)(`Specimen ${e} successfully!`),L.A.go(0),this.handleDialog())},loadOrder(e){(0,R.A)().searchbyID(e)},async addTest(){var e;this.handleDialog();const t=(0,O.Kj)(),n=null!==(e=this.details.client)&&void 0!==e&&e.sex.match(/f/i)?"Female":"Male";(0,y.u0)([{id:"test_types",helpText:"Select test types",type:A.P.TT_MULTIPLE_SELECT,config:{showKeyboard:!0},computedValue:(e,t)=>({order_id:this.details.order_id,tests:e.map((e=>({specimen:e.value,test_type:e.label})))}),options:async()=>{const e=await t.getJson("specimen/test_types",{specimen_id:this.details.specimen_id,sex:n});return null!==e&&void 0!==e&&e.ok?e.data.map((e=>({label:e,value:this.details.specimen_id}))):[]},validation:e=>X.A.required(e)}],(async(e,n)=>{const l=await t.postJson("orders/add_test_to_order",n.test_types);if(null===l||void 0===l||!l.ok)return(0,K._O)(null===l||void 0===l?void 0:l.error);m.OZ.getTop().then((e=>e&&m.OZ.dismiss())),this.loadOrder(this.details.accession_number)}),null)},async addOrderToEncounter(e){var t;this.handleDialog();const n=(0,O.Kj)(),l=null!==(t=this.details.client)&&void 0!==t&&t.sex.match(/f/i)?"Female":"Male";let a=[],o=[],r=null;const{getDisplayName:i}=(0,D.i)();(0,y.u0)([{id:"specimen_type",helpText:"Specimen type",type:A.P.TT_SELECT,requireNext:!1,init:async()=>{const e=await n.getJson("specimen");return!(null===e||void 0===e||!e.ok)&&(a=e.data.map((e=>({label:i(e.name,e.preferred_name),value:e.id}))),!0)},config:{showKeyboard:!0},options:()=>a,validation:e=>X.A.required(e)},{id:"test_types",helpText:"Select test types",type:A.P.TT_MULTIPLE_SELECT,config:{showKeyboard:!0},computedValue:(e,t)=>({tests:e.map((e=>({specimen:t.specimen_type.value,test_type:e.value})))}),options:async e=>{if(e.specimen_type.value){o=[],r=e.specimen_type.value;const t=await n.getJson("specimen/test_types",{specimen_id:r,sex:l});if(null===t||void 0===t||!t.ok)return[];o=t.data.map((e=>({label:e,value:e})))}return o},validation:e=>X.A.required(e)}],(async(t,l)=>{var a;l.encounter_id=e;const{getLocation:o,token:r}=(0,O.Kj)(),i=null===(a=r.value)||void 0===a||null===(a=a.authorization)||void 0===a?void 0:a.user,s=i.lab_locations.find((e=>e.name==o())),u=await n.postJson("orders/add_order_to_encounter",{encounter_id:l.encounter_id,lab_location:s.id||0,tests:l.test_types.tests});if(null===u||void 0===u||!u.ok)return(0,K._O)(null===u||void 0===u?void 0:u.error);u.ok&&this.printAccessNumber(u.data.accession_number),m.OZ.getTop().then((e=>e&&m.OZ.dismiss())),this.loadOrder(u.data.accession_number)}),null)},printAccessNumber(e){const t=new j.A,n=e;t.writeLbl("printout/accession_number",{accession_number:n},`${n}.lbl`)}}});var $=n(66262);const B=(0,$.A)(M,[["render",N]]),Q=B;function q(e,t){const n=document.getElementById("rootContainer"),l=(0,E.Ef)(Q,{show:e,test:t});l.mount(n,!1)}const J=(0,l.pM)({components:{IonPage:m.AO,IonToolbar:m.ai,IonItem:m.uz,IonIcon:m.iq,IonLabel:m.he,IonTitle:m.BC,IonHeader:m.eU,IonButton:m.Jm,IonFooter:m.M0,IonContent:m.W9,IonButtons:m.QW,IonChip:m.ZB},props:{title:{type:String,default:"Report"},subtitle:{type:String},columns:{type:Object,required:!0},columnData:{type:Array,default:()=>[]},enablePagination:{type:Boolean,default:!0},rowsPerPage:{type:Number,default:10},onFinish:{type:Function},onRefresh:{type:Function},onConfigure:{type:Function},csvQuarter:{type:String},searchValue:{type:String},pageMetadata:{type:Object,default:()=>({current_page:1,next_page:1,prev_page:1,total_pages:1,total_count:1})}},data(){return{moment:_()}},setup(e,{emit:t}){const n=(0,z.rd)(),a=(0,b.KR)([]),o=(0,b.KR)(1),r=(0,b.KR)(""),i=(0,b.KR)(""),s=(0,b.KR)("desc"),u=(0,l.EW)((()=>{const t=P(a.value)[s.value]((e=>e.data[i.value]));if(r.value){const n=new S.A(t,{threshold:.3,keys:["searchIndex"],useExtendedSearch:!0});return n.search(r.value,{limit:e.rowsPerPage}).map((e=>e.item))}return t})),d=(0,l.EW)((()=>e.pageMetadata.total_count)),c=(0,l.EW)((()=>e.pageMetadata.current_page<e.pageMetadata.next_page)),p=(0,l.EW)((()=>e.pageMetadata.prev_page>0)),v=(0,l.EW)((()=>u.value)),f=e=>{i.value=e,s.value="asc"===s.value?"desc":"asc"},_=()=>(0,y.Qf)((e=>{const t=parseInt(e);parseInt(e)<=d.value&&(o.value=t)}),{title:"Select page"}),m=()=>{(0,y.Ay)({id:"search",helpText:"Find",type:A.P.TT_TEXT},(e=>{setTimeout((()=>{r.value=e?e.value:"",o.value=1,k(r.value,1)}),3)}))},k=(e,n)=>{t("search",e,n)},C=()=>{o.value=1,k(r.value,o.value)},F=()=>o.value=d.value-1||0,T=()=>{o.value+=1,k(r.value,o.value)},w=()=>{o.value-=1,k(r.value,o.value)},I=()=>{"function"===typeof e.onFinish?e.onFinish():n.push("/")},x=e=>{q(!0,e.data);try{var t,n;if("function"===typeof(null===(t=e.column)||void 0===t?void 0:t.tdClick))null===(n=e.column)||void 0===n||n.tdClick(e);return}catch(l){console.error(l)}},W=()=>e.columns.reduce(((e,t)=>e.concat(t)),[]).filter((e=>e.value||e.ref)),E=e=>{e.forEach((e=>{const t=W().map((t=>{let n="";try{n=(0,h.isEmpty)(e)?"...":"function"===typeof t.value?t.value(e):e[t.ref]||""}catch(l){n="_ERROR_",console.error(l)}return{column:t,data:e,value:n,[t.ref||"nada"]:n}}));a.value.push({row:t,data:e,searchIndex:t.map((e=>`${e.value}`))})}))};(0,l.wB)((()=>e.columnData),(t=>{if(a.value=[],!Array.isArray(t)||!t.length)return o.value=1,r.value="",i.value="",void E(Array.from({length:e.rowsPerPage}).map((()=>({}))));E(t)}),{immediate:!0,deep:!0});const N=()=>{r.value="",t("search","",1)};return{clearSearch:N,first:C,last:F,next:T,prev:w,selectPage:_,sortColumn:f,searchTable:m,onClickTablecell:x,finish:I,sync:g.OH5,search:g.$P,close:g.VNx,arrowUp:g.bi4,arrowDown:g.mLg,document:g.AlX,page:v,canNext:c,searchTerm:r,totalPages:d,sortOrder:s,canPrev:p,currentPage:o,columnSorted:i}}}),V=(0,$.A)(J,[["render",v],["__scopeId","data-v-837cdb80"]]),U=V,H=(0,l.pM)({__name:"TestsPage",setup(e){const{getDisplayName:t}=(0,D.i)(),n=[[{label:"Date ordered",ref:"created_date"},{label:"Patient No",value:e=>{var t;return(null===e||void 0===e||null===(t=e.client)||void 0===t?void 0:t.id)||"-"}},{label:"Patient Name",value:e=>{var t,n;return`${null===e||void 0===e||null===(t=e.client)||void 0===t?void 0:t.first_name} ${null===e||void 0===e||null===(n=e.client)||void 0===n?void 0:n.last_name}`}},{label:"Accession No",ref:"accession_number"},{label:"Test type",value:e=>t(null===e||void 0===e?void 0:e.test_type_name,null===e||void 0===e?void 0:e.test_type_preferred_name)},{label:"Test Location",ref:"requesting_ward"},{label:"Test status",ref:"status"}]],a=(0,b.KR)([]),o=(0,b.KR)({current_page:1,next_page:1,prev_page:1,total_pages:1,total_count:1}),r=(0,O.Kj)(),i=(0,b.KR)(`${void 0!==L.A.currentRoute.value.query.patient_id?L.A.currentRoute.value.query.patient_id:""}`);function s(){L.A.push("/")}const u=(e,t)=>{d(e,t)};function d(e,t){var n;const l=e||"",i=t||1,{getLocation:s,token:u}=(0,O.Kj)(),d=null===(n=u.value)||void 0===n||null===(n=n.authorization)||void 0===n?void 0:n.user,c=d.lab_locations.filter((e=>e.name==s()));r.getJson(`tests?search=${l}&page=${i}&per_page=24&lab_location=${c[0].id}`).then((e=>{if(!e.ok)return(0,K._O)(e.error);const t=e.data.data.map((e=>{if(!e.test_type_preferred_name&&e.test_type_name){const{generatePreferredName:t}=(0,D.i)();e.preferred_name=t(e.test_type_name)}return e}));a.value=t.reverse(),o.value=e.data.meta}))}return(0,l.sV)((()=>d("",1))),(e,t)=>((0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(U,{searchValue:i.value,title:"All Tests",onSearch:u,columns:n,columnData:a.value,rowsPerPage:25,finish:s,onRefresh:d,pageMetadata:o.value},null,8,["searchValue","columnData","pageMetadata"]),t[0]||(t[0]=(0,l.Lk)("div",{id:"rootContainer"},null,-1))]))}}),Z=H,Y=Z}}]);
//# sourceMappingURL=4811.869ea751.js.map