"use strict";(globalThis["webpackChunkIBLISReception"]=globalThis["webpackChunkIBLISReception"]||[]).push([[4082],{3553:(e,t,a)=>{a.d(t,{Ab:()=>u,C_:()=>i,b9:()=>c,hd:()=>d,tr:()=>p,xL:()=>o});var n=a(3283);const l=[n.t$,[["","Delete"]]],i=[n.RH,[["Delete"]]],o=(n.RH,[n.RH,[["N/A"],["Delete","Unknown"]]]),u=[n.RH,[["Delete"]]],r=[n.RH,[["Unknown","Delete"],["Qwerty","A-Z"]]],d=[n.RK,[["Unknown"]]],s=[n.Xh,[["0-9","Delete"],["Qwerty","Unknown"],["","Space"]]],c=[n.dX,[["","Delete"],["?123","0-9"],["Space","Unknown"]]],p=[{btn:"0-9",keyboard:r},{btn:"?123",keyboard:l},{btn:"A-Z",keyboard:s},{btn:"Qwerty",keyboard:c}]},3283:(e,t,a)=>{a.d(t,{RH:()=>i,RK:()=>o,Xh:()=>u,Xt:()=>n,dX:()=>r,t$:()=>l,xi:()=>d});const n=[["1","2","3"],["4","5","6"],["7","8","9"],[".","0","Del"],["","Done",""]],l=[["1","2","3","+","-","/","*"],["4","5","6","%","=","<",">","Qwerty"],["7","8","9",".",","],["","0",""]],i=[["1","2","3"],["4","5","6"],["7","8","9"],["","0",""]],o=[["1","2","3","4","5","6","7"],["8","9","10","11","12","13","14"],["15","16","17","18","19","20","21"],["22","23","24","25","26","27","28"],["29","30","31"]],u=[["a","b","c","d","e","f","g","h","."],["i","j","k","l","m","n","o","p","q"],["r","s","t","u","v","w","x","y","z"]],r=[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l","'"],["z","x","c","v","b","n","m",",",".","A-Z"]],d=[["1","2","3","4","5","6","7","8","9","0","Del"],["q","w","e","r","t","y","u","i","o","p","Clear"],["a","s","d","f","g","h","j","k","l",".","Caps"],["z","x","c","v","b","n","m","<",">","/","Enter"]]},8688:(e,t,a)=>{a.d(t,{C:()=>n});a(5827);function n(e,t){const a=Object.values(Object.values(e)),n=a.filter((e=>!!e[t])).reduce(((e,a)=>(Array.isArray(a[t])?e[t]=a[t]:e[t]={...e[t],...a[t]},e)),{});return n}},1687:(e,t,a)=>{a.r(t),a.d(t,{default:()=>U});a(7658);var n=a(6252),l=a(9013),i=a(516),o=a(9652),u=a(4542),r=a(6188),d=a(2262),s=a(6486),c=a(3231),p=a(905);a(6699),a(5827),a(4916);const m=[{label:"Jan",value:1},{label:"Feb",value:2},{label:"Mar",value:3},{label:"Apr",value:4},{label:"May",value:5},{label:"Jun",value:6},{label:"Jul",value:7},{label:"Aug",value:8},{label:"Sep",value:9},{label:"Oct",value:10},{label:"Nov",value:11},{label:"Dec",value:12}];var f,v=a(3283),h=a(3553),T=a(7484),b=a.n(T),y=a(60);function _(e,t,a=!0){const n=[];return a&&n.push("UNKNOWN"),{id:e,helpText:`${t} Year`,appearInSummary:()=>!1,type:o.f.TT_TEXT,config:{customKeyboard:[v.RH,[n,["DELETE"]]]}}}function x(e,t){return{id:e,helpText:`${t} Month`,appearInSummary:()=>!1,type:o.f.TT_SELECT,options:()=>m}}function $(e,t){return{id:e,helpText:`${t} Day`,type:o.f.TT_MONTHLY_DAYS,appearInSummary:()=>!1}}function D(e,t){return{id:e,helpText:`${t} Estimated period`,type:o.f.TT_SELECT,appearInSummary:()=>!1,options:()=>[{label:"6 months ago",value:180},{label:"12 months ago",value:365},{label:"18 months ago",value:540},{label:"24 months ago",value:730},{label:"Over 2 years ago",value:730}]}}function w(e,t){return{id:e,helpText:`${t} Age Estimate`,type:o.f.TT_NUMBER,appearInSummary:()=>!1,config:{keypad:h.Ab}}}function E(e){return parseInt(e)<10?`0${e}`:e}async function k(e,t,a){if(t.defaultValue){const n=await t.defaultValue(e);if(n){const[e,t,l]=n.split("-");switch(a){case"Year":return e||"";case"Month":return parseInt(t)||"";case"Day":return parseInt(l)||""}}}return""}function g(e){return p.Z.toStandardHisDisplayFormat(e)}function I(e,t,a,n){if(t.minDate){const l=t.minDate(a,n);if(new Date(e)<new Date(l))return[`${g(e)} is less than minimum date of ${g(l)}`]}if(t.maxDate){const l=t.maxDate(a,n);if(l&&new Date(e)>new Date(l))return[`${g(e)} is greater than max date of  ${g(l)}`]}}function N(e,t=""){let a="",n="",i="",o="",u=!1;const r=`year_${e.id}`,d=`month_${e.id}`,s=`day_${e.id}`,c=`age_estimate_${e.id}`,v=`duration_estimate_${e.id}`,h=_(r,e.helpText,e.estimation.allowUnknown),T=x(d,e.helpText),N=$(s,e.helpText),S=w(c,e.helpText),V=D(v,e.helpText),M="boolean"===typeof e.estimation.allowUnknownMonthDay&&e.estimation.allowUnknownMonthDay,U=t=>!(t[r]&&t[r].value&&["Unknown"].includes(t[r].value))&&(!e.condition||e.condition(t)),A=(e,t)=>{const a=[{type:"year",value:n,default:"YYYY"},{type:"month",value:i,default:"MM"},{type:"day",value:o,default:"DD"}];return a.reduce(((a,n)=>{const l=[null,void 0,"Unknown",""];return t===n.type?l.includes(e)?a.push(n.default):a.push(e):l.includes(n.value)?a.push(n.default):a.push(n.value),a}),[]).join("-")};"function"===typeof e.init&&(h.init=e.init),h.updateHelpTextOnValue=e=>`${h.helpText} (${A(null===e||void 0===e?void 0:e.label,"year")})`,h.proxyID=e.id,h.unload=e=>n=e.value.toString(),h.config={...h.config,...e.config},h.defaultValue=t=>k(t,e,"Year"),h.condition=t=>!e.condition||e.condition(t),h.validation=(t,a,n)=>{if(e.required&&l.Z.required(t))return["Year cannot be empty"];const i=t?t.value:"";if(!e.estimation.allowUnknown&&i.toString().match(/unknown/i))return["Value unknown is not permitted"];if(i&&!["Unknown"].includes(i)&&isNaN(i)||Number(i)<1900)return["Invalid Year"];if(i&&"function"===typeof e.minDate){const t=p.Z.getYear(e.minDate(a,n));if(parseInt(i)<t)return[`Year of ${i} is less than Minimum year of ${t}`]}if(i&&"function"===typeof e.maxDate){const t=e.maxDate(a,n);if(t&&Number(i)>p.Z.getYear(t))return[`Year of ${i} exceeds Maximum year of ${p.Z.getYear(t)}`]}return null},h.summaryMapValue=()=>({label:e.summaryLabel||e.helpText,value:a?g(a):"Unknown"}),h.appearInSummary=(t,a)=>a===e.id,h.computedValue=t=>{if(a){const[n,l,i]=a.split("-");return a=`${t.value}-${l}-${i}`,e.computeValue(a,!1)}if(t&&"Unknown"===t.value)return a="",e.computeValue("Unknown",!1)},T.updateHelpTextOnValue=e=>`${T.helpText} (${A(null===e||void 0===e?void 0:e.label,"month")})`,T.proxyID=e.id,T.unload=e=>i=E(e.value.toString()),T.condition=e=>U(e),T.validation=e=>l.Z.required(e),T.defaultValue=t=>k(t,e,"Month"),M&&(T.options=()=>[...m,{label:"Unknown",value:"Unknown"}]),T.computedValue=(t,n)=>{if(`${t.value}`.match(/unknown/i))return a=`${n[r].value}-07-15`,e.computeValue(a,!0);if(a){const[n,l,i]=a.split("-"),o=E(`${t.value}`);return a=`${n}-${o}-${i}`,e.computeValue(a,!1)}},N.proxyID=e.id,N.updateHelpTextOnValue=e=>`${N.helpText} (${A(null===e||void 0===e?void 0:e.label,"day")})`,N.condition=e=>!`${e[d].value}`.match(/unknown/i)&&U(e),N.validation=(t,r,d)=>l.Z.required(t)?["Day is required for date"]:(u=!!`${t.value}`.match(/unknown/i),o=u?"15":E(`${t.value}`),a=`${n}-${i}-${o}`,I(a,e,r,d)),N.defaultValue=t=>k(t,e,"Day"),N.computedValue=()=>e.computeValue(a,u),N.unload=(t,a,n,l)=>{e.unload&&e.unload(t,a,n,l)},N.beforeNext=(t,n)=>!e.beforeNext||e.beforeNext(a,n),N.config={year:e=>e[r].value,month:e=>e[d].value},M||(N.config.keyboardActions=[]);const F=(t,a)=>{const n=["Unknown"===t[r].value,!e.condition||e.condition(t),e.estimation.estimationFieldType===a];return n.every(Boolean)};return S.proxyID=e.id,S.validation=(t,n,l)=>{if(!t)return["Age estimate is required"];const i=/^(12[0-7]|1[01][0-9]|[1-9]?[0-9])$/;if(!`${null===t||void 0===t?void 0:t.value}`.match(i))return["Not a valid age estimate"];const o=parseInt(`${(null===t||void 0===t?void 0:t.value)||-1}`);if(o<0)return["Please enter a valid number"];if(o>300)return["Age estimate is too high and exceeding hard limit of 300"];const u=b()(y.t6.getSessionDate()).subtract(o,"years").year();return a=`${u}-07-15`,I(a,e,n,l)},S.condition=e=>F(e,f.AGE_ESTIMATE_FIELD),S.computedValue=()=>e.computeValue(a,!0),S.beforeNext=(t,n)=>!e.beforeNext||e.beforeNext(a,n),V.proxyID=e.id,V.validation=(t,n,i)=>l.Z.required(t)?["Please select an estimate"]:(a=b()(y.t6.getSessionDate()).subtract(t.value,"day").format(p.i),I(a,e,n,i)),V.condition=e=>F(e,f.MONTH_ESTIMATE_FIELD),V.computedValue=()=>e.computeValue(a,!0),V.beforeNext=(t,n)=>!e.beforeNext||e.beforeNext(a,n),[h,T,N,S,V]}(function(e){e["AGE_ESTIMATE_FIELD"]="age-estimate-field",e["MONTH_ESTIMATE_FIELD"]="month-period-estimate-field"})(f||(f={}));var S=a(8688);const V=(0,n.aZ)({__name:"FindOrRegister",setup(e){const t=(0,u.KU)(),a=(0,d.iH)(""),m=()=>({id:"first_name",helpText:"First name",type:o.f.TT_TEXT,computedValue:e=>({person:{first_name:e.value}}),validation:e=>l.Z.isName(e)}),v=()=>({id:"last_name",helpText:"Last name",type:o.f.TT_TEXT,computedValue:e=>({person:{last_name:e.value}}),validation:e=>l.Z.isName(e)}),h=()=>({id:"middle_name",helpText:"Middle name(Optional)",type:o.f.TT_TEXT,computedValue:e=>{if(e)return{person:{middle_name:e.value}}}}),T=()=>({id:"sex",helpText:"Gender",type:o.f.TT_SELECT,computedValue:e=>({person:{sex:e.value}}),validation:e=>l.Z.required(e),options:()=>[{label:"Female",value:"F"},{label:"Male",value:"M"}]}),b=()=>{const e={id:"date_of_birth",summaryLabel:"Date of Birth",helpText:"Birth",required:!0,minDate:()=>p.Z.estimateDateFromAge(100),maxDate:()=>p.Z.sessionDate(),estimation:{allowUnknown:!0,allowUnknownMonthDay:!0,estimationFieldType:f.AGE_ESTIMATE_FIELD},computeValue:(e,t)=>({person:{date_of_birth:e,birth_date_estimated:t}})};return N(e)},y=()=>({id:"physical_address",helpText:"Physical address",type:o.f.TT_TEXT,computedValue:e=>({client_identifiers:{physical_address:e.value}}),validation:e=>l.Z.required(e)}),_=()=>({id:"npid",helpText:"External Patient Number (Option)",type:o.f.TT_TEXT,computedValue:e=>{if(e)return{client_identifiers:{npid:(null===e||void 0===e?void 0:e.value)||""}}}}),x=()=>({id:"results",helpText:"Search results",type:o.f.TT_PERSON_RESULT_VIEW,dynamicHelpText:e=>`Search results for "${e.first_name.value} ${e.last_name.value} | ${e.sex.label}"`,options:async e=>{const a={first_name:e.first_name.value,last_name:e.last_name.value,gender:e.sex.value},n=await t.getJson("clients/search_dde",a);return null!==n&&void 0!==n&&n.ok?n.data.map((e=>({label:`${e.first_name} ${e.last_name} (${e.date_of_birth})`,value:e.client_id,other:{person:e,options:[{label:"First name",value:e.first_name},{label:"Middle name",value:e.middle_name},{label:"Last name",value:e.last_name},{label:"Sex",value:e.sex},{label:"Birthdate",value:e.date_of_birth},{label:"Is birth estimated?",value:e.birth_date_estimated?"Yes":"No"}]}}))):((0,r.L6)("Unable to find client"),[])},config:{hiddenFooterBtns:["Clear","Next","Back","Finish"],footerBtns:[{name:"Edit Search",slot:"end",onClick:()=>{a.value="first_name"}},{name:"New Client",slot:"end",onClick:()=>{a.value="_NEXT_FIELD_"}},{name:"New Order",color:"success",slot:"end",state:{disabled:{default:()=>!0,onValue(e,t){return(0,s.isEmpty)(t.results)}}},onClick:e=>c.Z.push(`/order/${e.results.value}`)}]}}),$=[m(),h(),v(),T(),x(),...b(),y(),_()],D=(e,a)=>{t.postJson("clients",{client:{id:"",uuid:""},...(0,S.C)(a,"person"),...(0,S.C)(a,"client_identifiers")}).then((e=>{if(null!==e&&void 0!==e&&e.ok)return c.Z.push(`/order/${e.data.client_id}`),(0,r.x9)("Client created");(0,r.L6)((null===e||void 0===e?void 0:e.error)||"Unable to create")})).catch((()=>(0,r.N$)(u.XF.GENERAL_ERROR)))};return(e,t)=>((0,n.wg)(),(0,n.j4)(i.Z,{fields:$,onFinish:D,skipSummary:!0,onOnIndex:t[0]||(t[0]=e=>a.value=""),activeField:a.value},null,8,["activeField"]))}}),M=V,U=M}}]);
//# sourceMappingURL=4082.d538657d.js.map